document	O
:	O
A	O
-	O
Fast	Method
-	Method
RCNN	Method
:	O
Hard	Method
Positive	Method
Generation	Method
via	O
Adversary	Method
for	O
Object	Task
Detection	Task
How	O
do	O
we	O
learn	O
an	O
object	Method
detector	Method
that	O
is	O
invariant	O
to	O
occlusions	O
and	O
deformations	O
?	O
Our	O
current	O
solution	O
is	O
to	O
use	O
a	O
data	Method
-	Method
driven	Method
strategy	Method
–	O
collect	O
large	O
-	O
scale	O
datasets	O
which	O
have	O
object	O
instances	O
under	O
different	O
conditions	O
.	O

The	O
hope	O
is	O
that	O
the	O
final	O
classifier	Method
can	O
use	O
these	O
examples	O
to	O
learn	O
invariances	O
.	O

But	O
is	O
it	O
really	O
possible	O
to	O
see	O
all	O
the	O
occlusions	O
in	O
a	O
dataset	O
?	O
We	O
argue	O
that	O
like	O
categories	O
,	O
occlusions	O
and	O
object	O
deformations	O
also	O
follow	O
a	O
long	O
-	O
tail	O
.	O

Some	O
occlusions	O
and	O
deformations	O
are	O
so	O
rare	O
that	O
they	O
hardly	O
happen	O
;	O
yet	O
we	O
want	O
to	O
learn	O
a	O
model	O
invariant	O
to	O
such	O
occurrences	O
.	O

In	O
this	O
paper	O
,	O
we	O
propose	O
an	O
alternative	O
solution	O
.	O

We	O
propose	O
to	O
learn	O
an	O
adversarial	Method
network	Method
that	O
generates	O
examples	O
with	O
occlusions	O
and	O
deformations	O
.	O

The	O
goal	O
of	O
the	O
adversary	O
is	O
to	O
generate	O
examples	O
that	O
are	O
difficult	O
for	O
the	O
object	Method
detector	Method
to	O
classify	O
.	O

In	O
our	O
framework	O
both	O
the	O
original	O
detector	Method
and	O
adversary	Method
are	O
learned	O
in	O
a	O
joint	O
manner	O
.	O

Our	O
experimental	O
results	O
indicate	O
a	O
2.3	O
%	O
mAP	Metric
boost	Metric
on	O
VOC07	Material
and	O
a	O
2.6	O
%	O
mAP	Metric
boost	Metric
on	O
VOC2012	Material
object	Task
detection	Task
challenge	O
compared	O
to	O
the	O
Fast	Method
-	Method
RCNN	Method
pipeline	O
.	O

We	O
also	O
release	O
the	O
code	O
for	O
this	O
paper	O
.	O

section	O
:	O
Introduction	O
The	O
goal	O
of	O
object	Task
detection	Task
is	O
to	O
learn	O
a	O
visual	Method
model	Method
for	O
concepts	O
such	O
as	O
cars	O
and	O
use	O
this	O
model	O
to	O
localize	O
these	O
concepts	O
in	O
an	O
image	O
.	O

This	O
requires	O
the	O
ability	O
to	O
robustly	O
model	O
invariances	O
to	O
illuminations	O
,	O
deformations	O
,	O
occlusions	O
and	O
other	O
intra	O
-	O
class	O
variations	O
.	O

The	O
standard	O
paradigm	O
to	O
handle	O
these	O
invariances	O
is	O
to	O
collect	O
large	O
-	O
scale	O
datasets	O
which	O
have	O
object	O
instances	O
under	O
different	O
conditions	O
.	O

For	O
example	O
,	O
the	O
COCO	Material
dataset	Material
has	O
more	O
than	O
10	O
K	O
examples	O
of	O
cars	O
under	O
different	O
occlusions	O
and	O
deformations	O
.	O

The	O
hope	O
is	O
that	O
these	O
examples	O
capture	O
all	O
possible	O
variations	O
of	O
a	O
visual	O
concept	O
and	O
the	O
classifier	Method
can	O
then	O
effectively	O
model	O
invariances	O
to	O
them	O
.	O

We	O
believe	O
this	O
has	O
been	O
one	O
of	O
the	O
prime	O
reasons	O
why	O
ConvNets	Method
have	O
been	O
so	O
successful	O
at	O
the	O
task	O
of	O
object	Task
detection	Task
:	O
they	O
are	O
able	O
to	O
use	O
all	O
this	O
data	O
to	O
learn	O
invariances	O
.	O

However	O
,	O
like	O
object	O
categories	O
,	O
we	O
believe	O
even	O
occlusions	O
and	O
deformations	O
follow	O
a	O
long	O
-	O
tail	O
distribution	O
.	O

That	O
is	O
,	O
some	O
of	O
the	O
occlusions	O
and	O
deformations	O
are	O
so	O
rare	O
that	O
there	O
is	O
a	O
low	O
chance	O
that	O
they	O
will	O
occur	O
in	O
large	O
-	O
scale	O
datasets	O
.	O

For	O
example	O
,	O
consider	O
the	O
occlusions	O
shown	O
in	O
Figure	O
[	O
reference	O
]	O
.	O

We	O
notice	O
that	O
some	O
occlusions	O
occur	O
more	O
often	O
than	O
others	O
(	O
,	O
occlusion	O
from	O
other	O
cars	O
in	O
a	O
parking	O
garage	O
is	O
more	O
frequent	O
than	O
from	O
an	O
air	O
conditioner	O
)	O
.	O

Similarly	O
,	O
some	O
deformations	O
in	O
animals	O
are	O
common	O
(	O
,	O
sitting	O
/	O
standing	O
poses	O
)	O
while	O
other	O
deformations	O
are	O
very	O
rare	O
.	O

So	O
,	O
how	O
can	O
we	O
learn	O
invariances	O
to	O
such	O
rare	O
/	O
uncommon	O
occlusions	O
and	O
deformations	O
?	O
While	O
collecting	O
even	O
larger	O
datasets	O
is	O
one	O
possible	O
solution	O
,	O
it	O
is	O
not	O
likely	O
to	O
scale	O
due	O
to	O
the	O
long	O
-	O
tail	O
statistics	O
.	O

Recently	O
,	O
there	O
has	O
been	O
a	O
lot	O
of	O
work	O
on	O
generating	O
images	O
(	O
or	O
pixels	O
)	O
.	O

One	O
possible	O
way	O
to	O
learn	O
about	O
these	O
rare	O
occurrences	O
is	O
to	O
generate	O
realistic	O
images	O
by	O
sampling	O
from	O
the	O
tail	Method
distribution	Method
.	O

However	O
,	O
this	O
is	O
not	O
a	O
feasible	O
solution	O
since	O
image	Task
generation	Task
would	O
require	O
training	O
examples	O
of	O
these	O
rare	O
occurrences	O
to	O
begin	O
with	O
.	O

Another	O
solution	O
is	O
to	O
generate	O
all	O
possible	O
occlusions	O
and	O
deformations	O
and	O
train	O
object	Method
detectors	Method
from	O
them	O
.	O

However	O
,	O
since	O
the	O
space	O
of	O
deformations	O
and	O
occlusions	O
is	O
huge	O
,	O
this	O
is	O
not	O
a	O
scalable	O
solution	O
.	O

It	O
has	O
been	O
shown	O
that	O
using	O
all	O
examples	O
is	O
often	O
not	O
the	O
optimal	O
solution	O
and	O
selecting	O
hard	O
examples	O
is	O
better	O
.	O

Is	O
there	O
a	O
way	O
we	O
can	O
generate	O
“	O
hard	O
”	O
positive	O
examples	O
with	O
different	O
occlusions	O
and	O
deformations	O
and	O
without	O
generating	O
the	O
pixels	O
themselves	O
?	O
How	O
about	O
training	O
another	O
network	O
:	O
an	O
adversary	O
that	O
creates	O
hard	O
examples	O
by	O
blocking	O
some	O
feature	O
maps	O
spatially	O
or	O
creates	O
spatial	O
deformations	O
by	O
manipulating	O
feature	O
responses	O
.	O

This	O
adversary	O
will	O
predict	O
what	O
it	O
thinks	O
will	O
be	O
hard	O
for	O
a	O
detector	Method
like	O
Fast	Method
-	Method
RCNN	Method
and	O
in	O
turn	O
the	O
Fast	Method
-	Method
RCNN	Method
will	O
adapt	O
itself	O
to	O
learn	O
to	O
classify	O
these	O
adversarial	O
examples	O
.	O

The	O
key	O
idea	O
here	O
is	O
to	O
create	O
adversarial	O
examples	O
in	O
convolutional	O
feature	O
space	O
and	O
not	O
generate	O
the	O
pixels	O
directly	O
since	O
the	O
latter	O
is	O
a	O
much	O
harder	O
problem	O
.	O

In	O
our	O
experiments	O
,	O
we	O
show	O
substantial	O
improvements	O
in	O
performance	O
of	O
the	O
adversarial	O
Fast	Method
-	Method
RCNN	Method
(	O
A	O
-	O
Fast	Method
-	Method
RCNN	Method
)	O
compared	O
to	O
the	O
standard	O
Fast	Method
-	Method
RCNN	Method
pipeline	O
.	O

section	O
:	O
Related	O
Work	O
In	O
recent	O
years	O
,	O
significant	O
gains	O
have	O
been	O
made	O
in	O
the	O
field	O
of	O
object	Task
detection	Task
.	O

These	O
recent	O
successes	O
build	O
upon	O
the	O
powerful	O
deep	O
features	O
learned	O
from	O
the	O
task	O
of	O
ImageNet	Task
classification	Task
.	O

R	Method
-	Method
CNN	Method
and	O
OverFeat	O
object	Task
detection	Task
systems	O
led	O
this	O
wave	O
with	O
impressive	O
results	O
on	O
PASCAL	O
VOC	Metric
;	O
and	O
in	O
recent	O
years	O
,	O
more	O
computationally	O
efficient	O
versions	O
have	O
emerged	O
that	O
can	O
efficiently	O
train	O
on	O
larger	O
datasets	O
such	O
as	O
COCO	Material
.	O

For	O
example	O
,	O
Fast	Method
-	Method
RCNN	Method
shares	O
the	O
convolutions	Method
across	O
different	O
region	O
proposals	O
to	O
provide	O
speed	O
-	O
up	O
,	O
Faster	Method
-	Method
RCNN	Method
and	O
R	Method
-	Method
FCN	Method
incorporate	O
region	Method
proposal	Method
generation	Method
in	O
the	O
framework	O
leading	O
to	O
a	O
completely	O
end	O
-	O
to	O
-	O
end	O
version	O
.	O

Building	O
on	O
the	O
sliding	Method
-	Method
window	Method
paradigm	Method
of	O
the	O
Overfeat	Method
detector	Method
,	O
other	O
computationally	O
-	O
efficient	O
approaches	O
have	O
emerged	O
such	O
as	O
YOLO	Method
,	O
SSD	Method
and	O
DenseBox	Method
.	O

Thorough	O
comparisons	O
among	O
these	O
methods	O
are	O
discussed	O
in	O
.	O

Recent	O
research	O
has	O
focused	O
on	O
three	O
principal	O
directions	O
on	O
developing	O
better	O
object	Task
detection	Task
systems	O
.	O

The	O
first	O
direction	O
relies	O
on	O
changing	O
the	O
base	O
architecture	O
of	O
these	O
networks	O
.	O

The	O
central	O
idea	O
is	O
that	O
using	O
deeper	Method
networks	Method
should	O
not	O
only	O
lead	O
to	O
improvements	O
in	O
classification	Task
but	O
also	O
object	Task
detection	Task
.	O

Some	O
recent	O
work	O
in	O
this	O
direction	O
include	O
ResNet	Method
,	O
Inception	Method
-	Method
ResNet	Method
and	O
ResNetXt	Method
for	O
object	Task
detection	Task
.	O

The	O
second	O
area	O
of	O
research	O
has	O
been	O
to	O
use	O
contextual	Task
reasoning	Task
,	O
proxy	Task
tasks	Task
for	O
reasoning	Task
and	O
other	O
top	Method
-	Method
down	Method
mechanisms	Method
for	O
improving	O
representations	Task
for	O
object	Task
detection	Task
.	O

For	O
example	O
,	O
use	O
segmentation	Method
as	O
a	O
way	O
to	O
contextually	O
prime	O
object	Method
detectors	Method
and	O
provide	O
feedback	O
to	O
initial	O
layers	O
.	O

uses	O
skip	Method
-	Method
network	Method
architecture	Method
and	O
uses	O
features	O
from	O
multiple	O
layers	Method
of	Method
representation	Method
in	O
conjunction	O
with	O
contextual	Method
reasoning	Method
.	O

Other	O
approaches	O
include	O
using	O
a	O
top	O
-	O
down	O
features	O
for	O
incorporating	O
context	O
and	O
finer	O
details	O
which	O
leads	O
to	O
improved	O
detections	Task
.	O

The	O
third	O
direction	O
to	O
improve	O
a	O
detection	Method
systems	Method
is	O
to	O
better	O
exploit	O
the	O
data	O
itself	O
.	O

It	O
is	O
often	O
argued	O
that	O
the	O
recent	O
success	O
of	O
object	Method
detectors	Method
is	O
a	O
product	O
of	O
better	O
visual	Method
representation	Method
and	O
the	O
availability	O
of	O
large	O
-	O
scale	O
data	O
for	O
learning	Task
.	O

Therefore	O
,	O
this	O
third	O
class	O
of	O
approaches	O
try	O
to	O
explore	O
how	O
to	O
better	O
utilize	O
data	O
for	O
improving	O
the	O
performance	O
.	O

One	O
example	O
is	O
to	O
incorporate	O
hard	Task
example	Task
mining	Task
in	O
an	O
effective	O
and	O
efficient	O
setup	O
for	O
training	Task
region	Task
-	Task
based	Task
ConvNets	Task
.	O

Other	O
examples	O
of	O
findind	O
hard	O
examples	O
for	O
training	O
include	O
.	O

Our	O
work	O
follows	O
this	O
third	O
direction	O
of	O
research	O
where	O
the	O
focus	O
is	O
on	O
leveraging	O
data	O
in	O
a	O
better	O
manner	O
.	O

However	O
,	O
instead	O
of	O
trying	O
to	O
sift	O
through	O
the	O
data	O
to	O
find	O
hard	O
examples	O
,	O
we	O
try	O
to	O
generate	O
examples	O
which	O
will	O
be	O
hard	O
for	O
Fast	Method
-	Method
RCNN	Method
to	O
detect	O
/	O
classify	Task
.	O

We	O
restrict	O
the	O
space	O
of	O
new	O
positive	Task
generation	Task
to	O
adding	O
occlusions	O
and	O
deformations	O
to	O
the	O
current	O
existing	O
examples	O
from	O
the	O
dataset	O
.	O

Specifically	O
,	O
we	O
learn	O
adversarial	Method
networks	Method
which	O
try	O
to	O
predict	O
occlusions	O
and	O
deformations	O
that	O
would	O
lead	O
to	O
mis	O
-	O
classification	Task
by	O
Fast	Method
-	Method
RCNN	Method
.	O

Our	O
work	O
is	O
therefore	O
related	O
to	O
lot	O
of	O
recent	O
work	O
in	O
adversarial	Task
learning	Task
.	O

For	O
example	O
,	O
techniques	O
have	O
been	O
proposed	O
to	O
improve	O
adversarial	Method
learning	Method
for	O
image	Task
generation	Task
as	O
well	O
as	O
for	O
training	O
better	O
image	Method
generative	Method
model	Method
.	O

also	O
highlights	O
that	O
the	O
adversarial	Method
learning	Method
can	O
improve	O
image	Task
classification	Task
in	O
a	O
semi	Task
-	Task
supervised	Task
setting	Task
.	O

However	O
,	O
the	O
experiments	O
in	O
these	O
works	O
are	O
conducted	O
on	O
data	O
which	O
has	O
less	O
complexity	O
than	O
object	Task
detection	Task
datasets	O
,	O
where	O
image	Task
generation	Task
results	O
are	O
significantly	O
inferior	O
.	O

Our	O
work	O
is	O
also	O
related	O
to	O
a	O
recent	O
work	O
on	O
adversarial	Task
training	Task
in	Task
robotics	Task
.	O

However	O
,	O
instead	O
of	O
using	O
an	O
adversary	O
for	O
better	O
supervision	Task
,	O
we	O
use	O
the	O
adversary	O
to	O
generate	O
the	O
hard	O
examples	O
.	O

section	O
:	O
Adversarial	Method
Learning	Method
for	O
Object	Task
Detection	Task
Our	O
goal	O
is	O
to	O
learn	O
an	O
object	Method
detector	Method
that	O
is	O
robust	O
to	O
different	O
conditions	O
such	O
as	O
occlusion	O
,	O
deformation	O
and	O
illumination	O
.	O

We	O
hypothesize	O
that	O
even	O
in	O
large	O
-	O
scale	O
datasets	O
,	O
it	O
is	O
impossible	O
to	O
cover	O
all	O
potential	O
occlusions	O
and	O
deformations	O
.	O

Instead	O
of	O
relying	O
heavily	O
on	O
the	O
dataset	O
or	O
sifting	O
through	O
data	O
to	O
find	O
hard	O
examples	O
,	O
we	O
take	O
an	O
alternative	O
approach	O
.	O

We	O
actively	O
generate	O
examples	O
which	O
are	O
hard	O
for	O
the	O
object	Method
detector	Method
to	O
recognize	O
.	O

However	O
,	O
instead	O
of	O
generating	O
the	O
data	O
in	O
the	O
pixel	O
space	O
,	O
we	O
focus	O
on	O
a	O
restricted	O
space	O
for	O
generation	Task
:	O
occlusion	Task
and	Task
deformation	Task
.	O

Mathematically	O
,	O
let	O
us	O
assume	O
the	O
original	O
object	Method
detector	Method
network	Method
is	O
represented	O
as	O
where	O
is	O
one	O
of	O
the	O
object	O
proposals	O
.	O

A	O
detector	Method
gives	O
two	O
outputs	O
which	O
represents	O
class	O
output	O
and	O
represent	O
predicted	O
bounding	O
box	O
location	O
.	O

Let	O
us	O
assume	O
that	O
the	O
ground	O
-	O
truth	O
class	O
for	O
is	O
with	O
spatial	O
location	O
being	O
.	O

Our	O
original	O
detector	Method
loss	Method
can	O
be	O
written	O
down	O
as	O
,	O
where	O
the	O
first	O
term	O
is	O
the	O
SoftMax	O
loss	O
and	O
the	O
second	O
term	O
is	O
the	O
loss	O
based	O
on	O
predicted	O
bounding	O
box	O
location	O
and	O
ground	O
truth	O
box	O
location	O
(	O
foreground	O
classes	O
only	O
)	O
.	O

Let	O
’s	O
assume	O
the	O
adversarial	Method
network	Method
is	O
represented	O
as	O
which	O
given	O
a	O
feature	O
computed	O
on	O
image	O
,	O
generates	O
a	O
new	O
adversarial	O
example	O
.	O

The	O
loss	O
function	O
for	O
the	O
detector	Method
remains	O
the	O
same	O
just	O
that	O
the	O
mini	O
-	O
batch	O
now	O
includes	O
fewer	O
original	O
and	O
some	O
adversarial	O
examples	O
.	O

However	O
,	O
the	O
adversarial	Method
network	Method
has	O
to	O
learn	O
to	O
predict	O
the	O
feature	O
on	O
which	O
the	O
detector	Method
would	O
fail	O
.	O

We	O
train	O
this	O
adversarial	Method
network	Method
via	O
the	O
following	O
loss	O
function	O
,	O
Therefore	O
,	O
if	O
the	O
feature	O
generated	O
by	O
the	O
adversarial	Method
network	Method
is	O
easy	O
for	O
the	O
detector	O
to	O
classify	O
,	O
we	O
get	O
a	O
high	O
loss	O
for	O
the	O
adversarial	Method
network	Method
.	O

On	O
the	O
other	O
hand	O
,	O
if	O
after	O
adversarial	Task
feature	Task
generation	Task
it	O
is	O
difficult	O
for	O
the	O
detector	Method
,	O
we	O
get	O
a	O
high	O
loss	Metric
for	O
the	O
detector	O
and	O
a	O
low	O
loss	Metric
for	O
the	O
adversarial	Method
network	Method
.	O

section	O
:	O
A	O
-	O
Fast	Method
-	Method
RCNN	Method
:	O
Approach	O
Details	O
We	O
now	O
describe	O
the	O
details	O
of	O
our	O
framework	O
.	O

We	O
first	O
give	O
a	O
brief	O
overview	O
of	O
our	O
base	O
detector	O
Fast	Method
-	Method
RCNN	Method
.	O

This	O
is	O
followed	O
by	O
describing	O
the	O
space	O
of	O
adversarial	Task
generation	Task
.	O

In	O
particular	O
,	O
we	O
focus	O
on	O
generating	O
different	O
types	O
of	O
occlusions	O
and	O
deformations	O
in	O
this	O
paper	O
.	O

Finally	O
,	O
in	O
Section	O
[	O
reference	O
]	O
,	O
we	O
describe	O
our	O
experimental	O
setup	O
and	O
show	O
the	O
results	O
which	O
indicate	O
significant	O
improvements	O
over	O
baselines	O
.	O

subsection	O
:	O
Overview	O
of	O
Fast	Method
-	Method
RCNN	Method
We	O
build	O
upon	O
the	O
Fast	Method
-	Method
RCNN	Method
framework	O
for	O
object	Task
detection	Task
.	O

Fast	Method
-	Method
RCNN	Method
is	O
composed	O
of	O
two	O
parts	O
:	O
(	O
i	O
)	O
a	O
convolutional	Method
network	Method
for	O
feature	Task
extraction	Task
;	O
(	O
ii	O
)	O
an	O
RoI	Method
network	Method
with	O
an	O
RoI	Method
-	Method
pooling	Method
layer	Method
and	O
a	O
few	O
fully	Method
connected	Method
layers	Method
that	O
output	O
object	O
classes	O
and	O
bounding	O
boxes	O
.	O

Given	O
an	O
input	O
image	O
,	O
the	O
convolutional	Method
network	Method
of	O
the	O
Fast	Method
-	Method
RCNN	Method
takes	O
the	O
whole	O
image	O
as	O
an	O
input	O
and	O
produces	O
convolutional	O
feature	O
maps	O
as	O
the	O
output	O
.	O

Since	O
the	O
operations	O
are	O
mainly	O
convolutions	Method
and	O
max	Method
-	Method
pooling	Method
,	O
the	O
spatial	O
dimensions	O
of	O
the	O
output	O
feature	O
map	O
will	O
change	O
according	O
to	O
the	O
input	O
image	O
size	O
.	O

Given	O
the	O
feature	O
map	O
,	O
the	O
RoI	Method
-	Method
pooling	Method
layer	Method
is	O
used	O
to	O
project	O
the	O
object	O
proposals	O
onto	O
the	O
feature	O
space	O
.	O

The	O
RoI	Method
-	Method
pooling	Method
layer	Method
crops	O
and	O
resizes	O
to	O
generate	O
a	O
fixed	O
size	O
feature	O
vector	O
for	O
each	O
object	O
proposal	O
.	O

These	O
feature	O
vectors	O
are	O
then	O
passed	O
through	O
fully	Method
connected	Method
layers	Method
.	O

The	O
outputs	O
of	O
the	O
fully	Method
connected	Method
layers	Method
are	O
:	O
(	O
i	O
)	O
probabilities	O
for	O
each	O
object	O
class	O
including	O
the	O
background	O
class	O
;	O
and	O
(	O
ii	O
)	O
bounding	O
box	O
coordinates	O
.	O

For	O
training	Task
,	O
the	O
SoftMax	O
loss	O
and	O
regression	O
loss	O
are	O
applied	O
on	O
these	O
two	O
outputs	O
respectively	O
,	O
and	O
the	O
gradients	O
are	O
back	O
propagated	O
though	O
all	O
the	O
layers	O
to	O
perform	O
end	Task
-	Task
to	Task
-	Task
end	Task
learning	Task
.	O

subsection	O
:	O
Adversarial	Method
Networks	Method
Design	Method
We	O
consider	O
two	O
types	O
of	O
feature	Task
generations	Task
by	O
adversarial	Method
networks	Method
competing	O
against	O
the	O
Fast	Method
-	Method
RCNN	Method
(	O
FRCN	Method
)	O
detector	O
.	O

The	O
first	O
type	O
of	O
generation	Task
is	O
occlusion	Task
.	O

Here	O
,	O
we	O
propose	O
Adversarial	Method
Spatial	Method
Dropout	Method
Network	Method
(	O
ASDN	Method
)	O
which	O
learns	O
how	O
to	O
occlude	O
a	O
given	O
object	O
such	O
that	O
it	O
becomes	O
hard	O
for	O
FRCN	Method
to	O
classify	O
.	O

The	O
second	O
type	O
of	O
generation	Task
we	O
consider	O
in	O
this	O
paper	O
is	O
deformation	Task
.	O

In	O
this	O
case	O
,	O
we	O
propose	O
Adversarial	Method
Spatial	Method
Transformer	Method
Network	Method
(	O
ASTN	Method
)	O
which	O
learns	O
how	O
to	O
rotate	O
“	O
parts	O
”	O
of	O
the	O
objects	O
and	O
make	O
them	O
hard	O
to	O
recognize	O
by	O
the	O
detector	O
.	O

By	O
competing	O
against	O
these	O
networks	O
and	O
overcoming	O
the	O
obstacles	O
,	O
the	O
FRCN	Method
learns	O
to	O
handle	O
object	O
occlusions	O
and	O
deformations	O
in	O
a	O
robust	O
manner	O
.	O

Note	O
that	O
both	O
the	O
proposed	O
networks	O
ASDN	Method
and	O
ASTN	Method
are	O
learned	O
simultaneously	O
in	O
conjunction	O
with	O
the	O
FRCN	Method
during	O
training	O
.	O

Joint	Method
training	Method
prevents	O
the	O
detector	Method
from	O
overfitting	O
to	O
the	O
obstacles	O
created	O
by	O
the	O
fixed	Method
policies	Method
of	Method
generation	Method
.	O

Instead	O
of	O
creating	O
occlusions	O
and	O
deformations	O
on	O
the	O
input	O
images	O
,	O
we	O
find	O
that	O
operating	O
on	O
the	O
feature	O
space	O
is	O
more	O
efficient	O
and	O
effective	O
.	O

Thus	O
,	O
we	O
design	O
our	O
adversarial	Method
networks	Method
to	O
modify	O
the	O
features	O
to	O
make	O
the	O
object	O
harder	O
to	O
recognize	O
.	O

Note	O
that	O
these	O
two	O
networks	O
are	O
only	O
applied	O
during	O
training	Task
to	O
improve	O
the	O
detector	Method
.	O

We	O
will	O
first	O
introduce	O
the	O
ASDN	Method
and	O
ASTN	Method
individually	O
and	O
then	O
combine	O
them	O
together	O
in	O
an	O
unified	O
framework	O
.	O

subsubsection	Method
:	O
Adversarial	Method
Spatial	Method
Dropout	Method
for	O
Occlusion	Task
We	O
propose	O
an	O
Adversarial	Method
Spatial	Method
Dropout	Method
Network	Method
(	O
ASDN	Method
)	O
to	O
create	O
occlusions	O
on	O
the	O
deep	O
features	O
for	O
foreground	O
objects	O
.	O

Recall	O
that	O
in	O
the	O
standard	O
Fast	Method
-	Method
RCNN	Method
pipeline	O
,	O
we	O
can	O
obtain	O
the	O
convolutional	O
features	O
for	O
each	O
foreground	O
object	O
proposal	O
after	O
the	O
RoI	Method
-	Method
pooling	Method
layer	Method
.	O

We	O
use	O
these	O
region	O
-	O
based	O
features	O
as	O
the	O
inputs	O
for	O
our	O
adversarial	Method
network	Method
.	O

Given	O
the	O
feature	O
of	O
an	O
object	O
,	O
the	O
ASDN	Method
will	O
try	O
to	O
generate	O
a	O
mask	O
indicating	O
which	O
parts	O
of	O
the	O
feature	O
to	O
dropout	O
(	O
assigning	O
zeros	O
)	O
so	O
that	O
the	O
detector	Method
can	O
not	O
recognize	O
the	O
object	O
.	O

More	O
specifically	O
,	O
given	O
an	O
object	O
we	O
extract	O
the	O
feature	O
with	O
size	O
,	O
where	O
is	O
the	O
spatial	O
dimension	O
and	O
represents	O
the	O
number	O
of	O
channels	O
(	O
e.g.	O
,	O
in	O
AlexNet	Method
)	O
.	O

Given	O
this	O
feature	O
,	O
our	O
ASDN	Method
will	O
predict	O
a	O
mask	O
with	O
values	O
which	O
are	O
either	O
0	O
or	O
1	O
after	O
thresholding	O
.	O

We	O
visualize	O
some	O
of	O
the	O
masks	O
before	O
thresholding	O
in	O
Fig	O
.	O

[	O
reference	O
]	O
(	O
b	O
)	O
.	O

We	O
denote	O
as	O
the	O
value	O
for	O
the	O
th	O
row	O
and	O
th	O
column	O
of	O
the	O
mask	O
.	O

Similarly	O
,	O
represents	O
the	O
value	O
in	O
channel	O
at	O
location	O
of	O
the	O
feature	O
.	O

If	O
,	O
we	O
drop	O
out	O
the	O
values	O
of	O
all	O
the	O
channels	O
in	O
the	O
corresponding	O
spatial	O
location	O
of	O
the	O
feature	O
map	O
,	O
i.e.	O
,	O
.	O

Network	Method
Architecture	Method
.	O

We	O
use	O
the	O
standard	O
Fast	Method
-	Method
RCNN	Method
(	O
FRCN	Method
)	O
architecture	O
.	O

We	O
initialize	O
the	O
network	O
using	O
pre	Method
-	Method
training	Method
from	O
ImageNet	Material
.	O

The	O
adversarial	Method
network	Method
shares	O
the	O
convolutional	Method
layers	Method
and	O
RoI	Method
-	Method
pooling	Method
layer	Method
with	O
FRCN	Method
and	O
then	O
uses	O
its	O
own	O
separate	O
fully	Method
connected	Method
layers	Method
.	O

Note	O
that	O
we	O
do	O
not	O
share	O
the	O
parameters	O
in	O
our	O
ASDN	Method
with	O
Fast	Method
-	Method
RCNN	Method
since	O
we	O
are	O
optimizing	O
two	O
networks	O
to	O
do	O
the	O
exact	O
opposite	O
tasks	O
.	O

Model	Method
Pre	Method
-	Method
training	Method
.	O

In	O
our	O
experiment	O
,	O
we	O
find	O
it	O
important	O
to	O
pre	O
-	O
train	O
the	O
ASDN	Method
for	O
creating	Task
occlusions	Task
before	O
using	O
it	O
to	O
improve	O
Fast	Method
-	Method
RCNN	Method
.	O

Motivated	O
by	O
the	O
Faster	O
RCNN	Method
detector	Method
,	O
we	O
apply	O
stage	Method
-	Method
wise	Method
training	Method
here	O
.	O

We	O
first	O
train	O
our	O
Fast	Method
-	Method
RCNN	Method
detector	O
without	O
ASDN	Method
for	O
10	O
K	O
iterations	O
.	O

As	O
the	O
detector	O
now	O
has	O
a	O
sense	O
of	O
the	O
objects	O
in	O
the	O
dataset	O
,	O
we	O
train	O
the	O
ASDN	Method
model	O
for	O
creating	O
the	O
occlusions	O
by	O
fixing	O
all	O
the	O
layers	O
in	O
the	O
detector	O
.	O

Initializing	O
ASDN	Method
Network	O
.	O

To	O
initialize	O
the	O
ASDN	Method
network	O
,	O
given	O
a	O
feature	O
map	O
with	O
spatial	O
layout	O
,	O
we	O
apply	O
a	O
sliding	O
window	O
with	O
size	O
on	O
it	O
.	O

We	O
represent	O
the	O
sliding	Method
window	Method
process	Method
by	O
projecting	O
the	O
window	O
back	O
to	O
the	O
image	O
as	O
[	O
reference	O
]	O
(	O
a	O
)	O
.	O

For	O
each	O
sliding	O
window	O
,	O
we	O
drop	O
out	O
the	O
values	O
in	O
all	O
channels	O
whose	O
spatial	O
locations	O
are	O
covered	O
by	O
the	O
window	O
and	O
generate	O
a	O
new	O
feature	O
vector	O
for	O
the	O
region	Task
proposal	Task
.	O

This	O
feature	O
vector	O
is	O
then	O
passed	O
through	O
classification	Method
layers	Method
to	O
compute	O
the	O
loss	O
.	O

Based	O
on	O
the	O
loss	O
of	O
all	O
the	O
windows	O
,	O
we	O
select	O
the	O
one	O
with	O
the	O
highest	O
loss	O
.	O

This	O
window	O
is	O
then	O
used	O
to	O
create	O
a	O
single	O
mask	O
(	O
with	O
1	O
for	O
the	O
window	O
location	O
and	O
0	O
for	O
the	O
other	O
pixels	O
)	O
.	O

We	O
generate	O
these	O
spatial	O
masks	O
for	O
positive	O
region	O
proposals	O
and	O
obtain	O
pairs	O
of	O
training	O
examples	O
for	O
our	O
adversarial	Method
dropout	Method
network	Method
.	O

The	O
idea	O
is	O
that	O
the	O
ASDN	Method
should	O
learn	O
to	O
generate	O
the	O
masks	O
which	O
can	O
give	O
the	O
detector	Method
network	Method
high	O
losses	O
.	O

We	O
apply	O
the	O
binary	Method
cross	Method
entropy	Method
loss	Method
in	O
training	O
the	O
ASDN	Method
and	O
it	O
can	O
be	O
formulated	O
as	O
,	O
where	O
represents	O
the	O
outputs	O
of	O
the	O
ASDN	Method
in	O
location	O
given	O
input	O
feature	O
map	O
.	O

We	O
train	O
the	O
ASDN	Method
with	O
this	O
loss	O
for	O
10	O
K	O
iterations	O
.	O

We	O
show	O
that	O
the	O
network	O
starts	O
to	O
recognize	O
which	O
part	O
of	O
the	O
objects	O
are	O
significant	O
for	O
classification	Task
as	O
shown	O
in	O
Fig	O
.	O

[	O
reference	O
]	O
(	O
b	O
)	O
.	O

Also	O
note	O
that	O
our	O
output	O
masks	O
are	O
different	O
from	O
the	O
Attention	O
Mask	O
proposed	O
in	O
,	O
where	O
they	O
use	O
the	O
attention	Method
mechanism	Method
to	O
facilitate	O
classification	Task
.	O

In	O
our	O
case	O
,	O
we	O
use	O
the	O
masks	O
to	O
occlude	O
parts	O
to	O
make	O
the	O
classification	Task
harder	O
.	O

Thresholding	Method
by	O
Sampling	Method
.	O

The	O
output	O
generated	O
by	O
ASDN	Method
network	O
is	O
not	O
a	O
binary	O
mask	O
but	O
rather	O
a	O
continuous	O
heatmap	O
.	O

Instead	O
of	O
using	O
direct	Method
thresholding	Method
,	O
we	O
use	O
importance	Method
sampling	Method
to	O
select	O
the	O
top	O
pixels	O
to	O
mask	O
out	O
.	O

Note	O
that	O
the	O
sampling	Method
procedure	Method
incorporates	O
stochasticity	O
and	O
diversity	O
in	O
samples	O
during	O
training	Task
.	O

More	O
specifically	O
,	O
given	O
a	O
heatmap	Method
,	O
we	O
first	O
select	O
the	O
top	O
pixels	O
with	O
top	O
probabilities	O
and	O
randomly	O
select	O
pixels	O
out	O
of	O
them	O
to	O
assign	O
the	O
value	O
1	O
and	O
the	O
rest	O
of	O
pixels	O
are	O
set	O
to	O
0	O
.	O

Joint	Method
Learning	Method
.	O

Given	O
the	O
pre	O
-	O
trained	O
ASDN	Method
and	O
Fast	Method
-	Method
RCNN	Method
model	Method
,	O
we	O
jointly	O
optimize	O
these	O
two	O
networks	O
in	O
each	O
iteration	O
of	O
training	Task
.	O

For	O
training	O
the	O
Fast	Method
-	Method
RCNN	Method
detector	O
,	O
we	O
first	O
use	O
the	O
ASDN	Method
to	O
generate	O
the	O
masks	O
on	O
the	O
features	O
after	O
the	O
RoI	Method
-	Method
pooling	Method
during	O
forward	Method
propagation	Method
.	O

We	O
perform	O
sampling	Method
to	O
generate	O
binary	O
masks	O
and	O
use	O
them	O
to	O
drop	O
out	O
the	O
values	O
in	O
the	O
features	O
after	O
the	O
RoI	Method
-	Method
pooling	Method
layer	Method
.	O

We	O
then	O
forward	O
the	O
modified	O
features	O
to	O
calculate	O
the	O
loss	O
and	O
train	O
the	O
detector	Method
end	O
-	O
to	O
-	O
end	O
.	O

Note	O
that	O
although	O
our	O
features	O
are	O
modified	O
,	O
the	O
labels	O
remain	O
the	O
same	O
.	O

In	O
this	O
way	O
,	O
we	O
create	O
“	O
harder	O
”	O
and	O
more	O
diverse	O
examples	O
for	O
training	O
the	O
detector	Method
.	O

For	O
training	O
the	O
ASDN	Method
,	O
since	O
we	O
apply	O
the	O
sampling	Method
strategy	Method
to	O
convert	O
the	O
heatmap	O
into	O
a	O
binary	O
mask	O
,	O
which	O
is	O
not	O
differentiable	O
,	O
we	O
can	O
not	O
directly	O
back	O
-	O
prop	O
the	O
gradients	O
from	O
the	O
classification	O
loss	O
.	O

Alternatively	O
,	O
we	O
take	O
the	O
inspirations	O
from	O
the	O
REINFORCE	Method
approach	Method
.	O

We	O
compute	O
which	O
binary	O
masks	O
lead	O
to	O
significant	O
drops	O
in	O
Fast	Method
-	Method
RCNN	Method
classification	O
scores	O
.	O

We	O
use	O
only	O
those	O
hard	O
example	O
masks	O
as	O
ground	O
-	O
truth	O
to	O
train	O
the	O
adversarial	Method
network	Method
directly	O
using	O
the	O
same	O
loss	O
as	O
described	O
in	O
Eq	O
.	O

[	O
reference	O
]	O
.	O

subsubsection	O
:	O
Adversarial	Method
Spatial	Method
Transformer	Method
Network	Method
We	O
now	O
introduce	O
the	O
Adversarial	Method
Spatial	Method
Transformer	Method
Network	Method
(	O
ASTN	Method
)	O
.	O

The	O
key	O
idea	O
is	O
to	O
create	O
deformations	O
on	O
the	O
object	O
features	O
and	O
make	O
object	Task
recognition	Task
by	O
the	O
detector	Method
difficult	O
.	O

Our	O
network	O
is	O
built	O
upon	O
the	O
Spatial	Method
Transformer	Method
Network	Method
(	O
STN	Method
)	O
proposed	O
in	O
.	O

In	O
their	O
work	O
,	O
the	O
STN	Method
is	O
proposed	O
to	O
deform	O
the	O
features	O
to	O
make	O
classification	Task
easier	O
.	O

Our	O
network	O
,	O
on	O
the	O
other	O
hand	O
,	O
is	O
doing	O
the	O
exact	O
opposite	O
task	O
.	O

By	O
competing	O
against	O
our	O
ASTN	Method
,	O
we	O
can	O
train	O
a	O
better	O
detector	Method
which	O
is	O
robust	O
to	O
deformations	O
.	O

STN	Method
Overview	O
.	O

The	O
Spatial	Method
Transformer	Method
Network	Method
has	O
three	O
components	O
:	O
localisation	Method
network	Method
,	O
grid	Method
generator	Method
and	O
sampler	Method
.	O

Given	O
the	O
feature	O
map	O
as	O
input	O
,	O
the	O
localisation	Method
network	Method
will	O
estimate	O
the	O
variables	O
for	O
deformations	O
(	O
e.g.	O
,	O
rotation	O
degree	O
,	O
translation	O
distance	O
and	O
scaling	O
factor	O
)	O
.	O

These	O
variables	O
will	O
be	O
used	O
as	O
inputs	O
for	O
the	O
grid	Method
generator	Method
and	O
sampler	Method
to	O
operate	O
on	O
the	O
feature	Task
map	Task
.	O

The	O
output	O
is	O
a	O
deformed	O
feature	O
map	O
.	O

Note	O
that	O
we	O
only	O
need	O
to	O
learn	O
the	O
parameters	O
in	O
the	O
localisation	Method
network	Method
.	O

One	O
of	O
the	O
key	O
contribution	O
of	O
STN	Method
is	O
making	O
the	O
whole	O
process	O
differentiable	O
,	O
so	O
that	O
the	O
localisation	Method
network	Method
can	O
be	O
directly	O
optimized	O
for	O
the	O
classification	Task
objective	Task
via	O
back	Method
propagation	Method
.	O

Please	O
refer	O
to	O
for	O
more	O
technical	O
details	O
.	O

Adversarial	O
STN	Method
.	O

In	O
our	O
Adversarial	Method
Spatial	Method
Transformer	Method
Network	Method
,	O
we	O
focus	O
on	O
feature	Task
map	Task
rotations	Task
.	O

That	O
is	O
,	O
given	O
a	O
feature	O
map	O
after	O
the	O
RoI	Method
-	Method
pooling	Method
layer	Method
as	O
input	O
,	O
our	O
ASTN	Method
will	O
learn	O
to	O
rotate	O
the	O
feature	O
map	O
to	O
make	O
it	O
harder	O
to	O
recognize	O
.	O

Our	O
localisation	Method
network	Method
is	O
composed	O
with	O
3	O
fully	Method
connected	Method
layers	Method
where	O
the	O
first	O
two	O
layers	O
are	O
initialized	O
with	O
fc6	Method
and	O
fc7	Method
layers	Method
from	O
ImageNet	Method
pre	Method
-	Method
trained	Method
network	Method
as	O
in	O
our	O
Adversarial	Method
Spatial	Method
Dropout	Method
Network	Method
.	O

We	O
train	O
the	O
ASTN	Method
and	O
the	O
Fast	Method
-	Method
RCNN	Method
detector	O
jointly	O
.	O

For	O
training	O
the	O
detector	Task
,	O
similar	O
to	O
the	O
process	O
in	O
the	O
ASDN	Method
,	O
the	O
features	O
after	O
RoI	Method
-	Method
pooling	Method
are	O
first	O
transformed	O
by	O
our	O
ASTN	Method
and	O
forwarded	O
to	O
the	O
higher	O
layers	O
to	O
compute	O
the	O
SoftMax	O
loss	O
.	O

For	O
training	O
the	O
ASTN	Method
,	O
we	O
optimize	O
it	O
so	O
that	O
the	O
detector	Method
will	O
classify	O
the	O
foreground	O
objects	O
as	O
the	O
background	O
class	O
.	O

Different	O
from	O
training	O
ASDN	Method
,	O
since	O
the	O
spatial	O
transformation	O
is	O
differentiable	O
,	O
we	O
can	O
directly	O
use	O
the	O
classification	O
loss	O
to	O
back	O
-	O
prop	O
and	O
finetune	O
the	O
parameters	O
in	O
the	O
localisation	Method
network	Method
of	O
ASTN	Method
.	O

Implementation	O
Details	O
.	O

In	O
our	O
experiments	O
,	O
we	O
find	O
it	O
very	O
important	O
to	O
limit	O
the	O
rotation	O
degrees	O
produced	O
by	O
the	O
ASTN	Method
.	O

Otherwise	O
it	O
is	O
very	O
easy	O
to	O
rotate	O
the	O
object	O
upside	O
down	O
which	O
is	O
the	O
hardest	O
to	O
recognize	O
in	O
most	O
cases	O
.	O

We	O
constrain	O
the	O
rotation	O
degree	O
within	O
10	O
clockwise	O
and	O
anti	O
-	O
clockwise	O
.	O

Instead	O
of	O
rotating	O
all	O
the	O
feature	O
map	O
in	O
the	O
same	O
direction	O
,	O
we	O
divide	O
the	O
feature	O
maps	O
on	O
the	O
channel	O
dimension	O
into	O
4	O
blocks	O
and	O
estimate	O
4	O
different	O
rotation	O
angles	O
for	O
different	O
blocks	O
.	O

Since	O
each	O
of	O
the	O
channel	O
corresponds	O
to	O
activations	O
of	O
one	O
type	O
of	O
feature	O
,	O
rotating	O
channels	O
separately	O
corresponds	O
to	O
rotating	O
parts	O
of	O
the	O
object	O
in	O
different	O
directions	O
which	O
leads	O
to	O
deformations	O
.	O

We	O
also	O
find	O
that	O
if	O
we	O
use	O
one	O
rotation	O
angle	O
for	O
all	O
feature	O
maps	O
,	O
the	O
ASTN	Method
will	O
often	O
predict	O
the	O
largest	O
angle	O
.	O

By	O
using	O
4	O
different	O
angles	O
instead	O
of	O
one	O
,	O
we	O
increase	O
the	O
complexity	Metric
of	O
the	O
task	O
which	O
prevents	O
the	O
network	O
from	O
predicting	O
trivial	O
deformations	O
.	O

subsubsection	Method
:	O
Adversarial	Method
Fusion	Method
The	O
two	O
adversarial	O
networks	O
ASDN	Method
and	O
ASTN	Method
can	O
also	O
be	O
combined	O
and	O
trained	O
together	O
in	O
the	O
same	O
detection	Method
framework	Method
.	O

Since	O
these	O
two	O
networks	O
offer	O
different	O
types	O
of	O
information	O
.	O

By	O
competing	O
against	O
these	O
two	O
networks	O
simultaneously	O
,	O
our	O
detector	O
become	O
more	O
robust	O
.	O

We	O
combine	O
these	O
two	O
networks	O
into	O
the	O
Fast	Method
-	Method
RCNN	Method
framework	O
in	O
a	O
sequential	O
manner	O
.	O

As	O
shown	O
in	O
Fig	O
.	O

[	O
reference	O
]	O
,	O
the	O
feature	O
maps	O
extracted	O
after	O
the	O
RoI	Method
-	Method
pooling	Method
are	O
first	O
forwarded	O
to	O
our	O
ASDN	Method
which	O
drop	O
out	O
some	O
activations	O
.	O

The	O
modified	O
features	O
are	O
further	O
deformed	O
by	O
the	O
ASTN	Method
.	O

section	O
:	O
Experiments	O
We	O
conduct	O
our	O
experiments	O
on	O
PASCAL	O
VOC	Metric
2007	O
,	O
PASCAL	Material
VOC	Material
2012	Material
and	O
MS	Material
COCO	Material
datasets	Material
.	O

As	O
is	O
standard	O
practice	O
,	O
we	O
perform	O
most	O
of	O
the	O
ablative	Task
studies	Task
on	O
the	O
PASCAL	O
VOC	Metric
2007	O
dataset	O
.	O

We	O
also	O
report	O
our	O
numbers	O
on	O
the	O
PASCAL	Material
VOC	Material
2012	Material
and	O
COCO	Material
dataset	Material
.	O

Finally	O
,	O
we	O
perform	O
a	O
comparison	O
between	O
our	O
method	O
and	O
the	O
Online	Method
Hard	Method
Example	Method
Mining	Method
(	O
OHEM	Method
)	O
approach	O
.	O

subsection	O
:	O
Experimental	O
settings	O
PASCAL	O
VOC	Metric
.	O

For	O
the	O
VOC	Metric
datasets	O
,	O
we	O
use	O
the	O
‘	O
trainval	O
’	O
set	O
for	O
training	O
and	O
‘	O
test	O
’	O
set	O
for	O
testing	O
.	O

We	O
follow	O
most	O
of	O
the	O
setup	O
in	O
standard	O
Fast	Method
-	Method
RCNN	Method
for	O
training	Task
.	O

We	O
apply	O
SGD	Method
for	O
80	O
K	O
to	O
train	O
our	O
models	O
.	O

The	O
learning	Metric
rate	Metric
starts	O
with	O
and	O
decreases	O
to	O
after	O
60	O
K	O
iterations	O
.	O

We	O
use	O
the	O
selective	O
search	O
proposals	O
during	O
training	O
.	O

MS	Material
COCO	Material
.	O

For	O
the	O
COCO	Material
dataset	Material
,	O
we	O
use	O
the	O
‘	O
trainval35k	Material
’	Material
set	Material
for	O
training	O
and	O
the	O
‘	O
minival	O
’	O
set	O
for	O
testing	O
.	O

During	O
training	O
the	O
Fast	Method
-	Method
RCNN	Method
,	O
we	O
apply	O
SGD	Method
with	O
320	O
K	O
iterations	O
.	O

The	O
learning	Metric
rate	Metric
starts	O
with	O
and	O
decreases	O
to	O
after	O
280	O
K	O
iterations	O
.	O

For	O
object	Task
proposals	Task
,	O
we	O
use	O
the	O
DeepMask	Method
proposals	Method
.	O

In	O
all	O
the	O
experiments	O
,	O
our	O
minibatch	Metric
size	Metric
for	O
training	Task
is	O
256	O
proposals	O
with	O
2	O
images	O
.	O

We	O
follow	O
the	O
Torch	Method
implementation	Method
of	O
Fast	Method
-	Method
RCNN	Method
.	O

With	O
these	O
settings	O
,	O
our	O
baseline	O
numbers	O
for	O
are	O
slightly	O
better	O
than	O
the	O
reported	O
number	O
in	O
.	O

To	O
prevent	O
the	O
Fast	Method
-	Method
RCNN	Method
from	O
overfitting	O
to	O
the	O
modified	O
data	O
,	O
we	O
provide	O
one	O
image	O
in	O
the	O
batch	O
without	O
any	O
adversarial	O
occlusions	O
/	O
deformations	O
and	O
apply	O
our	O
approach	O
on	O
another	O
image	O
in	O
the	O
batch	O
.	O

subsection	O
:	O
PASCAL	O
VOC	Metric
2007	O
Results	O
We	O
report	O
our	O
results	O
for	O
using	O
ASTN	Method
and	O
ASDN	Method
during	O
training	O
Fast	Method
-	Method
RCNN	Method
in	O
Table	O
[	O
reference	O
]	O
.	O

For	O
the	O
AlexNet	Method
architecture	Method
,	O
our	O
implemented	O
baseline	O
is	O
mAP	Metric
.	O

Based	O
on	O
this	O
setting	O
,	O
joint	Method
learning	Method
with	O
our	O
ASTN	Method
model	O
reaches	O
and	O
joint	Method
learning	Method
with	O
the	O
ASDN	Method
model	O
gives	O
higher	O
performance	O
of	O
.	O

As	O
both	O
methods	O
are	O
complementary	O
to	O
each	O
other	O
,	O
combining	O
ASDN	Method
and	O
ASTN	Method
into	O
our	O
full	Method
model	Method
gives	O
another	O
boost	O
to	O
mAP	Metric
.	O

For	O
the	O
VGG16	Method
architecture	Method
,	O
we	O
conduct	O
the	O
same	O
set	O
of	O
experiments	O
.	O

Firstly	O
,	O
our	O
baseline	O
model	O
reaches	O
mAP	Metric
,	O
much	O
higher	O
than	O
the	O
reported	O
number	O
in	O
.	O

Based	O
on	O
this	O
implementation	O
,	O
joint	Method
learning	Method
with	O
our	O
ASTN	Method
model	O
gives	O
an	O
improvement	O
to	O
mAP	Metric
and	O
the	O
ASDN	Method
model	O
reaches	O
mAP	Metric
.	O

Our	O
full	O
model	O
with	O
both	O
ASTN	Method
and	O
ASDN	Method
improves	O
the	O
performance	O
to	O
.	O

Our	O
final	O
result	O
gives	O
boost	O
upon	O
the	O
baseline	O
.	O

To	O
show	O
that	O
our	O
method	O
also	O
works	O
with	O
very	O
deep	Method
CNNs	Method
,	O
we	O
apply	O
the	O
ResNet	Method
-	Method
101	Method
architecture	Method
in	O
training	O
Fast	Method
-	Method
RCNN	Method
.	O

As	O
the	O
last	O
two	O
lines	O
in	O
Table	O
.	O

[	O
reference	O
]	O
illustrate	O
,	O
the	O
performance	O
of	O
Fast	Method
-	Method
RCNN	Method
with	O
ResNet	Method
-	Method
101	Method
is	O
mAP	Metric
.	O

By	O
applying	O
the	O
adversarial	Method
training	Method
,	O
the	O
result	O
is	O
mAP	Metric
.	O

We	O
can	O
see	O
that	O
our	O
approach	O
consistently	O
improves	O
performances	O
on	O
different	O
types	O
of	O
architectures	O
.	O

subsubsection	O
:	O
Ablative	Method
Analysis	Method
ASDN	Method
Analysis	O
.	O

We	O
compare	O
our	O
Advesarial	Method
Spatial	Method
Dropout	Method
Network	Method
with	O
various	O
dropout	Method
/	Method
occlusion	Method
strategy	Method
in	O
training	O
using	O
the	O
AlexNet	Method
architecture	Method
.	O

The	O
first	O
simple	O
baseline	O
we	O
try	O
is	O
random	Method
spatial	Method
dropout	Method
on	O
the	O
feature	O
after	O
RoI	Method
-	Method
Pooling	Method
.	O

For	O
a	O
fair	O
comparison	O
,	O
we	O
mask	O
the	O
activations	O
of	O
the	O
same	O
number	O
of	O
neurons	O
as	O
we	O
do	O
in	O
the	O
ASDN	Method
network	O
.	O

As	O
Table	O
[	O
reference	O
]	O
shows	O
,	O
the	O
performance	O
of	O
random	Method
dropout	Method
is	O
mAP	Metric
which	O
is	O
slightly	O
better	O
than	O
the	O
baseline	O
.	O

Another	O
dropout	Method
strategy	Method
we	O
compare	O
to	O
is	O
a	O
similar	O
strategy	O
we	O
apply	O
in	O
pre	Task
-	Task
training	Task
the	O
ASDN	Method
(	O
Fig	O
.	O

[	O
reference	O
]	O
)	O
.	O

We	O
exhaustively	O
enumerate	O
different	O
kinds	O
of	O
occlusion	O
and	O
select	O
the	O
best	O
ones	O
for	O
training	O
in	O
each	O
iteration	O
.	O

The	O
performance	O
is	O
mAP	Metric
(	O
Ours	O
(	O
hard	Method
dropout	Method
)	O
)	O
,	O
which	O
is	O
slightly	O
better	O
than	O
random	Method
dropout	Method
.	O

As	O
we	O
find	O
the	O
exhaustive	Method
strategy	Method
can	O
only	O
explore	O
very	O
limited	O
space	O
of	O
occlusion	O
policies	O
,	O
we	O
use	O
the	O
pre	O
-	O
trained	O
ASDN	Method
network	O
to	O
replace	O
it	O
.	O

However	O
,	O
when	O
we	O
fix	O
the	O
parameters	O
of	O
the	O
ASDN	Method
,	O
we	O
find	O
the	O
performance	O
is	O
mAP	Metric
(	O
Ours	O
(	O
fixed	O
ASDN	Method
)	O
)	O
,	O
which	O
is	O
not	O
as	O
good	O
as	O
the	O
exhaustive	Method
strategy	Method
.	O

The	O
reason	O
is	O
the	O
fixed	O
ASDN	Method
has	O
not	O
received	O
any	O
feedback	O
from	O
the	O
updating	O
Fast	Method
-	Method
RCNN	Method
while	O
the	O
exhaustive	Method
search	Method
has	O
.	O

If	O
we	O
jointly	O
learn	O
the	O
ASDN	Method
and	O
the	O
Fast	Method
-	Method
RCNN	Method
together	O
,	O
we	O
can	O
get	O
mAP	Metric
,	O
improvement	O
compared	O
to	O
the	O
baseline	O
without	O
dropout	Method
.	O

This	O
evidence	O
shows	O
that	O
joint	Method
learning	Method
of	O
ASDN	Method
and	O
Fast	Method
-	Method
RCNN	Method
is	O
where	O
it	O
makes	O
a	O
difference	O
.	O

ASTN	Method
Analysis	O
.	O

We	O
compared	O
our	O
Adversarial	Method
Spatial	Method
Transformer	Method
Network	Method
with	O
random	Method
jittering	Method
on	O
the	O
object	O
proposals	O
.	O

The	O
augmentations	O
include	O
random	O
changes	O
of	O
scale	O
,	O
aspect	O
ratio	O
and	O
rotation	O
on	O
the	O
proposals	O
during	O
training	O
the	O
Fast	Method
-	Method
RCNN	Method
.	O

With	O
AlexNet	Method
,	O
the	O
performance	O
of	O
using	O
random	O
jittering	O
is	O
mAP	Metric
while	O
our	O
ASTN	Method
results	O
is	O
.	O

With	O
VGG16	Method
,	O
we	O
have	O
for	O
random	O
jittering	O
and	O
for	O
the	O
ASTN	Method
.	O

For	O
both	O
architectures	O
,	O
the	O
model	O
with	O
ASTN	Method
works	O
better	O
than	O
random	Method
jittering	Method
.	O

subsubsection	O
:	O
Category	Method
-	Method
based	Method
Analysis	Method
Figure	O
[	O
reference	O
]	O
shows	O
the	O
graph	O
of	O
how	O
performance	O
of	O
each	O
category	O
changes	O
with	O
the	O
occlusions	O
and	O
deformations	O
.	O

Interestingly	O
the	O
categories	O
that	O
seemed	O
to	O
be	O
helped	O
by	O
both	O
ASTN	Method
and	O
ASDN	Method
seem	O
to	O
be	O
quire	O
similar	O
.	O

It	O
seems	O
that	O
both	O
plant	Metric
and	O
bottle	Metric
performance	Metric
improves	O
with	O
adversarial	Method
training	Method
.	O

However	O
,	O
combining	O
the	O
two	O
transformations	O
together	O
seems	O
to	O
improve	O
performance	O
on	O
some	O
categories	O
which	O
were	O
hurt	O
by	O
using	O
occlusion	O
or	O
deformations	O
alone	O
.	O

Specifically	O
,	O
categories	O
like	O
car	O
and	O
aeroplane	O
are	O
helped	O
by	O
combining	O
the	O
two	O
adversarial	Method
processes	Method
.	O

subsubsection	O
:	O
Qualitative	O
Results	O
Figure	O
[	O
reference	O
]	O
shows	O
some	O
of	O
the	O
false	O
positives	O
of	O
our	O
approach	O
with	O
the	O
diagnosing	O
code	O
.	O

These	O
examples	O
are	O
hand	O
-	O
picked	O
such	O
that	O
they	O
only	O
appeared	O
in	O
the	O
list	O
of	O
false	O
positives	O
for	O
adversarial	Method
learning	Method
but	O
not	O
the	O
original	O
Fast	Method
-	Method
RCNN	Method
.	O

These	O
results	O
indicate	O
some	O
of	O
the	O
shortcomings	O
of	O
adversarial	Method
learning	Method
.	O

In	O
some	O
cases	O
,	O
the	O
adversary	O
creates	O
deformations	O
or	O
occlusions	O
which	O
are	O
similar	O
to	O
other	O
object	O
categories	O
and	O
leading	O
to	O
over	O
-	O
generalization	Task
.	O

For	O
example	O
,	O
our	O
approach	O
hides	O
the	O
wheels	O
of	O
the	O
bicycle	O
which	O
leads	O
to	O
a	O
wheel	O
chair	O
being	O
classified	O
as	O
a	O
bike	O
.	O

subsection	O
:	O
Results	O
on	O
PASCAL	Material
VOC	Material
2012	Material
and	O
MS	Material
COCO	Material
We	O
show	O
our	O
results	O
with	O
VGG16	Method
on	O
the	O
PASCAL	O
VOC	Metric
2012	O
dataset	O
in	O
Table	O
[	O
reference	O
]	O
,	O
where	O
our	O
baseline	O
performance	O
is	O
.Our	O
full	O
approach	O
with	O
joint	Method
learning	Method
of	O
ASDN	Method
and	O
ASTN	Method
gives	O
boost	O
to	O
mAP	Metric
.	O

This	O
again	O
shows	O
that	O
the	O
performance	O
improvement	O
using	O
VGG	Method
on	O
VOC2012	Material
is	O
significant	O
.	O

We	O
also	O
observe	O
that	O
our	O
method	O
improves	O
performance	O
of	O
all	O
the	O
categories	O
except	O
sofa	O
in	O
VOC	Metric
2012	O
.	O

We	O
believe	O
this	O
is	O
probably	O
because	O
of	O
larger	O
diversity	O
in	O
VOC	Metric
2012	O
.	O

We	O
finally	O
report	O
the	O
results	O
in	O
MS	O
COCO	Material
dataset	Material
.	O

The	O
baseline	O
method	O
with	O
VGG16	Method
architecture	Method
is	O
AP	O
on	O
the	O
VOC	Metric
metric	O
and	O
AP	O
on	O
the	O
standard	O
COCO	Metric
metric	Metric
.	O

By	O
applying	O
our	O
method	O
,	O
we	O
achieve	O
AP	Method
and	O
AP	Method
on	O
the	O
VOC	Metric
and	O
COCO	Metric
metric	Metric
respectively	O
.	O

subsection	O
:	O
Comparisons	O
with	O
OHEM	Method
Our	O
method	O
is	O
also	O
related	O
to	O
the	O
Online	Method
Hard	Method
Example	Method
Mining	Method
(	O
OHEM	Method
)	O
approach	O
.	O

Our	O
method	O
allows	O
us	O
to	O
sample	O
data	O
-	O
points	O
which	O
might	O
not	O
exist	O
in	O
the	O
dataset	O
,	O
whereas	O
OHEM	Method
is	O
bound	O
by	O
the	O
dataset	O
.	O

However	O
,	O
OHEM	Method
has	O
more	O
realistic	O
features	O
since	O
they	O
are	O
extracted	O
from	O
real	O
images	O
.	O

For	O
comparisons	O
,	O
our	O
approach	O
(	O
)	O
is	O
better	O
than	O
OHEM	Method
(	O
)	O
in	O
VOC2007	Material
.	O

However	O
,	O
our	O
result	O
(	O
)	O
is	O
not	O
as	O
good	O
as	O
OHEM	Method
(	O
)	O
in	O
VOC2012	Material
.	O

Since	O
these	O
two	O
approaches	O
are	O
generating	O
or	O
selecting	O
different	O
types	O
of	O
features	O
in	O
training	O
,	O
we	O
believe	O
they	O
should	O
be	O
complementary	O
.	O

To	O
demonstrate	O
this	O
,	O
we	O
use	O
an	O
ensemble	O
of	O
these	O
two	O
approaches	O
and	O
compare	O
it	O
with	O
separate	O
ensembles	O
of	O
OHEM	Method
and	O
Ours	O
alone	O
on	O
VOC	Metric
2012	O
.	O

As	O
a	O
result	O
,	O
the	O
ensemble	O
of	O
two	O
methods	O
achieves	O
mAP	Metric
,	O
while	O
the	O
ensemble	O
of	O
two	O
OHEM	Method
models	O
(	O
)	O
or	O
two	O
of	O
our	O
models	O
(	O
)	O
are	O
not	O
as	O
good	O
,	O
indicating	O
the	O
complementary	O
nature	O
of	O
two	O
approaches	O
.	O

section	O
:	O
Conclusion	O
One	O
of	O
the	O
long	O
-	O
term	O
goals	O
of	O
object	Task
detection	Task
is	O
to	O
learn	O
object	Method
models	Method
that	O
are	O
invariant	O
to	O
occlusions	O
and	O
deformations	O
.	O

Current	O
approaches	O
focus	O
on	O
learning	O
these	O
invariances	O
by	O
using	O
large	O
-	O
scale	O
datasets	O
.	O

In	O
this	O
paper	O
,	O
we	O
argue	O
that	O
like	O
categories	O
,	O
occlusions	O
and	O
deformations	O
also	O
follow	O
a	O
long	O
-	O
tail	O
distribution	O
:	O
some	O
of	O
them	O
are	O
so	O
rare	O
that	O
they	O
might	O
be	O
hard	O
to	O
sample	O
even	O
in	O
a	O
large	O
-	O
scale	O
dataset	O
.	O

We	O
propose	O
to	O
learn	O
these	O
invariances	O
using	O
adversarial	Method
learning	Method
strategy	Method
.	O

The	O
key	O
idea	O
is	O
to	O
learn	O
an	O
adversary	Method
in	O
conjunction	O
with	O
original	O
object	Method
detector	Method
.	O

This	O
adversary	O
creates	O
examples	O
on	O
the	O
fly	O
with	O
different	O
occlusions	O
and	O
deformations	O
,	O
such	O
that	O
these	O
occlusions	O
/	O
deformations	O
make	O
it	O
difficult	O
for	O
original	O
object	Method
detector	Method
to	O
classify	O
.	O

Instead	O
of	O
generating	O
examples	O
in	O
pixel	O
space	O
,	O
our	O
adversarial	Method
network	Method
modifies	O
the	O
features	O
to	O
mimic	O
occlusion	O
and	O
deformations	O
.	O

We	O
show	O
in	O
our	O
experiments	O
that	O
such	O
an	O
adversarial	Method
learning	Method
strategy	Method
provides	O
significant	O
boost	O
in	O
detection	Metric
performance	Metric
on	O
VOC	Metric
and	O
COCO	Material
dataset	Material
.	O

Acknowledgement	O
:	O
This	O
work	O
is	O
supported	O
by	O
the	O
Intelligence	O
Advanced	O
Research	O
Projects	O
Activity	O
(	O
IARPA	O
)	O
via	O
Department	O
of	O
Interior	O
/	O
Interior	O
Business	O
Center	O
(	O
DoI	O
/	O
IBC	O
)	O
contract	O
number	O
D16PC00007	O
.	O

The	O
U.S.	O
Government	O
is	O
authorized	O
to	O
reproduce	O
and	O
distribute	O
reprints	O
for	O
Governmental	O
purposes	O
notwithstanding	O
any	O
copyright	O
annotation	O
thereon	O
.	O

Disclaimer	O
:	O
The	O
views	O
and	O
conclusions	O
contained	O
herein	O
are	O
those	O
of	O
the	O
authors	O
and	O
should	O
not	O
be	O
interpreted	O
as	O
necessarily	O
representing	O
the	O
official	O
policies	O
or	O
endorsements	O
,	O
either	O
expressed	O
or	O
implied	O
,	O
of	O
IARPA	O
,	O
DoI	O
/	O
IBC	O
,	O
or	O
the	O
U.S.	O
Government	O
.	O

AG	O
was	O
also	O
supported	O
by	O
Sloan	O
Fellowship	O
.	O

bibliography	O
:	O
References	O
