document	O
:	O
FFDNet	Method
:	O
Toward	O
a	O
Fast	O
and	O
Flexible	O
Solution	O
for	O
CNN	Task
based	Task
Image	Task
Denoising	Task
Due	O
to	O
the	O
fast	O
inference	Task
and	O
good	O
performance	O
,	O
discriminative	Method
learning	Method
methods	Method
have	O
been	O
widely	O
studied	O
in	O
image	Task
denoising	Task
.	O

However	O
,	O
these	O
methods	O
mostly	O
learn	O
a	O
specific	O
model	O
for	O
each	O
noise	O
level	O
,	O
and	O
require	O
multiple	O
models	O
for	O
denoising	Task
images	Task
with	O
different	O
noise	O
levels	O
.	O

They	O
also	O
lack	O
flexibility	O
to	O
deal	O
with	O
spatially	O
variant	O
noise	O
,	O
limiting	O
their	O
applications	O
in	O
practical	Task
denoising	Task
.	O

To	O
address	O
these	O
issues	O
,	O
we	O
present	O
a	O
fast	O
and	O
flexible	O
denoising	Method
convolutional	Method
neural	Method
network	Method
,	O
namely	O
FFDNet	Method
,	O
with	O
a	O
tunable	O
noise	O
level	O
map	O
as	O
the	O
input	O
.	O

The	O
proposed	O
FFDNet	Method
works	O
on	O
downsampled	O
sub	O
-	O
images	O
,	O
achieving	O
a	O
good	O
trade	O
-	O
off	O
between	O
inference	Metric
speed	Metric
and	O
denoising	Task
performance	O
.	O

In	O
contrast	O
to	O
the	O
existing	O
discriminative	Method
denoisers	Method
,	O
FFDNet	Method
enjoys	O
several	O
desirable	O
properties	O
,	O
including	O
(	O
i	O
)	O
the	O
ability	O
to	O
handle	O
a	O
wide	O
range	O
of	O
noise	O
levels	O
(	O
i.e.	O
,	O
[	O
0	O
,	O
75	O
]	O
)	O
effectively	O
with	O
a	O
single	O
network	O
,	O
(	O
ii	O
)	O
the	O
ability	O
to	O
remove	O
spatially	O
variant	O
noise	O
by	O
specifying	O
a	O
non	O
-	O
uniform	O
noise	O
level	O
map	O
,	O
and	O
(	O
iii	O
)	O
faster	O
speed	Metric
than	O
benchmark	O
BM3D	Method
even	O
on	O
CPU	Metric
without	O
sacrificing	O
denoising	Metric
performance	Metric
.	O

Extensive	O
experiments	O
on	O
synthetic	O
and	O
real	O
noisy	O
images	O
are	O
conducted	O
to	O
evaluate	O
FFDNet	Method
in	O
comparison	O
with	O
state	O
-	O
of	O
-	O
the	O
-	O
art	O
denoisers	Method
.	O

The	O
results	O
show	O
that	O
FFDNet	Method
is	O
effective	O
and	O
efficient	O
,	O
making	O
it	O
highly	O
attractive	O
for	O
practical	O
denoising	Task
applications	Task
.	O

Image	Task
denoising	Task
,	O
convolutional	Method
neural	Method
networks	Method
,	O
Gaussian	Method
noise	Method
,	O
spatially	Method
variant	Method
noise	Method
section	O
:	O
Introduction	O
The	O
importance	O
of	O
image	Task
denoising	Task
in	O
low	Task
level	Task
vision	Task
can	O
be	O
revealed	O
from	O
many	O
aspects	O
.	O

First	O
,	O
noise	Task
corruption	Task
is	O
inevitable	O
during	O
the	O
image	Task
sensing	Task
process	Task
and	O
it	O
may	O
heavily	O
degrade	O
the	O
visual	Metric
quality	Metric
of	Metric
acquired	Metric
image	Metric
.	O

Removing	Task
noise	Task
from	O
the	O
observed	O
image	O
is	O
an	O
essential	O
step	O
in	O
various	O
image	Task
processing	Task
and	Task
computer	Task
vision	Task
tasks	Task
.	O

Second	O
,	O
from	O
the	O
Bayesian	Method
perspective	Method
,	O
image	Task
denoising	Task
is	O
an	O
ideal	O
test	O
bed	O
for	O
evaluating	O
image	Method
prior	Method
models	Method
and	O
optimization	Method
methods	Method
.	O

Last	O
but	O
not	O
least	O
,	O
in	O
the	O
unrolled	Method
inference	Method
via	O
variable	Method
splitting	Method
techniques	Method
,	O
many	O
image	Task
restoration	Task
problems	Task
can	O
be	O
addressed	O
by	O
sequentially	O
solving	O
a	O
series	O
of	O
denoising	Method
subproblems	Method
,	O
which	O
further	O
broadens	O
the	O
application	O
fields	O
of	O
image	Task
denoising	Task
.	O

As	O
in	O
many	O
previous	O
literature	O
of	O
image	Task
denoising	Task
,	O
in	O
this	O
paper	O
we	O
assume	O
that	O
the	O
noise	O
is	O
additive	O
white	O
Gaussian	O
noise	O
(	O
AWGN	Method
)	O
and	O
the	O
noise	O
level	O
is	O
given	O
.	O

In	O
order	O
to	O
handle	O
practical	O
image	Task
denoising	Task
problems	O
,	O
a	O
flexible	O
image	Task
denoiser	Task
is	O
expected	O
to	O
have	O
the	O
following	O
desirable	O
properties	O
:	O
(	O
i	O
)	O
it	O
is	O
able	O
to	O
perform	O
denoising	Task
using	O
a	O
single	O
model	O
;	O
(	O
ii	O
)	O
it	O
is	O
efficient	O
,	O
effective	O
and	O
user	O
-	O
friendly	O
;	O
and	O
(	O
iii	O
)	O
it	O
can	O
handle	O
spatially	O
variant	O
noise	O
.	O

Such	O
a	O
denoiser	Method
can	O
be	O
directly	O
deployed	O
to	O
recover	O
the	O
clean	O
image	O
when	O
the	O
noise	O
level	O
is	O
known	O
or	O
can	O
be	O
well	O
estimated	O
.	O

When	O
the	O
noise	O
level	O
is	O
unknown	O
or	O
is	O
difficult	O
to	O
estimate	O
,	O
the	O
denoiser	Method
should	O
allow	O
the	O
user	O
to	O
adaptively	O
control	O
the	O
trade	O
-	O
off	O
between	O
noise	Task
reduction	Task
and	O
detail	Task
preservation	Task
.	O

Furthermore	O
,	O
the	O
noise	O
can	O
be	O
spatially	O
variant	O
and	O
the	O
denoiser	Method
should	O
be	O
flexible	O
enough	O
to	O
handle	O
spatially	O
variant	O
noise	O
.	O

However	O
,	O
state	O
-	O
of	O
-	O
the	O
-	O
art	O
image	Task
denoising	Task
methods	O
are	O
still	O
limited	O
in	O
flexibility	O
or	O
efficiency	O
.	O

In	O
general	O
,	O
image	Task
denoising	Task
methods	O
can	O
be	O
grouped	O
into	O
two	O
major	O
categories	O
,	O
model	Method
-	Method
based	Method
methods	Method
and	O
discriminative	Method
learning	Method
based	Method
ones	Method
.	O

Model	Method
-	Method
based	Method
methods	Method
such	O
as	O
BM3D	Method
and	O
WNNM	Method
are	O
flexible	O
in	O
handling	O
denoising	Task
problems	Task
with	O
various	O
noise	O
levels	O
,	O
but	O
they	O
suffer	O
from	O
several	O
drawbacks	O
.	O

For	O
example	O
,	O
their	O
optimization	Method
algorithms	Method
are	O
generally	O
time	O
-	O
consuming	O
,	O
and	O
can	O
not	O
be	O
directly	O
used	O
to	O
remove	O
spatially	O
variant	O
noise	O
.	O

Moreover	O
,	O
model	Method
-	Method
based	Method
methods	Method
usually	O
employ	O
hand	O
-	O
crafted	O
image	O
priors	O
(	O
e.g.	O
,	O
sparsity	O
and	O
nonlocal	O
self	O
-	O
similarity	O
)	O
,	O
which	O
may	O
not	O
be	O
strong	O
enough	O
to	O
characterize	O
complex	O
image	O
structures	O
.	O

As	O
an	O
alternative	O
,	O
discriminative	Method
denoising	Method
methods	Method
aim	O
to	O
learn	O
the	O
underlying	O
image	O
prior	O
and	O
fast	O
inference	Task
from	O
a	O
training	O
set	O
of	O
degraded	O
and	O
ground	O
-	O
truth	O
image	O
pairs	O
.	O

One	O
approach	O
is	O
to	O
learn	O
stage	O
-	O
wise	O
image	O
priors	O
in	O
the	O
context	O
of	O
truncated	Method
inference	Method
procedure	Method
.	O

Another	O
more	O
popular	O
approach	O
is	O
plain	O
discriminative	Method
learning	Method
,	O
such	O
as	O
the	O
MLP	Method
and	Method
convolutional	Method
neural	Method
network	Method
(	Method
CNN	Method
)	Method
based	Method
methods	Method
,	O
among	O
which	O
the	O
DnCNN	Method
method	Method
has	O
achieved	O
very	O
competitive	O
denoising	Metric
performance	O
.	O

The	O
success	O
of	O
CNN	Method
for	O
image	Task
denoising	Task
is	O
attributed	O
to	O
its	O
large	O
modeling	Metric
capacity	Metric
and	O
tremendous	O
advances	O
in	O
network	Method
training	Method
and	O
design	Task
.	O

However	O
,	O
existing	O
discriminative	Method
denoising	Method
methods	Method
are	O
limited	O
in	O
flexibility	O
,	O
and	O
the	O
learned	O
model	O
is	O
usually	O
tailored	O
to	O
a	O
specific	O
noise	O
level	O
.	O

From	O
the	O
perspective	O
of	O
regression	Task
,	O
they	O
aim	O
to	O
learn	O
a	O
mapping	O
function	O
between	O
the	O
input	O
noisy	O
observation	O
y	O
and	O
the	O
desired	O
output	O
x	O
.	O

The	O
model	Method
parameters	Method
are	O
trained	O
for	O
noisy	O
images	O
corrupted	O
by	O
AWGN	O
with	O
a	O
fixed	O
noise	O
level	O
,	O
while	O
the	O
trained	O
model	O
with	O
is	O
hard	O
to	O
be	O
directly	O
deployed	O
to	O
images	O
with	O
other	O
noise	O
levels	O
.	O

Though	O
a	O
single	O
CNN	Method
model	Method
(	O
i.e.	O
,	O
DnCNN	Method
-	Method
B	Method
)	O
is	O
trained	O
in	O
for	O
Gaussian	Task
denoising	Task
,	O
it	O
does	O
not	O
generalize	O
well	O
to	O
real	O
noisy	O
images	O
and	O
works	O
only	O
if	O
the	O
noise	O
level	O
is	O
in	O
the	O
preset	O
range	O
,	O
e.g.	O
,	O
.	O

Besides	O
,	O
all	O
the	O
existing	O
discriminative	Method
learning	Method
based	Method
methods	Method
lack	O
flexibility	O
to	O
deal	O
with	O
spatially	O
variant	O
noise	O
.	O

To	O
overcome	O
the	O
drawbacks	O
of	O
existing	O
CNN	Method
based	Method
denoising	Method
methods	Method
,	O
we	O
present	O
a	O
fast	O
and	O
flexible	O
denoising	Method
convolutional	Method
neural	Method
network	Method
(	O
FFDNet	Method
)	O
.	O

Specifically	O
,	O
our	O
FFDNet	Method
is	O
formulated	O
as	O
,	O
where	O
M	O
is	O
a	O
noise	O
level	O
map	O
.	O

In	O
the	O
DnCNN	Method
model	Method
,	O
the	O
parameters	O
vary	O
with	O
the	O
change	O
of	O
noise	O
level	O
,	O
while	O
in	O
the	O
FFDNet	Method
model	O
,	O
the	O
noise	O
level	O
map	O
is	O
modeled	O
as	O
an	O
input	O
and	O
the	O
model	O
parameters	O
are	O
invariant	O
to	O
noise	O
level	O
.	O

Thus	O
,	O
FFDNet	Method
provides	O
a	O
flexible	O
way	O
to	O
handle	O
different	O
noise	O
levels	O
with	O
a	O
single	O
network	O
.	O

By	O
introducing	O
a	O
noise	O
level	O
map	O
as	O
input	O
,	O
it	O
is	O
natural	O
to	O
expect	O
that	O
the	O
model	O
performs	O
well	O
when	O
the	O
noise	O
level	O
map	O
matches	O
the	O
ground	O
-	O
truth	O
one	O
of	O
noisy	O
input	O
.	O

Furthermore	O
,	O
the	O
noise	Metric
level	Metric
map	Metric
should	O
also	O
play	O
the	O
role	O
of	O
controlling	O
the	O
trade	O
-	O
off	O
between	O
noise	Task
reduction	Task
and	O
detail	Task
preservation	Task
.	O

It	O
is	O
found	O
that	O
heavy	O
visual	Metric
quality	Metric
degradation	Metric
may	O
be	O
engendered	O
when	O
setting	O
a	O
larger	O
noise	O
level	O
to	O
smooth	O
out	O
the	O
details	O
.	O

We	O
highlight	O
this	O
problem	O
and	O
adopt	O
a	O
method	O
of	O
orthogonal	Method
initialization	Method
on	O
convolutional	Method
filters	Method
to	O
alleviate	O
this	O
.	O

Besides	O
,	O
the	O
proposed	O
FFDNet	Method
works	O
on	O
downsampled	O
sub	O
-	O
images	O
,	O
which	O
largely	O
accelerates	O
the	O
training	Metric
and	Metric
testing	Metric
speed	Metric
,	O
and	O
enlarges	O
the	O
receptive	O
field	O
as	O
well	O
.	O

Using	O
images	O
corrupted	O
by	O
AWGN	O
,	O
we	O
quantitatively	O
compare	O
FFDNet	Method
with	O
state	O
-	O
of	O
-	O
the	O
-	O
art	O
denoising	Method
methods	Method
,	O
including	O
model	Method
-	Method
based	Method
methods	Method
such	O
as	O
BM3D	Method
and	Method
WNNM	Method
and	O
discriminative	Method
learning	Method
based	Method
methods	Method
such	O
as	O
TNRD	Method
and	O
DnCNN	Method
.	O

The	O
results	O
clearly	O
demonstrate	O
the	O
superiority	O
of	O
FFDNet	Method
in	O
terms	O
of	O
both	O
denoising	Metric
performance	Metric
and	O
computational	Metric
efficiency	Metric
.	O

In	O
addition	O
,	O
FFDNet	Method
performs	O
favorably	O
on	O
images	O
corrupted	O
by	O
spatially	O
variant	O
AWGN	O
.	O

We	O
further	O
evaluate	O
FFDNet	Method
on	O
real	O
-	O
world	O
noisy	O
images	O
,	O
where	O
the	O
noise	O
is	O
often	O
signal	O
-	O
dependent	O
,	O
non	O
-	O
Gaussian	O
and	O
spatially	O
variant	O
.	O

The	O
proposed	O
FFDNet	Method
model	O
still	O
achieves	O
perceptually	O
convincing	O
results	O
by	O
setting	O
proper	O
noise	O
level	O
maps	O
.	O

Overall	O
,	O
FFDNet	Method
enjoys	O
high	O
potentials	O
for	O
practical	O
denoising	Task
applications	Task
.	O

The	O
main	O
contribution	O
of	O
our	O
work	O
is	O
summarized	O
as	O
follows	O
:	O
A	O
fast	Method
and	Method
flexible	Method
denoising	Method
network	Method
,	O
namely	O
FFDNet	Method
,	O
is	O
proposed	O
for	O
discriminative	O
image	Task
denoising	Task
.	O

By	O
taking	O
a	O
tunable	O
noise	O
level	O
map	O
as	O
input	O
,	O
a	O
single	O
FFDNet	Method
is	O
able	O
to	O
deal	O
with	O
noise	O
on	O
different	O
levels	O
,	O
as	O
well	O
as	O
spatially	O
variant	O
noise	O
.	O

We	O
highlight	O
the	O
importance	O
to	O
guarantee	O
the	O
role	O
of	O
the	O
noise	O
level	O
map	O
in	O
controlling	O
the	O
trade	O
-	O
off	O
between	O
noise	Task
reduction	Task
and	O
detail	Task
preservation	Task
.	O

FFDNet	Method
exhibits	O
perceptually	O
appealing	O
results	O
on	O
both	O
synthetic	O
noisy	O
images	O
corrupted	O
by	O
AWGN	O
and	O
real	O
-	O
world	O
noisy	O
images	O
,	O
demonstrating	O
its	O
potential	O
for	O
practical	O
image	Task
denoising	Task
.	O

The	O
remainder	O
of	O
this	O
paper	O
is	O
organized	O
as	O
follows	O
.	O

Sec	O
.	O

[	O
reference	O
]	O
reviews	O
existing	O
discriminative	Method
denoising	Method
methods	Method
.	O

Sec	O
.	O

[	O
reference	O
]	O
presents	O
the	O
proposed	O
image	Task
denoising	Task
model	O
.	O

Sec	O
.	O

[	O
reference	O
]	O
reports	O
the	O
experimental	O
results	O
.	O

Sec	O
.	O

[	O
reference	O
]	O
concludes	O
the	O
paper	O
.	O

section	O
:	O
Related	O
Work	O
In	O
this	O
section	O
,	O
we	O
briefly	O
review	O
and	O
discuss	O
the	O
two	O
major	O
categories	O
of	O
relevant	O
methods	O
to	O
this	O
work	O
,	O
i.e.	O
,	O
maximum	Method
a	Method
posteriori	Method
(	Method
MAP	Method
)	Method
inference	Method
guided	Method
discriminative	Method
learning	Method
and	O
plain	Method
discriminative	Method
learning	Method
.	O

subsection	O
:	O
MAP	Method
Inference	Method
Guided	Method
Discriminative	Method
Learning	Method
Instead	O
of	O
first	O
learning	O
the	O
prior	O
and	O
then	O
performing	O
the	O
inference	Task
,	O
this	O
category	O
of	O
methods	O
aims	O
to	O
learn	O
the	O
prior	O
parameters	O
along	O
with	O
a	O
compact	Method
unrolled	Method
inference	Method
through	O
minimizing	O
a	O
loss	O
function	O
.	O

Following	O
the	O
pioneer	O
work	O
of	O
fields	Method
of	Method
experts	Method
,	O
Barbu	O
trained	O
a	O
discriminative	Method
Markov	Method
random	Method
field	Method
(	Method
MRF	Method
)	Method
model	Method
together	O
with	O
a	O
gradient	Method
descent	Method
inference	Method
for	O
image	Task
denoising	Task
.	O

Samuel	O
and	O
Tappen	O
independently	O
proposed	O
a	O
compact	Method
gradient	Method
descent	Method
inference	Method
learning	Method
framework	Method
,	O
and	O
discussed	O
the	O
advantages	O
of	O
discriminative	Method
learning	Method
over	O
model	Method
-	Method
based	Method
optimization	Method
method	Method
with	O
MRF	Method
prior	Method
.	O

Sun	O
and	O
Tappen	O
proposed	O
a	O
novel	O
nonlocal	Method
range	Method
MRF	Method
(	Method
NLR	Method
-	Method
MRF	Method
)	Method
framework	Method
,	O
and	O
employed	O
the	O
gradient	Method
-	Method
based	Method
discriminative	Method
learning	Method
method	Method
to	O
train	O
the	O
model	O
.	O

Generally	O
speaking	O
,	O
the	O
methods	O
above	O
only	O
learn	O
the	O
prior	O
parameters	O
in	O
a	O
discriminative	O
manner	O
,	O
while	O
the	O
inference	O
parameters	O
are	O
stage	O
-	O
invariant	O
.	O

With	O
the	O
aid	O
of	O
unrolled	Method
half	Method
quadratic	Method
splitting	Method
(	Method
HQS	Method
)	Method
techniques	Method
,	O
Schmidt	O
et	O
al	O
.	O

proposed	O
a	O
cascade	Method
of	Method
shrinkage	Method
fields	Method
(	O
CSF	Method
)	Method
framework	Method
to	O
learn	O
stage	O
-	O
wise	O
inference	O
parameters	O
.	O

Chen	O
et	O
al	O
.	O

further	O
proposed	O
a	O
trainable	Method
nonlinear	Method
reaction	Method
diffusion	Method
(	Method
TNRD	Method
)	Method
model	Method
through	O
discriminative	Method
learning	Method
of	O
a	O
compact	Method
gradient	Method
descent	Method
inference	Method
step	Method
.	O

Recently	O
,	O
Lefkimmiatis	O
and	O
Qiao	O
et	O
al	O
.	O

adopted	O
a	O
proximal	Method
gradient	Method
-	Method
based	Method
denoising	Method
inference	Method
from	O
a	O
variational	Method
model	Method
to	O
incorporate	O
the	O
nonlocal	O
self	O
-	O
similarity	O
prior	O
.	O

It	O
is	O
worth	O
noting	O
that	O
,	O
apart	O
from	O
MAP	Method
inference	Method
,	O
Vemulapalli	O
et	O
al	O
.	O

derived	O
an	O
end	O
-	O
to	O
-	O
end	Method
trainable	Method
patch	Method
-	Method
based	Method
denoising	Method
network	Method
based	O
on	O
Gaussian	Method
Conditional	Method
Random	Method
Field	Method
(	Method
GCRF	Method
)	Method
inference	Method
.	O

MAP	Method
inference	Method
guided	Method
discriminative	Method
learning	Method
usually	O
requires	O
much	O
fewer	O
inference	O
steps	O
,	O
and	O
is	O
very	O
efficient	O
in	O
image	Task
denoising	Task
.	O

It	O
also	O
has	O
clear	O
interpretability	O
because	O
the	O
discriminative	Method
architecture	Method
is	O
derived	O
from	O
optimization	Method
algorithms	Method
such	O
as	O
HQS	Method
and	O
gradient	Method
descent	Method
.	O

However	O
,	O
the	O
learned	O
priors	O
and	O
inference	Method
procedure	Method
are	O
limited	O
by	O
the	O
form	O
of	O
MAP	Method
model	Method
,	O
and	O
generally	O
perform	O
inferior	O
to	O
the	O
state	O
-	O
of	O
-	O
the	O
-	O
art	O
CNN	Method
-	Method
based	Method
denoisers	Method
.	O

For	O
example	O
,	O
the	O
inference	Task
of	Task
CSF	Task
is	O
not	O
very	O
flexible	O
since	O
it	O
is	O
strictly	O
derived	O
from	O
the	O
HQS	Method
optimization	Method
under	O
the	O
field	Method
of	Method
experts	Method
(	Method
FoE	Method
)	Method
framework	Method
.	O

The	O
capacity	O
of	O
FoE	Method
is	O
however	O
not	O
large	O
enough	O
to	O
fully	O
characterize	O
image	O
priors	O
,	O
which	O
in	O
turn	O
makes	O
CSF	O
less	O
effective	O
.	O

For	O
these	O
reasons	O
,	O
Kruse	O
et	O
al	O
.	O

generalized	O
CSF	Method
for	O
better	O
performance	O
by	O
replacing	O
some	O
modular	Method
parts	Method
of	O
unrolled	Method
inference	Method
with	O
more	O
powerful	O
CNN	Method
.	O

subsection	O
:	O
Plain	Method
Discriminative	Method
Learning	Method
Instead	O
of	O
modeling	O
image	O
priors	O
explicitly	O
,	O
the	O
plain	O
discriminative	Method
learning	Method
methods	Method
learn	O
a	O
direct	O
mapping	O
function	O
to	O
model	O
image	O
prior	O
implicitly	O
.	O

The	O
multi	Method
-	Method
layer	Method
perceptron	Method
(	Method
MLP	Method
)	Method
and	O
CNNs	Method
have	O
been	O
adopted	O
to	O
learn	O
such	O
priors	O
.	O

The	O
use	O
of	O
CNN	Method
for	O
image	Task
denoising	Task
can	O
be	O
traced	O
back	O
to	O
,	O
where	O
a	O
five	Method
-	Method
layer	Method
network	Method
with	O
sigmoid	O
nonlinearity	O
was	O
proposed	O
.	O

Subsequently	O
,	O
auto	Method
-	Method
encoder	Method
based	Method
methods	Method
have	O
been	O
suggested	O
for	O
image	Task
denoising	Task
.	O

However	O
,	O
early	O
MLP	Method
and	Method
CNN	Method
-	Method
based	Method
methods	Method
are	O
limited	O
in	O
denoising	Task
performance	O
and	O
can	O
not	O
compete	O
with	O
the	O
benchmark	O
BM3D	Method
method	Method
.	O

The	O
first	O
discriminative	Method
denoising	Method
method	Method
which	O
achieves	O
comparable	O
performance	O
with	O
BM3D	Method
is	O
the	O
plain	Method
MLP	Method
method	Method
proposed	O
by	O
Burger	O
et	O
al	O
.	O

.	O

Benefitted	O
from	O
the	O
advances	O
in	O
deep	Method
CNN	Method
,	O
Zhang	O
et	O
al	O
.	O

proposed	O
a	O
plain	Method
denoising	Method
CNN	Method
(	Method
DnCNN	Method
)	Method
method	Method
which	O
achieves	O
state	O
-	O
of	O
-	O
the	O
-	O
art	O
denoising	Metric
performance	O
.	O

They	O
showed	O
that	O
residual	Method
learning	Method
and	O
batch	Method
normalization	Method
are	O
particularly	O
useful	O
for	O
the	O
success	O
of	O
denoising	Task
.	O

For	O
a	O
better	O
trade	O
-	O
off	O
between	O
accuracy	Metric
and	O
speed	Metric
,	O
Zhang	O
et	O
al	O
.	O

introduced	O
a	O
7	Method
-	Method
layer	Method
denoising	Method
network	Method
with	O
dilated	Method
convolution	Method
to	O
expand	O
the	O
receptive	O
field	O
of	O
CNN	Method
.	O

Mao	O
et	O
al	O
.	O

proposed	O
a	O
very	O
deep	Method
fully	Method
convolutional	Method
encoding	Method
-	Method
decoding	Method
network	Method
with	O
symmetric	Method
skip	Method
connection	Method
for	O
image	Task
denoising	Task
.	O

Santhanam	O
et	O
al	O
.	O

developed	O
a	O
recursively	Method
branched	Method
deconvolutional	Method
network	Method
(	O
RBDN	Method
)	Method
for	O
image	Task
denoising	Task
as	O
well	O
as	O
generic	Task
image	Task
-	Task
to	Task
-	Task
image	Task
regression	Task
.	O

Tai	O
et	O
al	O
.	O

proposed	O
a	O
very	Method
deep	Method
persistent	Method
memory	Method
network	Method
(	O
MemNet	Method
)	O
by	O
introducing	O
a	O
memory	Method
block	Method
to	O
mine	O
persistent	O
memory	O
through	O
an	O
adaptive	Method
learning	Method
process	Method
.	O

Plain	Method
discriminative	Method
learning	Method
has	O
shown	O
better	O
performance	O
than	O
MAP	Method
inference	Method
guided	Method
discriminative	Method
learning	Method
;	O
however	O
,	O
existing	O
discriminative	Method
learning	Method
methods	Method
have	O
to	O
learn	O
multiple	Method
models	Method
for	O
handling	O
images	O
with	O
different	O
noise	O
levels	O
,	O
and	O
are	O
incapable	O
to	O
deal	O
with	O
spatially	O
variant	O
noise	O
.	O

To	O
the	O
best	O
of	O
our	O
knowledge	O
,	O
it	O
remains	O
an	O
unaddressed	O
issue	O
to	O
develop	O
a	O
single	O
discriminative	Method
denoising	Method
model	Method
which	O
can	O
handle	O
noise	O
of	O
different	O
levels	O
,	O
even	O
spatially	O
variant	O
noise	O
,	O
in	O
a	O
speed	O
even	O
faster	O
than	O
BM3D.	Method
section	O
:	O
Proposed	O
Fast	O
and	O
Flexible	O
Discriminative	Method
CNN	Method
Denoiser	Method
We	O
present	O
a	O
single	O
discriminative	Method
CNN	Method
model	Method
,	O
namely	O
FFDNet	Method
,	O
to	O
achieve	O
the	O
following	O
three	O
objectives	O
:	O
Fast	Metric
speed	Metric
:	O
The	O
denoiser	Task
is	O
expected	O
to	O
be	O
highly	O
efficient	O
without	O
sacrificing	O
denoising	Metric
performance	Metric
.	O

Flexibility	O
:	O
The	O
denoiser	Method
is	O
able	O
to	O
handle	O
images	O
with	O
different	O
noise	O
levels	O
and	O
even	O
spatially	O
variant	O
noise	O
.	O

Robustness	Metric
:	O
The	O
denoiser	Method
should	O
introduce	O
no	O
visual	O
artifacts	O
in	O
controlling	O
the	O
trade	O
-	O
off	O
between	O
noise	Task
reduction	Task
and	O
detail	Task
preservation	Task
.	O

In	O
this	O
work	O
,	O
we	O
take	O
a	O
tunable	O
noise	O
level	O
map	O
M	O
as	O
input	O
to	O
make	O
the	O
denoising	Method
model	Method
flexible	O
to	O
noise	O
levels	O
.	O

To	O
improve	O
the	O
efficiency	O
of	O
the	O
denoiser	Task
,	O
a	O
reversible	Method
downsampling	Method
operator	Method
is	O
introduced	O
to	O
reshape	O
the	O
input	O
image	O
of	O
size	O
into	O
four	O
downsampled	O
sub	O
-	O
images	O
of	O
size	O
.	O

Here	O
is	O
the	O
number	O
of	O
channels	O
,	O
i.e.	O
,	O
for	O
grayscale	O
image	O
and	O
for	O
color	O
image	O
.	O

In	O
order	O
to	O
enable	O
the	O
noise	O
level	O
map	O
to	O
robustly	O
control	O
the	O
trade	O
-	O
off	O
between	O
noise	Metric
reduction	Metric
and	O
detail	Task
preservation	Task
by	O
introducing	O
no	O
visual	O
artifacts	O
,	O
we	O
adopt	O
the	O
orthogonal	Method
initialization	Method
method	Method
to	O
the	O
convolution	Method
filters	Method
.	O

subsection	O
:	O
Network	Method
Architecture	Method
Fig	O
.	O

[	O
reference	O
]	O
illustrates	O
the	O
architecture	O
of	O
FFDNet	Method
.	O

The	O
first	O
layer	O
is	O
a	O
reversible	Method
downsampling	Method
operator	Method
which	O
reshapes	O
a	O
noisy	Material
image	Material
y	Material
into	O
four	O
downsampled	Material
sub	Material
-	Material
images	Material
.	O

We	O
further	O
concatenate	O
a	O
tunable	O
noise	O
level	O
map	O
M	O
with	O
the	O
downsampled	Material
sub	Material
-	Material
images	Material
to	O
form	O
a	O
tensor	O
of	O
size	O
as	O
the	O
inputs	O
to	O
CNN	Method
.	O

For	O
spatially	O
invariant	O
AWGN	O
with	O
noise	O
level	O
,	O
M	O
is	O
a	O
uniform	Method
map	Method
with	O
all	O
elements	O
being	O
.	O

With	O
the	O
tensor	O
as	O
input	O
,	O
the	O
following	O
CNN	Method
consists	O
of	O
a	O
series	O
of	O
convolution	Method
layers	Method
.	O

Each	O
layer	O
is	O
composed	O
of	O
three	O
types	O
of	O
operations	O
:	O
Convolution	Method
(	O
Conv	Method
)	O
,	O
Rectified	Method
Linear	Method
Units	Method
(	O
ReLU	Method
)	O
,	O
and	O
Batch	Method
Normalization	Method
(	O
BN	Method
)	O
.	O

More	O
specifically	O
,	O
“	O
Conv	Method
+	O
ReLU	O
”	O
is	O
adopted	O
for	O
the	O
first	O
convolution	O
layer	O
,	O
“	O
Conv	Method
+	O
BN	O
+	O
ReLU	O
”	O
for	O
the	O
middle	O
layers	O
,	O
and	O
“	O
Conv	Method
”	O
for	O
the	O
last	O
convolution	Method
layer	Method
.	O

Zero	Method
-	Method
padding	Method
is	O
employed	O
to	O
keep	O
the	O
size	O
of	O
feature	O
maps	O
unchanged	O
after	O
each	O
convolution	Method
.	O

After	O
the	O
last	O
convolution	Method
layer	Method
,	O
an	O
upscaling	Method
operation	Method
is	O
applied	O
as	O
the	O
reverse	O
operator	O
of	O
the	O
downsampling	Method
operator	Method
applied	O
in	O
the	O
input	O
stage	O
to	O
produce	O
the	O
estimated	O
clean	O
image	O
of	O
size	O
.	O

Different	O
from	O
DnCNN	Method
,	O
FFDNet	Method
does	O
not	O
predict	O
the	O
noise	O
.	O

The	O
reason	O
is	O
given	O
in	O
Sec	O
.	O

[	O
reference	O
]	O
.	O

Since	O
FFDNet	Method
operates	O
on	O
downsampled	Material
sub	Material
-	Material
images	Material
,	O
it	O
is	O
not	O
necessary	O
to	O
employ	O
the	O
dilated	Method
convolution	Method
to	O
further	O
increase	O
the	O
receptive	O
field	O
.	O

By	O
considering	O
the	O
balance	O
of	O
complexity	Metric
and	O
performance	O
,	O
we	O
empirically	O
set	O
the	O
number	O
of	O
convolution	O
layers	O
as	O
15	O
for	O
grayscale	Material
image	Material
and	O
12	O
for	O
color	Material
image	Material
.	O

As	O
to	O
the	O
channels	O
of	O
feature	O
maps	O
,	O
we	O
set	O
64	O
for	O
grayscale	O
image	O
and	O
96	O
for	O
color	Material
image	Material
.	O

The	O
reason	O
that	O
we	O
use	O
different	O
settings	O
for	O
grayscale	O
and	O
color	O
images	O
is	O
twofold	O
.	O

First	O
,	O
since	O
there	O
are	O
high	O
dependencies	O
among	O
the	O
R	O
,	O
G	O
,	O
B	O
channels	O
,	O
using	O
a	O
smaller	O
number	O
of	O
convolution	Method
layers	Method
encourages	O
the	O
model	O
to	O
exploit	O
the	O
inter	O
-	O
channel	O
dependency	O
.	O

Second	O
,	O
color	Material
image	Material
has	O
more	O
channels	O
as	O
input	O
,	O
and	O
hence	O
more	O
feature	O
(	O
i.e.	O
,	O
more	O
channels	O
of	O
feature	O
map	O
)	O
is	O
required	O
.	O

According	O
to	O
our	O
experimental	O
results	O
,	O
increasing	O
the	O
number	O
of	O
feature	O
maps	O
contributes	O
more	O
to	O
the	O
denoising	Metric
performance	Metric
on	O
color	Material
images	Material
.	O

Using	O
different	O
settings	O
for	O
color	Material
images	Material
,	O
FFDNet	Method
can	O
bring	O
an	O
average	O
gain	O
of	O
0.15dB	O
by	O
PSNR	Metric
on	O
different	O
noise	O
levels	O
.	O

As	O
we	O
shall	O
see	O
from	O
Sec	O
.	O

[	O
reference	O
]	O
,	O
12	O
-	O
layer	O
FFDNet	Method
for	O
color	Material
image	Material
runs	O
slightly	O
slower	O
than	O
15	O
-	O
layer	O
FFDNet	Method
for	O
grayscale	Material
image	Material
.	O

Taking	O
both	O
denoising	Task
performance	O
and	O
efficiency	O
into	O
account	O
,	O
we	O
set	O
the	O
number	O
of	O
convolution	O
layers	O
as	O
12	O
and	O
the	O
number	O
of	O
feature	O
maps	O
as	O
96	O
for	O
color	O
image	Task
denoising	Task
.	O

subsection	O
:	O
Noise	Metric
Level	Metric
Map	Metric
Let	O
’s	O
first	O
revisit	O
the	O
model	O
-	O
based	O
image	Task
denoising	Task
methods	O
to	O
analyze	O
why	O
they	O
are	O
flexible	O
in	O
handling	O
noises	O
at	O
different	O
levels	O
,	O
which	O
will	O
in	O
turn	O
help	O
us	O
to	O
improve	O
the	O
flexibility	O
of	O
CNN	Method
-	Method
based	Method
denoiser	Method
.	O

Most	O
of	O
the	O
model	Method
-	Method
based	Method
denoising	Method
methods	Method
aim	O
to	O
solve	O
the	O
following	O
problem	O
where	O
is	O
the	O
data	O
fidelity	O
term	O
with	O
noise	O
level	O
,	O
is	O
the	O
regularization	O
term	O
associated	O
with	O
image	O
prior	O
,	O
and	O
controls	O
the	O
balance	O
between	O
the	O
data	O
fidelity	O
and	O
regularization	O
terms	O
.	O

It	O
is	O
worth	O
noting	O
that	O
in	O
practice	O
governs	O
the	O
compromise	O
between	O
noise	Task
reduction	Task
and	O
detail	Task
preservation	Task
.	O

When	O
it	O
is	O
too	O
small	O
,	O
much	O
noise	O
will	O
remain	O
;	O
on	O
the	O
opposite	O
,	O
details	O
will	O
be	O
smoothed	O
out	O
along	O
with	O
suppressing	O
noise	O
.	O

With	O
some	O
optimization	Method
algorithms	Method
,	O
the	O
solution	O
of	O
Eqn	O
.	O

(	O
[	O
reference	O
]	O
)	O
actually	O
defines	O
an	O
implicit	O
function	O
given	O
by	O
Since	O
can	O
be	O
absorbed	O
into	O
,	O
Eqn	O
.	O

(	O
[	O
reference	O
]	O
)	O
can	O
be	O
rewritten	O
as	O
In	O
this	O
sense	O
,	O
setting	O
noise	O
level	O
also	O
plays	O
the	O
role	O
of	O
setting	O
to	O
control	O
the	O
trade	O
-	O
off	O
between	O
noise	Task
reduction	Task
and	O
detail	Task
preservation	Task
.	O

In	O
a	O
word	O
,	O
model	Method
-	Method
based	Method
methods	Method
are	O
flexible	O
in	O
handling	O
images	O
with	O
various	O
noise	O
levels	O
by	O
simply	O
specifying	O
in	O
Eqn	O
.	O

(	O
[	O
reference	O
]	O
)	O
.	O

According	O
to	O
the	O
above	O
discussion	O
,	O
it	O
is	O
natural	O
to	O
utilize	O
CNN	Method
to	O
learn	O
an	O
explicit	O
mapping	O
of	O
Eqn	O
.	O

(	O
[	O
reference	O
]	O
)	O
which	O
takes	O
the	O
noise	Material
image	Material
and	O
noise	O
level	O
as	O
input	O
.	O

However	O
,	O
since	O
the	O
inputs	O
y	O
and	O
have	O
different	O
dimensions	O
,	O
it	O
is	O
not	O
easy	O
to	O
directly	O
feed	O
them	O
into	O
CNN	Method
.	O

Inspired	O
by	O
the	O
patch	Method
based	Method
denoising	Method
methods	Method
which	O
actually	O
set	O
for	O
each	O
patch	O
,	O
we	O
resolve	O
the	O
dimensionality	Task
mismatching	Task
problem	Task
by	O
stretching	O
the	O
noise	O
level	O
into	O
a	O
noise	O
level	O
map	O
M	O
.	O

In	O
M	O
,	O
all	O
the	O
elements	O
are	O
.	O

As	O
a	O
result	O
,	O
Eqn	O
.	O

(	O
[	O
reference	O
]	O
)	O
can	O
be	O
further	O
rewritten	O
as	O
It	O
is	O
worth	O
emphasizing	O
that	O
M	O
can	O
be	O
extended	O
to	O
degradation	Task
maps	Task
with	O
multiple	O
channels	O
for	O
more	O
general	O
noise	Method
models	Method
such	O
as	O
the	O
multivariate	Method
(	Method
3D	Method
)	Method
Gaussian	Method
noise	Method
model	Method
with	O
zero	O
mean	O
and	O
covariance	O
matrix	O
in	O
the	O
RGB	O
color	O
space	O
.	O

As	O
such	O
,	O
a	O
single	O
CNN	Method
model	Method
is	O
expected	O
to	O
inherit	O
the	O
flexibility	O
of	O
handling	O
noise	Method
model	Method
with	O
different	O
parameters	O
,	O
even	O
spatially	O
variant	O
noises	O
by	O
noting	O
M	O
can	O
be	O
non	O
-	O
uniform	O
.	O

subsection	O
:	O
Denoising	Task
on	O
Sub	Task
-	Task
images	Task
Efficiency	Metric
is	O
another	O
crucial	O
issue	O
for	O
practical	O
CNN	Task
-	Task
based	Task
denoising	Task
.	O

One	O
straightforward	O
idea	O
is	O
to	O
reduce	O
the	O
depth	O
and	O
number	O
of	O
filters	O
.	O

However	O
,	O
such	O
a	O
strategy	O
will	O
sacrifice	O
much	O
the	O
modeling	Metric
capacity	Metric
and	O
receptive	O
field	O
of	O
CNN	Method
.	O

In	O
,	O
dilated	Method
convolution	Method
is	O
introduced	O
to	O
expand	O
receptive	O
field	O
without	O
the	O
increase	O
of	O
network	O
depth	O
,	O
resulting	O
in	O
a	O
7	Method
-	Method
layer	Method
denoising	Method
CNN	Method
.	O

Unfortunately	O
,	O
we	O
empirically	O
find	O
that	O
FFDNet	Method
with	O
dilated	Method
convolution	Method
tends	O
to	O
generate	O
artifacts	O
around	O
sharp	O
edges	O
.	O

Shi	O
et	O
al	O
.	O

proposed	O
to	O
extract	O
deep	O
features	O
directly	O
from	O
the	O
low	Material
-	Material
resolution	Material
image	Material
for	O
super	Task
-	Task
resolution	Task
,	O
and	O
introduced	O
a	O
sub	Method
-	Method
pixel	Method
convolution	Method
layer	Method
to	O
improve	O
computational	Metric
efficiency	Metric
.	O

In	O
the	O
application	O
of	O
image	Task
denoising	Task
,	O
we	O
introduce	O
a	O
reversible	Method
downsampling	Method
layer	Method
to	O
reshape	O
the	O
input	O
image	O
into	O
a	O
set	O
of	O
small	Material
sub	Material
-	Material
images	Material
.	O

Here	O
the	O
downsampling	O
factor	O
is	O
set	O
to	O
2	O
since	O
it	O
can	O
largely	O
improve	O
the	O
speed	Metric
without	O
reducing	O
modeling	Metric
capacity	Metric
.	O

The	O
CNN	Method
is	O
deployed	O
on	O
the	O
sub	Material
-	Material
images	Material
,	O
and	O
finally	O
a	O
sub	Method
-	Method
pixel	Method
convolution	Method
layer	Method
is	O
adopted	O
to	O
reverse	O
the	O
downsampling	Task
process	Task
.	O

Denoising	Method
on	O
downsampled	Material
sub	Material
-	Material
images	Material
can	O
also	O
effectively	O
expand	O
the	O
receptive	O
field	O
which	O
in	O
turn	O
leads	O
to	O
a	O
moderate	O
network	O
depth	O
.	O

For	O
example	O
,	O
the	O
proposed	O
network	O
with	O
a	O
depth	O
of	O
15	O
and	O
convolution	Method
will	O
have	O
a	O
large	O
receptive	O
field	O
of	O
.	O

In	O
contrast	O
,	O
a	O
plain	Method
15	Method
-	Method
layer	Method
CNN	Method
only	O
has	O
a	O
receptive	O
field	O
size	O
of	O
31	O
31	O
.	O

We	O
note	O
that	O
the	O
receptive	O
field	O
of	O
most	O
state	O
-	O
of	O
-	O
the	O
-	O
art	O
denoising	Method
methods	Method
ranges	O
from	O
to	O
.	O

Further	O
increase	O
of	O
receptive	O
field	O
actually	O
benefits	O
little	O
in	O
improving	O
denoising	Metric
performance	Metric
.	O

What	O
is	O
more	O
,	O
the	O
introduction	O
of	O
subsampling	Method
and	Method
sub	Method
-	Method
pixel	Method
convolution	Method
is	O
effective	O
in	O
reducing	O
the	O
memory	Metric
burden	Metric
.	O

Experiments	O
are	O
conducted	O
to	O
validate	O
the	O
effectiveness	O
of	O
downsampling	Method
for	O
balancing	Metric
denoising	Metric
accuracy	Metric
and	O
efficiency	Metric
on	O
the	O
BSD68	Material
dataset	Material
with	O
and	O
.	O

For	O
grayscale	O
image	Task
denoising	Task
,	O
we	O
train	O
a	O
baseline	Method
CNN	Method
which	O
has	O
the	O
same	O
depth	O
as	O
FFDNet	Method
without	O
downsampling	Method
.	O

The	O
comparison	O
of	O
average	O
PSNR	Metric
values	O
is	O
given	O
as	O
follows	O
:	O
(	O
i	O
)	O
when	O
is	O
small	O
(	O
i.e.	O
,	O
)	O
,	O
the	O
baseline	Method
CNN	Method
slightly	O
outperforms	O
FFDNet	Method
by	O
0.02dB	O
;	O
(	O
ii	O
)	O
when	O
is	O
large	O
(	O
i.e.	O
,	O
)	O
,	O
FFDNet	Method
performs	O
better	O
than	O
the	O
baseline	Method
CNN	Method
by	O
0.09dB.	O
However	O
,	O
FFDNet	Method
is	O
nearly	O
3	O
times	O
faster	O
and	O
is	O
more	O
memory	O
-	O
friendly	O
than	O
the	O
baseline	Method
CNN	Method
.	O

As	O
a	O
result	O
,	O
by	O
performing	O
denoising	Method
on	O
sub	Material
-	Material
images	Material
,	O
FFDNet	Method
significantly	O
improves	O
efficiency	O
while	O
maintaining	O
denoising	Task
performance	O
.	O

subsection	O
:	O
Examining	O
the	O
Role	O
of	O
Noise	Metric
Level	Metric
Map	Metric
By	O
training	O
the	O
model	O
with	O
abundant	Material
data	Material
units	Material
,	O
where	O
M	O
is	O
exactly	O
the	O
noise	O
level	O
map	O
of	O
y	O
,	O
the	O
model	O
is	O
expected	O
to	O
perform	O
well	O
when	O
the	O
noise	O
level	O
matches	O
the	O
ground	O
-	O
truth	O
one	O
(	O
see	O
Fig	O
.	O

[	O
reference	O
]	O
(	O
a	O
)	O
)	O
.	O

On	O
the	O
other	O
hand	O
,	O
in	O
practice	O
,	O
we	O
may	O
need	O
to	O
use	O
the	O
learned	O
model	O
to	O
smooth	O
out	O
some	O
details	O
with	O
a	O
higher	O
noise	Metric
level	Metric
map	Metric
than	O
the	O
ground	O
-	O
truth	O
one	O
(	O
see	O
Fig	O
.	O

[	O
reference	O
]	O
(	O
b	O
)	O
)	O
.	O

In	O
other	O
words	O
,	O
one	O
may	O
take	O
advantage	O
of	O
the	O
role	O
of	O
to	O
control	O
the	O
trade	O
-	O
off	O
between	O
noise	Task
reduction	Task
and	O
detail	Task
preservation	Task
.	O

Hence	O
,	O
it	O
is	O
very	O
necessary	O
to	O
further	O
examine	O
whether	O
M	O
can	O
play	O
the	O
role	O
of	O
.	O

Unfortunately	O
,	O
the	O
use	O
of	O
both	O
M	O
and	O
y	O
as	O
input	O
also	O
increases	O
the	O
difficulty	O
to	O
train	O
the	O
model	O
.	O

According	O
to	O
our	O
experiments	O
on	O
several	O
learned	Method
models	Method
,	O
the	O
model	O
may	O
give	O
rise	O
to	O
visual	O
artifacts	O
especially	O
when	O
the	O
input	O
noise	O
level	O
is	O
much	O
higher	O
than	O
the	O
ground	O
-	O
truth	O
one	O
(	O
see	O
Fig	O
.	O

[	O
reference	O
]	O
(	O
c	O
)	O
)	O
,	O
which	O
indicates	O
M	O
fails	O
to	O
control	O
the	O
trade	O
-	O
off	O
between	O
noise	Task
reduction	Task
and	O
detail	Task
preservation	Task
.	O

Note	O
that	O
it	O
does	O
not	O
mean	O
all	O
the	O
models	O
suffer	O
from	O
such	O
problem	O
.	O

One	O
possible	O
solution	O
to	O
avoid	O
this	O
is	O
to	O
regularize	O
the	O
convolution	Method
filters	Method
.	O

As	O
a	O
widely	O
-	O
used	O
regularization	Method
method	Method
,	O
orthogonal	Method
regularization	Method
has	O
proven	O
to	O
be	O
effective	O
in	O
eliminating	O
the	O
correlation	O
between	O
convolution	O
filters	O
,	O
facilitating	O
gradient	Method
propagation	Method
and	O
improving	O
the	O
compactness	Metric
of	O
the	O
learned	Method
model	Method
.	O

In	O
addition	O
,	O
recent	O
studies	O
have	O
demonstrated	O
the	O
advantage	O
of	O
orthogonal	Method
regularization	Method
in	O
enhancing	O
the	O
network	Metric
generalization	Metric
ability	Metric
in	O
applications	O
of	O
deep	Task
hashing	Task
and	O
image	Task
classification	Task
.	O

According	O
to	O
our	O
experiments	O
,	O
we	O
empirically	O
find	O
that	O
the	O
orthogonal	Method
initialization	Method
of	Method
the	Method
convolution	Method
filters	Method
works	O
well	O
in	O
suppressing	O
the	O
above	O
mentioned	O
visual	O
artifacts	O
.	O

It	O
is	O
worth	O
emphasising	O
that	O
this	O
section	O
aims	O
to	O
highlight	O
the	O
necessity	O
of	O
guaranteeing	O
the	O
role	O
of	O
M	O
in	O
controlling	O
the	O
trade	O
-	O
off	O
between	O
noise	Task
reduction	Task
and	O
detail	Task
preservation	Task
rather	O
than	O
proposing	O
a	O
method	O
to	O
avoid	O
the	O
possible	O
visual	O
artifacts	O
caused	O
by	O
noise	O
level	O
mismatch	O
.	O

In	O
practice	O
,	O
one	O
may	O
retrain	O
the	O
model	O
until	O
M	O
plays	O
its	O
role	O
and	O
results	O
in	O
no	O
visual	O
artifacts	O
with	O
a	O
lager	O
noise	O
level	O
.	O

subsection	O
:	O
FFDNet	Method
vs.	O
a	O
Single	Method
Blind	Method
Model	Method
So	O
far	O
,	O
we	O
have	O
known	O
that	O
it	O
is	O
possible	O
to	O
learn	O
a	O
single	O
model	O
for	O
blind	Task
and	Task
non	Task
-	Task
blind	Task
Gaussian	Task
denoising	Task
,	O
respectively	O
.	O

And	O
it	O
is	O
of	O
significant	O
importance	O
to	O
clarify	O
their	O
differences	O
.	O

First	O
,	O
the	O
generalization	Metric
ability	Metric
is	O
different	O
.	O

Although	O
the	O
blind	Method
model	Method
performs	O
favorably	O
for	O
synthetic	Task
AWGN	Task
removal	Task
without	O
knowing	O
the	O
noise	O
level	O
,	O
it	O
does	O
not	O
generalize	O
well	O
to	O
real	O
noisy	Material
images	Material
whose	O
noises	Material
are	O
much	O
more	O
complex	O
than	O
AWGN	O
(	O
see	O
the	O
results	O
of	O
DnCNN	Method
-	O
B	O
in	O
Fig	O
.	O

[	O
reference	O
]	O
)	O
.	O

Actually	O
,	O
since	O
the	O
CNN	Method
model	Method
can	O
be	O
treated	O
as	O
the	O
inference	Task
of	Task
Eqn	Task
.	O

(	O
[	O
reference	O
]	O
)	O
and	O
the	O
data	O
fidelity	O
term	O
corresponds	O
to	O
the	O
degradation	Method
process	Method
(	O
or	O
the	O
noise	Method
model	Method
)	O
,	O
the	O
modeling	Metric
accuracy	Metric
of	O
the	O
degradation	Task
process	Task
is	O
very	O
important	O
for	O
the	O
success	O
of	O
a	O
denoising	Method
model	Method
.	O

For	O
example	O
,	O
a	O
model	O
trained	O
for	O
AWGN	Task
removal	Task
is	O
not	O
expected	O
to	O
be	O
still	O
effective	O
for	O
Poisson	Task
noise	Task
removal	Task
.	O

By	O
contrast	O
,	O
the	O
non	O
-	O
blind	O
FFDNet	Method
model	O
can	O
be	O
viewed	O
as	O
multiple	O
denoisers	Method
,	O
each	O
of	O
which	O
is	O
anchored	O
with	O
a	O
noise	O
level	O
.	O

Accordingly	O
,	O
it	O
has	O
the	O
ability	O
to	O
control	O
the	O
trade	O
-	O
off	O
between	O
noise	Task
removal	Task
and	O
detail	Task
preservation	Task
which	O
in	O
turn	O
facilitates	O
the	O
removal	Task
of	Task
real	Task
noise	Task
to	O
some	O
extent	O
(	O
see	O
the	O
results	O
of	O
DnCNN	Method
and	O
FFDNet	Method
in	O
Fig	O
.	O

[	O
reference	O
]	O
)	O
.	O

Second	O
,	O
the	O
performance	O
for	O
AWGN	Task
removal	Task
is	O
different	O
.	O

The	O
non	Method
-	Method
blind	Method
model	Method
with	O
noise	Method
level	Method
map	Method
has	O
moderately	O
better	O
performance	O
for	O
AWGN	Task
removal	Task
than	O
the	O
blind	O
one	O
(	O
about	O
0.1dB	O
gain	O
on	O
average	O
for	O
the	O
BSD68	Material
dataset	Material
)	O
,	O
possibly	O
because	O
the	O
noise	O
level	O
map	O
provides	O
additional	O
information	O
to	O
the	O
input	O
.	O

Similar	O
phenomenon	O
has	O
also	O
been	O
recognized	O
in	O
the	O
task	O
of	O
single	Task
image	Task
super	Task
-	Task
resolution	Task
(	O
SISR	Task
)	O
.	O

Third	O
,	O
the	O
application	O
range	O
is	O
different	O
.	O

In	O
the	O
variable	Method
splitting	Method
algorithms	Method
for	O
general	O
image	Task
restoration	Task
tasks	Task
,	O
the	O
prior	O
term	O
involves	O
a	O
denoising	Method
subproblem	Method
with	O
a	O
current	O
noise	O
level	O
.	O

Thus	O
,	O
the	O
non	Method
-	Method
blind	Method
model	Method
can	O
be	O
easily	O
plugged	O
into	O
variable	Method
splitting	Method
algorithms	Method
to	O
solve	O
various	O
image	Task
restoration	Task
tasks	Task
,	O
such	O
as	O
image	Task
deblurring	Task
,	O
SISR	Task
,	O
and	O
image	Task
inpainting	Task
.	O

However	O
,	O
the	O
blind	Method
model	Method
does	O
not	O
have	O
this	O
merit	O
.	O

subsection	O
:	O
Residual	Method
vs.	Method
Non	Method
-	Method
residual	Method
Learning	Method
of	Method
Plain	Method
CNN	Method
It	O
has	O
been	O
pointed	O
out	O
that	O
the	O
integration	O
of	O
residual	Method
learning	Method
for	O
plain	Method
CNN	Method
and	O
batch	Method
normalization	Method
is	O
beneficial	O
to	O
the	O
removal	Task
of	Task
AWGN	Task
as	O
it	O
eases	O
the	O
training	Task
and	O
tends	O
to	O
deliver	O
better	O
performance	O
.	O

The	O
main	O
reason	O
is	O
that	O
the	O
residual	O
(	O
noise	O
)	O
output	O
follows	O
a	O
Gaussian	Method
distribution	Method
which	O
facilitates	O
the	O
Gaussian	Method
normalization	Method
step	Method
of	O
batch	Method
normalization	Method
.	O

The	O
denoising	Method
network	Method
gains	O
most	O
from	O
such	O
a	O
task	O
-	O
specific	O
merit	O
especially	O
when	O
a	O
single	O
noise	O
level	O
is	O
considered	O
.	O

In	O
FFDNet	Method
,	O
we	O
instead	O
consider	O
a	O
wide	O
range	O
of	O
noise	O
level	O
and	O
introduce	O
a	O
noise	O
level	O
map	O
as	O
input	O
.	O

Thus	O
,	O
it	O
is	O
interesting	O
to	O
revisit	O
the	O
integration	O
of	O
residual	Method
learning	Method
and	O
batch	Method
normalization	Method
for	O
plain	Task
CNN	Task
.	O

According	O
to	O
our	O
experiments	O
,	O
batch	Method
normalization	Method
can	O
always	O
accelerate	O
the	O
training	O
of	O
denoising	Method
network	Method
regardless	O
of	O
the	O
residual	Method
or	Method
non	Method
-	Method
residual	Method
learning	Method
strategy	Method
of	O
plain	Method
CNN	Method
.	O

In	O
particular	O
,	O
with	O
batch	Task
normalization	Task
,	O
while	O
the	O
residual	Method
learning	Method
enjoys	O
a	O
faster	O
convergence	Metric
than	O
non	Method
-	Method
residual	Method
learning	Method
,	O
their	O
final	O
performances	O
after	O
fine	Method
-	Method
tuning	Method
are	O
almost	O
exactly	O
the	O
same	O
.	O

Some	O
recent	O
works	O
have	O
proposed	O
to	O
train	O
very	O
deep	Method
plain	Method
networks	Method
with	O
nearly	O
the	O
same	O
performance	O
to	O
that	O
with	O
residual	Method
learning	Method
.	O

In	O
fact	O
,	O
when	O
a	O
network	O
is	O
moderately	O
deep	O
(	O
e.g.	O
,	O
less	O
than	O
20	O
)	O
,	O
it	O
is	O
feasible	O
to	O
train	O
a	O
plain	Method
network	Method
without	O
the	O
residual	Method
learning	Method
strategy	Method
by	O
using	O
advanced	O
CNN	Method
training	Method
and	Method
design	Method
techniques	Method
such	O
as	O
ReLU	Method
,	O
batch	Method
normalization	Method
and	O
Adam	Method
.	O

For	O
simplicity	O
,	O
we	O
do	O
not	O
use	O
residual	Method
learning	Method
for	O
network	Task
design	Task
.	O

subsection	O
:	O
Un	Task
-	Task
clipping	Task
vs.	O
Clipping	O
of	O
Noisy	Material
Images	Material
for	O
Training	O
In	O
the	O
AWGN	Material
denoising	Material
literature	Material
,	O
there	O
exist	O
two	O
widely	O
-	O
used	O
settings	O
,	O
i.e.	O
,	O
un	O
-	O
clipping	O
and	O
clipping	Material
,	O
of	O
synthetic	Material
noisy	Material
image	Material
to	O
evaluate	O
the	O
performance	O
of	O
denoising	Method
methods	Method
.	O

The	O
main	O
difference	O
between	O
the	O
two	O
settings	O
lies	O
in	O
whether	O
the	O
noisy	Material
image	Material
is	O
clipped	O
into	O
the	O
range	O
of	O
0	O
-	O
255	O
(	O
or	O
more	O
precisely	O
,	O
quantized	O
into	O
8	O
-	O
bit	O
format	O
)	O
after	O
adding	O
the	O
noise	O
.	O

On	O
the	O
one	O
hand	O
,	O
the	O
un	Method
-	Method
clipping	Method
setting	Method
which	O
is	O
also	O
the	O
most	O
widely	O
-	O
used	O
setting	O
serves	O
an	O
ideal	O
test	O
bed	O
for	O
evaluating	O
the	O
denoising	Method
methods	Method
.	O

This	O
is	O
because	O
most	O
denoising	Method
methods	Method
assume	O
the	O
noise	O
is	O
ideal	O
AWGN	O
,	O
and	O
the	O
clipping	O
of	O
noisy	O
input	O
would	O
make	O
the	O
noise	O
characteristics	O
deviate	O
from	O
being	O
AWGN	O
.	O

Furthermore	O
,	O
in	O
the	O
variable	Method
splitting	Method
algorithms	Method
for	O
solving	O
general	Task
image	Task
restoration	Task
problems	Task
,	O
there	O
exists	O
a	O
subproblem	O
which	O
,	O
from	O
a	O
Bayesian	Method
perspective	Method
,	O
corresponds	O
to	O
a	O
Gaussian	Task
denoising	Task
problem	Task
.	O

This	O
further	O
broadens	O
the	O
use	O
of	O
the	O
un	Task
-	Task
clipping	Task
setting	Task
.	O

Thus	O
,	O
unless	O
otherwise	O
specified	O
,	O
FFDNet	Method
in	O
this	O
work	O
refers	O
to	O
the	O
model	O
trained	O
on	O
images	Material
without	O
clipping	Material
or	O
quantization	O
.	O

On	O
the	O
other	O
hand	O
,	O
since	O
real	Material
noisy	Material
images	Material
are	O
always	O
integer	O
-	O
valued	O
and	O
range	O
-	O
limited	O
,	O
it	O
has	O
been	O
argued	O
that	O
the	O
clipping	Method
setting	Method
of	O
noisy	Material
image	Material
makes	O
the	O
data	O
more	O
realistic	O
.	O

However	O
,	O
when	O
the	O
noise	O
level	O
is	O
high	O
,	O
the	O
noise	O
will	O
be	O
not	O
zero	O
-	O
mean	O
any	O
more	O
due	O
to	O
clipping	O
effects	O
.	O

This	O
in	O
turn	O
will	O
lead	O
to	O
unreliable	O
denoiser	Method
for	O
plugging	O
into	O
the	O
variable	Method
splitting	Method
algorithms	Method
to	O
solve	O
other	O
image	Task
restoration	Task
problems	Task
.	O

To	O
thoroughly	O
evaluate	O
the	O
proposed	O
method	O
,	O
we	O
also	O
train	O
an	O
FFDNet	Method
model	O
with	O
clipping	Method
setting	Method
of	O
noisy	Material
image	Material
,	O
namely	O
FFDNet	Method
-	Method
Clip	Method
,	O
for	O
comparison	O
.	O

During	O
training	O
and	O
testing	O
of	O
FFDNet	Method
-	Method
Clip	Method
,	O
the	O
noisy	Material
images	Material
are	O
quantized	O
into	O
8	O
-	O
bit	O
format	O
.	O

Specifically	O
,	O
for	O
a	O
clean	Material
image	Material
x	Material
,	O
we	O
use	O
the	O
matlab	Method
function	Method
imnoise	Method
(	Method
x	Method
,	O
'	O
gaussian	O
'	O
,	O
0	O
,	O
to	O
generate	O
the	O
quantized	O
noisy	O
y	O
with	O
noise	O
level	O
.	O

section	O
:	O
Experiments	O
subsection	O
:	O
Dataset	Task
Generation	Task
and	O
Network	Task
Training	Task
To	O
train	O
the	O
FFDNet	Method
model	O
,	O
we	O
need	O
to	O
prepare	O
a	O
training	O
dataset	O
of	O
input	O
-	O
output	O
pairs	O
.	O

Here	O
,	O
is	O
obtained	O
by	O
adding	O
AWGN	O
to	O
latent	Material
image	Material
,	O
and	O
is	O
the	O
noise	O
level	O
map	O
.	O

The	O
reason	O
to	O
use	O
AWGN	Method
to	O
generate	O
the	O
training	O
dataset	O
is	O
two	O
-	O
fold	O
.	O

First	O
,	O
AWGN	Method
is	O
a	O
natural	O
choice	O
when	O
there	O
is	O
no	O
specific	O
prior	O
information	O
on	O
noise	O
source	O
.	O

Second	O
,	O
real	O
-	O
world	O
noise	O
can	O
be	O
approximated	O
as	O
locally	O
AWGN	O
.	O

More	O
specifically	O
,	O
FFDNet	Method
model	O
is	O
trained	O
on	O
the	O
noisy	Material
images	Material
without	O
quantization	O
to	O
8	O
-	O
bit	O
integer	O
values	O
.	O

Though	O
the	O
real	Material
noisy	Material
images	Material
are	O
generally	O
8	O
-	O
bit	O
quantized	O
,	O
we	O
empirically	O
found	O
that	O
the	O
learned	O
model	O
still	O
works	O
effectively	O
on	O
real	Material
noisy	Material
images	Material
.	O

For	O
FFDNet	Method
-	Method
Clip	Method
,	O
as	O
mentioned	O
in	O
Sec	O
.	O

[	O
reference	O
]	O
,	O
we	O
use	O
the	O
matlab	Method
function	Method
imnoise	Method
to	O
generate	O
the	O
quantized	Material
noisy	Material
image	Material
from	O
a	O
clean	O
one	O
.	O

We	O
collected	O
a	O
large	O
dataset	O
of	O
source	Material
images	Material
,	O
including	O
400	O
BSD	Material
images	Material
,	O
400	O
images	O
selected	O
from	O
the	O
validation	O
set	O
of	O
ImageNet	Material
,	O
and	O
the	O
4	O
,	O
744	O
images	O
from	O
the	O
Waterloo	Material
Exploration	Material
Database	Material
.	O

In	O
each	O
epoch	O
,	O
we	O
randomly	O
crop	O
patches	O
from	O
these	O
images	O
for	O
training	O
.	O

The	O
patch	O
size	O
should	O
be	O
larger	O
than	O
the	O
receptive	O
field	O
of	O
FFDNet	Method
,	O
and	O
we	O
set	O
it	O
to	O
70	O
70	O
and	O
50	O
50	O
for	O
grayscale	Material
images	Material
and	O
color	Material
images	Material
,	O
respectively	O
.	O

The	O
noisy	Material
patches	Material
are	O
obtained	O
by	O
adding	O
AWGN	O
of	O
noise	O
level	O
to	O
the	O
clean	Material
patches	Material
.	O

For	O
each	O
noisy	O
patch	O
,	O
the	O
noise	O
level	O
map	O
is	O
uniform	O
.	O

Since	O
FFDNet	Method
is	O
a	O
fully	Method
convolutional	Method
neural	Method
network	Method
,	O
it	O
inherits	O
the	O
local	O
connectivity	O
property	O
that	O
the	O
output	O
pixel	O
is	O
determined	O
by	O
the	O
local	O
noisy	O
input	O
and	O
local	O
noise	O
level	O
.	O

Hence	O
,	O
the	O
trained	O
FFDNet	Method
naturally	O
has	O
the	O
ability	O
to	O
handle	O
spatially	O
variant	O
noise	O
by	O
specifying	O
a	O
non	O
-	O
uniform	O
noise	O
level	O
map	O
.	O

For	O
clarity	O
,	O
in	O
Table	O
[	O
reference	O
]	O
we	O
list	O
the	O
main	O
specifications	O
of	O
the	O
FFDNet	Method
models	O
.	O

The	O
ADAM	Method
algorithm	Method
is	O
adopted	O
to	O
optimize	O
FFDNet	Method
by	O
minimizing	O
the	O
following	O
loss	O
function	O
,	O
The	O
learning	Metric
rate	Metric
starts	O
from	O
and	O
reduces	O
to	O
when	O
the	O
training	Metric
error	Metric
stops	O
decreasing	O
.	O

When	O
the	O
training	Metric
error	Metric
keeps	O
unchanged	O
in	O
five	O
sequential	O
epochs	O
,	O
we	O
merge	O
the	O
parameters	O
of	O
each	O
batch	Method
normalization	Method
into	O
the	O
adjacent	O
convolution	Method
filters	Method
.	O

Then	O
,	O
a	O
smaller	O
learning	Metric
rate	Metric
of	O
is	O
adopted	O
for	O
additional	O
50	O
epochs	O
to	O
fine	O
-	O
tune	O
the	O
FFDNet	Method
model	O
.	O

As	O
for	O
the	O
other	O
hyper	O
-	O
parameters	O
of	O
ADAM	Method
,	O
we	O
use	O
their	O
default	O
settings	O
.	O

The	O
mini	O
-	O
batch	O
size	O
is	O
set	O
as	O
128	O
,	O
and	O
the	O
rotation	Method
and	Method
flip	Method
based	Method
data	Method
augmentation	Method
is	O
also	O
adopted	O
during	O
training	Task
.	O

The	O
FFDNet	Method
models	O
are	O
trained	O
in	O
Matlab	Method
(	O
R2015b	O
)	O
environment	O
with	O
MatConvNet	Method
package	Method
and	O
an	O
Nvidia	Method
Titan	Method
X	Method
Pascal	Method
GPU	Method
.	O

The	O
training	O
of	O
a	O
single	O
model	O
can	O
be	O
done	O
in	O
about	O
two	O
days	O
.	O

To	O
evaluate	O
the	O
proposed	O
FFDNet	Method
denoisers	O
on	O
grayscale	O
image	Task
denoising	Task
,	O
we	O
use	O
BSD68	Material
and	Material
Set12	Material
datasets	Material
to	O
test	O
FFDNet	Method
for	O
removing	O
AWGN	Material
noise	Material
,	O
and	O
use	O
the	O
“	O
RNI6	Material
”	Material
dataset	Material
to	O
test	O
FFDNet	Method
for	O
removing	Task
real	Task
noise	Task
.	O

The	O
BSD68	Material
dataset	Material
consists	O
of	O
68	O
images	O
from	O
the	O
separate	O
test	O
set	O
of	O
the	O
BSD300	Material
dataset	Material
.	O

The	O
Set12	Material
dataset	Material
is	O
a	O
collection	O
of	O
widely	O
-	O
used	O
testing	Material
images	Material
.	O

The	O
RNI6	Material
dataset	Material
contains	O
6	O
real	Material
noisy	Material
images	Material
without	O
ground	O
-	O
truth	O
.	O

In	O
particular	O
,	O
to	O
evaluate	O
FFDNet	Method
-	Method
Clip	Method
,	O
we	O
use	O
the	O
quantized	Material
“	Material
Clip300	Material
”	Material
dataset	Material
which	O
comprises	O
the	O
100	O
images	O
of	O
test	O
set	O
from	O
the	O
BSD300	Material
dataset	Material
and	O
200	O
images	O
from	O
PASCALVOC	Material
2012	Material
dataset	Material
.	O

Note	O
that	O
all	O
the	O
testing	O
images	O
are	O
not	O
included	O
in	O
the	O
training	O
dataset	O
.	O

As	O
for	O
color	O
image	Task
denoising	Task
,	O
we	O
employ	O
four	O
datasets	O
,	O
namely	O
CBSD68	Material
,	O
Kodak24	Material
,	O
McMaster	Material
,	O
and	O
“	O
RNI15	Method
”	O
.	O

The	O
CBSD68	Material
dataset	Material
is	O
the	O
corresponding	O
color	O
version	O
of	O
the	O
grayscale	O
BSD68	Material
dataset	Material
.	O

The	O
Kodak24	Material
dataset	Material
consists	O
of	O
24	O
center	Material
-	Material
cropped	Material
images	Material
of	O
size	O
500	O
500	O
from	O
the	O
original	O
Kodak	Material
dataset	Material
.	O

The	O
McMaster	Material
dataset	Material
is	O
a	O
widely	O
-	O
used	O
dataset	O
for	O
color	Task
demosaicing	Task
,	O
which	O
contains	O
18	O
cropped	Material
images	Material
of	O
size	O
500	O
500	O
.	O

Compared	O
to	O
the	O
Kodak24	Material
images	Material
,	O
the	O
images	O
in	O
McMaster	Material
dataset	Material
exhibit	O
more	O
saturated	O
colors	O
.	O

The	O
RNI15	Material
dataset	Material
consists	O
of	O
15	O
real	Material
noisy	Material
images	Material
.	O

We	O
note	O
that	O
RNI6	Method
and	O
RNI15	Method
cover	O
a	O
variety	O
of	O
real	O
noise	O
types	O
,	O
such	O
as	O
camera	Material
noise	Material
and	O
JPEG	Material
compression	Material
noise	Material
.	O

Since	O
the	O
ground	Material
-	Material
truth	Material
clean	Material
images	Material
are	O
unavailable	O
for	O
real	Material
noisy	Material
images	Material
,	O
we	O
thus	O
only	O
provide	O
the	O
visual	O
comparisons	O
on	O
these	O
images	O
.	O

The	O
source	Method
codes	Method
of	O
FFDNet	Method
and	O
its	O
extension	O
to	O
multivariate	O
Gaussian	O
noise	O
are	O
available	O
at	O
.	O

subsection	O
:	O
Experiments	O
on	O
AWGN	Task
Removal	Task
In	O
this	O
subsection	O
,	O
we	O
test	O
FFDNet	Method
on	O
noisy	Material
images	Material
corrupted	O
by	O
spatially	Material
invariant	Material
AWGN	Material
.	O

For	O
grayscale	O
image	Task
denoising	Task
,	O
we	O
mainly	O
compare	O
FFDNet	Method
with	O
state	O
-	O
of	O
-	O
the	O
-	O
art	O
methods	O
BM3D	Method
,	O
WNNM	Method
,	O
MLP	Method
,	O
TNRD	Method
,	O
and	O
DnCNN	Method
.	O

Note	O
that	O
BM3D	Method
and	O
WNNM	Method
are	O
two	O
representative	O
model	Method
-	Method
based	Method
methods	Method
based	O
on	O
nonlocal	Method
self	Method
-	Method
similarity	Method
prior	Method
,	O
whereas	O
TNRD	Method
,	O
MLP	Method
and	O
DnCNN	Method
are	O
discriminative	Method
learning	Method
based	Method
methods	Method
.	O

Tables	O
[	O
reference	O
]	O
and	O
[	O
reference	O
]	O
report	O
the	O
PSNR	Metric
results	O
on	O
BSD68	Material
and	Material
Set12	Material
datasets	Material
,	O
respectively	O
.	O

We	O
also	O
use	O
two	O
CNN	Method
-	Method
based	Method
denoising	Method
methods	Method
,	O
i.e.	O
,	O
RED30	Method
and	O
MemNet	Method
,	O
for	O
further	O
comparison	O
.	O

Their	O
PSNR	Metric
results	O
on	O
BSD68	Material
dataset	Material
with	O
noise	O
level	O
50	O
are	O
26.34dB	O
and	O
26.35dB	O
,	O
respectively	O
.	O

Note	O
that	O
RED30	Method
and	O
MemNet	Method
are	O
trained	O
on	O
a	O
specific	O
noise	O
level	O
and	O
are	O
less	O
efficient	O
than	O
DnCNN	Method
.	O

From	O
Tables	O
[	O
reference	O
]	O
and	O
[	O
reference	O
]	O
,	O
one	O
can	O
have	O
the	O
following	O
observations	O
.	O

First	O
,	O
FFDNet	Method
surpasses	O
BM3D	Method
by	O
a	O
large	O
margin	O
and	O
outperforms	O
WNNM	Method
,	O
MLP	Method
and	O
TNRD	Method
by	O
about	O
0.2dB	O
for	O
a	O
wide	O
range	O
of	O
noise	O
levels	O
on	O
BSD68	Method
.	O

Second	O
,	O
FFDNet	Method
is	O
slightly	O
inferior	O
to	O
DnCNN	Method
when	O
the	O
noise	O
level	O
is	O
low	O
(	O
e.g.	O
,	O
)	O
,	O
but	O
gradually	O
outperforms	O
DnCNN	Method
with	O
the	O
increase	O
of	O
noise	O
level	O
(	O
e.g.	O
,	O
)	O
.	O

This	O
phenomenon	O
may	O
be	O
resulted	O
from	O
the	O
trade	O
-	O
off	O
between	O
receptive	O
field	O
size	O
and	O
modeling	O
capacity	O
.	O

FFDNet	Method
has	O
a	O
larger	O
receptive	O
field	O
than	O
DnCNN	Method
,	O
thus	O
favoring	O
for	O
removing	Task
strong	Task
noise	Task
,	O
while	O
DnCNN	Method
has	O
better	O
modeling	Metric
capacity	Metric
which	O
is	O
beneficial	O
for	O
denoising	Task
images	Task
with	O
lower	O
noise	O
level	O
.	O

Third	O
,	O
FFDNet	Method
outperforms	O
WNNM	Method
on	O
images	Material
such	O
as	O
“	O
House	O
”	O
,	O
while	O
it	O
is	O
inferior	O
to	O
WNNM	Method
on	O
image	O
“	O
Barbara	O
”	O
.	O

This	O
is	O
because	O
“	O
Barbara	O
”	O
has	O
a	O
rich	O
amount	O
of	O
repetitive	O
structures	O
,	O
which	O
can	O
be	O
effectively	O
exploited	O
by	O
nonlocal	Method
self	Method
-	Method
similarity	Method
based	Method
WNNM	Method
method	Method
.	O

The	O
visual	O
comparisons	O
of	O
different	O
methods	O
are	O
given	O
in	O
Fig	O
.	O

[	O
reference	O
]	O
.	O

Overall	O
,	O
FFDNet	Method
produces	O
the	O
best	O
perceptual	Metric
quality	Metric
of	O
denoised	Material
images	Material
.	O

To	O
evaluate	O
FFDNet	Method
-	Method
Clip	Method
,	O
Table	O
[	O
reference	O
]	O
shows	O
the	O
PSNR	Metric
comparison	O
with	O
DCGRF	Method
and	O
RBDN	Method
on	O
the	O
Clip300	Material
dataset	Material
.	O

It	O
can	O
be	O
seen	O
that	O
FFDNet	Method
-	Method
Clip	Method
with	O
matched	O
noise	O
level	O
achieves	O
better	O
performance	O
than	O
DCGRF	Method
and	O
RBDN	Method
,	O
showing	O
that	O
FFDNet	Method
performs	O
well	O
under	O
the	O
clipping	O
setting	O
.	O

We	O
also	O
tested	O
FFDNet	Method
-	Method
Clip	Method
on	O
BSD68	Material
dataset	Material
with	O
clipping	Material
setting	Material
,	O
it	O
has	O
been	O
found	O
that	O
the	O
PSNR	Metric
result	O
is	O
similar	O
to	O
that	O
of	O
FFDNet	Method
with	O
un	Method
-	Method
clipping	Method
setting	Method
.	O

For	O
color	O
image	Task
denoising	Task
,	O
we	O
compare	O
FFDNet	Method
with	O
CBM3D	Method
and	O
CDnCNN	Method
.	O

Table	O
[	O
reference	O
]	O
reports	O
the	O
performance	O
of	O
different	O
methods	O
on	O
CBSD68	Material
,	O
Kodak24	Material
,	Material
and	Material
McMaster	Material
datasets	Material
,	O
and	O
Fig	O
.	O

[	O
reference	O
]	O
presents	O
the	O
visual	O
comparisons	O
.	O

It	O
can	O
be	O
seen	O
that	O
FFDNet	Method
consistently	O
outperforms	O
CBM3D	Method
on	O
different	O
noise	O
levels	O
in	O
terms	O
of	O
both	O
quantitative	Metric
and	Metric
qualitative	Metric
evaluation	Metric
,	O
and	O
has	O
competing	O
performance	O
with	O
CDnCNN	Method
.	O

subsection	O
:	O
Experiments	O
on	O
Spatially	Task
Variant	Task
AWGN	Task
Removal	Task
We	O
then	O
test	O
the	O
flexibility	O
of	O
FFDNet	Method
to	O
deal	O
with	O
spatially	O
variant	O
AWGN	O
.	O

To	O
synthesize	O
spatially	O
variant	O
AWGN	O
,	O
we	O
first	O
generate	O
an	O
AWGN	Material
image	Material
with	O
unit	O
standard	O
deviation	O
and	O
a	O
noise	O
level	O
map	O
M	O
of	O
the	O
same	O
size	O
.	O

Then	O
,	O
element	Method
-	Method
wise	Method
multiplication	Method
is	O
applied	O
on	O
and	O
M	O
to	O
produce	O
the	O
spatially	O
variant	O
AWGN	O
,	O
i.e.	O
,	O
.	O

In	O
the	O
denoising	Task
stage	Task
,	O
we	O
take	O
the	O
bilinearly	O
downsampled	O
noise	O
level	O
map	O
as	O
the	O
input	O
to	O
FFDNet	Method
.	O

Since	O
the	O
noise	O
level	O
map	O
is	O
spatially	O
smooth	O
,	O
the	O
use	O
of	O
downsampled	O
noise	O
level	O
map	O
generally	O
has	O
very	O
little	O
effect	O
on	O
the	O
final	O
denoising	Task
performance	O
.	O

Fig	O
.	O

[	O
reference	O
]	O
gives	O
an	O
example	O
to	O
show	O
the	O
effectiveness	O
of	O
FFDNet	Method
on	O
removing	Task
spatially	Task
variant	Task
AWGN	Task
.	O

We	O
do	O
not	O
compare	O
FFDNet	Method
with	O
other	O
methods	O
because	O
no	O
state	O
-	O
of	O
-	O
the	O
-	O
art	O
AWGN	Method
denoising	Method
method	Method
can	O
be	O
readily	O
extended	O
to	O
handle	O
spatially	O
variant	O
AWGN	O
.	O

From	O
Fig	O
.	O

[	O
reference	O
]	O
,	O
one	O
can	O
see	O
that	O
FFDNet	Method
with	O
non	O
-	O
uniform	O
noise	O
level	O
map	O
is	O
flexible	O
and	O
powerful	O
to	O
remove	O
spatially	O
variant	O
AWGN	O
.	O

In	O
contrast	O
,	O
FFDNet	Method
with	O
uniform	O
noise	O
level	O
map	O
would	O
fail	O
to	O
remove	O
strong	O
noise	O
at	O
the	O
region	O
with	O
higher	O
noise	O
level	O
while	O
smoothing	O
out	O
the	O
details	O
at	O
the	O
region	O
with	O
lower	O
noise	O
level	O
.	O

subsection	O
:	O
Experiments	O
on	O
Noise	Metric
Level	Metric
Sensitivity	Metric
In	O
practical	O
applications	O
,	O
the	O
noise	O
level	O
map	O
may	O
not	O
be	O
accurately	O
estimated	O
from	O
the	O
noisy	O
observation	O
,	O
and	O
mismatch	O
between	O
the	O
input	O
and	O
real	O
noise	O
levels	O
is	O
inevitable	O
.	O

If	O
the	O
input	O
noise	O
level	O
is	O
lower	O
than	O
the	O
real	O
noise	O
level	O
,	O
the	O
noise	O
can	O
not	O
be	O
completely	O
removed	O
.	O

Therefore	O
,	O
users	O
often	O
prefer	O
to	O
set	O
a	O
higher	O
noise	O
level	O
to	O
remove	O
more	O
noise	O
.	O

However	O
,	O
this	O
may	O
also	O
remove	O
some	O
image	O
details	O
together	O
with	O
noise	O
.	O

A	O
practical	O
denoiser	Method
should	O
tolerate	O
certain	O
mismatch	O
of	O
noise	O
levels	O
.	O

In	O
this	O
subsection	O
,	O
we	O
evaluate	O
FFDNet	Method
in	O
comparison	O
with	O
benchmark	O
BM3D	Method
and	O
DnCNN	Method
by	O
varying	O
different	O
input	O
noise	O
levels	O
for	O
a	O
given	O
ground	O
-	O
truth	O
noise	O
level	O
.	O

Fig	O
.	O

[	O
reference	O
]	O
illustrates	O
the	O
noise	Metric
level	Metric
sensitivity	Metric
curves	Metric
of	O
BM3D	Method
,	O
DnCNN	Method
and	O
FFDNet	Method
.	O

Different	O
methods	O
with	O
different	O
input	O
noise	O
levels	O
(	O
e.g.	O
,	O
“	O
FFDNet	Method
-	O
15	O
”	O
represents	O
FFDNet	Method
with	O
input	O
noise	O
level	O
fixed	O
as	O
15	O
)	O
are	O
evaluated	O
on	O
BSD68	Material
images	Material
with	O
noise	O
level	O
ranging	O
from	O
0	O
to	O
50	O
.	O

Fig	O
.	O

[	O
reference	O
]	O
shows	O
the	O
visual	O
comparisons	O
between	O
BM3D	Method
/	Method
CBM3D	Method
and	O
FFDNet	Method
by	O
setting	O
different	O
input	O
noise	O
levels	O
to	O
denoise	O
a	O
noisy	Material
image	Material
.	O

Four	O
typical	O
image	O
structures	O
,	O
including	O
flat	O
region	O
,	O
sharp	O
edge	O
,	O
line	O
with	O
high	O
contrast	O
,	O
and	O
line	O
with	O
low	O
contrast	O
,	O
are	O
selected	O
for	O
visual	O
comparison	O
to	O
investigate	O
the	O
noise	Metric
level	Metric
sensitivity	Metric
of	O
BM3D	Method
and	O
FFDNet	Method
.	O

From	O
Figs	O
.	O

[	O
reference	O
]	O
and	O
[	O
reference	O
]	O
,	O
we	O
have	O
the	O
following	O
observations	O
.	O

On	O
all	O
noise	O
levels	O
,	O
FFDNet	Method
achieves	O
similar	O
denoising	Metric
results	O
to	O
BM3D	Method
and	O
DnCNN	Method
when	O
their	O
input	O
noise	O
levels	O
are	O
the	O
same	O
.	O

With	O
the	O
fixed	O
input	O
noise	O
level	O
,	O
for	O
all	O
the	O
three	O
methods	O
,	O
the	O
PSNR	Metric
value	O
tends	O
to	O
stay	O
the	O
same	O
when	O
the	O
ground	O
-	O
truth	O
noise	O
level	O
is	O
lower	O
,	O
and	O
begins	O
to	O
decrease	O
when	O
the	O
ground	O
-	O
truth	O
noise	O
level	O
is	O
higher	O
.	O

The	O
best	O
visual	Metric
quality	Metric
is	O
obtained	O
when	O
the	O
input	O
noise	O
level	O
matches	O
the	O
ground	O
-	O
truth	O
one	O
.	O

BM3D	Method
and	O
FFDNet	Method
produce	O
similar	O
visual	O
results	O
with	O
lower	O
input	O
noise	O
levels	O
,	O
while	O
they	O
exhibit	O
certain	O
difference	O
with	O
higher	O
input	O
noise	O
levels	O
.	O

Both	O
of	O
them	O
will	O
smooth	O
out	O
noise	O
in	O
flat	O
regions	O
,	O
and	O
gradually	O
smooth	O
out	O
image	O
structures	O
with	O
the	O
increase	O
of	O
input	O
noise	O
levels	O
.	O

Particularly	O
,	O
FFDNet	Method
may	O
wipe	O
out	O
some	O
low	O
contrast	O
line	O
structure	O
,	O
whereas	O
BM3D	Method
can	O
still	O
preserve	O
the	O
mean	O
patch	O
regardless	O
of	O
the	O
input	O
noise	O
levels	O
due	O
to	O
its	O
use	O
of	O
nonlocal	O
information	O
.	O

Using	O
a	O
higher	O
input	O
noise	O
level	O
can	O
generally	O
produce	O
better	O
visual	O
results	O
than	O
using	O
a	O
lower	O
one	O
.	O

In	O
addition	O
,	O
there	O
is	O
no	O
much	O
visual	O
difference	O
when	O
the	O
input	O
noise	O
level	O
is	O
a	O
little	O
higher	O
than	O
the	O
ground	O
-	O
truth	O
one	O
.	O

According	O
to	O
above	O
observations	O
,	O
FFDNet	Method
exhibits	O
similar	O
noise	Metric
level	Metric
sensitivity	Metric
performance	Metric
to	O
BM3D	Method
and	O
DnCNN	Method
in	O
balancing	Task
noise	Task
reduction	Task
and	O
detail	Task
preservation	Task
.	O

When	O
the	O
ground	O
-	O
truth	O
noise	O
level	O
is	O
unknown	O
,	O
it	O
is	O
more	O
preferable	O
to	O
set	O
a	O
larger	O
input	O
noise	O
level	O
than	O
a	O
lower	O
one	O
to	O
remove	O
noise	O
with	O
better	O
perceptual	Metric
quality	Metric
.	O

subsection	O
:	O
Experiments	O
on	O
Real	Material
Noisy	Material
Images	Material
In	O
this	O
subsection	O
,	O
real	Material
noisy	Material
images	Material
are	O
used	O
to	O
further	O
assess	O
the	O
practicability	O
of	O
FFDNet	Method
.	O

However	O
,	O
such	O
an	O
evaluation	O
is	O
difficult	O
to	O
conduct	O
due	O
to	O
the	O
following	O
reasons	O
.	O

(	O
i	O
)	O
Both	O
the	O
ground	Material
-	Material
truth	Material
clean	Material
image	Material
and	O
noise	Metric
level	Metric
are	O
unknown	O
for	O
real	Material
noisy	Material
image	Material
.	O

(	O
ii	O
)	O
The	O
real	O
noise	O
comes	O
from	O
various	O
sources	O
such	O
as	O
camera	Method
imaging	Method
pipeline	Method
(	O
e.g.	O
,	O
shot	O
noise	O
,	O
amplifier	O
noise	O
and	O
quantization	O
noise	O
)	O
,	O
scanning	Task
,	O
lossy	Task
compression	Task
and	O
image	Task
resizing	Task
,	O
and	O
it	O
is	O
generally	O
non	O
-	O
Gaussian	O
,	O
spatially	O
variant	O
,	O
and	O
signal	O
-	O
dependent	O
.	O

As	O
a	O
result	O
,	O
the	O
AWGN	O
assumption	O
in	O
many	O
denoising	Method
algorithms	Method
does	O
not	O
hold	O
,	O
and	O
the	O
associated	O
noise	Method
level	Method
estimation	Method
methods	Method
do	O
not	O
work	O
well	O
for	O
real	Material
noisy	Material
images	Material
.	O

Instead	O
of	O
adopting	O
any	O
noise	Method
level	Method
estimation	Method
methods	Method
,	O
we	O
adopt	O
an	O
interactive	Method
strategy	Method
to	O
handle	O
real	Material
noisy	Material
images	Material
.	O

First	O
of	O
all	O
,	O
we	O
empirically	O
found	O
that	O
the	O
assumption	O
of	O
spatially	O
invariant	O
noise	O
usually	O
works	O
well	O
for	O
most	O
real	Material
noisy	Material
images	Material
.	O

We	O
then	O
employ	O
a	O
set	O
of	O
typical	O
input	O
noise	O
levels	O
to	O
produce	O
multiple	O
outputs	O
,	O
and	O
select	O
the	O
one	O
which	O
has	O
best	O
trade	O
-	O
off	O
between	O
noise	Metric
reduction	Metric
and	O
detail	Task
preservation	Task
.	O

Second	O
,	O
the	O
spatially	O
variant	O
noise	O
in	O
most	O
real	Material
-	Material
world	Material
images	Material
is	O
signal	O
-	O
dependent	O
.	O

In	O
this	O
case	O
,	O
we	O
first	O
sample	O
several	O
typical	O
regions	O
of	O
distinct	O
colors	O
.	O

For	O
each	O
typical	O
region	O
,	O
we	O
apply	O
different	O
noise	O
levels	O
with	O
an	O
interval	O
of	O
5	O
,	O
and	O
choose	O
the	O
best	O
noise	O
level	O
by	O
observing	O
the	O
denoising	Task
results	O
.	O

The	O
noise	O
levels	O
at	O
other	O
regions	O
are	O
then	O
interpolated	O
from	O
the	O
noise	O
levels	O
of	O
the	O
typical	O
regions	O
to	O
constitute	O
an	O
approximated	O
non	Method
-	Method
uniform	Method
noise	Method
level	Method
map	Method
.	O

Our	O
FFDNet	Method
focuses	O
on	O
non	Task
-	Task
blind	Task
denoising	Task
and	O
assumes	O
the	O
noise	O
level	O
map	O
is	O
known	O
.	O

In	O
practice	O
,	O
some	O
advanced	O
noise	Method
level	Method
estimation	Method
methods	Method
can	O
be	O
adopted	O
to	O
assist	O
the	O
estimation	Task
of	Task
noise	Task
level	Task
map	Task
.	O

In	O
our	O
following	O
experiments	O
,	O
unless	O
otherwise	O
specified	O
,	O
we	O
assume	O
spatially	O
invariant	O
noise	O
for	O
the	O
real	Material
noisy	Material
images	Material
.	O

Since	O
there	O
is	O
no	O
ground	O
-	O
truth	O
image	O
for	O
a	O
real	O
noisy	Material
image	Material
,	O
visual	Task
comparison	Task
is	O
employed	O
to	O
evaluate	O
the	O
performance	O
of	O
FFDNet	Method
.	O

We	O
choose	O
BM3D	Method
for	O
comparison	O
because	O
it	O
is	O
widely	O
accepted	O
as	O
a	O
benchmark	O
for	O
denoising	Task
applications	Task
.	O

Given	O
a	O
noisy	Material
image	Material
,	O
the	O
same	O
input	O
noise	O
level	O
is	O
used	O
for	O
BM3D	Method
and	O
FFDNet	Method
.	O

Another	O
CNN	Method
-	Method
based	Method
denoising	Method
method	Method
DnCNN	Method
and	O
a	O
blind	Method
denoising	Method
method	Method
Noise	Method
Clinic	Method
are	O
also	O
used	O
for	O
comparison	O
.	O

Note	O
that	O
,	O
apart	O
from	O
the	O
non	Method
-	Method
blind	Method
DnCNN	Method
models	Method
for	O
specific	O
noise	O
levels	O
,	O
the	O
blind	Method
DnCNN	Method
model	Method
(	O
i.e.	O
,	O
DnCNN	Method
-	Method
B	Method
)	O
trained	O
on	O
noise	O
level	O
range	O
of	O
is	O
also	O
used	O
for	O
grayscale	O
image	Task
denoising	Task
.	O

For	O
color	O
image	Task
denoising	Task
,	O
the	O
blind	Method
CDnCNN	Method
-	Method
B	Method
is	O
used	O
for	O
comparison	O
.	O

Fig	O
.	O

[	O
reference	O
]	O
compares	O
the	O
grayscale	O
image	Task
denoising	Task
results	O
of	O
Noise	Method
Clinic	Method
,	O
BM3D	Method
,	O
DnCNN	Method
,	O
DnCNN	Method
-	Method
B	Method
and	O
FFDNet	Method
on	O
RNI6	Material
images	Material
.	O

As	O
one	O
can	O
see	O
,	O
Noise	O
Clinic	O
reduces	O
much	O
the	O
noise	O
,	O
but	O
it	O
also	O
generates	O
many	O
algorithm	O
-	O
induced	O
artifacts	O
.	O

BM3D	Method
,	O
DnCNN	Method
and	O
FFDNet	Method
produce	O
more	O
visually	O
pleasant	O
results	O
.	O

While	O
the	O
non	Method
-	Method
blind	Method
DnCNN	Method
models	Method
perform	O
favorably	O
,	O
the	O
blind	Method
DnCNN	Method
-	Method
B	Method
model	Method
performs	O
poorly	O
in	O
removing	O
the	O
non	O
-	O
AWGN	O
real	O
noise	O
.	O

This	O
phenomenon	O
clearly	O
demonstrates	O
the	O
better	O
generalization	Metric
ability	Metric
of	O
non	Method
-	Method
blind	Method
model	Method
over	O
blind	Method
one	Method
for	O
controlling	O
the	O
trade	O
-	O
off	O
between	O
noise	Task
removal	Task
and	O
detail	Task
preservation	Task
.	O

It	O
is	O
worth	O
noting	O
that	O
,	O
for	O
image	Task
“	Task
Building	Task
”	Task
which	O
contains	O
structured	Material
noise	Material
,	O
Noise	O
Clinic	O
and	O
BM3D	Method
fail	O
to	O
remove	O
those	O
structured	O
noises	O
since	O
the	O
structured	O
noises	O
fit	O
the	O
nonlocal	O
self	O
-	O
similarity	O
prior	O
adopted	O
in	O
Noise	O
Clinic	O
and	O
BM3D.	Method
In	O
contrast	O
,	O
FFDNet	Method
and	O
DnCNN	Method
successfully	O
remove	O
such	O
noise	O
without	O
losing	O
underlying	O
image	O
textures	O
.	O

Fig	O
.	O

[	O
reference	O
]	O
shows	O
the	O
denoising	Task
results	O
of	O
Noise	Metric
Clinic	Metric
,	O
CBM3D	Method
,	O
CDnCNN	Method
-	Method
B	Method
and	O
FFDNet	Method
on	O
five	O
color	Material
noisy	Material
images	Material
from	O
RNI15	Material
.	O

It	O
can	O
be	O
seen	O
that	O
CDnCNN	Method
-	Method
B	Method
yields	O
very	O
pleasing	O
results	O
for	O
noisy	Material
image	Material
with	O
AWGN	Material
-	Material
like	Material
noise	Material
such	O
as	O
image	O
“	O
Frog	O
”	O
,	O
and	O
is	O
still	O
unable	O
to	O
handle	O
non	O
-	O
AWGN	O
noise	O
.	O

Notably	O
,	O
from	O
the	O
denoising	Task
results	O
of	O
“	O
Boy	O
”	O
,	O
one	O
can	O
see	O
that	O
CBM3D	Method
remains	O
the	O
structured	O
color	O
noise	O
unremoved	O
whereas	O
FFDNet	Method
removes	O
successfully	O
such	O
kind	O
of	O
noise	O
.	O

We	O
can	O
conclude	O
that	O
while	O
the	O
nonlocal	O
self	O
-	O
similarity	O
prior	O
helps	O
to	O
remove	O
random	O
noise	O
,	O
it	O
hinders	O
the	O
removal	Task
of	Task
structured	Task
noise	Task
.	O

In	O
comparison	O
,	O
the	O
prior	O
implicitly	O
learned	O
by	O
CNN	Method
is	O
able	O
to	O
remove	O
both	O
random	O
noise	O
and	O
structured	O
noise	O
.	O

Fig	O
.	O

[	O
reference	O
]	O
further	O
shows	O
more	O
visual	O
results	O
of	O
FFDNet	Method
on	O
the	O
other	O
nine	O
images	O
from	O
RNI15	Material
.	O

It	O
can	O
be	O
seen	O
that	O
FFDNet	Method
can	O
handle	O
various	O
kinds	O
of	O
noises	O
,	O
such	O
as	O
JPEG	O
lossy	O
compression	O
noise	O
(	O
see	O
image	O
“	O
Audrey	O
Hepburn	O
”	O
)	O
,	O
and	O
video	Material
noise	Material
(	O
see	O
image	O
“	O
Movie	O
”	O
)	O
.	O

Fig	O
.	O

[	O
reference	O
]	O
shows	O
a	O
more	O
challenging	O
example	O
to	O
demonstrate	O
the	O
advantage	O
of	O
FFDNet	Method
for	O
denoising	Material
noisy	Material
images	Material
with	O
spatially	Material
variant	Material
noise	Material
.	O

We	O
select	O
five	O
typical	O
regions	O
to	O
estimate	O
the	O
noise	O
levels	O
,	O
including	O
two	O
background	O
regions	O
,	O
the	O
coffee	O
region	O
,	O
the	O
milk	O
-	O
foam	O
region	O
,	O
and	O
the	O
specular	O
reflection	O
region	O
.	O

In	O
our	O
experiment	O
,	O
we	O
manually	O
and	O
interactively	O
set	O
=	O
10	O
for	O
the	O
milk	O
-	O
foam	O
and	O
specular	O
reflection	O
regions	O
,	O
=	O
35	O
for	O
the	O
background	O
region	O
with	O
high	O
noise	O
(	O
i.e.	O
,	O
green	O
region	O
)	O
,	O
and	O
=	O
25	O
for	O
the	O
other	O
regions	O
.	O

We	O
then	O
interpolate	O
the	O
non	O
-	O
uniform	O
noise	O
level	O
map	O
for	O
the	O
whole	O
image	O
based	O
on	O
the	O
estimated	O
five	O
noise	O
levels	O
.	O

As	O
one	O
can	O
see	O
,	O
while	O
FFDNet	Method
with	O
a	O
small	O
uniform	O
input	O
noise	O
level	O
can	O
recover	O
the	O
details	O
of	O
regions	O
with	O
low	O
noise	O
level	O
,	O
it	O
fails	O
to	O
remove	O
strong	O
noise	O
.	O

On	O
the	O
other	O
hand	O
,	O
FFDNet	Method
with	O
a	O
large	O
uniform	O
input	O
noise	O
level	O
can	O
remove	O
strong	O
noise	O
but	O
it	O
will	O
also	O
smooth	O
out	O
the	O
details	O
in	O
the	O
region	O
with	O
low	O
noise	O
level	O
.	O

In	O
contrast	O
,	O
the	O
denoising	Method
result	O
with	O
a	O
proper	O
non	O
-	O
uniform	O
noise	O
level	O
map	O
not	O
only	O
preserves	O
image	O
details	O
but	O
also	O
removes	O
the	O
strong	O
noise	O
.	O

Finally	O
,	O
according	O
to	O
the	O
above	O
experiments	O
on	O
real	Material
noisy	Material
images	Material
,	O
we	O
can	O
see	O
that	O
the	O
FFDNet	Method
model	O
trained	O
with	O
un	Material
-	Material
quantized	Material
image	Material
data	Material
performs	O
well	O
on	O
8	Material
-	Material
bit	Material
quantized	Material
real	Material
noisy	Material
images	Material
.	O

subsection	O
:	O
Running	Metric
Time	Metric
Table	O
[	O
reference	O
]	O
lists	O
the	O
running	Metric
time	Metric
results	O
of	O
BM3D	Method
,	O
DnCNN	Method
and	O
FFDNet	Method
for	O
denoising	Material
grayscale	Material
and	Material
color	Material
images	Material
with	O
size	O
256	O
256	O
,	O
512	O
512	O
and	O
1	O
,	O
024	O
1	O
,	O
024	O
.	O

The	O
evaluation	O
was	O
performed	O
in	O
Matlab	O
(	O
R2015b	O
)	O
environment	O
on	O
a	O
computer	O
with	O
a	O
six	O
-	O
core	O
Intel	O
(	O
R	O
)	O
Core	Method
(	Method
TM	Method
)	O
i7	O
-	O
5820	O
K	O
CPU	Method
@	O
3.3GHz	O
,	O
32	O
GB	O
of	O
RAM	O
and	O
an	O
Nvidia	Method
Titan	Method
X	Method
Pascal	Method
GPU	Method
.	O

For	O
BM3D	Method
,	O
we	O
evaluate	O
its	O
running	Metric
time	Metric
by	O
denoising	Material
images	Material
with	O
noise	Material
level	Material
25	O
.	O

For	O
DnCNN	Method
,	O
the	O
grayscale	O
and	O
color	O
image	Task
denoising	Task
models	O
have	O
17	O
and	O
20	O
convolution	O
layers	O
,	O
respectively	O
.	O

The	O
Nvidia	Method
cuDNN	Method
-	Method
v5.1	Method
deep	Method
learning	Method
library	Method
is	O
used	O
to	O
accelerate	O
the	O
computation	Task
of	Task
DnCNN	Task
and	O
FFDNet	Method
.	O

The	O
memory	Metric
transfer	Metric
time	Metric
between	O
CPU	O
and	O
GPU	O
is	O
also	O
counted	O
.	O

Note	O
that	O
DnCNN	Method
and	O
FFDNet	Method
can	O
be	O
implemented	O
with	O
both	O
single	Method
-	Method
threaded	Method
(	O
ST	Method
)	O
and	O
multi	Method
-	Method
threaded	Method
(	O
MT	Method
)	O
CPU	O
computations	O
.	O

From	O
Table	O
[	O
reference	O
]	O
,	O
we	O
have	O
the	O
following	O
observations	O
.	O

First	O
,	O
BM3D	Method
spends	O
much	O
more	O
time	O
on	O
denoising	Material
color	Material
images	Material
than	O
grayscale	Material
images	Material
.	O

The	O
reason	O
is	O
that	O
,	O
compared	O
to	O
gray	Method
-	Method
BM3D	Method
,	O
CBM3D	Method
needs	O
extra	O
time	O
to	O
denoise	O
the	O
chrominance	O
components	O
after	O
luminance	O
-	O
chrominance	O
color	O
transformation	O
.	O

Second	O
,	O
while	O
DnCNN	Method
can	O
benefit	O
from	O
GPU	Method
computation	Method
for	O
fast	Task
implementation	Task
,	O
it	O
has	O
comparable	O
CPU	Metric
time	Metric
to	O
BM3D.	Method
Third	O
,	O
FFDNet	Method
spends	O
almost	O
the	O
same	O
time	O
for	O
processing	O
grayscale	Material
and	Material
color	Material
images	Material
.	O

More	O
specifically	O
,	O
FFDNet	Method
with	O
multi	Method
-	Method
threaded	Method
implementation	O
is	O
about	O
three	O
times	O
faster	O
than	O
DnCNN	Method
and	O
BM3D	Method
on	O
CPU	Method
,	O
and	O
much	O
faster	O
than	O
DnCNN	Method
on	O
GPU	Method
.	O

Even	O
with	O
single	Method
-	Method
threaded	Method
implementation	O
,	O
FFDNet	Method
is	O
also	O
faster	O
than	O
BM3D.	Method
Taking	O
denoising	Task
performance	O
and	O
flexibility	O
into	O
consideration	O
,	O
FFDNet	Method
is	O
very	O
competitive	O
for	O
practical	O
applications	O
.	O

section	O
:	O
Conclusion	O
In	O
this	O
paper	O
,	O
we	O
proposed	O
a	O
new	O
CNN	Method
model	Method
,	O
namely	O
FFDNet	Method
,	O
for	O
fast	O
,	O
effective	O
and	O
flexible	O
discriminative	Task
denoising	Task
.	O

To	O
achieve	O
this	O
goal	O
,	O
several	O
techniques	O
were	O
utilized	O
in	O
network	Method
design	Method
and	O
training	Task
,	O
such	O
as	O
the	O
use	O
of	O
noise	O
level	O
map	O
as	O
input	O
and	O
denoising	Task
in	O
downsampled	Task
sub	Task
-	Task
images	Task
space	Task
.	O

The	O
results	O
on	O
synthetic	Material
images	Material
with	O
AWGN	Material
demonstrated	O
that	O
FFDNet	Method
can	O
not	O
only	O
produce	O
state	O
-	O
of	O
-	O
the	O
-	O
art	O
results	O
when	O
input	O
noise	O
level	O
matches	O
ground	Metric
-	Metric
truth	Metric
noise	Metric
level	Metric
,	O
but	O
also	O
have	O
the	O
ability	O
to	O
robustly	O
control	O
the	O
trade	O
-	O
off	O
between	O
noise	Task
reduction	Task
and	O
detail	Task
preservation	Task
.	O

The	O
results	O
on	O
images	Material
with	O
spatially	O
variant	O
AWGN	O
validated	O
the	O
flexibility	O
of	O
FFDNet	Method
for	O
handing	Material
inhomogeneous	Material
noise	Material
.	O

The	O
results	O
on	O
real	Material
noisy	Material
images	Material
further	O
demonstrated	O
that	O
FFDNet	Method
can	O
deliver	O
perceptually	Task
appealing	Task
denoising	Task
results	O
.	O

Finally	O
,	O
the	O
running	Metric
time	Metric
comparisons	Metric
showed	O
the	O
faster	O
speed	O
of	O
FFDNet	Method
over	O
other	O
competing	O
methods	O
such	O
as	O
BM3D.	Method
Considering	O
its	O
flexibility	O
,	O
efficiency	O
and	O
effectiveness	O
,	O
FFDNet	Method
provides	O
a	O
practical	O
solution	O
to	O
CNN	Task
denoising	Task
applications	Task
.	O

bibliography	O
:	O
References	O
