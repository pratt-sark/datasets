Weakly	Method
Supervised	Method
Deep	Method
Detection	Method
Networks	Method
section	O
:	O
Abstract	O
Weakly	Task
supervised	Task
learning	Task
of	Task
object	Task
detection	Task
is	O
an	O
important	O
problem	O
in	O
image	Task
understanding	Task
that	O
still	O
does	O
not	O
have	O
a	O
satisfactory	O
solution	O
.	O

In	O
this	O
paper	O
,	O
we	O
address	O
this	O
problem	O
by	O
exploiting	O
the	O
power	O
of	O
deep	Method
convolutional	Method
neural	Method
networks	Method
pre	O
-	O
trained	O
on	O
large	Task
-	Task
scale	Task
image	Task
-	Task
level	Task
classification	Task
tasks	Task
.	O

We	O
propose	O
a	O
weakly	Method
supervised	Method
deep	Method
detection	Method
architecture	Method
that	O
modifies	O
one	O
such	O
network	O
to	O
operate	O
at	O
the	O
level	O
of	O
image	O
regions	O
,	O
performing	O
simultaneously	O
region	Task
selection	Task
and	O
classification	Task
.	O

Trained	O
as	O
an	O
image	Method
classifier	Method
,	O
the	O
architecture	O
implicitly	O
learns	O
object	Method
detectors	Method
that	O
are	O
better	O
than	O
alternative	O
weakly	Task
supervised	Task
detection	Task
systems	O
on	O
the	O
PASCAL	Material
VOC	Material
data	Material
.	O

The	O
model	O
,	O
which	O
is	O
a	O
simple	O
and	O
elegant	O
end	Method
-	Method
to	Method
-	Method
end	Method
architecture	Method
,	O
outperforms	O
standard	O
data	Method
augmentation	Method
and	O
fine	Method
-	Method
tuning	Method
techniques	Method
for	O
the	O
task	O
of	O
image	Task
-	Task
level	Task
classification	Task
as	O
well	O
.	O

section	O
:	O
Introduction	O
In	O
recent	O
years	O
,	O
Convolutional	Method
Neural	Method
Networks	Method
(	O
CNN	Method
)	O
[	O
reference	O
]	O
have	O
emerged	O
as	O
the	O
new	O
state	O
-	O
of	O
-	O
the	O
-	O
art	O
learning	Method
framework	Method
for	O
image	Task
recognition	Task
.	O

Key	O
to	O
their	O
success	O
is	O
the	O
ability	O
to	O
learn	O
from	O
large	O
quantities	O
of	O
labelled	O
data	O
the	O
complex	O
appearance	O
of	O
real	O
-	O
world	O
objects	O
.	O

One	O
of	O
the	O
most	O
striking	O
aspects	O
of	O
CNNs	Method
is	O
their	O
ability	O
to	O
learn	O
generic	O
visual	O
features	O
that	O
generalise	O
to	O
many	O
tasks	O
.	O

In	O
particular	O
,	O
CNNs	Method
pre	O
-	O
trained	O
on	O
datasets	O
such	O
as	O
ImageNet	Material
ILSVRC	Material
have	O
been	O
shown	O
to	O
obtain	O
excellent	O
results	O
in	O
recognition	Task
in	O
other	O
domains	O
[	O
reference	O
]	O
,	O
in	O
object	Task
detection	Task
[	O
reference	O
]	O
,	O
in	O
semantic	Task
segmentation	Task
[	O
reference	O
]	O
,	O
in	O
human	Task
pose	Task
estimation	Task
[	O
reference	O
]	O
,	O
and	O
in	O
many	O
other	O
tasks	O
.	O

In	O
this	O
paper	O
we	O
look	O
at	O
how	O
the	O
power	O
of	O
CNNs	Method
can	O
be	O
leveraged	O
in	O
weakly	Task
supervised	Task
detection	Task
(	O
WSD	Task
)	O
,	O
which	O
is	O
the	O
problem	O
of	O
learning	Task
object	Task
detectors	Task
using	O
only	O
imagelevel	O
labels	O
.	O

The	O
ability	O
of	O
learning	O
from	O
weak	O
annotations	O
is	O
very	O
important	O
for	O
two	O
reasons	O
:	O
first	O
,	O
image	Task
understanding	Task
aims	O
at	O
learning	O
an	O
growing	O
body	O
of	O
complex	O
visual	O
concepts	O
(	O
e.g.	O
hundred	O
thousands	O
object	O
categories	O
in	O
ImageNet	Material
)	O
.	O

Second	O
,	O
CNN	Method
training	Metric
is	O
data	O
-	O
hungry	O
.	O

Therefore	O
,	O
being	O
able	O
to	O
learn	O
complex	O
concepts	O
using	O
only	O
light	O
super	O
-	O
Figure	O
1	O
.	O

Weakly	Task
Supervised	Task
Deep	Task
Detection	Task
Network	Task
.	O

Our	O
method	O
starts	O
from	O
a	O
CNN	Method
pre	O
-	O
trained	O
for	O
image	Task
classification	Task
on	O
a	O
large	O
dataset	O
,	O
e.g.	O
ImageNet	Material
.	O

It	O
then	O
modifies	O
to	O
reason	O
efficiently	O
about	O
regions	O
,	O
branching	O
off	O
a	O
recognition	Task
and	O
a	O
detection	Task
data	Task
streams	Task
.	O

The	O
resulting	O
architecture	O
can	O
be	O
fine	O
-	O
tuned	O
on	O
a	O
target	O
dataset	O
to	O
achieve	O
state	O
-	O
of	O
-	O
the	O
-	O
art	O
weakly	Task
supervised	Task
object	Task
detection	Task
using	O
only	O
image	O
-	O
level	O
annotations	O
.	O

vision	Method
can	O
reduce	O
significantly	O
the	O
cost	O
of	O
data	Task
annotation	Task
in	O
tasks	O
such	O
as	O
image	Task
segmentation	Task
,	O
image	Task
captioning	Task
,	O
or	O
object	Task
detection	Task
.	O

We	O
are	O
motivated	O
in	O
our	O
research	O
by	O
the	O
hypothesis	O
that	O
,	O
since	O
pre	O
-	O
trained	O
CNNs	Method
generalise	O
so	O
well	O
to	O
a	O
large	O
number	O
of	O
tasks	O
,	O
they	O
should	O
contain	O
meaningful	O
representations	O
of	O
the	O
data	O
.	O

For	O
example	O
,	O
there	O
exists	O
evidence	O
that	O
CNNs	Method
trained	O
for	O
image	Task
classification	Task
learn	O
proxies	O
to	O
objects	O
and	O
objects	O
parts	O
[	O
reference	O
]	O
.	O

Remarkably	O
,	O
these	O
concepts	O
are	O
acquired	O
implicitly	O
,	O
without	O
ever	O
providing	O
the	O
network	O
with	O
information	O
about	O
the	O
location	O
of	O
such	O
structures	O
in	O
images	O
.	O

Hence	O
,	O
CNNs	Method
trained	O
for	O
image	Task
classification	Task
may	O
already	O
contain	O
implicitly	O
most	O
of	O
the	O
information	O
required	O
to	O
perform	O
object	Task
detection	Task
.	O

We	O
are	O
not	O
the	O
first	O
to	O
address	O
the	O
problem	O
of	O
WSD	Task
with	O
CNNs	Method
.	O

The	O
method	O
of	O
Wang	O
et	O
al	O
.	O

[	O
reference	O
]	O
,	O
for	O
example	O
,	O
uses	O
a	O
pre	O
-	O
trained	O
CNN	Method
to	O
describe	O
image	O
regions	O
and	O
then	O
learn	O
object	O
categories	O
as	O
corresponding	O
visual	O
topics	O
.	O

While	O
this	O
method	O
is	O
currently	O
state	O
-	O
of	O
-	O
the	O
-	O
art	O
in	O
weakly	Task
supervised	Task
object	Task
detection	Task
,	O
it	O
comprises	O
several	O
components	O
beyond	O
the	O
CNN	Method
and	O
requires	O
signifiant	O
tuning	O
.	O

In	O
this	O
paper	O
we	O
contribute	O
a	O
novel	O
end	Method
-	Method
to	Method
-	Method
end	Method
method	Method
for	O
weakly	Task
supervised	Task
object	Task
detection	Task
using	O
pre	O
-	O
trained	O
CNNs	Method
which	O
we	O
call	O
a	O
weakly	Method
supervised	Method
deep	Method
detection	Method
network	Method
(	O
WSDDN	Method
)	O
(	O
fig	O
.	O

1	O
)	O
.	O

Our	O
method	O
(	O
section	O
3	O
)	O
starts	O
from	O
an	O
existing	O
network	O
,	O
such	O
as	O
AlexNet	Method
pre	Method
-	O
trained	O
on	O
ImageNet	Material
data	Material
,	O
and	O
extends	O
it	O
to	O
reason	O
explicitly	O
and	O
efficiently	O
about	O
image	O
regions	O
R.	O
In	O
order	O
to	O
do	O
so	O
,	O
given	O
an	O
image	O
x	O
,	O
the	O
first	O
step	O
is	O
to	O
efficiently	O
extract	O
region	O
-	O
level	O
descriptors	O
φ	O
(	O
x	O
;	O
R	O
)	O
by	O
inserting	O
a	O
spatial	Method
pyramid	Method
pooling	Method
layer	Method
on	O
top	O
of	O
the	O
convolutional	Method
layers	Method
of	O
the	O
CNN	Method
[	O
reference	O
][	O
reference	O
]	O
.	O

Next	O
,	O
the	O
network	O
is	O
branched	O
to	O
extract	O
two	O
data	O
streams	O
from	O
the	O
pooled	O
region	O
-	O
level	O
features	O
.	O

The	O
first	O
stream	O
associates	O
a	O
class	O
score	O
φ	O
c	O
(	O
x	O
;	O
R	O
)	O
to	O
each	O
region	O
individually	O
,	O
performing	O
recognition	Task
.	O

The	O
second	O
stream	O
,	O
instead	O
,	O
compares	O
regions	O
by	O
computing	O
a	O
probability	O
distribution	O
φ	O
d	O
(	O
x	O
;	O
R	O
)	O
over	O
them	O
;	O
the	O
latter	O
represents	O
the	O
belief	O
that	O
,	O
among	O
all	O
the	O
candidate	O
regions	O
in	O
the	O
image	O
,	O
R	O
is	O
the	O
one	O
that	O
contains	O
the	O
most	O
salient	O
image	O
structure	O
,	O
and	O
is	O
therefore	O
a	O
proxy	O
to	O
detection	Task
.	O

The	O
recognition	Metric
and	Metric
detection	Metric
scores	Metric
computed	O
for	O
all	O
the	O
image	O
regions	O
are	O
finally	O
aggregated	O
in	O
order	O
to	O
predict	O
the	O
class	O
of	O
the	O
image	O
as	O
a	O
whole	O
,	O
which	O
is	O
then	O
used	O
to	O
inject	O
image	Task
-	Task
level	Task
supervision	Task
in	O
learning	Task
.	O

It	O
is	O
interesting	O
to	O
compare	O
our	O
method	O
to	O
the	O
most	O
common	O
weakly	Method
supervised	Method
object	Method
detection	Method
technique	Method
,	O
namely	O
multiple	Method
instance	Method
learning	Method
(	O
MIL	Method
)	O
[	O
reference	O
]	O
.	O

MIL	O
alternates	O
between	O
selecting	O
which	O
regions	O
in	O
images	O
look	O
like	O
the	O
object	O
of	O
interest	O
and	O
estimating	O
an	O
appearance	Method
model	Method
of	O
the	O
object	O
using	O
the	O
selected	O
regions	O
.	O

Hence	O
,	O
MIL	Method
uses	O
the	O
appearance	Method
model	Method
itself	O
to	O
perform	O
region	Task
selection	Task
.	O

Our	O
technique	O
differs	O
from	O
MIL	Method
in	O
a	O
fundamental	O
way	O
as	O
regions	O
are	O
selected	O
by	O
a	O
dedicated	O
parallel	Method
detection	Method
branch	Method
in	O
the	O
network	O
,	O
which	O
is	O
independent	O
of	O
the	O
recognition	O
branch	O
.	O

In	O
this	O
manner	O
,	O
our	O
approach	O
helps	O
avoiding	O
one	O
of	O
the	O
pitfalls	O
of	O
MIL	Task
,	O
namely	O
the	O
tendency	O
of	O
the	O
method	O
to	O
get	O
stuck	O
in	O
local	O
optima	O
.	O

Our	O
two	O
-	O
stream	O
CNN	Method
is	O
also	O
weakly	O
related	O
to	O
the	O
recent	O
work	O
of	O
Lin	O
et	O
al	O
.	O

[	O
reference	O
]	O
.	O

They	O
propose	O
a	O
"	O
bilinear	Method
"	Method
architecture	Method
where	O
the	O
output	O
of	O
two	O
parallel	Method
network	Method
streams	Method
are	O
combined	O
by	O
taking	O
the	O
outer	O
product	O
of	O
feature	O
vectors	O
at	O
corresponding	O
spatial	O
locations	O
.	O

The	O
authors	O
state	O
that	O
this	O
construction	O
is	O
inspired	O
by	O
the	O
ventral	Method
and	Method
dorsal	Method
streams	Method
of	Method
the	Method
human	Method
visual	Method
system	Method
,	O
one	O
focusing	O
on	O
recognition	Task
and	O
the	O
other	O
one	O
on	O
localisation	Task
.	O

While	O
our	O
architecture	O
contains	O
two	O
such	O
streams	O
,	O
the	O
similarity	O
is	O
only	O
superficial	O
.	O

A	O
key	O
difference	O
is	O
that	O
in	O
Lin	O
et	O
al	O
.	O

the	O
two	O
streams	O
are	O
perfectly	O
symmetric	O
,	O
and	O
therefore	O
there	O
is	O
no	O
reason	O
to	O
believe	O
that	O
one	O
should	O
perform	O
classification	Task
and	O
the	O
other	O
detection	Task
;	O
in	O
our	O
scheme	O
,	O
instead	O
,	O
the	O
detection	Method
branch	Method
is	O
explicitly	O
designed	O
to	O
compare	O
regions	O
,	O
breaking	O
the	O
symmetry	O
.	O

Note	O
also	O
that	O
Lin	O
et	O
al	O
.	O

[	O
reference	O
]	O
do	O
not	O
perform	O
WSD	Task
nor	O
evaluate	O
object	Task
detection	Task
performance	O
.	O

Once	O
the	O
modifications	O
have	O
been	O
applied	O
,	O
the	O
network	O
is	O
ready	O
to	O
be	O
fine	O
-	O
tuned	O
on	O
a	O
target	O
dataset	O
,	O
using	O
only	O
image	O
-	O
level	O
labels	O
,	O
region	Method
proposals	Method
and	O
back	Method
-	Method
propagation	Method
.	O

In	O
section	O
4	O
we	O
show	O
that	O
,	O
when	O
fine	O
-	O
tuned	O
on	O
the	O
PASCAL	Material
VOC	Material
training	Material
set	O
,	O
this	O
architecture	O
achieves	O
state	O
-	O
of	O
-	O
the	O
-	O
art	O
weakly	Task
supervised	Task
object	Task
detection	Task
on	O
the	O
PASCAL	Material
data	Material
,	O
achieving	O
superior	O
results	O
to	O
the	O
current	O
state	O
-	O
of	O
-	O
the	O
-	O
art	O
[	O
reference	O
]	O
but	O
using	O
only	O
CNN	Method
machinery	O
.	O

Since	O
the	O
system	O
can	O
be	O
trained	O
end	O
-	O
to	O
-	O
end	O
using	O
standard	O
CNN	Method
packages	O
,	O
it	O
is	O
also	O
as	O
efficient	O
as	O
the	O
recent	O
fully	O
-	O
supervised	O
Fast	O
R	O
-	O
CNN	Method
detector	O
of	O
Girshick	O
et	O
al	O
.	O

[	O
reference	O
]	O
,	O
both	O
in	O
training	Metric
and	O
in	O
testing	Task
.	O

Finally	O
,	O
as	O
a	O
byproduct	O
of	O
our	O
construction	O
we	O
also	O
obtain	O
a	O
powerful	O
image	Method
classifier	Method
that	O
performs	O
better	O
than	O
standard	O
fine	Method
-	Method
tuning	Method
techniques	Method
on	O
the	O
target	O
data	O
.	O

Our	O
findings	O
are	O
summarised	O
in	O
section	O
5	O
.	O

section	O
:	O
Related	O
Work	O
The	O
majority	O
of	O
existing	O
approaches	O
to	O
WSD	Task
formulate	O
this	O
task	O
as	O
MIL	Task
.	O

In	O
this	O
formulation	O
an	O
image	O
is	O
interpreted	O
as	O
a	O
bag	O
of	O
regions	O
.	O

If	O
the	O
image	O
is	O
labeled	O
as	O
positive	O
,	O
then	O
one	O
of	O
the	O
regions	O
is	O
assume	O
to	O
tightly	O
contain	O
the	O
object	O
of	O
interest	O
.	O

If	O
the	O
image	O
is	O
labeled	O
as	O
negative	O
,	O
then	O
no	O
region	O
contains	O
the	O
object	O
.	O

Learning	Method
alternates	O
between	O
estimating	O
a	O
model	O
of	O
the	O
object	O
appearance	O
and	O
selecting	O
which	O
regions	O
in	O
the	O
positive	O
bags	O
correspond	O
to	O
the	O
object	O
using	O
the	O
appearance	Method
model	Method
.	O

The	O
MIL	Method
strategy	Method
results	O
in	O
a	O
non	Task
-	Task
convex	Task
optimization	Task
problem	Task
;	O
in	O
practice	O
,	O
solvers	O
tend	O
to	O
get	O
stuck	O
in	O
local	O
optima	O
such	O
that	O
the	O
quality	O
of	O
the	O
solution	O
strongly	O
depends	O
on	O
the	O
initialization	O
.	O

Several	O
papers	O
have	O
focused	O
on	O
developing	O
various	O
initialization	Method
strategies	Method
[	O
reference	O
][	O
reference	O
][	O
reference	O
][	O
reference	O
]	O
and	O
on	O
regularizing	O
the	O
optimization	Task
problem	Task
[	O
reference	O
][	O
reference	O
]	O
.	O

Kumar	O
et	O
al	O
.	O

[	O
reference	O
]	O
propose	O
a	O
self	Method
-	Method
paced	Method
learning	Method
strategy	Method
that	O
progressively	O
includes	O
harder	O
samples	O
to	O
a	O
small	O
set	O
of	O
initial	O
ones	O
at	O
training	Metric
.	O

Deselaers	O
et	O
al	O
.	O

[	O
reference	O
]	O
initialize	O
object	O
locations	O
based	O
on	O
the	O
objectness	Metric
score	Metric
.	O

Cinbis	O
et	O
al	O
.	O

[	O
reference	O
]	O
propose	O
a	O
multi	Method
-	Method
fold	Method
split	Method
of	O
the	O
training	Metric
data	O
to	O
escape	O
local	O
optima	O
.	O

Song	O
et	O
al	O
.	O

[	O
reference	O
]	O
apply	O
Nesterov	Method
's	Method
smoothing	Method
technique	Method
[	O
reference	O
]	O
to	O
the	O
latent	Method
SVM	Method
formulation	Method
[	O
reference	O
]	O
to	O
be	O
more	O
robust	O
against	O
poor	O
initializations	O
.	O

Bilen	O
et	O
al	O
.	O

[	O
reference	O
]	O
propose	O
a	O
smoothed	Method
version	Method
of	O
MIL	Method
that	O
softly	O
labels	O
object	O
instances	O
instead	O
of	O
choosing	O
the	O
highest	O
scoring	O
ones	O
.	O

Additionally	O
,	O
their	O
method	O
regularizes	O
the	O
latent	O
object	O
locations	O
by	O
penalizing	O
unlikely	O
configurations	O
based	O
on	O
symmetry	Method
and	Method
mutual	Method
exclusion	Method
principles	Method
.	O

Another	O
line	O
of	O
research	O
in	O
WSD	Task
[	O
reference	O
][	O
reference	O
][	O
reference	O
]	O
is	O
based	O
on	O
the	O
idea	O
of	O
identifying	O
the	O
similarity	O
between	O
image	O
parts	O
.	O

Song	O
et	O
al	O
.	O

[	O
reference	O
]	O
propose	O
a	O
discriminative	Method
graph	Method
-	Method
based	Method
algorithm	Method
that	O
selects	O
a	O
subset	O
of	O
windows	O
such	O
that	O
each	O
window	O
is	O
connected	O
to	O
its	O
nearest	O
neighbors	O
in	O
positive	O
images	O
.	O

In	O
[	O
reference	O
]	O
,	O
the	O
same	O
authors	O
extend	O
this	O
method	O
to	O
discover	O
multiple	O
co	O
-	O
occurring	O
part	O
configurations	O
.	O

Wang	O
et	O
al	O
.	O

[	O
reference	O
]	O
propose	O
an	O
iterative	Method
technique	Method
that	O
applies	O
a	O
latent	Method
semantic	Method
clustering	Method
via	O
latent	Method
Semantic	Method
Analysis	Method
(	O
pLSA	Method
)	O
on	O
the	O
windows	O
of	O
positive	O
samples	O
and	O
selects	O
the	O
most	O
discriminative	O
cluster	O
for	O
each	O
class	O
based	O
on	O
its	O
classification	Task
performance	O
.	O

Bilen	O
et	O
al	O
.	O

[	O
reference	O
]	O
propose	O
a	O
formulation	O
that	O
jointly	O
learns	O
a	O
discriminative	Method
model	Method
and	O
enforces	O
the	O
similarity	O
of	O
the	O
selected	O
object	O
regions	O
via	O
a	O
discriminative	Method
convex	Method
clustering	Method
algorithm	Method
.	O

Recently	O
a	O
number	O
of	O
researchers	O
[	O
reference	O
][	O
reference	O
]	O
have	O
proposed	O
weakly	Method
supervised	Method
localization	Method
principles	Method
to	O
improve	O
classification	Task
performance	O
of	O
CNNs	Method
without	O
providing	O
any	O
annotation	O
for	O
the	O
location	O
of	O
objects	O
in	O
images	O
.	O

Oquab	O
et	O
al	O
.	O

[	O
23	O
]	O
employ	O
a	O
pre	O
-	O
trained	O
CNN	Method
to	O
compute	O
a	O
mid	Method
-	Method
level	Method
image	Method
representation	Method
for	O
images	Material
of	Material
PASCAL	Material
VOC	Material
.	O

In	O
their	O
follow	O
-	O
up	O
work	O
,	O
Oquab	O
et	O
al	O
.	O

[	O
reference	O
]	O
modify	O
a	O
CNN	Method
architecture	O
to	O
coarsely	O
localize	O
object	O
instances	O
in	O
image	O
while	O
predicting	O
its	O
label	O
.	O

Jaderberg	O
et	O
al	O
.	O

[	O
reference	O
]	O
proposed	O
a	O
CNN	Method
architecture	O
in	O
which	O
a	O
subnetwork	O
automatically	O
pre	O
-	O
transforms	O
an	O
image	O
in	O
order	O
to	O
optimize	O
the	O
classification	Metric
accuracy	Metric
of	O
a	O
second	O
subnetwork	O
.	O

This	O
"	O
transformer	Method
network	Method
"	O
,	O
which	O
is	O
trained	O
in	O
an	O
end	O
-	O
to	O
-	O
end	O
fashion	O
from	O
image	O
-	O
level	O
labels	O
,	O
is	O
shown	O
to	O
align	O
objects	O
to	O
a	O
common	O
reference	O
frame	O
,	O
which	O
is	O
a	O
proxy	O
to	O
detection	Task
.	O

Our	O
architecture	O
contains	O
a	O
mechanism	O
that	O
pre	O
-	O
select	O
image	O
regions	O
that	O
are	O
likely	O
to	O
contain	O
the	O
object	O
,	O
also	O
trained	O
in	O
an	O
end	O
-	O
to	O
-	O
end	O
fashion	O
;	O
while	O
this	O
may	O
seem	O
very	O
different	O
,	O
this	O
mechanism	O
can	O
also	O
be	O
thought	O
as	O
learning	O
transformations	O
(	O
as	O
the	O
ones	O
that	O
map	O
the	O
detected	O
regions	O
to	O
a	O
canonical	O
reference	O
frame	O
)	O
.	O

However	O
,	O
the	O
nature	O
of	O
the	O
selection	Method
process	Method
in	O
in	O
our	O
and	O
their	O
networks	O
are	O
very	O
different	O
.	O

section	O
:	O
Method	O
In	O
this	O
section	O
we	O
introduce	O
our	O
weakly	Method
supervised	Method
deep	Method
detection	Method
network	Method
(	O
WSDDN	Method
)	O
method	O
.	O

The	O
overall	O
idea	O
consists	O
of	O
three	O
steps	O
.	O

First	O
,	O
we	O
obtain	O
a	O
CNN	Method
pre	O
-	O
trained	O
on	O
a	O
large	Task
-	Task
scale	Task
image	Task
classification	Task
task	Task
(	O
section	O
3.1	O
)	O
.	O

Second	O
,	O
we	O
construct	O
the	O
WSDDN	Method
as	O
an	O
architectural	Method
modification	Method
of	O
this	O
CNN	Method
(	O
section	O
3.2	O
)	O
.	O

Third	O
,	O
we	O
train	O
/	O
fine	O
-	O
tune	O
the	O
WS	Method
-	Method
DDN	Method
on	O
a	O
target	O
dataset	O
,	O
once	O
more	O
using	O
only	O
image	O
-	O
level	O
annotations	O
(	O
section	O
3.3	O
)	O
.	O

The	O
remainder	O
of	O
this	O
section	O
discusses	O
these	O
three	O
steps	O
in	O
detail	O
.	O

section	O
:	O
Pre	Method
-	Method
trained	Method
network	Method
We	O
build	O
our	O
method	O
on	O
a	O
pre	O
-	O
trained	O
CNN	Method
that	O
has	O
been	O
pre	O
-	O
trained	O
on	O
the	O
ImageNet	Material
ILSVRC	Material
2012	Material
data	Material
[	O
reference	O
]	O
with	O
only	O
image	O
-	O
level	O
supervision	O
(	O
i.e.	O
no	O
bounding	O
box	O
annotations	O
)	O
.	O

We	O
give	O
the	O
details	O
of	O
the	O
used	O
CNN	Method
architectures	O
in	O
section	O
4	O
.	O

section	O
:	O
Weakly	Method
supervised	Method
deep	Method
detection	Method
network	Method
Given	O
the	O
pre	O
-	O
trained	O
CNN	Method
,	O
we	O
transform	O
it	O
into	O
a	O
WS	Method
-	Method
DDN	Method
by	O
introducing	O
three	O
modifications	O
(	O
see	O
also	O
section	O
3	O
)	O
.	O

First	O
,	O
we	O
replace	O
the	O
last	O
pooling	O
layer	O
immediately	O
following	O
the	O
ReLU	Method
layer	Method
in	O
the	O
last	O
convolutional	O
block	O
(	O
also	O
known	O
as	O
relu5	O
and	O
pool5	O
,	O
respectively	O
)	O
with	O
a	O
layer	O
implementing	O
spatial	Method
pyramid	Method
pooling	Method
(	O
SPP	Method
)	O
[	O
reference	O
][	O
reference	O
]	O
.	O

This	O
results	O
in	O
a	O
function	O
that	O
takes	O
as	O
input	O
an	O
image	O
x	O
and	O
a	O
region	O
(	O
bounding	O
box	O
)	O
R	O
and	O
produces	O
as	O
output	O
a	O
feature	O
vector	O
or	O
representation	O
φ	O
(	O
x	O
;	O
R	O
)	O
.	O

Importantly	O
,	O
the	O
function	O
decomposes	O
as	O
where	O
φ	O
relu5	O
(	O
x	O
)	O
needs	O
to	O
be	O
computed	O
only	O
once	O
for	O
the	O
whole	O
image	O
and	O
φ	O
SPP	O
(	O
·	O
;	O
R	O
)	O
is	O
fast	O
to	O
compute	O
for	O
any	O
given	O
region	O
R.	O
In	O
practice	O
,	O
SPP	Method
is	O
configured	O
to	O
be	O
compatible	O
to	O
the	O
first	O
fully	Method
connected	Method
layers	Method
of	Method
networks	Method
(	O
i.e.	O
fc6	O
)	O
.	O

Note	O
that	O
SPP	Method
is	O
implemented	O
as	O
a	O
network	Method
layer	Method
as	O
in	O
[	O
reference	O
]	O
to	O
allow	O
to	O
train	O
the	O
system	O
end	O
-	O
to	O
-	O
end	O
(	O
and	O
for	O
efficiency	O
)	O
.	O

Given	O
an	O
image	O
x	O
,	O
a	O
shortlist	O
of	O
candidate	O
object	O
regions	O
R	O
=	O
(	O
R	O
1	O
,	O
.	O

.	O

.	O

,	O
R	O
n	O
)	O
are	O
obtained	O
by	O
a	O
region	Method
proposal	Method
mechanism	Method
.	O

Here	O
we	O
experiment	O
with	O
two	O
methods	O
,	O
Selective	Method
Search	Method
Windows	Method
(	O
SSW	Method
)	O
[	O
reference	O
]	O
and	O
Edge	O
Boxes	O
(	O
EB	Method
)	O
[	O
reference	O
]	O
.	O

As	O
in	O
[	O
reference	O
]	O
,	O
we	O
then	O
modify	O
the	O
SPP	Method
layer	Method
to	O
take	O
as	O
input	O
not	O
a	O
single	O
region	O
,	O
but	O
rather	O
the	O
full	O
list	O
R	O
;	O
in	O
particular	O
,	O
φ	O
(	O
x	O
;	O
R	O
)	O
is	O
defined	O
as	O
the	O
concatenation	O
of	O
φ	O
(	O
x	O
;	O
R	O
1	O
)	O
,	O
.	O

.	O

.	O

,	O
φ	O
(	O
x	O
;	O
R	O
n	O
)	O
along	O
the	O
fourth	O
dimension	O
(	O
since	O
each	O
individual	O
φ	O
(	O
x	O
;	O
R	O
)	O
is	O
a	O
3D	O
tensor	O
)	O
.	O

At	O
this	O
point	O
in	O
the	O
architecture	O
,	O
region	O
-	O
level	O
features	O
are	O
further	O
processed	O
by	O
two	O
fully	Method
connected	Method
layers	Method
φ	Method
fc6	Method
and	O
φ	Method
fc7	Method
,	O
each	O
comprising	O
a	O
linear	Method
map	Method
followed	O
by	O
a	O
ReLU	Method
.	O

Out	O
of	O
the	O
output	O
of	O
the	O
last	O
such	O
layer	O
,	O
we	O
branch	O
off	O
two	O
data	O
streams	O
,	O
described	O
next	O
.	O

Classification	O
data	O
stream	O
.	O

The	O
first	O
data	O
stream	O
performs	O
classification	Task
of	O
the	O
individual	O
regions	O
,	O
by	O
mapping	O
each	O
of	O
them	O
to	O
a	O
C	O
-	O
dimensional	O
vector	O
of	O
class	O
scores	O
,	O
assuming	O
that	O
the	O
system	O
is	O
trained	O
to	O
detect	O
C	O
different	O
classes	O
.	O

This	O
is	O
achieved	O
by	O
evaluating	O
a	O
linear	Method
map	Method
φ	Method
f	Method
c8c	Method
and	O
results	O
in	O
a	O
matrix	O
of	O
data	O
x	O
c	O
∈	O
R	O
C×|R|	O
,	O
containing	O
the	O
class	O
prediction	O
scores	O
for	O
each	O
region	O
.	O

The	O
latter	O
is	O
then	O
passed	O
through	O
a	O
softmax	Method
operator	Method
,	O
defined	O
as	O
follows	O
:	O
Detection	O
data	O
stream	O
.	O

The	O
second	O
data	O
stream	O
performs	O
instead	O
detection	Task
,	O
by	O
scoring	O
regions	O
relative	O
to	O
one	O
another	O
.	O

This	O
is	O
done	O
on	O
a	O
class	O
-	O
specific	O
basis	O
by	O
using	O
a	O
second	O
linear	Method
map	Method
φ	Method
f	Method
c8d	Method
,	O
also	O
resulting	O
in	O
a	O
matrix	O
of	O
scores	O
It	O
is	O
then	O
passed	O
through	O
another	O
softmax	Method
operator	Method
,	O
but	O
this	O
time	O
defined	O
as	O
follows	O
:	O
While	O
the	O
two	O
streams	O
are	O
remarkably	O
similar	O
,	O
the	O
introduction	O
of	O
the	O
σ	O
class	O
and	O
σ	O
det	O
non	O
-	O
linearities	O
in	O
the	O
classification	Task
and	Task
detection	Task
streams	Task
is	O
a	O
key	O
difference	O
which	O
allows	O
Figure	O
2	O
.	O

Weakly	Method
-	Method
supervised	Method
deep	Method
detection	Method
network	Method
.	O

The	O
figure	O
illustrates	O
the	O
architecture	O
of	O
WSDDN	Method
.	O

to	O
interpret	O
them	O
as	O
performing	O
classification	Task
and	O
detection	Task
,	O
respectively	O
.	O

In	O
the	O
first	O
case	O
,	O
in	O
fact	O
,	O
the	O
softmax	Method
operator	Method
compares	O
,	O
for	O
each	O
region	O
independently	O
,	O
class	O
scores	O
,	O
whereas	O
in	O
the	O
second	O
case	O
the	O
softmax	Method
operator	Method
compares	O
,	O
for	O
each	O
class	O
independently	O
,	O
the	O
scores	O
of	O
different	O
regions	O
.	O

Hence	O
,	O
the	O
first	O
branch	O
predicts	O
which	O
class	O
to	O
associate	O
to	O
a	O
region	O
,	O
whereas	O
the	O
second	O
branch	O
selects	O
which	O
regions	O
are	O
more	O
likely	O
to	O
contain	O
an	O
informative	O
image	O
fragment	O
.	O

Combined	O
region	Metric
scores	Metric
and	O
detection	Task
.	O

The	O
final	O
score	O
of	O
each	O
region	O
is	O
obtained	O
by	O
taking	O
the	O
element	O
-	O
wise	O
(	O
Hadamard	O
)	O
product	O
of	O
the	O
two	O
scoring	O
matrices	O
.	O

The	O
region	O
scores	O
are	O
then	O
used	O
to	O
rank	O
image	O
regions	O
by	O
likelihood	O
of	O
centring	O
an	O
object	O
(	O
for	O
each	O
class	O
independently	O
)	O
;	O
standard	O
non	Method
-	Method
maxima	Method
suppression	Method
is	O
then	O
performed	O
(	O
by	O
iteratively	O
removing	O
regions	O
with	O
Intersection	O
over	O
Union	O
(	O
IoU	O
)	O
larger	O
than	O
40	O
%	O
with	O
regions	O
already	O
selected	O
)	O
to	O
obtain	O
the	O
final	O
list	O
of	O
class	O
-	O
specific	O
detections	O
in	O
an	O
image	O
.	O

The	O
way	O
the	O
two	O
streams	O
'	O
scores	O
are	O
combined	O
is	O
reminiscent	O
of	O
the	O
bilinear	Method
networks	Method
of	O
[	O
reference	O
]	O
,	O
but	O
there	O
are	O
three	O
key	O
differences	O
.	O

The	O
first	O
difference	O
is	O
that	O
the	O
introduction	O
of	O
the	O
different	O
softmax	O
operators	O
explicitly	O
breaks	O
the	O
symmetry	O
of	O
the	O
two	O
streams	O
.	O

The	O
second	O
one	O
is	O
that	O
,	O
instead	O
of	O
computing	O
the	O
outer	O
product	O
of	O
the	O
two	O
feature	O
vectors	O
σ	O
class	O
(	O
x	O
are	O
computed	O
for	O
specific	O
image	O
regions	O
r	O
rather	O
than	O
a	O
fixed	O
set	O
of	O
image	O
locations	O
on	O
a	O
grid	O
.	O

Together	O
,	O
these	O
three	O
differences	O
mean	O
that	O
we	O
can	O
interpret	O
σ	O
det	O
(	O
x	O
d	O
)	O
as	O
a	O
term	O
that	O
ranks	O
regions	O
,	O
whereas	O
σ	O
class	O
(	O
x	O
c	O
)	O
ranks	O
classes	O
.	O

It	O
is	O
more	O
difficult	O
to	O
clearly	O
assess	O
the	O
nature	O
of	O
the	O
two	O
streams	O
in	O
[	O
reference	O
]	O
.	O

Image	Metric
-	Metric
level	Metric
classification	Metric
scores	Metric
.	O

So	O
far	O
,	O
WSDDN	Method
has	O
computed	O
region	O
-	O
level	O
scores	O
x	O
R	O
.	O

This	O
is	O
transformed	O
in	O
an	O
image	Metric
-	Metric
level	Metric
class	Metric
prediction	Metric
score	Metric
by	O
summation	O
over	O
regions	O
:	O
Note	O
that	O
both	O
y	Method
c	Method
is	O
a	O
sum	O
of	O
element	Method
-	Method
wise	Method
product	Method
of	Method
softmax	Method
normalised	Method
scores	Method
over	O
|R|	O
regions	O
and	O
thus	O
it	O
is	O
in	O
the	O
range	O
of	O
(	O
0	O
,	O
1	O
)	O
.	O

Softmax	Method
is	O
not	O
performed	O
at	O
this	O
stage	O
as	O
images	O
are	O
allowed	O
to	O
contain	O
more	O
than	O
one	O
object	O
class	O
(	O
whereas	O
regions	O
should	O
contain	O
a	O
single	O
class	O
)	O
.	O

section	O
:	O
Training	O
WSDDN	Method
Having	O
discussed	O
the	O
WSDDN	Method
architecture	O
in	O
the	O
previous	O
section	O
,	O
here	O
we	O
explain	O
how	O
the	O
model	O
is	O
trained	O
.	O

The	O
data	O
is	O
a	O
collection	O
of	O
images	O
x	O
i	O
,	O
i	O
=	O
1	O
,	O
.	O

.	O

.	O

,	O
n	O
with	O
image	O
level	O
labels	O
y	O
i	O
∈	O
{	O
−1	O
,	O
1	O
}	O
C	O
.	O

We	O
denote	O
by	O
φ	O
y	O
(	O
x|w	O
)	O
the	O
complete	O
architecture	O
,	O
mapping	O
an	O
image	O
x	O
to	O
a	O
vector	O
of	O
class	O
scores	O
y	O
∈	O
R	O
C	O
.	O

The	O
parameters	O
w	O
of	O
the	O
model	O
lump	O
together	O
the	O
coefficients	O
of	O
all	O
the	O
filters	O
and	O
biases	O
in	O
the	O
convolutional	Method
and	Method
fully	Method
-	Method
connected	Method
layers	Method
.	O

Then	O
,	O
stochastic	Method
gradient	Method
descent	Method
with	O
momentum	Method
is	O
used	O
to	O
optimise	O
the	O
energy	O
function	O
hence	O
optimising	O
a	O
sum	O
of	O
C	O
binary	O
-	O
log	O
-	O
loss	O
terms	O
,	O
one	O
per	O
class	O
.	O

As	O
φ	O
y	O
k	O
(	O
x	O
i	O
|w	O
)	O
is	O
in	O
range	O
of	O
(	O
0	O
,	O
1	O
)	O
,	O
it	O
can	O
be	O
considered	O
as	O
a	O
probability	O
of	O
class	O
k	O
being	O
present	O
in	O
image	O
x	O
i	O
,	O
i.e.	O
p	O
(	O
y	O
ki	O
=	O
1	O
)	O
.	O

When	O
the	O
ground	O
-	O
truth	O
label	O
is	O
positive	O
,	O
the	O
binary	O
log	O
loss	O
becomes	O
log	O
(	O
p	O
(	O
y	O
ki	O
=	O
1	O
)	O
)	O
,	O
log	O
(	O
1	O
−	O
p	O
(	O
y	O
ki	O
=	O
1	O
)	O
)	O
otherwise	O
.	O

section	O
:	O
Spatial	Method
Regulariser	Method
As	O
WSDDN	Method
is	O
optimised	O
for	O
image	Task
-	Task
level	Task
class	Task
labels	Task
,	O
it	O
does	O
not	O
guarantee	O
any	O
spatial	O
smoothness	O
such	O
that	O
if	O
a	O
region	O
obtains	O
a	O
high	O
score	O
for	O
an	O
object	O
class	O
,	O
the	O
neighbouring	O
regions	O
with	O
high	O
overlap	O
will	O
also	O
have	O
high	O
scores	O
.	O

In	O
the	O
supervised	Task
detection	Task
case	Task
,	O
Fast	Method
-	Method
RCNN	Method
[	O
reference	O
]	O
takes	O
the	O
region	O
proposals	O
that	O
have	O
at	O
least	O
50	O
%	O
IoU	O
with	O
a	O
ground	O
truth	O
box	O
as	O
positive	O
samples	O
and	O
learns	O
to	O
regress	O
them	O
into	O
their	O
corresponding	O
ground	O
truth	O
bounding	O
box	O
.	O

As	O
our	O
method	O
does	O
not	O
have	O
access	O
to	O
ground	O
truth	O
boxes	O
,	O
we	O
follow	O
a	O
soft	Method
regularisation	Method
strategy	Method
that	O
penalises	O
the	O
feature	O
map	O
discrepancies	O
at	O
the	O
second	O
fully	Method
connected	Method
layer	Method
fc7	Method
between	O
the	O
highest	O
scoring	O
region	O
and	O
the	O
regions	O
with	O
at	O
least	O
60	O
%	O
IoU	O
(	O
i.e.	O
r	O
∈	O
|R|	O
)	O
during	O
training	Metric
:	O
where	O
N	O
+	O
k	O
is	O
the	O
number	O
of	O
positive	O
images	O
for	O
the	O
class	O
k	O
and	O
*	O
=	O
arg	O
max	O
r	O
φ	O
y	O
kri	O
is	O
the	O
highest	O
scoring	O
region	O
in	O
image	O
i	O
for	O
the	O
class	O
k.	O
We	O
add	O
this	O
regularisation	Method
term	Method
to	O
the	O
cost	O
function	O
in	O
eq	O
.	O

(	O
3	O
)	O
.	O

section	O
:	O
Experiments	O
In	O
this	O
section	O
we	O
conduct	O
a	O
thorough	O
investigation	O
of	O
WSDDN	Method
and	O
its	O
components	O
on	O
weakly	Task
supervised	Task
detection	Task
and	O
image	Task
classification	Task
.	O

section	O
:	O
Benchmark	O
data	O
.	O

We	O
evaluate	O
our	O
method	O
on	O
the	O
PASCAL	Material
VOC	Material
2007	Material
and	O
2010	Material
datasets	Material
[	O
reference	O
]	O
,	O
as	O
they	O
are	O
the	O
most	O
widely	O
-	O
used	O
benchmark	O
in	O
weakly	Task
supervised	Task
object	Task
detection	Task
.	O

While	O
the	O
VOC	Material
2007	Material
dataset	Material
consists	O
of	O
2501	O
training	Metric
,	O
2510	O
validation	O
,	O
and	O
5011	O
test	O
images	O
containing	O
bounding	O
box	O
annotations	O
for	O
20	O
object	O
categories	O
,	O
VOC	Material
2010	Material
dataset	Material
contains	O
4998	O
training	Metric
,	O
5105	O
validation	O
,	O
and	O
9637	O
test	O
images	O
for	O
the	O
same	O
number	O
of	O
categories	O
.	O

We	O
use	O
the	O
suggested	O
training	Metric
and	O
validation	O
splits	O
and	O
report	O
results	O
evaluated	O
on	O
test	O
split	O
.	O

We	O
report	O
performance	O
of	O
our	O
method	O
on	O
both	O
the	O
object	Task
detection	Task
and	O
the	O
image	Task
classification	Task
tasks	Task
of	Task
PASCAL	Task
VOC	Task
.	O

For	O
detection	Task
,	O
we	O
use	O
two	O
performance	Metric
measures	Metric
.	O

The	O
first	O
one	O
follows	O
the	O
standard	O
PASCAL	Method
VOC	Method
protocol	Method
and	O
reports	O
average	Metric
precision	Metric
(	O
AP	Metric
)	O
at	O
50	O
%	O
intersection	Metric
-	Metric
overunion	Metric
(	O
IoU	Metric
)	O
of	O
the	O
detected	O
boxes	O
with	O
the	O
ground	O
truth	O
ones	O
.	O

We	O
also	O
report	O
CorLoc	Method
,	O
a	O
commonly	O
-	O
used	O
weakly	Task
supervised	Task
detection	Task
measure	O
[	O
reference	O
]	O
.	O

CorLoc	Method
is	O
the	O
percentage	O
of	O
images	O
that	O
contain	O
at	O
least	O
one	O
instance	O
of	O
the	O
target	O
object	O
class	O
for	O
which	O
the	O
most	O
confident	O
detected	O
bounding	O
box	O
overlaps	O
by	O
at	O
least	O
50	O
%	O
with	O
one	O
of	O
these	O
instances	O
.	O

Differently	O
from	O
AP	Metric
,	O
which	O
is	O
measured	O
on	O
the	O
PASCAL	Material
test	Material
set	Material
,	O
CorLoc	Method
is	O
evaluated	O
on	O
the	O
union	O
of	O
the	O
training	Metric
and	O
validation	O
subset	O
of	O
PASCAL	Material
.	O

For	O
classification	Task
,	O
we	O
use	O
the	O
standard	O
PASCAL	Method
VOC	Method
protocol	Method
and	O
report	O
AP	Metric
.	O

section	O
:	O
Experimental	O
setup	O
.	O

We	O
comprehensively	O
evaluate	O
our	O
method	O
with	O
three	O
pretrained	O
CNN	Method
models	O
in	O
our	O
experiments	O
as	O
in	O
[	O
reference	O
]	O
.	O

The	O
first	O
network	O
is	O
the	O
VGG	O
-	O
CNN	Method
-	O
F	O
[	O
reference	O
]	O
which	O
is	O
similar	O
to	O
AlexNet	Method
[	O
reference	O
]	O
but	O
has	O
reduced	O
number	O
of	O
convolutional	O
filters	O
.	O

We	O
refer	O
to	O
this	O
network	O
as	O
S	O
,	O
for	O
small	O
.	O

The	O
second	O
one	O
is	O
VGG	O
-	O
CNN	Method
-	O
M	Method
-	O
1024	O
which	O
has	O
the	O
same	O
depth	O
as	O
S	O
but	O
has	O
smaller	O
stride	O
in	O
the	O
first	O
convolutional	Method
layer	Method
.	O

We	O
name	O
this	O
network	O
M	Method
for	O
medium	O
.	O

The	O
last	O
network	O
is	O
the	O
deep	Method
VGG	Method
-	Method
VD16	Method
model	Method
[	O
reference	O
]	O
and	O
we	O
call	O
this	O
network	O
L	O
for	O
large	O
.	O

These	O
models	O
,	O
which	O
are	O
pre	O
-	O
trained	O
on	O
the	O
ImageNet	Material
ILSVRC	Material
2012	Material
challenge	Material
data	Material
[	O
reference	O
]	O
,	O
attain	O
18.8	O
%	O
,	O
16.1	O
%	O
and	O
9.9	O
%	O
top	Metric
-	Metric
5	Metric
accuracy	Metric
respectively	O
(	O
using	O
a	O
single	O
centre	Method
-	Method
crop	Method
)	O
on	O
ILSVRC	Method
(	O
importantly	O
no	O
bounding	O
box	O
information	O
is	O
provided	O
during	O
pre	O
-	O
training	Metric
)	O
.	O

As	O
explained	O
in	O
section	O
3.1	O
,	O
we	O
apply	O
the	O
following	O
modifications	O
to	O
the	O
network	O
.	O

First	O
,	O
we	O
replace	O
the	O
last	O
pooling	Method
layer	Method
pool5	Method
with	O
a	O
SPP	Method
layer	Method
[	O
reference	O
]	O
which	O
is	O
configured	O
to	O
be	O
compatible	O
with	O
the	O
network	O
's	O
first	O
fully	Method
connected	Method
layer	Method
.	O

Second	O
,	O
we	O
add	O
a	O
parallel	Method
detection	Method
branch	Method
to	O
the	O
classification	Method
one	Method
that	O
contains	O
a	O
fully	Method
-	Method
connected	Method
layer	Method
followed	O
by	O
a	O
soft	Method
-	Method
max	Method
layer	Method
.	O

Third	O
,	O
we	O
combine	O
the	O
classification	Task
and	Task
detection	Task
streams	Task
by	O
element	Method
-	Method
wise	Method
product	Method
followed	O
by	O
summing	O
scores	O
across	O
regions	O
,	O
and	O
feed	O
the	O
latter	O
to	O
a	O
binary	Method
log	Method
-	Method
loss	Method
layer	Method
.	O

Note	O
that	O
this	O
layer	O
assesses	O
the	O
classification	Task
performance	O
for	O
the	O
20	O
classes	O
together	O
,	O
but	O
each	O
of	O
them	O
is	O
treated	O
as	O
a	O
different	O
binary	Task
classification	Task
problem	Task
;	O
the	O
reason	O
is	O
that	O
classes	O
can	O
co	O
-	O
occur	O
in	O
the	O
PASCAL	Material
VOC	Material
,	O
such	O
that	O
the	O
softmax	O
log	O
loss	O
used	O
in	O
AlexNet	Method
is	O
not	O
appropriate	O
.	O

The	O
WSDDNs	Method
are	O
trained	O
on	O
the	O
PASCAL	Material
VOC	Material
training	Material
and	O
validation	Material
data	Material
by	O
using	O
fine	Method
-	Method
tuning	Method
on	O
all	O
layers	O
,	O
a	O
widely	O
-	O
adopted	O
technique	O
to	O
improve	O
the	O
performance	O
of	O
a	O
CNN	Method
on	O
a	O
target	O
domain	O
[	O
reference	O
]	O
.	O

Here	O
,	O
however	O
,	O
fine	Method
tuning	Method
performs	O
the	O
essential	O
function	O
of	O
learning	O
the	O
classification	Task
and	Task
detection	Task
streams	Task
,	O
effectively	O
causing	O
the	O
network	O
to	O
learn	O
to	O
detect	O
objects	O
,	O
but	O
using	O
only	O
weak	O
image	O
-	O
level	O
supervision	O
.	O

The	O
experiments	O
are	O
run	O
for	O
20	O
epochs	O
and	O
all	O
the	O
layers	O
are	O
fine	O
-	O
tuned	O
with	O
the	O
learning	Metric
rate	Metric
10	O
−5	O
for	O
the	O
first	O
ten	O
epochs	O
and	O
10	O
−6	O
for	O
the	O
last	O
ten	O
epochs	O
.	O

Each	O
minibatch	O
contains	O
all	O
region	O
proposals	O
from	O
a	O
single	O
image	O
.	O

In	O
order	O
to	O
generate	O
candidate	O
regions	O
to	O
use	O
with	O
our	O
networks	O
,	O
we	O
evaluate	O
two	O
proposal	Method
methods	Method
,	O
Selective	Method
Search	Method
Windows	Method
(	O
SSW	Method
)	O
[	O
reference	O
]	O
using	O
its	O
fast	O
setting	O
,	O
and	O
EdgeBoxes	Method
(	Method
EB	Method
)	O
[	O
reference	O
]	O
.	O

In	O
addition	O
to	O
region	O
proposals	O
,	O
EB	Method
provides	O
an	O
objectness	Metric
score	Metric
for	O
each	O
region	O
based	O
on	O
the	O
number	O
of	O
contours	O
wholly	O
encloses	O
.	O

We	O
exploit	O
this	O
additional	O
information	O
by	O
multiplying	O
the	O
feature	O
map	O
φ	O
SPP	O
proportional	O
to	O
its	O
score	O
via	O
a	O
scaling	Method
layer	Method
in	O
WSDDN	Method
and	O
denote	O
this	O
setting	O
as	O
Box	Method
Sc	Method
.	O

Since	O
we	O
use	O
a	O
SPP	Method
layer	Method
to	O
aggregate	O
descriptors	O
for	O
each	O
region	O
,	O
images	O
do	O
not	O
need	O
to	O
be	O
resized	O
to	O
a	O
particular	O
size	O
as	O
in	O
the	O
original	O
pre	O
-	O
trained	Method
model	Method
.	O

Instead	O
,	O
we	O
keep	O
the	O
original	O
aspect	O
ratio	O
of	O
images	O
fixed	O
and	O
resize	O
them	O
to	O
five	O
different	O
scales	O
(	O
setting	O
their	O
maximum	O
of	O
width	O
or	O
height	O
to	O
{	O
480	O
,	O
576	O
,	O
688	O
,	O
864	O
,	O
1200	O
}	O
respectively	O
)	O
as	O
in	O
[	O
reference	O
]	O
.	O

During	O
training	Metric
,	O
we	O
apply	O
random	O
horizontal	O
flips	O
to	O
the	O
images	O
and	O
select	O
a	O
scale	O
at	O
random	O
as	O
a	O
form	O
of	O
jittering	O
or	O
data	Task
augmentation	Task
.	O

At	O
test	Metric
time	Metric
we	O
average	O
the	O
outputs	O
of	O
10	O
images	O
(	O
i.e.	O
the	O
5	O
scales	O
and	O
their	O
flips	O
)	O
.	O

We	O
use	O
the	O
publicly	O
available	O
CNN	Method
toolbox	O
MatConvNet	O
[	O
reference	O
]	O
to	O
conduct	O
our	O
experiments	O
and	O
share	O
our	O
code	O
,	O
models	O
and	O
data	O
[	O
reference	O
]	O
.	O

When	O
evaluated	O
on	O
an	O
image	O
,	O
WSDDN	Method
produces	O
,	O
for	O
each	O
target	O
class	O
c	O
and	O
image	O
x	O
,	O
a	O
score	O
x	O
R	O
r	O
=	O
S	O
c	O
(	O
x	O
;	O
r	O
)	O
for	O
each	O
region	O
r	O
and	O
an	O
aggregated	O
score	O
y	O
c	O
=	O
S	O
c	O
(	O
x	O
)	O
for	O
each	O
image	O
.	O

Non	Method
-	Method
maxima	Method
suppression	Method
(	O
with	O
40	O
%	O
IoU	O
threshold	O
)	O
is	O
applied	O
to	O
the	O
regions	O
and	O
then	O
the	O
scored	O
regions	O
and	O
images	O
are	O
pooled	O
together	O
to	O
compute	O
detection	O
AP	Metric
and	O
CorLoc	Task
.	O

Table	O
3	O
.	O

section	O
:	O
Detection	Task
results	O
Baseline	O
method	O
.	O

First	O
we	O
design	O
a	O
single	Method
stream	Method
classification	Method
-	Method
detection	Method
network	Method
as	O
an	O
alternative	O
baseline	O
to	O
WSDDN	Method
.	O

Part	O
of	O
the	O
construction	O
is	O
similar	O
to	O
WSDDN	Method
,	O
as	O
we	O
replace	O
pool5	O
layer	O
of	O
VGG	O
-	O
CNN	Method
-	O
F	O
model	O
with	O
an	O
SPP	Method
.	O

However	O
,	O
we	O
do	O
not	O
branch	O
off	O
two	O
streams	O
,	O
but	O
simply	O
append	O
to	O
the	O
last	O
fully	O
connected	O
layer	O
(	O
φ	Method
fc8c	Method
)	O
the	O
following	O
loss	Method
layer	Method
The	O
term	O
log	O
|R|	O
r=1	O
exp	O
(	O
x	O
R	O
cr	O
)	O
is	O
a	O
soft	Method
approximation	Method
of	O
the	O
max	Method
operator	Method
max	O
r	O
x	O
R	O
cr	O
and	O
was	O
found	O
to	O
yield	O
better	O
performance	O
than	O
using	O
the	O
max	O
scoring	O
region	O
.	O

This	O
observation	O
is	O
also	O
reported	O
in	O
[	O
reference	O
]	O
.	O

Note	O
that	O
the	O
non	O
-	O
linearity	O
is	O
necessary	O
as	O
otherwise	O
aggregating	O
region	O
-	O
based	O
scores	O
would	O
sum	O
over	O
the	O
scores	O
of	O
a	O
majority	O
of	O
regions	O
that	O
are	O
uninformative	O
.	O

The	O
loss	O
function	O
is	O
once	O
more	O
a	O
sum	O
of	O
C	O
binary	Method
hinge	Method
-	Method
losses	Method
,	O
one	O
for	O
each	O
class	O
.	O

This	O
baseline	O
obtains	O
21.6	O
%	O
mAP	Metric
detection	Metric
score	Metric
on	O
the	O
PASCAL	Material
VOC	Material
test	Material
set	Material
,	O
which	O
is	O
well	O
below	O
the	O
state	O
-	O
of	O
-	O
the	O
-	O
art	O
(	O
31.6	O
%	O
in	O
[	O
reference	O
]	O
)	O
.	O

Pre	O
-	O
trained	O
CNN	Method
architectures	O
.	O

We	O
evaluate	O
our	O
method	O
with	O
the	O
models	O
S	O
,	O
M	Method
and	O
L	O
and	O
also	O
report	O
the	O
results	O
for	O
the	O
ensemble	O
of	O
these	O
models	O
by	O
simply	O
averaging	O
their	O
scores	O
.	O

Table	O
1	O
shows	O
that	O
WSDDN	Method
with	O
individual	O
models	O
S	O
and	O
M	Method
are	O
already	O
on	O
par	O
with	O
the	O
state	O
-	O
ofthe	O
-	O
art	O
method	O
[	O
reference	O
]	O
and	O
the	O
ensemble	Method
outperforms	O
the	O
best	O
previous	O
score	O
in	O
the	O
VOC	Material
2007	Material
dataset	Material
.	O

Differently	O
from	O
supervised	Method
detection	Method
methods	Method
(	O
e.g.	O
[	O
reference	O
]	O
)	O
,	O
detection	Task
performance	O
of	O
WSDDN	Method
does	O
not	O
improve	O
with	O
use	O
of	O
wider	O
or	O
deeper	Method
networks	Method
.	O

In	O
contrast	O
,	O
model	O
L	O
performs	O
significantly	O
worse	O
than	O
models	O
S	O
and	O
M	Method
(	O
see	O
table	O
1	O
)	O
.	O

This	O
can	O
be	O
explained	O
with	O
the	O
fact	O
that	O
model	Method
L	Method
frequently	O
focuses	O
on	O
parts	O
of	O
objects	O
,	O
instead	O
of	O
whole	O
instances	O
,	O
and	O
is	O
still	O
able	O
to	O
associate	O
these	O
parts	O
with	O
object	O
categories	O
due	O
to	O
its	O
smaller	O
convolution	O
strides	O
,	O
higher	O
resolution	O
and	O
deeper	Method
architecture	Method
.	O

Object	Task
proposals	Task
.	O

Next	O
,	O
we	O
compare	O
the	O
detection	Task
performances	O
with	O
two	O
popular	O
object	Method
proposal	Method
methods	Method
,	O
SSW	Method
[	O
reference	O
]	O
and	O
EB	O
[	O
reference	O
]	O
.	O

While	O
both	O
the	O
region	Method
proposals	Method
provides	O
comparable	O
quality	O
region	O
proposals	O
,	O
using	O
box	O
scores	O
of	O
EB	Method
(	O
denoted	O
as	O
Box	O
Sc	O
in	O
table	O
1	O
)	O
leads	O
to	O
a	O
2	O
%	O
improvement	O
for	O
models	O
S	O
and	O
M	Method
and	O
boosts	O
the	O
detection	Task
performance	O
of	O
model	O
L	O
5	O
%	O
.	O

Spatial	Method
regulariser	Method
.	O

We	O
denote	O
the	O
setting	O
where	O
WS	Method
-	Method
DDN	Method
is	O
trained	O
with	O
the	O
additional	O
spatial	O
regularisation	O
term	O
(	O
denoted	O
as	O
Sp	O
.	O

Reg	O
.	O

in	O
table	O
1	O
)	O
.	O

Finally	O
the	O
introduction	O
of	O
the	O
regularisation	Method
improves	O
the	O
detection	Task
performance	O
1	O
,	O
2	O
and	O
4	O
mAP	Metric
points	O
for	O
models	O
S	O
,	O
M	Method
and	O
L	O
respectively	O
.	O

The	O
improvements	O
show	O
that	O
larger	O
network	O
benefits	O
more	O
from	O
introduction	O
of	O
the	O
spatial	O
invariance	O
around	O
high	O
confidence	O
regions	O
.	O

Comparison	O
with	O
the	O
state	O
of	O
the	O
art	O
.	O

After	O
evaluating	O
the	O
design	O
decisions	O
,	O
we	O
follow	O
the	O
best	O
setting	O
(	O
last	O
row	O
in	O
table	O
1	O
)	O
and	O
compare	O
WSDDN	Method
to	O
the	O
state	O
of	O
the	O
art	O
in	O
weakly	Task
supervised	Task
detection	Task
literature	O
in	O
table	O
2	O
and	O
table	O
3	O
for	O
the	O
VOC	Material
2007	Material
dataset	Material
and	O
in	O
table	O
5	O
and	O
table	O
6	O
for	O
the	O
VOC	Material
2010	Material
dataset	Material
.	O

The	O
results	O
show	O
that	O
our	O
method	O
already	O
achieves	O
overall	O
significantly	O
better	O
performance	O
than	O
these	O
alternatives	O
with	O
a	O
single	O
model	O
and	O
ensemble	Method
models	Method
further	O
boost	O
the	O
performance	O
.	O

The	O
majority	O
of	O
previous	O
work	O
[	O
reference	O
][	O
reference	O
][	O
reference	O
][	O
reference	O
][	O
reference	O
]	O
use	O
the	O
Caffe	O
reference	O
CNN	Method
model	O
[	O
reference	O
]	O
,	O
which	O
is	O
comparable	O
to	O
model	O
S	O
in	O
this	O
paper	O
,	O
as	O
a	O
black	O
box	O
to	O
extract	O
features	O
over	O
SSW	Method
proposals	Method
.	O

In	O
addition	O
to	O
CNN	Method
features	O
,	O
Cinbis	O
et	O
al	O
.	O

[	O
reference	O
]	O
use	O
Fisher	O
Vectors	O
[	O
reference	O
]	O
and	O
EB	Metric
objectness	Metric
measure	Metric
of	O
Zitnick	O
and	O
Dollar	O
[	O
reference	O
]	O
as	O
well	O
.	O

Differently	O
from	O
the	O
previous	O
work	O
,	O
WSDDN	Method
is	O
based	O
on	O
a	O
simple	O
modification	O
of	O
the	O
original	O
CNN	Method
architecture	O
fine	O
-	O
tuned	O
on	O
the	O
target	O
data	O
using	O
back	Method
-	Method
propagation	Method
.	O

Next	O
,	O
we	O
investigate	O
the	O
results	O
in	O
more	O
detail	O
.	O

While	O
our	O
method	O
significantly	O
outperforms	O
the	O
alternatives	O
in	O
majority	O
of	O
categories	O
,	O
is	O
not	O
as	O
strong	O
in	O
chair	O
,	O
person	O
and	O
pottedplant	O
categories	O
.	O

Failure	O
and	O
success	O
case	O
are	O
illustrated	O
in	O
fig	O
.	O

3	O
.	O

It	O
can	O
be	O
noted	O
that	O
,	O
by	O
far	O
,	O
the	O
most	O
important	O
failure	O
modality	O
for	O
our	O
system	O
is	O
that	O
an	O
object	O
part	O
(	O
e.g.	O
person	O
face	O
)	O
is	O
detected	O
instead	O
as	O
the	O
object	O
as	O
a	O
whole	O
.	O

This	O
can	O
be	O
explained	O
by	O
the	O
fact	O
that	O
parts	O
such	O
as	O
"	O
face	O
"	O
are	O
very	O
often	O
much	O
more	O
discriminative	O
and	O
with	O
a	O
less	O
variable	O
appearance	O
than	O
the	O
rest	O
of	O
the	O
object	O
.	O

Note	O
that	O
the	O
root	O
cause	O
for	O
this	O
failure	O
modality	O
is	O
that	O
we	O
,	O
as	O
many	O
other	O
authors	O
,	O
define	O
objects	O
as	O
image	O
regions	O
that	O
are	O
most	O
predictive	O
for	O
a	O
given	O
object	O
class	O
,	O
and	O
these	O
may	O
not	O
include	O
the	O
object	O
as	O
a	O
whole	O
.	O

Addressing	O
this	O
issue	O
will	O
therefore	O
require	O
incorporating	O
additional	O
cue	O
in	O
the	O
model	O
to	O
try	O
to	O
learn	O
the	O
"	O
whole	O
object	O
"	O
.	O

The	O
output	O
of	O
our	O
model	O
could	O
also	O
be	O
used	O
as	O
input	O
to	O
one	O
of	O
the	O
existing	O
methods	O
for	O
weakly	Task
-	Task
supervised	Task
detection	Task
that	O
use	O
a	O
CNN	Method
as	O
a	O
black	O
-	O
box	O
for	O
feature	Task
extraction	Task
.	O

Investigating	O
this	O
option	O
is	O
left	O
to	O
future	O
work	O
.	O

This	O
figure	O
depicts	O
success	O
(	O
in	O
green	O
)	O
and	O
failure	O
cases	O
(	O
in	O
red	O
)	O
of	O
our	O
detector	O
in	O
randomly	O
picked	O
images	O
.	O

Majority	O
of	O
false	Task
detections	Task
contains	O
two	O
kinds	O
of	O
error	O
:	O
i	O
)	O
group	O
multiple	O
object	O
instances	O
with	O
a	O
single	O
bounding	O
box	O
,	O
ii	O
)	O
focus	O
on	O
(	O
discriminative	O
)	O
parts	O
(	O
e.g.	O
"	O
faces	O
"	O
)	O
rather	O
than	O
whole	O
object	O
.	O

section	O
:	O
Classification	Task
Results	O
While	O
WSDDN	Method
is	O
primarily	O
designed	O
for	O
weaklysupervised	Task
object	Task
detection	Task
,	O
ultimately	O
it	O
is	O
trained	O
to	O
perform	O
image	Task
classification	Task
.	O

Hence	O
,	O
it	O
is	O
interesting	O
to	O
evaluate	O
its	O
performance	O
on	O
this	O
task	O
as	O
well	O
.	O

To	O
this	O
end	O
,	O
we	O
use	O
the	O
PASCAL	Material
VOC	Material
2007	Material
benchmark	O
and	O
contrast	O
it	O
to	O
standard	O
fine	Method
-	Method
tuning	Method
techniques	Method
that	O
are	O
often	O
used	O
in	O
combination	O
with	O
CNNs	Method
and	O
show	O
the	O
results	O
in	O
table	O
6	O
.	O

These	O
techniques	O
have	O
been	O
thoroughly	O
investigated	O
in	O
[	O
reference	O
][	O
reference	O
][	O
reference	O
]	O
.	O

Chatfield	O
et	O
al	O
.	O

[	O
reference	O
]	O
,	O
in	O
particular	O
,	O
analyse	O
many	O
variants	O
of	O
fine	Task
-	Task
tuning	Task
,	O
including	O
extensive	O
data	Task
augmentation	Task
,	O
on	O
the	O
PASCAL	Material
VOC	Material
.	O

They	O
experiment	O
with	O
three	O
architectures	O
,	O
VGG	Method
-	Method
F	Method
,	O
VGG	O
-	O
M	Method
,	O
and	O
VGG	Method
-	Method
S.	Method
While	O
VGG	Method
-	Method
F	Method
is	O
their	O
fastest	O
model	O
,	O
the	O
other	O
two	O
networks	O
are	O
slower	O
but	O
more	O
accurate	O
.	O

As	O
explained	O
in	O
4.2	O
,	O
we	O
initialise	O
WSDDN	Method
S	Method
and	O
M	Method
with	O
the	O
pre	Method
-	Method
trained	Method
VGG	Method
-	Method
F	Method
and	O
VGG	Method
-	Method
M	Method
-	Method
1024	Method
respectively	O
and	O
thus	O
they	O
should	O
be	O
considered	O
as	O
right	O
baselines	O
.	O

WS	Method
-	Method
DDN	Method
S	Method
and	O
M	Method
improves	O
8	O
and	O
7	O
points	O
over	O
VGG	Method
-	Method
F	Method
and	O
VGG	Method
-	Method
M	Method
-	Method
1024	Method
respectively	O
.	O

We	O
also	O
compare	O
WSDDN	Method
to	O
the	O
SPP	Method
-	Method
net	Method
[	O
reference	O
]	O
which	O
uses	O
the	O
Overfeat	Method
-	Method
7	Method
[	O
reference	O
]	O
with	O
a	O
4	O
-	O
level	O
spatial	O
pyramid	O
pooling	O
layer	O
{	O
6	O
×	O
6	O
,	O
3	O
×	O
3	O
,	O
2	O
×	O
2	O
,	O
1	O
×	O
1	O
}	O
for	O
supervised	Task
object	Task
detection	Task
.	O

While	O
they	O
do	O
not	O
perform	O
fine	Method
-	Method
tuning	Method
,	O
they	O
include	O
a	O
spatial	Method
pooling	Method
layer	Method
.	O

Applied	O
to	O
image	Task
classification	Task
,	O
their	O
best	O
performance	O
on	O
the	O
PASCAL	Material
VOC	Material
2007	Material
is	O
82.4	O
%	O
.	O

Finally	O
we	O
compare	O
WSDDN	Method
L	Method
to	O
the	O
competitive	Method
VGG	Method
-	Method
VD16	Method
[	O
reference	O
]	O
.	O

Interestingly	O
,	O
this	O
method	O
also	O
exploits	O
coarse	O
local	O
information	O
by	O
aggregating	O
the	O
activations	O
of	O
the	O
last	O
fully	Method
connected	Method
layer	Method
over	O
multiple	O
locations	O
and	O
scales	O
.	O

WSDDN	Method
L	Method
outperforms	O
this	O
very	O
competitive	O
baseline	O
with	O
a	O
margin	O
of	O
0.4	O
point	O
.	O

section	O
:	O
Conclusions	O
In	O
this	O
paper	O
,	O
we	O
have	O
presented	O
WSDDN	Method
,	O
a	O
simple	O
modification	O
of	O
a	O
pre	O
-	O
trained	O
CNN	Method
for	O
image	Task
classification	Task
that	O
allows	O
it	O
to	O
perform	O
weakly	Task
supervised	Task
detection	Task
.	O

It	O
achieves	O
significantly	O
better	O
performance	O
than	O
existing	O
methods	O
on	O
weakly	Task
supervised	Task
detection	Task
,	O
while	O
requiring	O
only	O
fine	O
-	O
tuning	O
on	O
a	O
target	O
dataset	O
using	O
back	Method
-	Method
propagation	Method
,	O
region	O
proposals	O
and	O
image	O
-	O
level	O
labels	O
.	O

Since	O
it	O
works	O
on	O
top	O
of	O
a	O
SPP	Method
layer	Method
,	O
it	O
is	O
also	O
efficient	O
at	O
training	Metric
and	O
test	Metric
time	Metric
.	O

WSDDN	Method
is	O
also	O
shown	O
to	O
perform	O
better	O
than	O
traditional	O
fine	Method
-	Method
tuning	Method
techniques	Method
to	O
improve	O
the	O
performance	O
of	O
a	O
pre	O
-	O
trained	O
CNN	Method
on	O
the	O
problem	O
of	O
image	Task
classification	Task
.	O

We	O
have	O
identified	O
the	O
detection	Task
of	Task
object	Task
parts	Task
as	O
a	O
failure	O
modality	O
of	O
the	O
method	O
,	O
damaging	O
its	O
performance	O
in	O
selected	O
object	O
categories	O
,	O
and	O
imputed	O
that	O
to	O
the	O
main	O
criterion	O
used	O
to	O
identify	O
objects	O
,	O
namely	O
the	O
selection	O
of	O
highly	O
-	O
distinctive	O
image	O
regions	O
.	O

We	O
are	O
currently	O
exploring	O
complementary	O
cues	O
that	O
would	O
favour	O
detecting	O
complete	O
objects	O
instead	O
.	O

section	O
:	O
section	O
:	O
Acknowledgments	O
:	O
This	O
work	O
acknowledges	O
the	O
support	O
of	O
the	O
EPSRC	O
EP	O
/	O
L024683	O
/	O
1	O
,	O
EPSRC	O
Seebibyte	O
EP	O
/	O
M013774	O
/	O
1	O
and	O
the	O
ERC	O
Starting	O
Grant	O
IDIU	O
.	O

section	O
:	O
