document	O
:	O
Deep	Method
Interest	Method
Network	Method
for	O
Click	Task
-	Task
Through	Task
Rate	Task
Prediction	Task
Click	Task
-	Task
through	Task
rate	Task
prediction	Task
is	O
an	O
essential	O
task	O
in	O
industrial	Task
applications	Task
,	O
such	O
as	O
online	Task
advertising	Task
.	O

Recently	O
deep	Method
learning	Method
based	Method
models	Method
have	O
been	O
proposed	O
,	O
which	O
follow	O
a	O
similar	O
Embedding	Method
&	O
MLP	Method
paradigm	Method
.	O

In	O
these	O
methods	O
large	O
scale	O
sparse	O
input	O
features	O
are	O
first	O
mapped	O
into	O
low	O
dimensional	O
embedding	Method
vectors	O
,	O
and	O
then	O
transformed	O
into	O
fixed	O
-	O
length	O
vectors	O
in	O
a	O
group	O
-	O
wise	O
manner	O
,	O
finally	O
concatenated	O
together	O
to	O
fed	O
into	O
a	O
multilayer	Method
perceptron	Method
(	O
MLP	Method
)	O
to	O
learn	O
the	O
nonlinear	O
relations	O
among	O
features	O
.	O

In	O
this	O
way	O
,	O
user	O
features	O
are	O
compressed	O
into	O
a	O
fixed	Method
-	Method
length	Method
representation	Method
vector	Method
,	O
in	O
regardless	O
of	O
what	O
candidate	O
ads	O
are	O
.	O

The	O
use	O
of	O
fixed	O
-	O
length	O
vector	O
will	O
be	O
a	O
bottleneck	O
,	O
which	O
brings	O
difficulty	O
for	O
Embedding	Method
&	O
MLP	Method
methods	Method
to	O
capture	O
user	O
’s	O
diverse	O
interests	O
effectively	O
from	O
rich	O
historical	O
behaviors	O
.	O

In	O
this	O
paper	O
,	O
we	O
propose	O
a	O
novel	O
model	O
:	O
Deep	Method
Interest	Method
Network	Method
(	O
DIN	Method
)	O
which	O
tackles	O
this	O
challenge	O
by	O
designing	O
a	O
local	Method
activation	Method
unit	Method
to	O
adaptively	O
learn	O
the	O
representation	O
of	O
user	O
interests	O
from	O
historical	O
behaviors	O
with	O
respect	O
to	O
a	O
certain	O
ad	O
.	O

This	O
representation	O
vector	O
varies	O
over	O
different	O
ads	O
,	O
improving	O
the	O
expressive	O
ability	O
of	O
model	O
greatly	O
.	O

Besides	O
,	O
we	O
develop	O
two	O
techniques	O
:	O
mini	O
-	O
batch	O
aware	O
regularization	Method
and	O
data	Method
adaptive	Method
activation	Method
function	Method
which	O
can	O
help	O
training	O
industrial	Method
deep	Method
networks	Method
with	O
hundreds	O
of	O
millions	O
of	O
parameters	O
.	O

Experiments	O
on	O
two	O
public	O
datasets	O
as	O
well	O
as	O
an	O
Alibaba	O
real	O
production	O
dataset	O
with	O
over	O
2	O
billion	O
samples	O
demonstrate	O
the	O
effectiveness	O
of	O
proposed	O
approaches	O
,	O
which	O
achieve	O
superior	O
performance	O
compared	O
with	O
state	O
-	O
of	O
-	O
the	O
-	O
art	O
methods	O
.	O

DIN	Method
now	O
has	O
been	O
successfully	O
deployed	O
in	O
the	O
online	Method
display	Method
advertising	Method
system	Method
in	O
Alibaba	O
,	O
serving	O
the	O
main	O
traffic	O
.	O

printacmref	O
=	O
false	O
2018	O
2018	O
acmcopyright	O
KDD’18August19–23	O
,	O
2018	O
,	O
London	O
,	O
UnitedKingdom	O
.	O

¡	O
ccs2012	O
¿	O
¡	O
concept	O
¿	O
¡	O
concept_id¿10002951.10003260.10003272.10003275¡	O
/	O
concept_id	O
¿	O
¡	O
concept_desc¿Information	O
systems	O
Display	O
advertising¡	O
/	O
concept_desc	O
¿	O
¡	O
concept_significance¿500¡	O
/	O
concept_significance	O
¿	O
¡	O
/	O
concept	O
¿	O
¡	O
concept	O
¿	O
¡	O
concept_id¿10002951.10003317.10003347.10003350¡	O
/	O
concept_id	O
¿	O
¡	O
concept_desc¿Information	O
systems	O
Recommender	O
systems¡	O
/	O
concept_desc	O
¿	O
¡	O
concept_significance¿500¡	O
/	O
concept_significance	O
¿	O
¡	O
/	O
concept	O
¿	O
¡	O
/	O
ccs2012	O
¿	O
[	O
500	O
]	O
Information	O
systems	O
Display	O
advertising	O
systems	O
Recommender	O
systems	O
section	O
:	O
Introduction	O
In	O
cost	Metric
-	Metric
per	Metric
-	Metric
click	Metric
(	O
CPC	Metric
)	O
advertising	O
system	O
,	O
advertisements	O
are	O
ranked	O
by	O
the	O
eCPM	Metric
(	O
effective	Metric
cost	Metric
per	Metric
mille	Metric
)	O
,	O
which	O
is	O
the	O
product	O
of	O
the	O
bid	O
price	O
and	O
CTR	Metric
(	O
click	Metric
-	Metric
through	Metric
rate	Metric
)	O
,	O
and	O
CTR	Metric
needs	O
to	O
be	O
predicted	O
by	O
the	O
system	O
.	O

Hence	O
,	O
the	O
performance	O
of	O
CTR	Method
prediction	Method
model	Method
has	O
a	O
direct	O
impact	O
on	O
the	O
final	O
revenue	Metric
and	O
plays	O
a	O
key	O
role	O
in	O
the	O
advertising	Task
system	Task
.	O

Modeling	O
CTR	Metric
prediction	O
has	O
received	O
much	O
attention	O
from	O
both	O
research	O
and	O
industry	O
community	O
.	O

Recently	O
,	O
inspired	O
by	O
the	O
success	O
of	O
deep	Method
learning	Method
in	O
computer	Task
vision	Task
and	O
natural	Task
language	Task
processing	Task
,	O
deep	Method
learning	Method
based	Method
methods	Method
have	O
been	O
proposed	O
for	O
CTR	Task
prediction	Task
task	Task
.	O

These	O
methods	O
follow	O
a	O
similar	O
Embedding	Method
&	O
MLP	Method
paradigm	Method
:	O
large	O
scale	O
sparse	O
input	O
features	O
are	O
first	O
mapped	O
into	O
low	O
dimensional	O
embedding	Method
vectors	O
,	O
and	O
then	O
transformed	O
into	O
fixed	O
-	O
length	O
vectors	O
in	O
a	O
group	O
-	O
wise	O
manner	O
,	O
finally	O
concatenated	O
together	O
to	O
fed	O
into	O
fully	Method
connected	Method
layers	Method
(	O
also	O
known	O
as	O
multilayer	Method
perceptron	Method
,	O
MLP	Method
)	O
to	O
learn	O
the	O
nonlinear	O
relations	O
among	O
features	O
.	O

Compared	O
with	O
commonly	O
used	O
logistic	Method
regression	Method
model	Method
,	O
these	O
deep	Method
learning	Method
methods	Method
can	O
reduce	O
a	O
lot	O
of	O
feature	O
engineering	O
jobs	O
and	O
enhance	O
the	O
model	O
capability	O
greatly	O
.	O

For	O
simplicity	O
,	O
we	O
name	O
these	O
methods	O
Embedding	Method
&	O
MLP	Method
in	O
this	O
paper	O
,	O
which	O
now	O
have	O
become	O
popular	O
on	O
CTR	Task
prediction	Task
task	Task
.	O

However	O
,	O
the	O
user	O
representation	O
vector	O
with	O
a	O
limited	O
dimension	O
in	O
Embedding	Method
&	O
MLP	Method
methods	O
will	O
be	O
a	O
bottleneck	O
to	O
express	O
user	O
’s	O
diverse	O
interests	O
.	O

Take	O
display	Task
advertising	Task
in	O
e	O
-	O
commerce	O
site	O
as	O
an	O
example	O
.	O

Users	O
might	O
be	O
interested	O
in	O
different	O
kinds	O
of	O
goods	O
simultaneously	O
when	O
visiting	O
the	O
e	O
-	O
commerce	O
site	O
.	O

That	O
is	O
to	O
say	O
,	O
user	O
interests	O
are	O
diverse	O
.	O

When	O
it	O
comes	O
to	O
CTR	Task
prediction	Task
task	Task
,	O
user	O
interests	O
are	O
usually	O
captured	O
from	O
user	O
behavior	O
data	O
.	O

Embedding	Method
&	O
MLP	Method
methods	O
learn	O
the	O
representation	O
of	O
all	O
interests	O
for	O
a	O
certain	O
user	O
by	O
transforming	O
the	O
embedding	Method
vectors	O
of	O
user	O
behaviors	O
into	O
a	O
fixed	O
-	O
length	O
vector	O
,	O
which	O
is	O
in	O
an	O
euclidean	O
space	O
where	O
all	O
users	O
’	O
representation	O
vectors	O
are	O
.	O

In	O
other	O
words	O
,	O
diverse	O
interests	O
of	O
the	O
user	O
are	O
compressed	O
into	O
a	O
fixed	O
-	O
length	O
vector	O
,	O
which	O
limits	O
the	O
expressive	O
ability	O
of	O
Embedding	Method
&	O
MLP	Method
methods	O
.	O

To	O
make	O
the	O
representation	O
capable	O
enough	O
for	O
expressing	O
user	O
’s	O
diverse	O
interests	O
,	O
the	O
dimension	O
of	O
the	O
fixed	O
-	O
length	O
vector	O
needs	O
to	O
be	O
largely	O
expanded	O
.	O

Unfortunately	O
,	O
it	O
will	O
dramatically	O
enlarge	O
the	O
size	O
of	O
learning	O
parameters	O
and	O
aggravate	O
the	O
risk	O
of	O
overfitting	O
under	O
limited	O
data	O
.	O

Besides	O
,	O
it	O
adds	O
the	O
burden	O
of	O
computation	Metric
and	O
storage	Metric
,	O
which	O
may	O
not	O
be	O
tolerated	O
for	O
an	O
industrial	Task
online	Task
system	Task
.	O

On	O
the	O
other	O
hand	O
,	O
it	O
is	O
not	O
necessary	O
to	O
compress	O
all	O
the	O
diverse	O
interests	O
of	O
a	O
certain	O
user	O
into	O
the	O
same	O
vector	O
when	O
predicting	O
a	O
candidate	O
ad	O
because	O
only	O
part	O
of	O
user	O
’s	O
interests	O
will	O
influence	O
his	O
/	O
her	O
action	O
(	O
to	O
click	O
or	O
not	O
to	O
click	O
)	O
.	O

For	O
example	O
,	O
a	O
female	O
swimmer	O
will	O
click	O
a	O
recommended	O
goggle	O
mostly	O
due	O
to	O
the	O
bought	O
of	O
bathing	O
suit	O
rather	O
than	O
the	O
shoes	O
in	O
her	O
last	O
week	O
’s	O
shopping	O
list	O
.	O

Motivated	O
by	O
this	O
,	O
we	O
propose	O
a	O
novel	O
model	O
:	O
Deep	Method
Interest	Method
Network	Method
(	O
DIN	Method
)	O
,	O
which	O
adaptively	O
calculates	O
the	O
representation	O
vector	O
of	O
user	O
interests	O
by	O
taking	O
into	O
consideration	O
the	O
relevance	O
of	O
historical	O
behaviors	O
given	O
a	O
candidate	O
ad	O
.	O

By	O
introducing	O
a	O
local	Method
activation	Method
unit	Method
,	O
DIN	Method
pays	O
attentions	O
to	O
the	O
related	O
user	O
interests	O
by	O
soft	O
-	O
searching	O
for	O
relevant	O
parts	O
of	O
historical	O
behaviors	O
and	O
takes	O
a	O
weighted	Method
sum	Method
pooling	Method
to	O
obtain	O
the	O
representation	O
of	O
user	O
interests	O
with	O
respect	O
to	O
the	O
candidate	O
ad	O
.	O

Behaviors	O
with	O
higher	O
relevance	O
to	O
the	O
candidate	O
ad	O
get	O
higher	O
activated	O
weights	O
and	O
dominate	O
the	O
representation	O
of	O
user	O
interests	O
.	O

We	O
visualize	O
this	O
phenomenon	O
in	O
the	O
experiment	O
section	O
.	O

In	O
this	O
way	O
,	O
the	O
representation	O
vector	O
of	O
user	O
interests	O
varies	O
over	O
different	O
ads	O
,	O
which	O
improves	O
the	O
expressive	O
ability	O
of	O
model	O
under	O
limited	O
dimension	O
and	O
enables	O
DIN	Method
to	O
better	O
capture	O
user	O
’s	O
diverse	O
interests	O
.	O

Training	O
industrial	Method
deep	Method
networks	Method
with	O
large	O
scale	O
sparse	O
features	O
is	O
of	O
great	O
challenge	O
.	O

For	O
example	O
,	O
SGD	Method
based	Method
optimization	Method
methods	Method
only	O
update	O
those	O
parameters	O
of	O
sparse	O
features	O
appearing	O
in	O
each	O
mini	O
-	O
batch	O
.	O

However	O
,	O
adding	O
with	O
traditional	O
regularization	Method
,	O
the	O
computation	O
turns	O
to	O
be	O
unacceptable	O
,	O
which	O
needs	O
to	O
calculate	O
L2	O
-	O
norm	O
over	O
the	O
whole	O
parameters	O
(	O
with	O
size	O
scaling	O
up	O
to	O
billions	O
in	O
our	O
situation	O
)	O
for	O
each	O
mini	O
-	O
batch	O
.	O

In	O
this	O
paper	O
,	O
we	O
develop	O
a	O
novel	O
mini	O
-	O
batch	O
aware	O
regularization	Method
where	O
only	O
parameters	O
of	O
non	O
-	O
zero	O
features	O
appearing	O
in	O
each	O
mini	O
-	O
batch	O
participate	O
in	O
the	O
calculation	O
of	O
L2	O
-	O
norm	O
,	O
making	O
the	O
computation	O
acceptable	O
.	O

Besides	O
,	O
we	O
design	O
a	O
data	Method
adaptive	Method
activation	Method
function	Method
,	O
which	O
generalizes	O
commonly	O
used	O
PReLU	Method
by	O
adaptively	O
adjusting	O
the	O
rectified	O
point	O
w.r.t	O
.	O

distribution	O
of	O
inputs	O
and	O
is	O
shown	O
to	O
be	O
helpful	O
for	O
training	O
industrial	Task
networks	Task
with	O
sparse	O
features	O
.	O

The	O
contributions	O
of	O
this	O
paper	O
are	O
summarized	O
as	O
follows	O
:	O
We	O
point	O
out	O
the	O
limit	O
of	O
using	O
fixed	O
-	O
length	O
vector	O
to	O
express	O
user	O
’s	O
diverse	O
interests	O
and	O
design	O
a	O
novel	O
deep	Method
interest	Method
network	Method
(	O
DIN	Method
)	O
which	O
introduces	O
a	O
local	Method
activation	Method
unit	Method
to	O
adaptively	O
learn	O
the	O
representation	O
of	O
user	O
interests	O
from	O
historical	O
behaviors	O
w.r.t	O
.	O

given	O
ads	O
.	O

DIN	Method
can	O
improve	O
the	O
expressive	Metric
ability	Metric
of	O
model	O
greatly	O
and	O
better	O
capture	O
the	O
diversity	O
characteristic	O
of	O
user	O
interests	O
.	O

We	O
develop	O
two	O
novel	O
techniques	O
to	O
help	O
training	O
industrial	Method
deep	Method
networks	Method
:	O
i	O
)	O
a	O
mini	Method
-	Method
batch	Method
aware	Method
regularizer	Method
,	O
which	O
saves	O
heavy	O
computation	O
of	O
regularization	Method
on	O
deep	Method
networks	Method
with	O
huge	O
number	O
of	O
parameters	O
and	O
is	O
helpful	O
for	O
avoiding	O
overfitting	O
,	O
ii	O
)	O
a	O
data	Method
adaptive	Method
activation	Method
function	Method
,	O
which	O
generalizes	O
PReLU	Method
by	O
considering	O
the	O
distribution	O
of	O
inputs	O
and	O
shows	O
well	O
performance	O
.	O

We	O
conduct	O
extensive	O
experiments	O
on	O
both	O
public	O
and	O
Alibaba	O
datasets	O
.	O

Results	O
verify	O
the	O
effectiveness	O
of	O
proposed	O
DIN	Method
and	O
training	Method
techniques	Method
.	O

Our	O
code	O
is	O
publicly	O
available	O
.	O

The	O
proposed	O
approaches	O
have	O
been	O
deployed	O
in	O
the	O
commercial	O
display	Method
advertising	Method
system	Method
in	O
Alibaba	O
,	O
one	O
of	O
world	O
’s	O
largest	O
advertising	Task
platform	Task
,	O
contributing	O
significant	O
improvement	O
to	O
the	O
business	O
.	O

In	O
this	O
paper	O
we	O
focus	O
on	O
the	O
CTR	Metric
prediction	O
modeling	O
in	O
the	O
scenario	O
of	O
display	Task
advertising	Task
in	O
e	Task
-	Task
commerce	Task
industry	Task
.	O

Methods	O
discussed	O
here	O
can	O
be	O
applied	O
in	O
similar	O
scenarios	O
with	O
rich	O
user	O
behaviors	O
,	O
such	O
as	O
personalized	Task
recommendation	Task
in	O
e	Task
-	Task
commerce	Task
sites	Task
,	O
feeds	Task
ranking	Task
in	O
social	Task
networks	Task
etc	O
.	O

The	O
rest	O
of	O
the	O
paper	O
is	O
organized	O
as	O
follows	O
.	O

We	O
discuss	O
related	O
work	O
in	O
section	O
2	O
and	O
introduce	O
the	O
background	O
about	O
characteristic	O
of	O
user	O
behavior	O
data	O
in	O
display	Method
advertising	Method
system	Method
of	O
e	O
-	O
commerce	O
site	O
in	O
section	O
3	O
.	O

Section	O
4	O
and	O
5	O
describe	O
in	O
detail	O
the	O
design	O
of	O
DIN	Method
model	O
as	O
well	O
as	O
two	O
proposed	O
training	Method
techniques	Method
.	O

We	O
present	O
experiments	O
in	O
section	O
6	O
and	O
conclude	O
in	O
section	O
7	O
.	O

section	O
:	O
Relatedwork	O
The	O
structure	O
of	O
CTR	Method
prediction	Method
model	Method
has	O
evolved	O
from	O
shallow	O
to	O
deep	O
.	O

At	O
the	O
same	O
time	O
,	O
the	O
number	O
of	O
samples	O
and	O
the	O
dimension	O
of	O
features	O
used	O
in	O
CTR	Metric
model	O
have	O
become	O
larger	O
and	O
larger	O
.	O

In	O
order	O
to	O
better	O
extract	O
feature	O
relations	O
to	O
improve	O
performance	O
,	O
several	O
works	O
pay	O
attention	O
to	O
the	O
design	O
of	O
model	O
structure	O
.	O

As	O
a	O
pioneer	O
work	O
,	O
NNLM	Method
learns	O
distributed	Method
representation	Method
for	O
each	O
word	O
,	O
aiming	O
to	O
avoid	O
curse	O
of	O
dimension	O
in	O
language	Task
modeling	Task
.	O

This	O
method	O
,	O
often	O
referred	O
to	O
as	O
embedding	Method
,	O
has	O
inspired	O
many	O
natural	Method
language	Method
models	Method
and	O
CTR	Method
prediction	Method
models	Method
that	O
need	O
to	O
handle	O
large	O
-	O
scale	O
sparse	O
inputs	O
.	O

LS	Method
-	Method
PLM	Method
and	Method
FM	Method
models	Method
can	O
be	O
viewed	O
as	O
a	O
class	O
of	O
networks	O
with	O
one	O
hidden	O
layer	O
,	O
which	O
first	O
employs	O
embedding	Method
layer	Method
on	O
sparse	O
inputs	O
and	O
then	O
imposes	O
specially	O
designed	O
transformation	O
functions	O
for	O
target	Task
fitting	Task
,	O
aiming	O
to	O
capture	O
the	O
combination	O
relations	O
among	O
features	O
.	O

Deep	Method
Crossing	Method
,	O
Wide	Method
&	O
Deep	Method
Learning	Method
and	O
YouTube	Method
Recommendation	Method
CTR	Method
model	Method
extend	O
LS	Method
-	Method
PLM	Method
and	O
FM	Method
by	O
replacing	O
the	O
transformation	O
function	O
with	O
complex	O
MLP	Method
network	O
,	O
which	O
enhances	O
the	O
model	O
capability	O
greatly	O
.	O

PNN	Method
tries	O
to	O
capture	O
high	O
-	O
order	O
feature	O
interactions	O
by	O
involving	O
a	O
product	Method
layer	Method
after	O
embedding	Method
layer	Method
.	O

DeepFM	Method
imposes	O
a	O
factorization	Method
machines	Method
as	O
”	O
wide	O
”	O
module	O
in	O
Wide	Method
&	O
Deep	O
with	O
no	O
need	O
of	O
feature	Method
engineering	Method
.	O

Overall	O
,	O
these	O
methods	O
follow	O
a	O
similar	O
model	Method
structure	Method
with	O
combination	O
of	O
embedding	Method
layer	Method
(	O
for	O
learning	O
the	O
dense	Task
representation	Task
of	Task
sparse	Task
features	Task
)	O
and	O
MLP	Method
(	O
for	O
learning	O
the	O
combination	O
relations	O
of	O
features	O
automatically	O
)	O
.	O

This	O
kind	O
of	O
CTR	Method
prediction	Method
model	Method
reduces	O
the	O
manual	Task
feature	Task
engineering	Task
jobs	Task
greatly	O
.	O

Our	O
base	O
model	O
follows	O
this	O
kind	O
of	O
model	O
structure	O
.	O

However	O
in	O
applications	O
with	O
rich	O
user	O
behaviors	O
,	O
features	O
are	O
often	O
contained	O
with	O
variable	O
-	O
length	O
list	O
of	O
ids	O
,	O
e.g.	O
,	O
searched	O
terms	O
or	O
watched	O
videos	O
in	O
YouTube	Method
recommender	Method
system	Method
.	O

These	O
models	O
often	O
transform	O
corresponding	O
list	O
of	O
embedding	Method
vectors	O
into	O
a	O
fixed	O
-	O
length	O
vector	O
via	O
sum	Method
/	Method
average	Method
pooling	Method
,	O
which	O
causes	O
loss	O
of	O
information	O
.	O

The	O
proposed	O
DIN	Method
tackles	O
it	O
by	O
adaptively	O
learning	O
the	O
representation	Method
vector	Method
w.r.t	Method
.	O

given	O
ad	O
,	O
improving	O
the	O
expressive	Metric
ability	Metric
of	O
model	O
.	O

Attention	Method
mechanism	Method
originates	O
from	O
Neural	Task
Machine	Task
Translation	Task
(	O
NMT	Task
)	O
field	O
.	O

NMT	Task
takes	O
a	O
weighted	O
sum	O
of	O
all	O
the	O
annotations	O
to	O
get	O
an	O
expected	O
annotation	O
and	O
focuses	O
only	O
on	O
information	O
relevant	O
to	O
the	O
generation	O
of	O
next	O
target	O
word	O
.	O

A	O
recent	O
work	O
,	O
DeepIntent	O
applies	O
attention	Task
in	O
the	O
context	O
of	O
search	Task
advertising	Task
.	O

Similar	O
to	O
NMT	Task
,	O
they	O
use	O
RNN	Method
to	O
model	O
text	O
,	O
then	O
learn	O
one	O
global	O
hidden	O
vector	O
to	O
help	O
paying	O
attention	O
on	O
the	O
key	O
words	O
in	O
each	O
query	O
.	O

It	O
is	O
shown	O
that	O
the	O
use	O
of	O
attention	O
can	O
help	O
capturing	O
the	O
main	O
intent	O
of	O
query	O
or	O
ad	O
.	O

DIN	Method
designs	O
a	O
local	Method
activation	Method
unit	Method
to	O
soft	O
-	O
search	O
for	O
relevant	O
user	O
behaviors	O
and	O
takes	O
a	O
weighted	Method
sum	Method
pooling	Method
to	O
obtain	O
the	O
adaptive	Task
representation	Task
of	Task
user	Task
interests	Task
with	O
respect	O
to	O
a	O
given	O
ad	O
.	O

The	O
user	O
representation	O
vector	O
varies	O
over	O
different	O
ads	O
,	O
which	O
is	O
different	O
from	O
DeepIntent	O
in	O
which	O
there	O
is	O
no	O
interaction	O
between	O
ad	O
and	O
user	O
.	O

We	O
make	O
code	O
publicly	O
available	O
,	O
and	O
further	O
show	O
how	O
to	O
successfully	O
deploy	O
DIN	Method
in	O
one	O
of	O
the	O
world	O
’s	O
largest	O
advertising	Task
systems	Task
with	O
novel	O
developed	O
techniques	O
for	O
training	O
large	Method
scale	Method
deep	Method
networks	Method
with	O
hundreds	O
of	O
millions	O
of	O
parameters	O
.	O

section	O
:	O
Background	O
In	O
e	Task
-	Task
commerce	Task
sites	Task
,	O
such	O
as	O
Alibaba	O
,	O
advertisements	O
are	O
natural	O
goods	O
.	O

In	O
the	O
rest	O
of	O
this	O
paper	O
,	O
without	O
special	O
declaration	O
,	O
we	O
regard	O
ads	O
as	O
goods	O
.	O

Figure	O
[	O
reference	O
]	O
briefly	O
illustrates	O
the	O
running	O
procedure	O
of	O
display	Method
advertising	Method
system	Method
in	O
Alibaba	Method
,	O
which	O
consists	O
of	O
two	O
main	O
stages	O
:	O
i	O
)	O
matching	Method
stage	O
which	O
generates	O
list	O
of	O
candidate	O
ads	O
relevant	O
to	O
the	O
visiting	O
user	O
via	O
methods	O
like	O
collaborative	Method
filtering	Method
,	O
ii	O
)	O
ranking	Method
stage	Method
which	O
predicts	O
CTR	Metric
for	O
each	O
given	O
ad	O
and	O
then	O
selects	O
top	O
ranked	O
ones	O
.	O

Everyday	O
,	O
hundreds	O
of	O
millions	O
of	O
users	O
visit	O
the	O
e	O
-	O
commerce	O
site	O
,	O
leaving	O
us	O
with	O
lots	O
of	O
user	O
behavior	O
data	O
which	O
contributes	O
critically	O
in	O
building	O
matching	Method
and	O
ranking	Method
models	Method
.	O

It	O
is	O
worth	O
mentioning	O
that	O
users	O
with	O
rich	O
historical	O
behaviors	O
contain	O
diverse	O
interests	O
.	O

For	O
example	O
,	O
a	O
young	O
mother	O
has	O
browsed	O
goods	O
including	O
woolen	O
coat	O
,	O
T	O
-	O
shits	O
,	O
earrings	O
,	O
tote	O
bag	O
,	O
leather	O
handbag	O
and	O
children	O
’s	O
coat	O
recently	O
.	O

These	O
behavior	O
data	O
give	O
us	O
hints	O
about	O
her	O
shopping	O
interests	O
.	O

When	O
she	O
visits	O
the	O
e	O
-	O
commerce	O
site	O
,	O
system	O
displays	O
a	O
suitable	O
ad	O
to	O
her	O
,	O
for	O
example	O
a	O
new	O
handbag	O
.	O

Obviously	O
the	O
displayed	O
ad	O
only	O
matches	O
or	O
activates	O
part	O
of	O
interests	O
of	O
this	O
mother	O
.	O

In	O
summary	O
,	O
interests	O
of	O
user	O
with	O
rich	O
behaviors	O
are	O
diverse	O
and	O
could	O
be	O
locally	O
activated	O
given	O
certain	O
ads	O
.	O

We	O
show	O
later	O
in	O
this	O
paper	O
making	O
use	O
of	O
these	O
characteristics	O
plays	O
important	O
role	O
for	O
building	O
CTR	Method
prediction	Method
model	Method
.	O

section	O
:	O
Deep	Method
Interest	Method
Network	Method
Different	O
from	O
sponsored	Task
search	Task
,	O
users	O
come	O
into	O
display	Method
advertising	Method
system	Method
without	O
explicitly	O
expressed	O
intentions	O
.	O

Effective	O
approaches	O
are	O
required	O
to	O
extract	O
user	O
interests	O
from	O
rich	O
historical	O
behaviors	O
when	O
building	O
the	O
CTR	Method
prediction	Method
model	Method
.	O

Features	O
that	O
depict	O
users	O
and	O
ads	O
are	O
the	O
basic	O
elements	O
in	O
the	O
CTR	Metric
modeling	O
of	O
advertisement	O
system	O
.	O

Making	O
use	O
of	O
these	O
features	O
reasonably	O
and	O
mining	O
information	O
from	O
them	O
are	O
critical	O
.	O

subsection	O
:	O
Feature	Method
Representation	Method
Data	O
in	O
industrial	O
CTR	Metric
prediction	O
tasks	O
is	O
mostly	O
in	O
a	O
multi	O
-	O
group	O
categorial	O
form	O
,	O
for	O
example	O
,	O
[	O
weekday	O
=	O
Friday	O
,	O
gender	O
=	O
Female	O
,	O
visited	O
cate	O
ids=	O
Bag	O
,	O
Book	O
,	O
ad	O
cate	O
i	O
d	O
=	O
Book	O
]	O
,	O
which	O
is	O
normally	O
transformed	O
into	O
high	O
-	O
dimensional	O
sparse	O
binary	O
features	O
via	O
encoding	Method
.	O

Mathematically	O
,	O
encoding	O
vector	O
of	O
i	O
-	O
th	O
feature	O
group	O
is	O
formularized	O
as	O
.	O

denotes	O
the	O
dimensionality	O
of	O
feature	O
group	O
,	O
which	O
means	O
feature	O
group	O
contains	O
unique	O
ids	O
.	O

is	O
the	O
j	O
-	O
th	O
element	O
of	O
and	O
.	O

.	O

Vector	Method
with	Method
refers	O
to	O
one	Method
-	Method
hot	Method
encoding	Method
and	O
refers	O
to	O
multi	Method
-	Method
hot	Method
encoding	Method
.	O

Then	O
one	O
instance	O
can	O
be	O
represent	O
as	O
in	O
a	O
group	O
-	O
wise	O
manner	O
,	O
where	O
is	O
number	O
of	O
feature	O
groups	O
,	O
,	O
is	O
dimensionality	O
of	O
the	O
entire	O
feature	O
space	O
.	O

In	O
this	O
way	O
,	O
the	O
aforementioned	O
instance	O
with	O
four	O
groups	O
of	O
features	O
are	O
illustrated	O
as	O
:	O
The	O
whole	O
feature	O
set	O
used	O
in	O
our	O
system	O
is	O
described	O
in	O
Table	O
[	O
reference	O
]	O
.	O

It	O
is	O
composed	O
of	O
four	O
categories	O
,	O
among	O
which	O
user	O
behavior	O
features	O
are	O
typically	O
multi	Method
-	Method
hot	Method
encoding	Method
vectors	O
and	O
contain	O
rich	O
information	O
of	O
user	O
interests	O
.	O

Note	O
that	O
in	O
our	O
setting	O
,	O
there	O
are	O
no	O
combination	O
features	O
.	O

We	O
capture	O
the	O
interaction	O
of	O
features	O
with	O
deep	Method
neural	Method
network	Method
.	O

subsection	O
:	O
Base	Method
Model	Method
(	O
Embedding	Method
&	O
MLP	Method
)	O
Most	O
of	O
the	O
popular	O
model	Method
structures	Method
share	O
a	O
similar	O
Embedding	Method
&	O
MLP	Method
paradigm	Method
,	O
which	O
we	O
refer	O
to	O
as	O
base	Method
model	Method
,	O
as	O
shown	O
in	O
the	O
left	O
of	O
Fig	O
.	O

[	O
reference	O
]	O
.	O

It	O
consists	O
of	O
several	O
parts	O
:	O
paragraph	O
:	O
Embedding	Method
layer	Method
As	O
the	O
inputs	O
are	O
high	O
dimensional	O
binary	O
vectors	O
,	O
embedding	Method
layer	Method
is	O
used	O
to	O
transform	O
them	O
into	O
low	Method
dimensional	Method
dense	Method
representations	Method
.	O

For	O
the	O
i	O
-	O
th	O
feature	O
group	O
of	O
,	O
let	O
represent	O
the	O
i	O
-	O
th	O
embedding	Method
dictionary	O
,	O
where	O
is	O
an	O
embedding	Method
vector	O
with	O
dimensionality	O
of	O
.	O

Embedding	Method
operation	O
follows	O
the	O
table	Method
lookup	Method
mechanism	Method
,	O
as	O
illustrated	O
in	O
Fig	O
.	O

[	O
reference	O
]	O
.	O

If	O
is	O
one	O
-	O
hot	O
vector	O
with	O
j	O
-	O
th	O
element	O
,	O
the	O
embedded	Method
representation	Method
of	O
is	O
a	O
single	O
embedding	Method
vector	O
.	O

If	O
is	O
multi	O
-	O
hot	O
vector	O
with	O
,	O
the	O
embedded	Method
representation	Method
of	O
is	O
a	O
list	O
of	O
embedding	Method
vectors	O
:	O
.	O

paragraph	O
:	O
Pooling	Method
layer	Method
and	O
Concat	Method
layer	Method
Notice	O
that	O
different	O
users	O
have	O
different	O
numbers	O
of	O
behaviors	O
.	O

Thus	O
the	O
number	O
of	O
non	O
-	O
zero	O
values	O
for	O
multi	O
-	O
hot	O
behavioral	O
feature	O
vector	O
varies	O
across	O
instances	O
,	O
causing	O
the	O
lengths	O
of	O
the	O
corresponding	O
list	O
of	O
embedding	Method
vectors	O
to	O
be	O
variable	O
.	O

As	O
fully	Method
connected	Method
networks	Method
can	O
only	O
handle	O
fixed	O
-	O
length	O
inputs	O
,	O
it	O
is	O
a	O
common	O
practice	O
to	O
transform	O
the	O
list	O
of	O
embedding	Method
vectors	O
via	O
a	O
pooling	Method
layer	Method
to	O
get	O
a	O
fixed	O
-	O
length	O
vector	O
:	O
Two	O
most	O
commonly	O
used	O
pooling	Method
layers	Method
are	O
sum	Method
pooling	Method
and	O
average	Method
pooling	Method
,	O
which	O
apply	O
element	Method
-	Method
wise	Method
sum	Method
/	Method
average	Method
operations	Method
to	O
the	O
list	O
of	O
embedding	Method
vectors	O
.	O

Both	O
embedding	Method
and	O
pooling	Method
layers	Method
operate	O
in	O
a	O
group	Method
-	Method
wise	Method
manner	Method
,	O
mapping	O
the	O
original	O
sparse	O
features	O
into	O
multiple	O
fixed	Method
-	Method
length	Method
representation	Method
vectors	O
.	O

Then	O
all	O
the	O
vectors	O
are	O
concatenated	O
together	O
to	O
obtain	O
the	O
overall	O
representation	O
vector	O
for	O
the	O
instance	O
.	O

paragraph	O
:	O
MLP	Method
Given	O
the	O
concatenated	O
dense	O
representation	O
vector	O
,	O
fully	O
connected	O
layers	O
are	O
used	O
to	O
learn	O
the	O
combination	O
of	O
features	O
automatically	O
.	O

Recently	O
developed	O
methods	O
focus	O
on	O
designing	O
structures	O
of	O
MLP	Method
for	O
better	O
information	Task
extraction	Task
.	O

paragraph	O
:	O
Loss	O
The	O
objective	Metric
function	Metric
used	O
in	O
base	Method
model	Method
is	O
the	O
negative	O
log	O
-	O
likelihood	O
function	O
defined	O
as	O
:	O
where	O
is	O
the	O
training	O
set	O
of	O
size	O
,	O
with	O
as	O
the	O
input	O
of	O
the	O
network	O
and	O
as	O
the	O
label	O
,	O
is	O
the	O
output	O
of	O
the	O
network	O
after	O
the	O
softmax	Method
layer	Method
,	O
representing	O
the	O
predicted	O
probability	O
of	O
sample	O
being	O
clicked	O
.	O

subsection	O
:	O
The	O
structure	O
of	O
Deep	Method
Interest	Method
Network	Method
Among	O
all	O
those	O
features	O
of	O
Table	O
[	O
reference	O
]	O
,	O
user	O
behavior	O
features	O
are	O
critically	O
important	O
and	O
play	O
key	O
roles	O
in	O
modeling	O
user	Task
interests	Task
in	O
the	O
scenario	O
of	O
e	Task
-	Task
commerce	Task
applications	Task
.	O

Base	Method
model	Method
obtains	O
a	O
fixed	Method
-	Method
length	Method
representation	Method
vector	O
of	O
user	O
interests	O
by	O
pooling	O
all	O
the	O
embedding	Method
vectors	O
over	O
the	O
user	O
behavior	O
feature	O
group	O
,	O
as	O
Eq	O
.	O

(	O
[	O
reference	O
]	O
)	O
.	O

This	O
representation	O
vector	O
stays	O
the	O
same	O
for	O
a	O
given	O
user	O
,	O
in	O
regardless	O
of	O
what	O
candidate	O
ads	O
are	O
.	O

In	O
this	O
way	O
,	O
the	O
user	O
representation	O
vector	O
with	O
a	O
limited	O
dimension	O
will	O
be	O
a	O
bottleneck	O
to	O
express	O
user	O
’s	O
diverse	O
interests	O
.	O

To	O
make	O
it	O
capable	O
enough	O
,	O
an	O
easy	O
method	O
is	O
to	O
expand	O
the	O
dimension	O
of	O
embedding	Method
vector	O
,	O
which	O
unfortunately	O
will	O
increase	O
the	O
size	O
of	O
learning	O
parameters	O
heavily	O
.	O

It	O
will	O
lead	O
to	O
overfitting	O
under	O
limited	O
training	O
data	O
and	O
add	O
the	O
burden	O
of	O
computation	Metric
and	O
storage	O
,	O
which	O
may	O
not	O
be	O
tolerated	O
for	O
an	O
industrial	Task
online	Task
system	Task
.	O

Is	O
there	O
an	O
elegant	O
way	O
to	O
represent	O
user	O
’s	O
diverse	O
interests	O
in	O
one	O
vector	O
under	O
limited	O
dimension	O
?	O
The	O
local	O
activation	O
characteristic	O
of	O
user	O
interests	O
gives	O
us	O
inspiration	O
to	O
design	O
a	O
novel	O
model	O
named	O
deep	Method
interest	Method
network	Method
(	O
DIN	Method
)	O
.	O

Imagine	O
when	O
the	O
young	O
mother	O
mentioned	O
above	O
in	O
section	O
[	O
reference	O
]	O
visits	O
the	O
e	O
-	O
commerce	O
site	O
,	O
she	O
finds	O
the	O
displayed	O
new	O
handbag	O
cute	O
and	O
clicks	O
it	O
.	O

Let	O
’s	O
dissect	O
the	O
driving	O
force	O
of	O
click	O
action	O
.	O

The	O
displayed	O
ad	O
hits	O
the	O
related	O
interests	O
of	O
this	O
young	O
mother	O
by	O
soft	O
-	O
searching	O
her	O
historical	O
behaviors	O
and	O
finding	O
that	O
she	O
had	O
browsed	O
similar	O
goods	O
of	O
tote	O
bag	O
and	O
leather	O
handbag	O
recently	O
.	O

In	O
other	O
words	O
,	O
behaviors	O
related	O
to	O
displayed	O
ad	O
greatly	O
contribute	O
to	O
the	O
click	O
action	O
.	O

DIN	Method
simulates	O
this	O
process	O
by	O
paying	O
attention	O
to	O
the	O
representation	O
of	O
locally	O
activated	O
interests	O
w.r.t	O
.	O

given	O
ad	O
.	O

Instead	O
of	O
expressing	O
all	O
user	O
’s	O
diverse	O
interests	O
with	O
the	O
same	O
vector	O
,	O
DIN	Method
adaptively	O
calculate	O
the	O
representation	O
vector	O
of	O
user	O
interests	O
by	O
taking	O
into	O
consideration	O
the	O
relevance	O
of	O
historical	O
behaviors	O
w.r.t	O
.	O

candidate	O
ad	O
.	O

This	O
representation	O
vector	O
varies	O
over	O
different	O
ads	O
.	O

The	O
right	O
part	O
of	O
Fig	O
.	O

[	O
reference	O
]	O
illustrates	O
the	O
architecture	O
of	O
DIN	Method
.	O

Compared	O
with	O
base	Method
model	Method
,	O
DIN	Method
introduces	O
a	O
novel	O
designed	O
local	Method
activation	Method
unit	Method
and	O
maintains	O
the	O
other	O
structures	O
the	O
same	O
.	O

Specifically	O
,	O
activation	O
units	O
are	O
applied	O
on	O
the	O
user	O
behavior	O
features	O
,	O
which	O
performs	O
as	O
a	O
weighted	Method
sum	Method
pooling	Method
to	O
adaptively	O
calculate	O
user	Method
representation	Method
given	O
a	O
candidate	O
ad	O
,	O
as	O
shown	O
in	O
Eq	O
.	O

(	O
[	O
reference	O
]	O
)	O
where	O
is	O
the	O
list	O
of	O
embedding	Method
vectors	O
of	O
behaviors	O
of	O
user	O
with	O
length	O
of	O
,	O
is	O
the	O
embedding	Method
vector	O
of	O
ad	O
.	O

In	O
this	O
way	O
,	O
varies	O
over	O
different	O
ads	O
.	O

is	O
a	O
feed	Method
-	Method
forward	Method
network	Method
with	O
output	O
as	O
the	O
activation	O
weight	O
,	O
as	O
illustrated	O
in	O
Fig	O
.	O

[	O
reference	O
]	O
.	O

Apart	O
from	O
the	O
two	O
input	O
embedding	Method
vectors	O
,	O
adds	O
the	O
out	O
product	O
of	O
them	O
to	O
feed	O
into	O
the	O
subsequent	O
network	O
,	O
which	O
is	O
an	O
explicit	O
knowledge	O
to	O
help	O
relevance	Task
modeling	Task
.	O

Local	Method
activation	Method
unit	Method
of	O
Eq	O
.	O

(	O
[	O
reference	O
]	O
)	O
shares	O
similar	O
ideas	O
with	O
attention	Method
methods	Method
which	O
are	O
developed	O
in	O
NMT	Task
task	O
.	O

However	O
different	O
from	O
traditional	O
attention	Method
method	Method
,	O
the	O
constraint	O
of	O
is	O
relaxed	O
in	O
Eq	O
.	O

(	O
[	O
reference	O
]	O
)	O
,	O
aiming	O
to	O
reserve	O
the	O
intensity	O
of	O
user	O
interests	O
.	O

That	O
is	O
,	O
normalization	O
with	O
softmax	O
on	O
the	O
output	O
of	O
is	O
abandoned	O
.	O

Instead	O
,	O
value	O
of	O
is	O
treated	O
as	O
an	O
approximation	O
of	O
the	O
intensity	O
of	O
activated	O
user	O
interests	O
to	O
some	O
degree	O
.	O

For	O
example	O
,	O
if	O
one	O
user	O
’s	O
historical	O
behaviors	O
contain	O
90	O
%	O
clothes	O
and	O
10	O
%	O
electronics	O
.	O

Given	O
two	O
candidate	O
ads	O
of	O
T	O
-	O
shirt	O
and	O
phone	O
,	O
T	O
-	O
shirt	O
activates	O
most	O
of	O
the	O
historical	O
behaviors	O
belonging	O
to	O
clothes	O
and	O
may	O
get	O
larger	O
value	O
of	O
(	O
higher	O
intensity	O
of	O
interest	O
)	O
than	O
phone	O
.	O

Traditional	O
attention	Method
methods	Method
lose	O
the	O
resolution	O
on	O
the	O
numerical	O
scale	O
of	O
by	O
normalizing	O
of	O
the	O
output	O
of	O
.	O

We	O
have	O
tried	O
LSTM	Method
to	O
model	O
user	O
historical	O
behavior	O
data	O
in	O
the	O
sequential	O
manner	O
.	O

But	O
it	O
shows	O
no	O
improvement	O
.	O

Different	O
from	O
text	O
which	O
is	O
under	O
the	O
constraint	O
of	O
grammar	O
in	O
NLP	Task
task	Task
,	O
the	O
sequence	O
of	O
user	O
historical	O
behaviors	O
may	O
contain	O
multiple	O
concurrent	O
interests	O
.	O

Rapid	O
jumping	O
and	O
sudden	O
ending	O
over	O
these	O
interests	O
causes	O
the	O
sequence	O
data	O
of	O
user	O
behaviors	O
to	O
seem	O
to	O
be	O
noisy	O
.	O

A	O
possible	O
direction	O
is	O
to	O
design	O
special	O
structures	O
to	O
model	O
such	O
data	O
in	O
a	O
sequence	O
way	O
.	O

We	O
leave	O
it	O
for	O
future	O
research	O
.	O

section	O
:	O
Training	O
Techniques	O
In	O
the	O
advertising	Task
system	Task
in	O
Alibaba	O
,	O
numbers	O
of	O
goods	O
and	O
users	O
scale	O
up	O
to	O
hundreds	O
of	O
millions	O
.	O

Practically	O
,	O
training	O
industrial	Method
deep	Method
networks	Method
with	O
large	O
scale	O
sparse	O
input	O
features	O
is	O
of	O
great	O
challenge	O
.	O

In	O
this	O
section	O
,	O
we	O
introduce	O
two	O
important	O
techniques	O
which	O
are	O
proven	O
to	O
be	O
helpful	O
in	O
practice	O
.	O

subsection	O
:	O
Mini	Task
-	Task
batch	Task
Aware	Task
Regularization	Task
Overfitting	Method
is	O
a	O
critical	O
challenge	O
for	O
training	Task
industrial	Task
networks	Task
.	O

For	O
example	O
,	O
with	O
addition	O
of	O
fine	O
-	O
grained	O
features	O
,	O
such	O
as	O
features	O
of	O
goods_ids	O
with	O
dimensionality	O
of	O
0.6	O
billion	O
(	O
including	O
of	O
user	O
and	O
of	O
ad	O
as	O
described	O
in	O
Table	O
[	O
reference	O
]	O
)	O
,	O
model	O
performance	O
falls	O
rapidly	O
after	O
the	O
first	O
epoch	O
during	O
training	O
without	O
regularization	Method
,	O
as	O
the	O
dark	O
green	O
line	O
shown	O
in	O
Fig	O
.	O

[	O
reference	O
]	O
in	O
later	O
section	O
[	O
reference	O
]	O
.	O

It	O
is	O
not	O
practical	O
to	O
directly	O
apply	O
traditional	O
regularization	Method
methods	O
,	O
such	O
as	O
and	O
regularization	Method
,	O
on	O
training	Method
networks	Method
with	O
sparse	O
inputs	O
and	O
hundreds	O
of	O
millions	O
of	O
parameters	O
.	O

Take	O
regularization	Method
as	O
an	O
example	O
.	O

Only	O
parameters	O
of	O
non	O
-	O
zero	O
sparse	O
features	O
appearing	O
in	O
each	O
mini	O
-	O
batch	O
needs	O
to	O
be	O
updated	O
in	O
the	O
scenario	O
of	O
SGD	Method
based	Method
optimization	Method
methods	Method
without	O
regularization	Method
.	O

However	O
,	O
when	O
adding	O
regularization	Method
it	O
needs	O
to	O
calculate	O
L2	O
-	O
norm	O
over	O
the	O
whole	O
parameters	O
for	O
each	O
mini	O
-	O
batch	O
,	O
which	O
leads	O
to	O
extremely	O
heavy	O
computations	O
and	O
is	O
unacceptable	O
with	O
parameters	O
scaling	O
up	O
to	O
hundreds	O
of	O
millions	O
.	O

In	O
this	O
paper	O
,	O
we	O
introduce	O
an	O
efficient	O
mini	Method
-	Method
batch	Method
aware	Method
regularizer	Method
,	O
which	O
only	O
calculates	O
the	O
L2	O
-	O
norm	O
over	O
the	O
parameters	O
of	O
sparse	O
features	O
appearing	O
in	O
each	O
mini	O
-	O
batch	O
and	O
makes	O
the	O
computation	O
possible	O
.	O

In	O
fact	O
,	O
it	O
is	O
the	O
embedding	Method
dictionary	O
that	O
contributes	O
most	O
of	O
the	O
parameters	O
for	O
CTR	Metric
networks	O
and	O
arises	O
the	O
difficulty	O
of	O
heavy	O
computation	O
.	O

Let	O
denote	O
parameters	O
of	O
the	O
whole	O
embedding	Method
dictionary	O
,	O
with	O
as	O
the	O
dimensionality	O
of	O
the	O
embedding	Method
vector	O
and	O
as	O
the	O
dimensionality	O
of	O
feature	O
space	O
.	O

Expand	O
the	O
regularization	Method
on	O
over	O
samples	O
where	O
is	O
the	O
-	O
th	O
embedding	Method
vector	O
,	O
denotes	O
if	O
the	O
instance	O
has	O
the	O
feature	O
i	O
d	O
,	O
and	O
denotes	O
the	O
number	O
of	O
occurrence	O
for	O
feature	O
i	O
d	O
in	O
all	O
samples	O
.	O

Eq	O
.	O

(	O
[	O
reference	O
]	O
)	O
can	O
be	O
transformed	O
into	O
Eq	O
.	O

(	O
[	O
reference	O
]	O
)	O
in	O
the	O
mini	Task
-	Task
batch	Task
aware	Task
manner	Task
where	O
denotes	O
the	O
number	O
of	O
mini	O
-	O
batches	O
,	O
denotes	O
the	O
-	O
th	O
mini	O
-	O
batch	O
.	O

Let	O
denote	O
if	O
there	O
is	O
at	O
least	O
one	O
instance	O
having	O
the	O
feature	O
i	O
d	O
in	O
mini	O
-	O
batch	O
.	O

Then	O
Eq	O
.	O

(	O
[	O
reference	O
]	O
)	O
can	O
be	O
approximated	O
by	O
In	O
this	O
way	O
,	O
we	O
derive	O
an	O
approximated	Method
mini	Method
-	Method
batch	Method
aware	Method
version	Method
of	Method
regularization	Method
.	O

For	O
the	O
-	O
th	O
mini	O
-	O
batch	O
,	O
the	O
gradient	O
w.r.t	O
.	O

the	O
embedding	Method
weights	O
of	O
feature	O
is	O
in	O
which	O
only	O
parameters	O
of	O
features	O
appearing	O
in	O
-	O
th	O
mini	O
-	O
batch	O
participate	O
in	O
the	O
computation	O
of	O
regularization	Method
.	O

subsection	O
:	O
Data	Method
Adaptive	Method
Activation	Method
Function	Method
PReLU	Method
is	O
a	O
commonly	O
used	O
activation	Method
function	Method
where	O
is	O
one	O
dimension	O
of	O
the	O
input	O
of	O
activation	Method
function	Method
and	O
is	O
an	O
indicator	Method
function	Method
which	O
controls	O
to	O
switch	O
between	O
two	O
channels	O
of	O
and	O
.	O

in	O
the	O
second	O
channel	O
is	O
a	O
learning	O
parameter	O
.	O

Here	O
we	O
refer	O
to	O
as	O
the	O
control	O
function	O
.	O

The	O
left	O
part	O
of	O
Fig	O
.	O

[	O
reference	O
]	O
plots	O
the	O
control	O
function	O
of	O
PReLU	Method
.	O

PReLU	Method
takes	O
a	O
hard	O
rectified	O
point	O
with	O
value	O
of	O
,	O
which	O
may	O
be	O
not	O
suitable	O
when	O
the	O
inputs	O
of	O
each	O
layer	O
follow	O
different	O
distributions	O
.	O

Take	O
this	O
into	O
consideration	O
,	O
we	O
design	O
a	O
novel	O
data	Method
adaptive	Method
activation	Method
function	Method
named	O
Dice	Method
,	O
with	O
the	O
control	O
function	O
to	O
be	O
plotted	O
in	O
the	O
right	O
part	O
of	O
Fig	O
.	O

[	O
reference	O
]	O
.	O

In	O
the	O
training	O
phrase	O
,	O
and	O
is	O
the	O
mean	O
and	O
variance	O
of	O
input	O
in	O
each	O
mini	O
-	O
batch	O
.	O

In	O
the	O
testing	O
phrase	O
,	O
and	O
is	O
calculated	O
by	O
moving	Method
averages	Method
and	O
over	O
data	O
.	O

is	O
a	O
small	O
constant	O
which	O
is	O
set	O
to	O
be	O
in	O
our	O
practice	O
.	O

Dice	Method
can	O
be	O
viewed	O
as	O
a	O
generalization	Method
of	Method
PReLu	Method
.	O

The	O
key	O
idea	O
of	O
Dice	Method
is	O
to	O
adaptively	O
adjust	O
the	O
rectified	O
point	O
according	O
to	O
distribution	O
of	O
input	O
data	O
,	O
whose	O
value	O
is	O
set	O
to	O
be	O
the	O
mean	O
of	O
input	O
.	O

Besides	O
,	O
Dice	Method
controls	O
smoothly	O
to	O
switch	O
between	O
the	O
two	O
channels	O
.	O

When	O
and	O
,	O
Dice	Method
degenerates	O
into	O
PReLU	O
.	O

section	O
:	O
Experiments	O
In	O
this	O
section	O
,	O
we	O
present	O
our	O
experiments	O
in	O
detail	O
,	O
including	O
datasets	O
,	O
evaluation	Metric
metric	Metric
,	O
experimental	O
setup	O
,	O
model	O
comparison	O
and	O
the	O
corresponding	O
analysis	O
.	O

Experiments	O
on	O
two	O
public	O
datasets	O
with	O
user	O
behaviors	O
as	O
well	O
as	O
a	O
dataset	O
collected	O
from	O
the	O
display	Method
advertising	Method
system	Method
in	O
Alibaba	O
demonstrate	O
the	O
effectiveness	O
of	O
proposed	O
approach	O
which	O
outperforms	O
state	O
-	O
of	O
-	O
the	O
-	O
art	O
methods	O
on	O
the	O
CTR	Task
prediction	Task
task	Task
.	O

Both	O
the	O
public	O
datasets	O
and	O
experiment	O
codes	O
are	O
made	O
available	O
.	O

subsection	O
:	O
Datasets	O
and	O
Experimental	O
Setup	O
Amazon	Material
Datasethttp:	O
//	O
jmcauley.ucsd.edu	O
/	O
data	O
/	O
amazon	O
/	O
.	O

Amazon	Material
Dataset	Material
contains	O
product	O
reviews	O
and	O
metadata	O
from	O
Amazon	Material
,	O
which	O
is	O
used	O
as	O
benchmark	O
dataset	O
.	O

We	O
conduct	O
experiments	O
on	O
a	O
subset	O
named	O
Electronics	O
,	O
which	O
contains	O
192	O
,	O
403	O
users	O
,	O
63	O
,	O
001	O
goods	O
,	O
801	O
categories	O
and	O
1	O
,	O
689	O
,	O
188	O
samples	O
.	O

User	O
behaviors	O
in	O
this	O
dataset	O
are	O
rich	O
,	O
with	O
more	O
than	O
5	O
reviews	O
for	O
each	O
users	O
and	O
goods	O
.	O

Features	O
include	O
goods_id	O
,	O
cate_id	O
,	O
user	O
reviewed	O
goods_id_list	O
and	O
cate_id_list	O
.	O

Let	O
all	O
behaviors	O
of	O
a	O
user	O
be	O
(	O
)	O
,	O
the	O
task	O
is	O
to	O
predict	O
the	O
(	O
k	O
+	O
1	O
)-	O
th	O
reviewed	O
goods	O
by	O
making	O
use	O
of	O
the	O
first	O
k	O
reviewed	O
goods	O
.	O

Training	O
dataset	O
is	O
generated	O
with	O
for	O
each	O
user	O
.	O

In	O
the	O
test	O
set	O
,	O
we	O
predict	O
the	O
last	O
one	O
given	O
the	O
first	O
reviewed	O
goods	O
.	O

For	O
all	O
models	O
,	O
we	O
use	O
SGD	Method
as	O
the	O
optimizer	Method
with	O
exponential	O
decay	O
,	O
in	O
which	O
learning	Metric
rate	Metric
starts	O
at	O
1	O
and	O
decay	Metric
rate	Metric
is	O
set	O
to	O
0.1	O
.	O

The	O
mini	O
-	O
batch	O
size	O
is	O
set	O
to	O
be	O
.	O

MovieLens	Material
Datasethttps:	O
//	O
grouplens.org	O
/	O
datasets	O
/	O
movielens	O
/	O
20m	O
/	O
.	O

MovieLens	Material
data	Material
contains	O
138	O
,	O
493	O
users	O
,	O
27	O
,	O
278	O
movies	O
,	O
21	O
categories	O
and	O
20	O
,	O
000	O
,	O
263	O
samples	O
.	O

To	O
make	O
it	O
suitable	O
for	O
CTR	Task
prediction	Task
task	Task
,	O
we	O
transform	O
it	O
into	O
a	O
binary	O
classification	O
data	O
.	O

Original	O
user	O
rating	O
of	O
the	O
movies	O
is	O
continuous	O
value	O
ranging	O
from	O
0	O
to	O
5	O
.	O

We	O
label	O
the	O
samples	O
with	O
rating	O
of	O
4	O
and	O
5	O
to	O
be	O
positive	O
and	O
the	O
rest	O
to	O
be	O
negative	O
.	O

We	O
segment	O
the	O
data	O
into	O
training	O
and	O
testing	O
dataset	O
based	O
on	O
userID	O
.	O

Among	O
all	O
138	O
,	O
493	O
users	O
,	O
of	O
which	O
100	O
,	O
000	O
are	O
randomly	O
selected	O
into	O
training	O
set	O
(	O
about	O
14	O
,	O
470	O
,	O
000	O
samples	O
)	O
and	O
the	O
rest	O
38	O
,	O
493	O
into	O
the	O
test	O
set	O
(	O
about	O
5	O
,	O
530	O
,	O
000	O
samples	O
)	O
.	O

The	O
task	O
is	O
to	O
predict	O
whether	O
user	O
will	O
rate	O
a	O
given	O
movie	O
to	O
be	O
above	O
3	O
(	O
positive	O
label	O
)	O
based	O
on	O
historical	O
behaviors	O
.	O

Features	O
include	O
movie_id	O
,	O
movie_cate_id	O
and	O
user	O
rated	O
movie_id_list	O
,	O
movie_cate_id_list	O
.	O

We	O
use	O
the	O
same	O
optimizer	Method
,	O
learning	Metric
rate	Metric
and	O
mini	Metric
-	Metric
batch	Metric
size	Metric
as	O
described	O
on	O
Amazon	Material
Dataset	Material
.	O

Alibaba	O
Dataset	O
.	O

We	O
collected	O
traffic	O
logs	O
from	O
the	O
online	Method
display	Method
advertising	Method
system	Method
in	O
Alibaba	O
,	O
of	O
which	O
two	O
weeks	O
’	O
samples	O
are	O
used	O
for	O
training	O
and	O
samples	O
of	O
the	O
following	O
day	O
for	O
testing	O
.	O

The	O
size	O
of	O
training	O
and	O
testing	O
set	O
is	O
about	O
2	O
billions	O
and	O
0.14	O
billion	O
respectively	O
.	O

For	O
all	O
the	O
deep	Method
models	Method
,	O
the	O
dimensionality	O
of	O
embedding	Method
vector	O
is	O
12	O
for	O
the	O
whole	O
16	O
groups	O
of	O
features	O
.	O

Layers	O
of	O
MLP	Method
is	O
set	O
by	O
.	O

Due	O
to	O
the	O
huge	O
size	O
of	O
data	O
,	O
we	O
set	O
the	O
mini	O
-	O
batch	O
size	O
to	O
be	O
5000	O
and	O
use	O
Adam	Method
as	O
the	O
optimizer	Method
.	O

We	O
apply	O
exponential	Method
decay	Method
,	O
in	O
which	O
learning	Metric
rate	Metric
starts	O
at	O
0.001	O
and	O
decay	Metric
rate	Metric
is	O
set	O
to	O
0.9	O
.	O

The	O
statistics	O
of	O
all	O
the	O
above	O
datasets	O
is	O
shown	O
in	O
Table	O
[	O
reference	O
]	O
.	O

Volume	O
of	O
Alibaba	O
Dataset	O
is	O
much	O
larger	O
than	O
both	O
Amazon	Material
and	O
MovieLens	Material
,	O
which	O
brings	O
more	O
challenges	O
.	O

For	O
MovieLens	Material
dataset	O
,	O
goods	O
refer	O
to	O
be	O
movies	O
.	O

subsection	O
:	O
Competitors	O
LR	O
[	O
]	O
.	O

Logistic	Method
regression	Method
(	Method
LR	Method
)	Method
is	O
a	O
widely	O
used	O
shallow	Method
model	Method
before	O
deep	Method
networks	Method
for	O
CTR	Task
prediction	Task
task	Task
.	O

We	O
implement	O
it	O
as	O
a	O
weak	O
baseline	O
.	O

BaseModel	Method
.	O

As	O
introduced	O
in	O
section	O
[	O
reference	O
]	O
,	O
BaseModel	Method
follows	O
the	O
Embedding	Method
&	O
MLP	Method
architecture	Method
and	O
is	O
the	O
base	O
of	O
most	O
of	O
subsequently	O
developed	O
deep	Method
networks	Method
for	O
CTR	Metric
modeling	O
.	O

It	O
acts	O
as	O
a	O
strong	O
baseline	O
for	O
our	O
model	O
comparison	O
.	O

Wide	Method
&	O
Deep	O
[	O
]	O
.	O

In	O
real	O
industrial	Task
applications	Task
,	O
Wide	Method
&	O
Deep	Method
model	Method
has	O
been	O
widely	O
accepted	O
.	O

It	O
consists	O
of	O
two	O
parts	O
:	O
i	O
)	O
wide	Method
model	Method
,	O
which	O
handles	O
the	O
manually	O
designed	O
cross	O
product	O
features	O
,	O
ii	O
)	O
deep	Method
model	Method
,	O
which	O
automatically	O
extracts	O
nonlinear	O
relations	O
among	O
features	O
and	O
equals	O
to	O
the	O
BaseModel	O
.	O

Wide	Method
&	O
Deep	O
needs	O
expertise	O
feature	Method
engineering	Method
on	O
the	O
input	O
of	O
the	O
”	O
wide	Method
”	Method
module	Method
.	O

We	O
follow	O
the	O
practice	O
in	O
to	O
take	O
cross	O
-	O
product	O
of	O
user	O
behaviors	O
and	O
candidates	O
as	O
wide	O
inputs	O
.	O

For	O
example	O
,	O
in	O
MovieLens	Material
dataset	O
,	O
it	O
refers	O
to	O
the	O
cross	O
-	O
product	O
of	O
user	O
rated	O
movies	O
and	O
candidate	O
movies	O
.	O

PNN	Method
[]	O
.	O

PNN	Method
can	O
be	O
viewed	O
as	O
an	O
improved	O
version	O
of	O
BaseModel	Method
by	O
introducing	O
a	O
product	Method
layer	Method
after	O
embedding	Method
layer	Method
to	O
capture	O
high	O
-	O
order	O
feature	O
interactions	O
.	O

DeepFM	Method
[	O
]	O
.	O

It	O
imposes	O
a	O
factorization	O
machines	O
as	O
”	O
wide	O
”	O
module	O
in	O
Wide	Method
&	O
Deep	O
saving	O
feature	O
engineering	O
jobs	O
.	O

subsection	O
:	O
Metrics	O
In	O
CTR	Metric
prediction	O
field	O
,	O
AUC	Metric
is	O
a	O
widely	O
used	O
metric	O
.	O

It	O
measures	O
the	O
goodness	O
of	O
order	O
by	O
ranking	O
all	O
the	O
ads	O
with	O
predicted	O
CTR	Metric
,	O
including	O
intra	O
-	O
user	O
and	O
inter	O
-	O
user	O
orders	O
.	O

An	O
variation	O
of	O
user	Metric
weighted	Metric
AUC	Metric
is	O
introduced	O
in	O
which	O
measures	O
the	O
goodness	O
of	O
intra	O
-	O
user	O
order	O
by	O
averaging	O
AUC	Metric
over	O
users	O
and	O
is	O
shown	O
to	O
be	O
more	O
relevant	O
to	O
online	O
performance	O
in	O
display	Method
advertising	Method
system	Method
.	O

We	O
adapt	O
this	O
metric	O
in	O
our	O
experiments	O
.	O

For	O
simplicity	O
,	O
we	O
still	O
refer	O
it	O
as	O
AUC	Metric
.	O

It	O
is	O
calculated	O
as	O
follows	O
:	O
where	O
is	O
the	O
number	O
of	O
users	O
,	O
and	O
are	O
the	O
number	O
of	O
impressions	O
and	O
AUC	Metric
corresponding	O
to	O
the	O
-	O
th	O
user	O
.	O

Besides	O
,	O
we	O
follow	O
to	O
introduce	O
RelaImpr	Metric
metric	Metric
to	O
measure	O
relative	Metric
improvement	Metric
over	O
models	O
.	O

For	O
a	O
random	Method
guesser	Method
,	O
the	O
value	O
of	O
AUC	Metric
is	O
.	O

Hence	O
RelaImpr	Method
is	O
defined	O
as	O
below	O
:	O
Other	O
lines	O
except	O
LR	Method
use	O
PReLU	O
as	O
activation	Method
function	Method
.	O

subsection	O
:	O
Result	O
from	O
model	O
comparison	O
on	O
Amazon	Material
Dataset	Material
and	O
MovieLens	Material
Dataset	O
Table	O
[	O
reference	O
]	O
shows	O
the	O
results	O
on	O
Amazon	Material
dataset	O
and	O
MovieLens	Material
dataset	O
.	O

All	O
experiments	O
are	O
repeated	O
5	O
times	O
and	O
averaged	O
results	O
are	O
reported	O
.	O

The	O
influence	O
of	O
random	O
initialization	O
on	O
AUC	Metric
is	O
less	O
than	O
0.0002	O
.	O

Obviously	O
,	O
all	O
the	O
deep	Method
networks	Method
beat	O
LR	Method
model	Method
significantly	O
,	O
which	O
indeed	O
demonstrates	O
the	O
power	O
of	O
deep	Method
learning	Method
.	O

PNN	Method
and	O
DeepFM	Method
with	O
specially	O
designed	O
structures	O
preform	O
better	O
than	O
Wide	Method
&	O
Deep	O
.	O

DIN	Method
performs	O
best	O
among	O
all	O
the	O
competitors	O
.	O

Especially	O
on	O
Amazon	Material
Dataset	Material
with	O
rich	O
user	O
behaviors	O
,	O
DIN	Method
stands	O
out	O
significantly	O
.	O

We	O
owe	O
this	O
to	O
the	O
design	O
of	O
local	Method
activation	Method
unit	Method
structure	O
in	O
DIN	Method
.	O

DIN	Method
pays	O
attentions	O
to	O
the	O
locally	O
related	O
user	O
interests	O
by	O
soft	O
-	O
searching	O
for	O
parts	O
of	O
user	O
behaviors	O
that	O
are	O
relevant	O
to	O
candidate	O
ad	O
.	O

With	O
this	O
mechanism	O
,	O
DIN	Method
obtains	O
an	O
adaptively	O
varying	O
representation	O
of	O
user	O
interests	O
,	O
greatly	O
improving	O
the	O
expressive	Metric
ability	Metric
of	O
model	O
compared	O
with	O
other	O
deep	Method
networks	Method
.	O

Besides	O
,	O
DIN	Method
with	O
Dice	Method
brings	O
further	O
improvement	O
over	O
DIN	Method
,	O
which	O
verifies	O
the	O
effectiveness	O
of	O
the	O
proposed	O
data	Method
adaptive	Method
activation	Method
function	Method
Dice	Method
.	O

subsection	O
:	O
Performance	O
of	O
regularization	Method
As	O
the	O
dimension	O
of	O
features	O
in	O
both	O
Amazon	Material
Dataset	Material
and	O
MovieLens	Material
Dataset	O
is	O
not	O
high	O
(	O
about	O
0.1	O
million	O
)	O
,	O
all	O
the	O
deep	Method
models	Method
including	O
our	O
proposed	O
DIN	Method
do	O
not	O
meet	O
grave	O
problem	O
of	O
overfitting	O
.	O

However	O
,	O
when	O
it	O
comes	O
to	O
the	O
Alibaba	O
dataset	O
from	O
the	O
online	Task
advertising	Task
system	Task
which	O
contains	O
higher	O
dimensional	O
sparse	O
features	O
,	O
overfitting	O
turns	O
to	O
be	O
a	O
big	O
challenge	O
.	O

For	O
example	O
,	O
when	O
training	O
deep	Method
models	Method
with	O
fine	O
-	O
grained	O
features	O
(	O
e.g.	O
,	O
features	O
of	O
with	O
dimension	O
of	O
0.6	O
billion	O
in	O
Table	O
[	O
reference	O
]	O
)	O
,	O
serious	O
overfitting	O
occurs	O
after	O
the	O
first	O
epoch	O
without	O
any	O
regularization	Method
,	O
which	O
causes	O
the	O
model	O
performance	O
to	O
drop	O
rapidly	O
,	O
as	O
the	O
dark	O
green	O
line	O
shown	O
in	O
Fig	O
.	O

[	O
reference	O
]	O
.	O

For	O
this	O
reason	O
,	O
we	O
conduct	O
careful	O
experiments	O
to	O
check	O
the	O
performance	O
of	O
several	O
commonly	O
used	O
regularizations	Method
.	O

Dropout	Method
[	O
]	O
.	O

Randomly	O
discard	O
of	O
feature	O
ids	O
in	O
each	O
sample	O
.	O

Filter	Method
.	O

Filter	O
visited	O
by	O
occurrence	O
frequency	O
in	O
samples	O
and	O
leave	O
only	O
the	O
most	O
frequent	O
ones	O
.	O

In	O
our	O
setting	O
,	O
top	O
million	O
are	O
left	O
.	O

Regularization	Method
in	O
DiFacto	O
[	O
]	O
.	O

Parameters	O
associated	O
with	O
frequent	O
features	O
are	O
less	O
over	O
-	O
regularized	O
.	O

MBA	Method
.	O

Our	O
proposed	O
M	O
ini	O
-	O
B	O
atch	O
A	O
ware	O
regularization	Method
method	O
(	O
Eq	O
.	O

[	O
reference	O
]	O
)	O
.	O

Regularization	O
parameter	O
for	O
both	O
DiFacto	Method
and	O
MBA	Method
is	O
searched	O
and	O
set	O
to	O
be	O
.	O

Fig	O
.	O

[	O
reference	O
]	O
and	O
Table	O
[	O
reference	O
]	O
give	O
the	O
comparison	O
results	O
.	O

Focusing	O
on	O
the	O
detail	O
of	O
Fig	O
.	O

[	O
reference	O
]	O
,	O
model	O
trained	O
with	O
fine	O
-	O
grained	O
features	O
brings	O
large	O
improvement	O
on	O
the	O
test	O
AUC	Metric
performance	O
in	O
the	O
first	O
epoch	O
,	O
compared	O
without	O
it	O
.	O

However	O
,	O
overfitting	O
occurs	O
rapidly	O
in	O
the	O
case	O
of	O
training	O
without	O
regularization	Method
(	O
dark	O
green	O
line	O
)	O
.	O

Dropout	Method
prevents	O
quick	O
overfitting	O
but	O
causes	O
slower	O
convergence	Metric
.	O

Frequency	Method
filter	Method
relieves	O
overfitting	O
to	O
a	O
degree	O
.	O

Regularization	Method
in	O
DiFacto	Method
sets	O
a	O
greater	O
penalty	O
on	O
with	O
high	O
frequency	O
,	O
which	O
performs	O
worse	O
than	O
frequency	Method
filter	Method
.	O

Our	O
proposed	O
mini	O
-	O
batch	O
aware	O
(	O
MBA	O
)	O
regularization	Method
performs	O
best	O
compared	O
with	O
all	O
the	O
other	O
methods	O
,	O
which	O
prevents	O
overfitting	O
significantly	O
.	O

Besides	O
,	O
well	O
trained	O
models	O
with	O
features	O
show	O
better	O
AUC	Metric
performance	O
than	O
without	O
them	O
.	O

This	O
is	O
duo	O
to	O
the	O
richer	O
information	O
that	O
fine	O
-	O
grained	O
features	O
contained	O
.	O

Considering	O
this	O
,	O
although	O
frequency	Method
filter	Method
performs	O
slightly	O
better	O
than	O
dropout	Method
,	O
it	O
throws	O
away	O
most	O
of	O
low	O
frequent	O
ids	O
and	O
may	O
lose	O
room	O
for	O
models	O
to	O
make	O
better	O
use	O
of	O
fine	O
-	O
grained	O
features	O
.	O

subsection	O
:	O
Result	O
from	O
model	O
comparison	O
on	O
Alibaba	O
Dataset	O
Table	O
[	O
reference	O
]	O
shows	O
the	O
experimental	O
results	O
on	O
Alibaba	O
dataset	O
with	O
full	O
feature	O
sets	O
as	O
shown	O
in	O
Table	O
[	O
reference	O
]	O
.	O

As	O
expected	O
,	O
LR	Method
is	O
proven	O
to	O
be	O
much	O
weaker	O
than	O
deep	Method
models	Method
.	O

Making	O
comparisons	O
among	O
deep	Method
models	Method
,	O
we	O
report	O
several	O
conclusions	O
.	O

First	O
,	O
under	O
the	O
same	O
activation	Method
function	Method
and	O
regularization	Method
,	O
DIN	Method
itself	O
has	O
achieved	O
superior	O
performance	O
compared	O
with	O
all	O
the	O
other	O
deep	Method
networks	Method
including	O
BaseModel	Method
,	O
Wide	Method
&	O
Deep	O
,	O
PNN	Method
and	O
DeepFM	Method
.	O

DIN	Method
achieves	O
0.0059	O
absolute	O
AUC	Metric
gain	O
and	O
RelaImpr	Method
over	O
BaseModel	Method
.	O

It	O
validates	O
again	O
the	O
useful	O
design	O
of	O
local	Method
activation	Method
unit	Method
structure	Method
.	O

Second	O
,	O
ablation	O
study	O
based	O
on	O
DIN	Method
demonstrates	O
the	O
effectiveness	O
of	O
our	O
proposed	O
training	Method
techniques	Method
.	O

Training	O
DIN	Method
with	O
mini	Method
-	Method
batch	Method
aware	Method
regularizer	Method
brings	O
additional	O
0.0031	O
absolute	O
AUC	Metric
gain	O
over	O
dropout	Method
.	O

Besides	O
,	O
DIN	Method
with	O
Dice	Method
brings	O
additional	O
0.0015	O
absolute	O
AUC	Metric
gain	O
over	O
PReLU	Method
.	O

Taken	O
together	O
,	O
DIN	Method
with	O
MBA	O
regularization	Method
and	O
Dice	Method
achieves	O
total	O
RelaImpr	Metric
and	O
0.0113	O
absolute	O
AUC	Metric
gain	O
over	O
BaseModel	O
.	O

Even	O
compared	O
with	O
competitor	O
DeepFM	Method
which	O
performs	O
best	O
on	O
this	O
dataset	O
,	O
DIN	Method
still	O
achieves	O
0.009	O
absolute	O
AUC	Metric
gain	O
.	O

It	O
is	O
notable	O
that	O
in	O
commercial	Task
advertising	Task
systems	Task
with	O
hundreds	O
of	O
millions	O
of	O
traffics	O
,	O
0.001	O
absolute	O
AUC	Metric
gain	O
is	O
significant	O
and	O
worthy	O
of	O
model	O
deployment	O
empirically	O
.	O

DIN	Method
shows	O
great	O
superiority	O
to	O
better	O
understand	O
and	O
make	O
use	O
of	O
the	O
characteristics	O
of	O
user	O
behavior	O
data	O
.	O

Besides	O
,	O
the	O
two	O
proposed	O
techniques	O
further	O
improve	O
model	O
performance	O
and	O
provide	O
powerful	O
help	O
for	O
training	O
large	O
scale	O
industrial	Method
deep	Method
networks	Method
.	O

These	O
lines	O
are	O
trained	O
with	O
PReLU	Method
as	O
the	O
activation	Method
function	Method
.	O

These	O
lines	O
are	O
trained	O
with	O
dropout	Method
regularization	Method
.	O

subsection	O
:	O
Result	O
from	O
online	Task
A	Task
/	Task
B	Task
testing	Task
Careful	O
online	Task
A	Task
/	Task
B	Task
testing	Task
in	O
the	O
display	Method
advertising	Method
system	Method
in	O
Alibaba	O
was	O
conducted	O
from	O
2017	O
-	O
05	O
to	O
2017	O
-	O
06	O
.	O

During	O
almost	O
a	O
month	O
’s	O
testing	O
,	O
DIN	Method
trained	O
with	O
the	O
proposed	O
regularizer	Method
and	Method
activation	Method
function	Method
contributes	O
up	O
to	O
10.0	O
%	O
CTR	Metric
and	O
3.8	O
%	O
RPM	Metric
(	O
Revenue	Metric
Per	Metric
Mille	Metric
)	O
promotion	O
compared	O
with	O
the	O
introduced	O
BaseModel	O
,	O
the	O
last	O
version	O
of	O
our	O
online	Method
-	Method
serving	Method
model	Method
.	O

This	O
is	O
a	O
significant	O
improvement	O
and	O
demonstrates	O
the	O
effectiveness	O
of	O
our	O
proposed	O
approaches	O
.	O

Now	O
DIN	Method
has	O
been	O
deployed	O
online	O
and	O
serves	O
the	O
main	O
traffic	O
.	O

It	O
is	O
worth	O
mentioning	O
that	O
online	O
serving	O
of	O
industrial	Method
deep	Method
networks	Method
is	O
not	O
an	O
easy	O
job	O
with	O
hundreds	O
of	O
millions	O
of	O
users	O
visiting	O
our	O
system	O
everyday	O
.	O

Even	O
worse	O
,	O
at	O
traffic	O
peak	O
our	O
system	O
serves	O
more	O
than	O
1	O
million	O
users	O
per	O
second	O
.	O

It	O
is	O
required	O
to	O
make	O
realtime	O
CTR	Metric
predictions	O
with	O
high	O
throughput	Metric
and	O
low	Metric
latency	Metric
.	O

For	O
example	O
,	O
in	O
our	O
real	O
system	O
we	O
need	O
to	O
predict	O
hundreds	O
of	O
ads	O
for	O
each	O
visitor	O
in	O
less	O
than	O
10	O
milliseconds	O
.	O

In	O
our	O
practice	O
,	O
several	O
important	O
techniques	O
are	O
deployed	O
for	O
accelerating	O
online	O
serving	O
of	O
industrial	Method
deep	Method
networks	Method
under	O
the	O
CPU	Method
-	Method
GPU	Method
architecture	Method
:	O
i	O
)	O
request	Method
batching	Method
which	O
merges	O
adjacent	O
requests	O
from	O
CPU	O
to	O
take	O
advantage	O
of	O
GPU	O
power	O
,	O
ii	O
)	O
GPU	Method
memory	Method
optimization	Method
which	O
improves	O
the	O
access	O
pattern	O
to	O
reduce	O
wasted	O
transactions	O
in	O
GPU	O
memory	O
,	O
iii	O
)	O
concurrent	Method
kernel	Method
computation	Method
which	O
allows	O
execution	O
of	O
matrix	Task
computations	Task
to	O
be	O
processed	O
with	O
multiple	O
CUDA	Method
kernels	Method
concurrently	O
.	O

In	O
all	O
,	O
optimization	Task
of	O
these	O
techniques	O
doubles	O
the	O
QPS	Metric
(	O
Query	Metric
Per	Metric
Second	Metric
)	O
capacity	O
of	O
a	O
single	O
machine	O
practically	O
.	O

Online	O
serving	O
of	O
DIN	Method
also	O
benefits	O
from	O
this	O
.	O

subsection	O
:	O
Visualization	O
of	O
DIN	Method
Finally	O
we	O
conduct	O
case	O
study	O
to	O
reveal	O
the	O
inner	O
structure	O
of	O
DIN	Method
on	O
Alibaba	O
dataset	O
.	O

We	O
first	O
examine	O
the	O
effectiveness	O
of	O
local	Method
activation	Method
unit	Method
.	O

Fig	O
.	O

[	O
reference	O
]	O
illustrates	O
the	O
activation	O
intensity	O
of	O
user	O
behaviors	O
with	O
respect	O
to	O
a	O
candidate	O
ad	O
.	O

As	O
expected	O
,	O
behaviors	O
with	O
high	O
relevance	O
to	O
candidate	O
ad	O
are	O
weighted	O
high	O
.	O

We	O
then	O
visualize	O
the	O
learned	O
embedding	Method
vectors	O
.	O

Taking	O
the	O
young	O
mother	O
mentioned	O
before	O
as	O
example	O
,	O
we	O
randomly	O
select	O
9	O
categories	O
(	O
dress	O
,	O
sport	O
shoes	O
,	O
bags	O
,	O
etc	O
)	O
and	O
100	O
goods	O
of	O
each	O
category	O
as	O
the	O
candidate	O
ads	O
for	O
her	O
.	O

Fig	O
.	O

[	O
reference	O
]	O
shows	O
the	O
visualization	O
of	O
embedding	Method
vectors	O
of	O
goods	O
with	O
t	Method
-	Method
SNE	Method
learned	O
by	O
DIN	Method
,	O
in	O
which	O
points	O
with	O
same	O
shape	O
correspond	O
to	O
the	O
same	O
category	O
.	O

We	O
can	O
see	O
that	O
goods	O
with	O
same	O
category	O
almost	O
belong	O
to	O
one	O
cluster	O
,	O
which	O
shows	O
the	O
clustering	Metric
property	Metric
of	O
DIN	Method
embeddings	O
clearly	O
.	O

Besides	O
,	O
we	O
color	O
the	O
points	O
that	O
represent	O
candidate	O
ads	O
by	O
the	O
prediction	O
value	O
.	O

Fig	O
.	O

[	O
reference	O
]	O
is	O
also	O
a	O
heat	Method
map	Method
of	O
this	O
mother	O
’s	O
interest	Method
density	Method
distribution	Method
for	O
potential	O
candidates	O
in	O
embedding	Method
space	O
.	O

It	O
shows	O
DIN	Method
can	O
form	O
a	O
multimodal	O
interest	Method
density	Method
distribution	Method
in	O
candidates	O
’	O
embedding	Method
space	O
for	O
a	O
certain	O
user	O
to	O
capture	O
his	O
/	O
her	O
diverse	O
interests	O
.	O

section	O
:	O
Conclusions	O
In	O
this	O
paper	O
,	O
we	O
focus	O
on	O
the	O
task	O
of	O
CTR	Metric
prediction	O
modeling	O
in	O
the	O
scenario	O
of	O
display	Task
advertising	Task
in	O
e	Task
-	Task
commerce	Task
industry	Task
with	O
rich	O
user	O
behavior	O
data	O
.	O

The	O
use	O
of	O
fixed	Method
-	Method
length	Method
representation	Method
in	O
traditional	O
deep	O
CTR	Metric
models	O
is	O
a	O
bottleneck	O
for	O
capturing	O
the	O
diversity	O
of	O
user	O
interests	O
.	O

To	O
improve	O
the	O
expressive	O
ability	O
of	O
model	O
,	O
a	O
novel	O
approach	O
named	O
DIN	Method
is	O
designed	O
to	O
activate	O
related	O
user	O
behaviors	O
and	O
obtain	O
an	O
adaptive	Method
representation	Method
vector	Method
for	O
user	O
interests	O
which	O
varies	O
over	O
different	O
ads	O
.	O

Besides	O
two	O
novel	O
techniques	O
are	O
introduced	O
to	O
help	O
training	O
industrial	Method
deep	Method
networks	Method
and	O
further	O
improve	O
the	O
performance	O
of	O
DIN	Method
.	O

They	O
can	O
be	O
easily	O
generalized	O
to	O
other	O
industrial	O
deep	Method
learning	Method
tasks	O
.	O

DIN	Method
now	O
has	O
been	O
deployed	O
in	O
the	O
online	Method
display	Method
advertising	Method
system	Method
in	O
Alibaba	O
.	O

bibliography	O
:	O
References	O
