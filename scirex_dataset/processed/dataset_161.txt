document	O
:	O
Optical	Task
Flow	Task
Estimation	Task
using	O
a	O
Spatial	Method
Pyramid	Method
Network	Method
We	O
learn	O
to	O
compute	O
optical	Task
flow	Task
by	O
combining	O
a	O
classical	O
spatial	Method
-	Method
pyramid	Method
formulation	Method
with	O
deep	Method
learning	Method
.	O

This	O
estimates	O
large	O
motions	O
in	O
a	O
coarse	O
-	O
to	O
-	O
fine	Method
approach	Method
by	O
warping	O
one	O
image	O
of	O
a	O
pair	O
at	O
each	O
pyramid	O
level	O
by	O
the	O
current	O
flow	Method
estimate	Method
and	O
computing	O
an	O
update	O
to	O
the	O
flow	O
.	O

Instead	O
of	O
the	O
standard	O
minimization	O
of	O
an	O
objective	O
function	O
at	O
each	O
pyramid	O
level	O
,	O
we	O
train	O
one	O
deep	Method
network	Method
per	O
level	O
to	O
compute	O
the	O
flow	Method
update	Method
.	O

Unlike	O
the	O
recent	O
FlowNet	Method
approach	Method
,	O
the	O
networks	O
do	O
not	O
need	O
to	O
deal	O
with	O
large	O
motions	O
;	O
these	O
are	O
dealt	O
with	O
by	O
the	O
pyramid	Method
.	O

This	O
has	O
several	O
advantages	O
.	O

First	O
,	O
our	O
Spatial	Method
Pyramid	Method
Network	Method
(	O
SPyNet	Method
)	O
is	O
much	O
simpler	O
and	O
96	O
%	O
smaller	O
than	O
FlowNet	Method
in	O
terms	O
of	O
model	O
parameters	O
.	O

This	O
makes	O
it	O
more	O
efficient	O
and	O
appropriate	O
for	O
embedded	Task
applications	Task
.	O

Second	O
,	O
since	O
the	O
flow	O
at	O
each	O
pyramid	O
level	O
is	O
small	O
(	O
pixel	O
)	O
,	O
a	O
convolutional	Method
approach	Method
applied	O
to	O
pairs	O
of	O
warped	O
images	O
is	O
appropriate	O
.	O

Third	O
,	O
unlike	O
FlowNet	Method
,	O
the	O
learned	O
convolution	Method
filters	Method
appear	O
similar	O
to	O
classical	O
spatio	Method
-	Method
temporal	Method
filters	Method
,	O
giving	O
insight	O
into	O
the	O
method	O
and	O
how	O
to	O
improve	O
it	O
.	O

Our	O
results	O
are	O
more	O
accurate	O
than	O
FlowNet	Method
on	O
most	O
standard	O
benchmarks	O
,	O
suggesting	O
a	O
new	O
direction	O
of	O
combining	O
classical	Method
flow	Method
methods	Method
with	O
deep	Method
learning	Method
.	O

section	O
:	O
Introduction	O
Recent	O
years	O
have	O
seen	O
significant	O
progress	O
on	O
the	O
problem	O
of	O
accurately	Task
estimating	Task
optical	Task
flow	Task
,	O
as	O
evidenced	O
by	O
improving	O
performance	O
on	O
increasingly	O
challenging	O
benchmarks	O
.	O

Despite	O
this	O
,	O
most	O
flow	Method
methods	Method
are	O
derived	O
from	O
a	O
“	O
classical	Method
formulation	Method
”	O
that	O
makes	O
a	O
variety	O
of	O
assumptions	O
about	O
the	O
image	O
,	O
from	O
brightness	O
constancy	O
to	O
spatial	O
smoothness	O
.	O

These	O
assumptions	O
are	O
only	O
coarse	O
approximations	O
to	O
reality	O
and	O
this	O
likely	O
limits	O
performance	O
.	O

The	O
recent	O
history	O
of	O
the	O
field	O
has	O
focused	O
on	O
improving	O
these	O
assumptions	O
or	O
making	O
them	O
more	O
robust	O
to	O
violations	O
.	O

This	O
has	O
led	O
to	O
steady	O
but	O
incremental	O
progress	O
.	O

An	O
alternative	O
approach	O
abandons	O
the	O
classical	O
formulation	O
altogether	O
and	O
starts	O
over	O
using	O
recent	O
neural	Method
network	Method
architectures	Method
.	O

Such	O
an	O
approach	O
takes	O
a	O
pair	O
(	O
or	O
sequence	O
)	O
of	O
images	O
and	O
learns	O
to	O
directly	O
compute	O
flow	O
from	O
them	O
.	O

Ideally	O
such	O
a	O
network	O
would	O
learn	O
to	O
solve	O
the	O
correspondence	Task
problem	Task
(	O
short	O
and	O
long	O
range	O
)	O
,	O
learn	O
filters	O
relevant	O
to	O
the	O
problem	O
,	O
learn	O
what	O
is	O
constant	O
in	O
the	O
sequence	O
,	O
and	O
learn	O
about	O
the	O
spatial	O
structure	O
of	O
the	O
flow	O
and	O
how	O
it	O
relates	O
to	O
the	O
image	O
structure	O
.	O

The	O
first	O
attempts	O
are	O
promising	O
but	O
are	O
not	O
yet	O
as	O
accurate	O
as	O
the	O
classical	O
methods	O
.	O

Goal	O
.	O

We	O
argue	O
that	O
there	O
is	O
an	O
alternative	O
approach	O
that	O
combines	O
the	O
best	O
of	O
both	O
approaches	O
.	O

Decades	O
of	O
research	O
on	O
flow	Task
has	O
produced	O
well	O
engineered	O
systems	O
and	O
principles	O
that	O
are	O
effective	O
.	O

But	O
there	O
are	O
places	O
where	O
these	O
methods	O
make	O
assumptions	O
that	O
limit	O
their	O
performance	O
.	O

Consequently	O
,	O
here	O
we	O
apply	O
machine	Method
learning	Method
to	O
address	O
the	O
weak	O
points	O
,	O
while	O
keeping	O
the	O
engineered	Method
architecture	Method
,	O
with	O
the	O
goal	O
of	O
1	O
)	O
improving	O
performance	O
over	O
existing	O
neural	Method
networks	Method
and	O
the	O
classical	O
methods	O
upon	O
which	O
our	O
work	O
is	O
based	O
;	O
2	O
)	O
achieving	O
real	Task
-	Task
time	Task
flow	Task
estimates	Task
with	O
accuracy	Metric
better	O
than	O
the	O
much	O
slower	O
classical	O
methods	O
;	O
and	O
3	O
)	O
reducing	O
memory	Metric
requirements	Metric
to	O
make	O
flow	Task
more	O
practical	O
for	O
embedded	Task
,	Task
robotic	Task
,	Task
and	Task
mobile	Task
applications	Task
.	O

Problem	O
.	O

The	O
key	O
problem	O
with	O
recent	O
methods	O
for	O
learning	Task
flow	Task
is	O
that	O
they	O
typically	O
take	O
two	O
frames	O
,	O
stack	O
them	O
together	O
,	O
and	O
apply	O
a	O
convolutional	Method
network	Method
architecture	Method
.	O

When	O
the	O
motions	O
between	O
frames	O
are	O
larger	O
than	O
one	O
(	O
or	O
a	O
few	O
)	O
pixels	O
,	O
spatio	Method
-	Method
temporal	Method
convolutional	Method
filters	Method
will	O
not	O
obtain	O
meaningful	O
responses	O
.	O

Said	O
another	O
way	O
,	O
if	O
a	O
convolutional	O
window	O
in	O
one	O
image	O
does	O
not	O
overlap	O
with	O
related	O
image	O
pixels	O
at	O
the	O
next	O
time	O
instant	O
,	O
no	O
meaningful	O
temporal	Method
filter	Method
can	O
be	O
learned	O
.	O

There	O
are	O
two	O
problems	O
that	O
need	O
to	O
be	O
solved	O
.	O

One	O
is	O
to	O
solve	O
for	O
long	Task
-	Task
range	Task
correlations	Task
while	O
the	O
other	O
is	O
to	O
solve	O
for	O
detailed	Task
,	Task
sub	Task
-	Task
pixel	Task
,	Task
optical	Task
flow	Task
and	Task
precise	Task
motion	Task
boundaries	Task
.	O

FlowNet	Method
attempts	O
to	O
learn	O
both	O
of	O
these	O
at	O
once	O
.	O

In	O
contrast	O
,	O
we	O
tackle	O
the	O
latter	O
using	O
deep	Method
learning	Method
and	O
rely	O
on	O
existing	O
methods	O
to	O
solve	O
the	O
former	O
.	O

Approach	O
.	O

To	O
deal	O
with	O
large	Task
motions	Task
we	O
adopt	O
a	O
traditional	O
coarse	Method
-	Method
to	Method
-	Method
fine	Method
approach	Method
using	O
a	O
spatial	Method
pyramid	Method
.	O

At	O
that	O
top	O
level	O
of	O
the	O
pyramid	O
,	O
the	O
hope	O
is	O
that	O
the	O
motions	O
between	O
frames	O
are	O
smaller	O
than	O
a	O
few	O
pixels	O
and	O
that	O
,	O
consequently	O
,	O
the	O
convolutional	Method
filters	Method
can	O
learn	O
meaningful	O
temporal	O
structure	O
.	O

At	O
each	O
level	O
of	O
the	O
pyramid	O
we	O
solve	O
for	O
the	O
flow	O
using	O
a	O
convolutional	Method
network	Method
and	O
up	O
-	O
sample	O
the	O
flow	O
to	O
the	O
next	O
pyramid	O
level	O
.	O

As	O
is	O
standard	O
,	O
with	O
classical	O
formulations	O
,	O
we	O
warp	O
one	O
image	O
towards	O
the	O
other	O
using	O
the	O
current	O
flow	O
,	O
and	O
repeat	O
this	O
process	O
at	O
each	O
pyramid	O
level	O
.	O

Instead	O
of	O
minimizing	O
a	O
classical	O
objective	O
function	O
at	O
each	O
level	O
,	O
we	O
learn	O
a	O
convolutional	Method
network	Method
to	O
predict	O
the	O
flow	O
increment	O
at	O
that	O
level	O
.	O

We	O
train	O
the	O
network	O
from	O
coarse	O
to	O
fine	O
to	O
learn	O
the	O
flow	Task
correction	Task
at	O
each	O
level	O
and	O
add	O
this	O
to	O
the	O
flow	O
output	O
of	O
the	O
network	O
above	O
.	O

The	O
idea	O
is	O
that	O
the	O
displacements	O
are	O
then	O
always	O
less	O
than	O
a	O
few	O
pixels	O
at	O
each	O
pyramid	O
level	O
.	O

We	O
call	O
the	O
method	O
SPyNet	Method
,	O
for	O
Spatial	Method
Pyramid	Method
Network	Method
,	O
and	O
train	O
it	O
using	O
the	O
same	O
Flying	Material
Chairs	Material
data	Material
as	O
FlowNet	Material
.	O

We	O
report	O
similar	O
performance	O
as	O
FlowNet	Method
on	O
Flying	Material
Chairs	Material
and	O
Sintel	Material
but	O
are	O
significantly	O
more	O
accurate	O
than	O
FlowNet	Method
on	O
Middlebury	Material
and	O
KITTI	Material
after	O
fine	Method
tuning	Method
.	O

The	O
total	O
size	O
of	O
SPyNet	Method
is	O
96	O
%	O
smaller	O
than	O
FlowNet	Method
,	O
meaning	O
that	O
it	O
runs	O
faster	O
,	O
and	O
uses	O
much	O
less	O
memory	O
.	O

The	O
expensive	O
iterative	Method
propagation	Method
of	O
classical	Method
methods	Method
is	O
replaced	O
by	O
the	O
non	Method
-	Method
iterative	Method
computation	Method
of	Method
the	Method
neural	Method
network	Method
.	O

We	O
do	O
not	O
claim	O
to	O
solve	O
the	O
full	Task
optical	Task
flow	Task
problem	Task
with	O
SPyNet	Method
–	O
we	O
address	O
the	O
same	O
problem	O
as	O
traditional	O
approaches	O
and	O
inherit	O
some	O
of	O
their	O
limitations	O
.	O

For	O
example	O
,	O
it	O
is	O
well	O
known	O
that	O
large	O
motions	O
of	O
small	O
or	O
thin	O
objects	O
are	O
difficult	O
to	O
capture	O
with	O
a	O
pyramid	Method
representation	Method
.	O

We	O
see	O
the	O
large	Task
motion	Task
problem	Task
as	O
separate	O
,	O
requiring	O
different	O
solutions	O
.	O

Rather	O
,	O
what	O
we	O
show	O
is	O
that	O
the	O
traditional	O
problem	O
can	O
be	O
reformulated	O
,	O
portions	O
of	O
it	O
can	O
be	O
learned	O
,	O
and	O
performance	O
improves	O
in	O
many	O
scenarios	O
.	O

Additionally	O
,	O
because	O
our	O
approach	O
connects	O
past	O
methods	O
with	O
new	O
tools	O
,	O
it	O
provides	O
insights	O
into	O
how	O
to	O
move	O
forward	O
.	O

In	O
particular	O
,	O
we	O
find	O
that	O
SPyNet	Method
learns	O
spatio	Method
-	Method
temporal	Method
convolutional	Method
filters	Method
that	O
resemble	O
traditional	O
spatio	Method
-	Method
temporal	Method
derivative	Method
or	Method
Gabor	Method
filters	Method
.	O

The	O
learned	O
filters	O
resemble	O
biological	Method
models	Method
of	Method
motion	Method
processing	Method
filters	Method
in	O
MT	Method
and	O
V1	O
.	O

This	O
is	O
in	O
contrast	O
to	O
the	O
highly	O
random	O
-	O
looking	O
filters	O
learned	O
by	O
FlowNet	Method
.	O

This	O
suggests	O
that	O
it	O
is	O
timely	O
to	O
reexamine	O
older	O
spatio	Method
-	Method
temporal	Method
filtering	Method
approaches	Method
with	O
new	O
tools	O
.	O

In	O
summary	O
our	O
contributions	O
are	O
:	O
1	O
)	O
the	O
combination	O
of	O
traditional	O
coarse	Method
-	Method
to	Method
-	Method
fine	Method
pyramid	Method
methods	Method
with	O
deep	Method
learning	Method
for	O
optical	Task
flow	Task
estimation	Task
;	O
2	O
)	O
a	O
new	O
SPyNet	Method
model	O
that	O
is	O
96	O
%	O
smaller	O
and	O
faster	O
than	O
FlowNet	Method
;	O
3	O
)	O
SPyNet	Method
achieves	O
comparable	O
or	O
lower	O
error	Metric
than	O
FlowNet	Method
on	O
standard	O
benchmarks	O
–	O
Sintel	Material
,	O
KITTI	Material
and	O
Middlebury	Material
;	O
4	O
)	O
the	O
learned	O
spatio	Method
-	Method
temporal	Method
filters	Method
provide	O
insight	O
about	O
what	O
filters	O
are	O
needed	O
for	O
flow	Task
estimation	Task
;	O
5	O
)	O
the	O
trained	O
network	O
and	O
related	O
code	O
are	O
publicly	O
available	O
for	O
research	O
.	O

section	O
:	O
Related	O
Work	O
Our	O
formulation	O
effectively	O
combines	O
ideas	O
from	O
“	O
classical	Method
”	Method
optical	Method
flow	Method
and	O
recent	O
deep	Method
learning	Method
methods	Method
.	O

Our	O
review	O
focuses	O
on	O
the	O
work	O
most	O
relevant	O
to	O
this	O
.	O

Spatial	O
pyramids	O
and	O
optical	Task
flow	Task
.	O

The	O
classical	O
formulation	O
of	O
the	O
optical	Task
flow	Task
problem	Task
dates	O
to	O
Horn	O
and	O
Schunck	O
and	O
involves	O
optimizing	O
the	O
sum	O
of	O
a	O
data	Method
term	Method
based	O
on	O
brightness	O
constancy	O
and	O
a	O
spatial	O
smoothness	O
term	O
.	O

The	O
classical	O
methods	O
typically	O
suffer	O
from	O
the	O
fact	O
that	O
they	O
make	O
very	O
approximate	O
assumptions	O
about	O
the	O
image	O
brightness	O
change	O
and	O
the	O
spatial	O
structure	O
of	O
the	O
flow	O
.	O

Many	O
methods	O
focus	O
on	O
improving	O
robustness	Metric
by	O
changing	O
the	O
assumptions	O
.	O

A	O
full	O
review	O
would	O
effectively	O
cover	O
the	O
history	O
of	O
the	O
field	O
;	O
for	O
this	O
we	O
refer	O
the	O
reader	O
to	O
.	O

The	O
key	O
advantage	O
of	O
learning	O
to	O
compute	O
flow	Task
,	O
as	O
we	O
do	O
here	O
,	O
is	O
that	O
we	O
do	O
not	O
hand	O
craft	O
changes	O
in	O
these	O
assumptions	O
.	O

Rather	O
,	O
the	O
variation	O
in	O
image	O
brightness	O
and	O
spatial	O
smoothness	O
are	O
embodied	O
in	O
the	O
learned	Method
network	Method
.	O

The	O
idea	O
of	O
using	O
a	O
spatial	Method
pyramid	Method
has	O
a	O
similarly	O
long	O
history	O
dating	O
to	O
with	O
its	O
first	O
use	O
in	O
the	O
classical	O
flow	Method
formulation	Method
appearing	O
in	O
.	O

Typically	O
Gaussian	Method
or	Method
Laplacian	Method
pyramids	Method
are	O
used	O
for	O
flow	Task
estimation	Task
with	O
the	O
primary	O
motivation	O
to	O
deal	O
with	O
large	O
motions	O
.	O

These	O
methods	O
are	O
well	O
known	O
to	O
have	O
problems	O
when	O
small	O
objects	O
move	O
quickly	O
.	O

Brox	O
et	O
al	O
.	O

incorporate	O
long	Method
range	Method
matching	Method
into	O
the	O
traditional	O
optical	Method
flow	Method
objective	Method
function	Method
.	O

This	O
approach	O
of	O
combining	O
image	Task
matching	Task
to	O
capture	O
large	Task
motions	Task
,	O
with	O
a	O
variational	Method
or	Method
discrete	Method
optimization	Method
for	O
fine	Task
motions	Task
,	O
can	O
produce	O
accurate	O
results	O
.	O

Of	O
course	O
spatial	Method
pyramids	Method
are	O
widely	O
used	O
in	O
other	O
areas	O
of	O
computer	Task
vision	Task
and	O
have	O
recently	O
been	O
used	O
in	O
deep	Method
neural	Method
networks	Method
to	O
learn	O
generative	Method
image	Method
models	Method
.	O

Spatio	Method
-	Method
temporal	Method
filters	Method
.	O

Burt	O
and	O
Adelson	O
lay	O
out	O
the	O
theory	O
of	O
spatio	Method
-	Method
temporal	Method
models	Method
for	O
motion	Task
estimation	Task
and	O
Heeger	O
provides	O
a	O
computational	Method
embodiment	Method
.	O

While	O
inspired	O
by	O
human	O
perception	O
,	O
such	O
methods	O
did	O
not	O
perform	O
well	O
at	O
the	O
time	O
.	O

Various	O
methods	O
have	O
shown	O
that	O
spatio	O
-	O
temporal	O
filters	O
emerge	O
from	O
learning	Method
,	O
for	O
example	O
using	O
independent	Method
component	Method
analysis	Method
,	O
sparseness	Method
,	O
and	O
multi	Method
-	Method
layer	Method
models	Method
.	O

Memisevic	Method
and	O
Hinton	O
learn	O
simple	O
spatial	Method
transformations	Method
with	O
a	O
restricted	Method
Boltzmann	Method
machine	Method
,	O
finding	O
a	O
variety	O
of	O
filters	Method
.	O

Taylor	O
et	O
al	O
.	O

use	O
synthetic	O
data	O
to	O
learn	O
“	O
flow	O
like	O
”	O
features	O
using	O
a	O
restricted	Method
Boltzmann	Method
machine	Method
but	O
do	O
not	O
evaluate	O
flow	Metric
accuracy	Metric
.	O

Dosovitskiy	O
et	O
al	O
.	O

learn	O
spatio	Method
-	Method
temporal	Method
filters	Method
for	O
flow	Task
estimation	Task
using	O
a	O
deep	Method
network	Method
,	O
yet	O
these	O
filters	O
do	O
not	O
resemble	O
classical	Method
filters	Method
inspired	O
by	O
neuroscience	Method
.	O

By	O
using	O
a	O
pyramid	Method
approach	Method
,	O
here	O
we	O
learn	O
filters	O
that	O
are	O
visually	O
similar	O
to	O
classical	O
spatio	Method
-	Method
temporal	Method
filters	Method
,	O
yet	O
because	O
they	O
are	O
learned	O
from	O
data	O
,	O
produce	O
good	O
flow	Task
estimates	Task
.	O

Learning	O
to	O
model	O
and	O
compute	Task
flow	Task
.	O

Possibly	O
the	O
first	O
attempt	O
to	O
learn	O
a	O
model	O
to	O
estimate	O
optical	Task
flow	Task
is	O
the	O
work	O
of	O
Freeman	O
et	O
al	O
.	O

using	O
an	O
MRF	Method
.	O

They	O
consider	O
a	O
simple	O
synthetic	O
world	O
of	O
uniform	O
moving	O
blobs	O
with	O
ground	O
truth	O
flow	O
.	O

The	O
training	O
data	O
was	O
not	O
realistic	O
and	O
they	O
did	O
not	O
apply	O
the	O
method	O
to	O
real	O
image	O
sequences	O
.	O

Roth	O
and	O
Black	O
learn	O
a	O
field	Method
-	Method
of	Method
-	Method
experts	Method
(	Method
FoE	Method
)	Method
model	Method
to	O
capture	O
the	O
spatial	Task
statistics	Task
of	Task
optical	Task
flow	Task
.	O

The	O
FoE	Method
can	O
be	O
viewed	O
as	O
a	O
(	Method
shallow	Method
)	Method
convolutional	Method
neural	Method
network	Method
.	O

The	O
model	O
is	O
trained	O
using	O
flow	O
fields	O
generated	O
from	O
laser	O
scans	O
of	O
real	O
scenes	O
and	O
natural	O
camera	O
motions	O
.	O

They	O
have	O
no	O
images	O
of	O
the	O
scenes	O
(	O
only	O
their	O
flow	O
)	O
and	O
consequently	O
the	O
method	O
only	O
learns	O
the	O
spatial	Method
component	Method
.	O

Sun	O
et	O
al	O
.	O

describe	O
the	O
first	O
fully	Method
learned	Method
model	Method
that	O
can	O
be	O
considered	O
a	O
(	O
shallow	Method
)	Method
convolutional	Method
neural	Method
network	Method
.	O

They	O
formulate	O
a	O
classical	Task
flow	Task
problem	Task
with	O
a	O
data	O
term	O
and	O
a	O
spatial	O
term	O
.	O

The	O
spatial	Method
term	Method
uses	O
the	O
FoE	Method
model	Method
from	O
,	O
while	O
the	O
data	Method
term	Method
replaces	O
traditional	O
derivative	Method
filters	Method
with	O
a	O
set	O
of	O
learned	O
convolutional	Method
image	Method
filters	Method
.	O

With	O
limited	O
training	O
data	O
and	O
a	O
small	O
set	O
of	O
filters	O
,	O
it	O
did	O
not	O
fully	O
show	O
the	O
full	O
promise	O
of	O
learning	Task
flow	Task
.	O

Wulff	O
and	O
Black	Method
learn	O
the	O
spatial	Task
statistics	Task
of	Task
optical	Task
flow	Task
by	O
a	O
applying	O
robust	Method
PCA	Method
to	O
real	O
(	O
noisy	O
)	O
optical	O
flow	O
computed	O
from	O
natural	O
movies	O
.	O

While	O
this	O
produces	O
a	O
global	O
flow	O
basis	O
and	O
overly	O
smooth	O
flow	O
,	O
they	O
use	O
the	O
model	O
to	O
compute	O
reasonable	Task
flow	Task
relatively	O
quickly	O
.	O

Deep	Method
Learning	Method
.	O

The	O
above	O
learning	Method
methods	Method
suffer	O
from	O
limited	O
training	O
data	O
and	O
the	O
use	O
of	O
shallow	Method
models	Method
.	O

In	O
contrast	O
,	O
deep	Method
convolutional	Method
neural	Method
networks	Method
have	O
emerged	O
as	O
a	O
powerful	O
class	O
of	O
models	O
for	O
solving	O
recognition	Task
and	Task
dense	Task
estimation	Task
problems	Task
.	O

FlowNet	Method
represents	O
the	O
first	O
deep	Method
convolutional	Method
architecture	Method
for	O
flow	Task
estimation	Task
that	O
is	O
trained	O
end	O
-	O
to	O
-	O
end	O
.	O

The	O
network	O
shows	O
promising	O
results	O
,	O
despite	O
being	O
trained	O
on	O
an	O
artificial	O
dataset	O
of	O
chairs	O
flying	O
over	O
randomly	O
selected	O
images	O
.	O

Despite	O
promising	O
results	O
,	O
the	O
method	O
lags	O
behind	O
the	O
state	O
of	O
the	O
art	O
in	O
terms	O
of	O
accuracy	Metric
.	O

Deep	Method
matching	Method
methods	Method
do	O
not	O
fully	O
solve	O
the	O
problem	O
,	O
since	O
they	O
resort	O
to	O
classical	Method
methods	Method
to	O
compute	O
the	O
final	O
flow	O
field	O
.	O

It	O
remains	O
an	O
open	O
question	O
as	O
to	O
which	O
architectures	O
are	O
most	O
appropriate	O
for	O
the	O
problem	O
and	O
how	O
best	O
to	O
train	O
these	O
.	O

Tran	O
et	O
al	O
.	O

,	O
use	O
a	O
traditional	O
flow	Method
method	Method
to	O
create	O
“	O
semi	O
-	O
truth	O
”	O
training	O
data	O
for	O
a	O
3D	Method
convolutional	Method
network	Method
.	O

The	O
performance	O
is	O
below	O
the	O
state	O
of	O
the	O
art	O
and	O
the	O
method	O
is	O
not	O
tested	O
on	O
the	O
standard	O
benchmarks	O
.	O

There	O
have	O
also	O
been	O
several	O
attempts	O
at	O
estimating	Task
optical	Task
flow	Task
using	O
unsupervised	Method
learning	Method
.	O

However	O
these	O
methods	O
have	O
lower	O
accuracy	Metric
on	O
standard	O
benchmarks	O
.	O

Fast	Task
flow	Task
.	O

Several	O
recent	O
methods	O
attempt	O
to	O
balance	O
speed	O
and	O
accuracy	Metric
,	O
with	O
the	O
goal	O
of	O
real	Task
-	Task
time	Task
processing	Task
and	O
reasonable	O
(	O
though	O
not	O
top	O
)	O
accuracy	Metric
.	O

GPU	Method
-	Method
flow	Method
began	O
this	O
trend	O
but	O
several	O
methods	O
now	O
outperform	O
it	O
.	O

PCA	Method
-	Method
Flow	Method
runs	O
on	O
a	O
CPU	Method
,	O
is	O
slower	O
than	O
frame	Metric
rate	Metric
,	O
and	O
produces	O
overly	O
smooth	O
flow	O
fields	O
.	O

EPPM	Method
achieves	O
similar	O
,	O
middle	O
-	O
of	O
-	O
the	O
-	O
pack	O
,	O
performance	O
on	O
Sintel	Material
(	O
test	O
)	O
,	O
with	O
similar	O
speed	O
on	O
a	O
GPU	Method
.	O

Most	O
recently	O
DIS	Method
-	Method
Fast	Method
is	O
a	O
GPU	Method
method	Method
that	O
is	O
significantly	O
faster	O
than	O
previous	O
methods	O
but	O
is	O
also	O
significantly	O
less	O
accurate	O
.	O

Our	O
method	O
is	O
also	O
significantly	O
faster	O
than	O
the	O
best	O
previous	O
CNN	Method
flow	Method
method	Method
(	O
FlowNet	Method
)	O
,	O
which	O
reports	O
a	O
runtime	Metric
of	O
80ms	O
/	O
frame	O
for	O
FlowNetS.	Task
The	O
key	O
to	O
our	O
speed	O
is	O
to	O
create	O
a	O
small	Method
neural	Method
network	Method
that	O
fits	O
entirely	O
on	O
the	O
GPU	O
.	O

Additionally	O
all	O
our	O
pyramid	Method
operations	Method
are	O
implemented	O
on	O
the	O
GPU	O
.	O

Size	Task
is	O
an	O
important	O
issue	O
that	O
has	O
not	O
attracted	O
as	O
much	O
attention	O
as	O
speed	O
.	O

For	O
optical	Task
flow	Task
to	O
exist	O
on	O
embedded	O
processors	O
,	O
aerial	Task
vehicles	Task
,	O
phones	O
,	O
etc	O
.	O

,	O
the	O
algorithm	O
needs	O
a	O
small	O
memory	O
footprint	O
.	O

Our	O
network	O
is	O
96	O
%	O
smaller	O
than	O
FlowNetS	Method
and	O
uses	O
only	O
9.7	O
MB	O
for	O
the	O
model	O
parameters	O
,	O
making	O
it	O
easily	O
small	O
enough	O
to	O
fit	O
on	O
a	O
mobile	O
phone	O
GPU	O
.	O

section	O
:	O
Spatial	Method
Pyramid	Method
Network	Method
Our	O
approach	O
uses	O
the	O
coarse	O
-	O
to	O
-	O
fine	O
spatial	O
pyramid	O
structure	O
of	O
to	O
learn	O
residual	O
flow	O
at	O
each	O
pyramid	O
level	O
.	O

Here	O
we	O
describe	O
the	O
network	Method
and	O
training	Method
procedure	Method
.	O

subsection	O
:	O
Spatial	Method
Sampling	Method
Let	O
be	O
the	O
downsampling	Method
function	Method
that	O
decimates	O
an	O
image	O
to	O
the	O
corresponding	O
image	O
of	O
size	O
.	O

Let	O
be	O
the	O
reverse	O
operation	O
that	O
upsamples	O
images	O
.	O

These	O
operators	O
are	O
also	O
used	O
for	O
downsampling	Task
and	Task
upsampling	Task
the	Task
horizontal	Task
and	Task
vertical	Task
components	Task
of	Task
the	Task
optical	Task
flow	Task
field	Task
,	O
.	O

We	O
also	O
define	O
a	O
warping	Method
operator	Method
that	O
warps	O
the	O
image	O
,	O
according	O
to	O
the	O
flow	O
field	O
,	O
,	O
using	O
bi	Method
-	Method
linear	Method
interpolation	Method
.	O

subsection	O
:	O
Inference	Task
Let	O
denote	O
a	O
set	O
of	O
trained	O
convolutional	Method
neural	Method
network	Method
(	Method
convnet	Method
)	Method
models	Method
,	O
each	O
of	O
which	O
computes	O
residual	O
flow	O
,	O
at	O
the	O
-	O
th	O
pyramid	O
level	O
.	O

The	O
convnet	Method
computes	O
the	O
residual	O
flow	O
using	O
the	O
upsampled	O
flow	O
from	O
the	O
previous	O
pyramid	O
level	O
,	O
,	O
and	O
the	O
frames	O
at	O
level	O
.	O

The	O
second	O
frame	O
is	O
warped	O
using	O
the	O
flow	O
as	O
before	O
feeding	O
it	O
to	O
the	O
convnet	Method
.	O

The	O
flow	O
,	O
at	O
the	O
-	O
th	O
pyramid	O
level	O
is	O
then	O
As	O
shown	O
in	O
Fig	O
.	O

[	O
reference	O
]	O
,	O
we	O
start	O
with	O
downsampled	O
images	O
and	O
an	O
initial	O
flow	Method
estimate	Method
that	O
is	O
zero	O
everywhere	O
to	O
compute	O
the	O
residual	O
flow	O
at	O
the	O
top	O
of	O
the	O
pyramid	O
.	O

We	O
upsample	O
the	O
resulting	O
flow	O
,	O
,	O
and	O
pass	O
it	O
to	O
the	O
network	O
along	O
with	O
to	O
compute	O
the	O
residual	O
flow	O
.	O

At	O
each	O
pyramid	O
level	O
,	O
we	O
compute	O
the	O
flow	O
using	O
Equation	O
(	O
[	O
reference	O
]	O
)	O
.	O

The	O
flow	O
is	O
similarly	O
propagated	O
to	O
higher	O
resolution	O
layers	O
of	O
the	O
pyramid	O
until	O
we	O
obtain	O
the	O
flow	O
at	O
full	O
resolution	O
.	O

Figure	O
[	O
reference	O
]	O
shows	O
the	O
working	O
of	O
our	O
approach	O
using	O
a	O
3	Method
-	Method
level	Method
pyramid	Method
.	O

In	O
experiments	O
,	O
we	O
use	O
a	O
5	O
-	O
level	O
pyramid	O
(	O
)	O
.	O

subsection	O
:	O
Training	O
and	O
Network	Method
Architecture	Method
We	O
train	O
each	O
of	O
the	O
convnets	Method
independently	O
and	O
sequentially	O
to	O
compute	O
the	O
residual	O
flow	O
given	O
the	O
inputs	O
.	O

We	O
compute	O
target	O
residual	O
flows	O
as	O
a	O
difference	O
of	O
target	O
flow	O
at	O
the	O
-	O
th	O
pyramid	O
level	O
and	O
the	O
upsampled	O
flow	O
,	O
obtained	O
from	O
the	O
trained	O
convnet	Method
of	O
the	O
previous	O
level	O
As	O
shown	O
in	O
Fig	O
.	O

[	O
reference	O
]	O
,	O
we	O
train	O
each	O
of	O
the	O
networks	O
,	O
,	O
to	O
minimize	O
the	O
average	Metric
End	Metric
Point	Metric
Error	Metric
(	O
EPE	Metric
)	O
loss	O
on	O
the	O
residual	O
flow	O
.	O

Each	O
level	O
in	O
the	O
pyramid	O
has	O
a	O
simplified	O
task	O
relative	O
to	O
the	O
full	Task
optical	Task
flow	Task
estimation	Task
problem	Task
;	O
it	O
only	O
has	O
to	O
estimate	O
a	O
small	O
-	O
motion	O
update	O
to	O
an	O
existing	O
flow	O
field	O
.	O

Consequently	O
each	O
network	O
can	O
be	O
simple	O
.	O

Here	O
,	O
each	O
has	O
5	O
convolutional	O
layers	O
,	O
which	O
we	O
found	O
gave	O
the	O
best	O
combination	O
of	O
accuracy	Metric
,	O
size	Metric
,	O
and	O
speed	Metric
.	O

We	O
train	O
five	O
convnets	Method
at	O
different	O
resolutions	O
of	O
the	O
Flying	Material
Chairs	Material
dataset	Material
.	O

The	O
network	O
is	O
trained	O
with	O
24x32	O
images	O
.	O

We	O
double	O
the	O
resolution	O
at	O
each	O
lower	O
level	O
and	O
finally	O
train	O
the	O
convnet	Method
,	O
with	O
a	O
resolution	Metric
of	O
384x512	O
.	O

Each	O
convolutional	Method
layer	Method
is	O
followed	O
by	O
a	O
Rectified	Method
Linear	Method
Unit	Method
(	O
ReLU	Method
)	O
,	O
except	O
the	O
last	O
one	O
.	O

We	O
use	O
a	O
7x7	O
convolutional	Method
kernel	Method
for	O
each	O
of	O
the	O
layers	O
and	O
found	O
these	O
work	O
better	O
than	O
smaller	O
filters	O
.	O

The	O
number	O
of	O
feature	O
maps	O
in	O
each	O
convnet	O
,	O
are	O
{	O
32	O
,	O
64	O
,	O
32	O
,	O
16	O
,	O
2}.	O
The	O
image	O
and	O
the	O
warped	O
image	O
have	O
3	O
channels	O
each	O
(	O
RGB	O
)	O
.	O

The	O
upsampled	O
flow	O
is	O
2	O
channel	O
(	O
horizontal	O
and	O
vertical	O
)	O
.	O

We	O
stack	O
image	O
frames	O
together	O
with	O
upsampled	O
flow	O
to	O
form	O
an	O
8	O
channel	O
input	O
to	O
each	O
.	O

The	O
output	O
is	O
2	O
channel	O
flow	O
corresponding	O
to	O
velocity	O
in	O
and	O
directions	O
.	O

We	O
train	O
five	O
networks	O
such	O
that	O
each	O
network	O
uses	O
the	O
previous	O
network	O
as	O
initialization	O
.	O

The	O
networks	O
are	O
trained	O
using	O
Adam	Method
optimization	Method
with	O
and	O
.	O

We	O
use	O
a	O
batch	O
size	O
of	O
32	O
across	O
all	O
networks	O
with	O
4000	O
iterations	O
per	O
epoch	O
.	O

We	O
use	O
a	O
learning	Metric
rate	Metric
of	O
1e	O
-	O
4	O
for	O
the	O
first	O
60	O
epochs	O
and	O
decrease	O
it	O
to	O
1e	O
-	O
5	O
until	O
the	O
networks	O
converge	O
.	O

We	O
use	O
Torch7	Method
as	O
our	O
deep	Method
learning	Method
framework	Method
.	O

We	O
use	O
the	O
Flying	Material
Chairs	Material
dataset	Material
and	O
the	O
MPI	O
Sintel	Material
for	O
training	O
our	O
network	O
.	O

All	O
our	O
networks	O
are	O
trained	O
on	O
a	O
single	O
Nvidia	O
K80	O
GPU	O
.	O

We	O
include	O
various	O
types	O
of	O
data	Task
augmentation	Task
during	O
training	Task
.	O

We	O
randomly	O
scale	O
images	O
by	O
a	O
factor	O
of	O
and	O
apply	O
rotations	O
at	O
random	O
within	O
.	O

We	O
then	O
apply	O
a	O
random	O
crop	O
to	O
match	O
the	O
resolution	O
of	O
the	O
convnet	Method
,	O
being	O
trained	O
.	O

We	O
include	O
additive	O
white	O
Gaussian	O
noise	O
sampled	O
uniformly	O
from	O
.	O

We	O
apply	O
color	O
jitter	O
with	O
additive	O
brightness	O
,	O
contrast	O
and	O
saturation	O
sampled	O
from	O
a	O
Gaussian	O
,	O
.	O

We	O
finally	O
normalize	O
the	O
images	O
using	O
a	O
mean	O
and	O
standard	Metric
deviation	Metric
computed	O
from	O
a	O
large	O
corpus	O
of	O
ImageNet	Material
data	Material
in	O
.	O

section	O
:	O
Experiments	O
We	O
evaluate	O
our	O
performance	O
on	O
standard	O
optical	Task
flow	Task
benchmarks	Task
and	O
compare	O
with	O
FlowNet	Method
and	O
Classic	Method
+	Method
NLP	Method
,	O
a	O
traditional	O
pyramid	Method
-	Method
based	Method
method	Method
.	O

We	O
compare	O
performance	O
using	O
average	O
end	Metric
point	Metric
errors	Metric
in	O
Table	O
[	O
reference	O
]	O
.	O

We	O
evaluate	O
on	O
all	O
the	O
standard	O
benchmarks	O
and	O
find	O
that	O
SPyNet	Method
is	O
the	O
most	O
accurate	O
overall	O
,	O
with	O
and	O
without	O
fine	O
tuning	O
(	O
details	O
below	O
)	O
.	O

Additionally	O
SPyNet	Method
is	O
faster	O
than	O
all	O
other	O
methods	O
.	O

Note	O
that	O
the	O
FlowNet	O
results	O
reported	O
on	O
the	O
MPI	O
-	O
Sintel	Material
website	O
are	O
for	O
a	O
version	O
that	O
applies	O
variational	Method
refinement	Method
(	O
“	O
+	O
v	O
”	O
)	O
to	O
the	O
convnet	O
results	O
.	O

Here	O
we	O
are	O
not	O
interested	O
in	O
the	O
variational	Method
component	Method
and	O
only	O
compare	O
the	O
results	O
of	O
the	O
convnet	O
output	O
.	O

paragraph	O
:	O
Flying	O
Chairs	O
.	O

Once	O
the	O
convnets	Method
are	O
trained	O
on	O
Flying	O
Chairs	O
,	O
we	O
fine	O
tune	O
the	O
network	O
on	O
the	O
same	O
dataset	O
but	O
without	O
any	O
data	Method
augmentation	Method
at	O
a	O
learning	Metric
rate	Metric
of	O
1e	O
-	O
6	O
.	O

We	O
see	O
an	O
improvement	O
of	O
EPE	Metric
by	O
0.14	O
on	O
the	O
test	O
set	O
.	O

Our	O
model	O
achieves	O
better	O
performance	O
than	O
FlowNetS	Method
on	O
the	O
Flying	Material
Chairs	Material
dataset	Material
,	O
however	O
FlowNetC	Method
performs	O
better	O
than	O
ours	O
.	O

We	O
show	O
the	O
qualitative	O
results	O
on	O
Flying	Material
Chairs	Material
dataset	Material
in	O
Fig	O
.	O

[	O
reference	O
]	O
and	O
compare	O
the	O
performance	O
in	O
Table	O
[	O
reference	O
]	O
.	O

paragraph	O
:	O
MPI	O
-	O
Sintel	Material
.	O

The	O
resolution	O
of	O
Sintel	Material
images	O
is	O
436x1024	O
.	O

To	O
use	O
SPyNet	Method
,	O
we	O
scale	O
the	O
images	O
to	O
448x1024	O
,	O
and	O
use	O
6	O
pyramid	O
levels	O
to	O
compute	O
the	O
optical	O
flow	O
.	O

The	O
networks	O
used	O
on	O
each	O
pyramid	O
level	O
are	O
.	O

We	O
repeat	O
the	O
network	O
at	O
the	O
sixth	O
level	O
of	O
pyramid	O
for	O
experiments	O
on	O
Sintel	Material
.	O

Because	O
Sintel	Material
has	O
extremely	O
large	O
motions	O
,	O
we	O
found	O
that	O
this	O
gives	O
better	O
performance	O
than	O
using	O
just	O
five	O
levels	O
.	O

We	O
evaluate	O
the	O
performance	O
of	O
our	O
model	O
on	O
MPI	O
-	O
Sintel	Material
in	O
two	O
ways	O
.	O

First	O
,	O
we	O
directly	O
use	O
the	O
model	O
trained	O
on	O
Flying	Material
Chairs	Material
dataset	Material
and	O
evaluate	O
our	O
performance	O
on	O
both	O
the	O
training	O
and	O
the	O
test	O
sets	O
.	O

Second	O
,	O
we	O
extract	O
a	O
validation	O
set	O
from	O
the	O
Sintel	Material
training	O
set	O
,	O
using	O
the	O
same	O
partition	O
as	O
.	O

We	O
fine	O
tune	O
our	O
model	O
independently	O
on	O
the	O
Sintel	Material
Clean	O
and	O
Sintel	Material
Final	O
split	O
,	O
and	O
evaluate	O
the	O
EPE	Metric
.	O

The	O
fine	Method
-	Method
tuned	Method
models	Method
are	O
listed	O
as	O
“	O
+	O
ft	O
”	O
in	O
Table	O
[	O
reference	O
]	O
.	O

We	O
show	O
the	O
qualitative	O
results	O
on	O
MPI	Material
-	Material
Sintel	Material
in	O
Fig	O
.	O

[	O
reference	O
]	O
.	O

Table	O
[	O
reference	O
]	O
compares	O
our	O
fine	Method
-	Method
tuned	Method
model	Method
with	O
FlowNet	Method
for	O
different	O
velocities	O
and	O
distances	O
from	O
motion	O
boundaries	O
.	O

We	O
observe	O
that	O
SPyNet	Method
is	O
more	O
accurate	O
than	O
FlowNet	Method
for	O
all	O
velocity	O
ranges	O
except	O
the	O
largest	O
displacements	O
(	O
over	O
40	O
pixels	O
/	O
frame	O
)	O
.	O

SPyNet	Method
is	O
also	O
more	O
accurate	O
than	O
FlowNet	Task
close	Task
to	Task
motion	Task
boundaries	Task
,	O
which	O
is	O
important	O
for	O
many	O
problems	O
.	O

paragraph	O
:	O
KITTI	Material
and	O
Middlebury	Material
.	O

We	O
evaluate	O
KITTI	Material
scenes	O
using	O
the	O
base	O
model	O
SPyNet	Method
trained	O
on	O
Flying	Material
Chairs	Material
.	O

We	O
then	O
fine	O
-	O
tune	O
the	O
model	O
on	O
Driving	Material
and	O
Monkaa	Material
scenes	Material
from	O
and	O
evaluate	O
the	O
fine	Method
-	Method
tuned	Method
model	Method
SPyNet	Method
+	O
ft	O
.	O

Fine	Method
tuning	Method
results	O
in	O
a	O
significant	O
improvement	O
in	O
accuracy	Metric
by	O
about	O
5	O
pixels	O
.	O

The	O
large	O
improvement	O
in	O
accuracy	Metric
suggests	O
that	O
better	O
training	O
datasets	O
are	O
needed	O
and	O
that	O
these	O
could	O
improve	O
the	O
accuracy	Metric
of	O
SPyNet	Method
further	O
on	O
general	O
scenes	O
.	O

While	O
SPyNet	Method
+	O
ft	O
is	O
much	O
more	O
accurate	O
than	O
FlowNet	Method
+	Method
ft	Method
,	O
the	O
latter	O
is	O
fine	O
-	O
tuned	O
on	O
different	O
data	O
.	O

For	O
the	O
Middlebury	Material
dataset	O
,	O
we	O
evaluate	O
the	O
sequences	O
using	O
the	O
base	O
model	O
SPyNet	Method
as	O
well	O
as	O
SPyNet	Method
+	O
ft	O
,	O
which	O
is	O
fine	O
-	O
tuned	O
on	O
the	O
Sintel	Material
-	O
Final	O
dataset	O
;	O
the	O
Middlebury	Material
dataset	O
itself	O
is	O
too	O
small	O
for	O
fine	Task
-	Task
tuning	Task
.	O

SPyNet	Method
is	O
significantly	O
more	O
accurate	O
on	O
Middlebury	Material
,	O
where	O
FlowNet	Material
has	O
trouble	O
with	O
the	O
small	O
motions	O
.	O

Both	O
learned	O
methods	O
are	O
less	O
accurate	O
than	O
Classic	O
+	O
NL	O
on	O
Middlebury	Material
but	O
both	O
are	O
also	O
significantly	O
faster	O
.	O

section	O
:	O
Analysis	O
paragraph	O
:	O
Model	Metric
Size	Metric
Combining	O
spatial	Method
pyramids	Method
with	O
convnets	Method
results	O
in	O
a	O
huge	O
reduction	O
in	O
model	Metric
complexity	Metric
.	O

At	O
each	O
pyramid	O
level	O
,	O
a	O
network	O
,	O
,	O
has	O
240	O
,	O
050	O
learned	O
parameters	O
.	O

The	O
total	O
number	O
of	O
parameters	O
learned	O
by	O
the	O
entire	O
network	O
is	O
1	O
,	O
200	O
,	O
250	O
,	O
with	O
5	O
spatial	O
pyramid	O
levels	O
.	O

In	O
comparison	O
,	O
FlowNetS	Method
and	O
FlowNetC	Method
have	O
32	O
,	O
070	O
,	O
472	O
and	O
32	O
,	O
561	O
,	O
032	O
parameters	O
respectively	O
.	O

SPyNet	Method
is	O
about	O
96	O
%	O
smaller	O
than	O
FlowNet	Method
(	O
Fig	O
.	O

[	O
reference	O
]	O
)	O
.	O

The	O
spatial	Method
pyramid	Method
approach	Method
enables	O
a	O
significant	O
reduction	O
in	O
model	O
parameters	O
without	O
sacrificing	O
accuracy	Metric
.	O

There	O
are	O
two	O
reasons	O
–	O
the	O
warping	Method
function	Method
and	O
learning	Method
of	Method
residual	Method
flow	Method
.	O

By	O
using	O
the	O
warping	O
function	O
directly	O
,	O
the	O
convnet	Method
does	O
not	O
need	O
to	O
learn	O
it	O
.	O

More	O
importantly	O
,	O
the	O
residual	Method
learning	Method
restricts	O
the	O
range	O
of	O
flow	O
fields	O
in	O
the	O
output	O
space	O
.	O

Each	O
network	O
only	O
has	O
to	O
model	O
a	O
smaller	O
range	O
of	O
velocities	O
at	O
each	O
level	O
of	O
the	O
spatial	O
pyramid	O
.	O

SPyNet	Method
also	O
has	O
a	O
small	O
memory	O
footprint	O
.	O

The	O
disk	O
space	O
required	O
to	O
store	O
all	O
the	O
model	O
parameters	O
is	O
9.7	O
MB	O
.	O

This	O
could	O
simplify	O
deployment	O
on	O
mobile	Task
or	Task
embedded	Task
devices	Task
with	O
GPU	O
support	O
.	O

paragraph	O
:	O
Visualization	Method
of	Method
Learned	Method
Filters	Method
.	O

Figure	O
[	O
reference	O
]	O
shows	O
examples	O
of	O
filters	O
learned	O
by	O
the	O
first	O
layer	O
of	O
the	O
network	O
,	O
.	O

In	O
each	O
row	O
,	O
the	O
first	O
two	O
columns	O
show	O
the	O
spatial	Method
filters	Method
that	O
operate	O
on	O
the	O
RGB	O
channels	O
of	O
the	O
two	O
input	O
images	O
respectively	O
.	O

The	O
third	O
column	O
is	O
the	O
difference	O
between	O
the	O
two	O
spatial	Method
filters	Method
hence	O
representing	O
the	O
temporal	O
features	O
learned	O
by	O
our	O
model	O
.	O

We	O
observe	O
that	O
most	O
of	O
the	O
spatio	O
-	O
temporal	O
filters	O
in	O
Fig	O
.	O

[	O
reference	O
]	O
are	O
equally	O
sensitive	O
to	O
all	O
color	O
channels	O
,	O
and	O
hence	O
appear	O
mostly	O
grayscale	O
.	O

Note	O
that	O
the	O
actual	O
filters	Method
are	O
pixels	O
and	O
are	O
upsampled	O
for	O
visualization	Task
.	O

We	O
observe	O
that	O
many	O
of	O
the	O
spatial	Method
filters	Method
appear	O
to	O
be	O
similar	O
to	O
traditional	O
Gaussian	Method
derivative	Method
filters	Method
used	O
by	O
classical	O
methods	O
.	O

These	O
classical	O
filters	O
are	O
hand	O
crafted	O
and	O
typically	O
are	O
applied	O
in	O
the	O
horizontal	O
and	O
vertical	O
direction	O
.	O

Here	O
,	O
we	O
observe	O
a	O
greater	O
variety	O
of	O
derivative	Method
-	Method
like	Method
filters	Method
of	O
varied	O
scales	O
and	O
orientations	O
.	O

We	O
also	O
observe	O
filters	O
that	O
spatially	O
resemble	O
second	Method
derivative	Method
or	Method
Gabor	Method
filters	Method
.	O

The	O
temporal	Method
filters	Method
show	O
a	O
clear	O
derivative	O
-	O
like	O
structure	O
in	O
time	O
.	O

Note	O
that	O
these	O
filters	O
are	O
very	O
different	O
from	O
those	O
reported	O
in	O
(	O
Sup	O
.	O

Mat	O
.	O

)	O
,	O
which	O
have	O
a	O
high	O
-	O
frequency	O
structure	O
,	O
unlike	O
classical	Method
filters	Method
.	O

Figure	O
[	O
reference	O
]	O
illustrates	O
how	O
filters	O
learned	O
by	O
the	O
network	O
at	O
each	O
level	O
of	O
the	O
pyramid	O
differ	O
from	O
each	O
other	O
.	O

Recall	O
that	O
,	O
during	O
training	O
,	O
each	O
network	O
is	O
initialized	O
with	O
the	O
network	O
before	O
it	O
in	O
the	O
pyramid	O
.	O

The	O
filters	O
,	O
however	O
,	O
do	O
not	O
stay	O
exactly	O
the	O
same	O
with	O
training	O
.	O

Most	O
of	O
the	O
filters	O
in	O
our	O
network	O
look	O
like	O
rows	O
1	O
and	O
2	O
,	O
where	O
the	O
filters	O
become	O
sharper	O
as	O
we	O
progress	O
towards	O
the	O
finer	O
-	O
resolution	O
levels	O
of	O
the	O
pyramid	O
.	O

However	O
,	O
there	O
are	O
some	O
filters	O
that	O
are	O
similar	O
to	O
rows	O
3	O
and	O
4	O
,	O
where	O
these	O
filters	O
become	O
more	O
defined	O
at	O
higher	O
resolution	O
levels	O
of	O
the	O
pyramid	O
.	O

paragraph	O
:	O
Speed	O
.	O

Optical	Task
flow	Task
estimation	Task
is	O
traditionally	O
viewed	O
as	O
an	O
optimization	Task
problem	Task
involving	O
some	O
form	O
of	O
variational	Method
inference	Method
.	O

Such	O
algorithms	O
are	O
computationally	O
expensive	O
,	O
often	O
taking	O
several	O
seconds	O
or	O
minutes	O
per	O
frame	O
.	O

This	O
has	O
limited	O
the	O
application	O
of	O
optical	Task
flow	Task
in	O
robotics	Task
,	O
embedded	Task
systems	Task
,	O
and	O
video	Task
analysis	Task
.	O

Using	O
a	O
GPU	Method
can	O
speed	O
up	O
traditional	O
methods	O
but	O
with	O
reduced	O
accuracy	Metric
.	O

Feed	Method
forward	Method
deep	Method
networks	Method
leverage	O
fast	O
GPU	Method
convolutions	Method
and	O
avoid	O
iterative	Method
optimization	Method
.	O

Of	O
course	O
for	O
embedded	Task
applications	Task
,	O
network	Task
size	Task
is	O
critical	O
(	O
see	O
Fig	O
.	O

[	O
reference	O
]	O
)	O
.	O

Figure	O
[	O
reference	O
]	O
shows	O
the	O
speed	Metric
-	Metric
accuracy	Metric
comparisons	O
of	O
several	O
well	O
known	O
methods	O
.	O

All	O
times	O
shown	O
are	O
measured	O
with	O
the	O
images	O
already	O
loaded	O
in	O
the	O
memory	O
.	O

The	O
errors	O
are	O
computed	O
as	O
the	O
average	O
EPE	Metric
of	O
both	O
the	O
clean	O
and	O
final	O
MPI	O
-	O
Sintel	Material
sequences	O
.	O

SPyNet	Method
offers	O
a	O
good	O
balance	O
between	O
speed	Metric
and	O
accuracy	Metric
;	O
no	O
faster	O
method	O
is	O
as	O
accurate	O
.	O

section	O
:	O
Discussion	O
and	O
Future	O
Work	O
Traditional	O
flow	Method
methods	Method
linearize	O
the	O
brightness	Method
constancy	Method
equation	Method
resulting	O
in	O
an	O
optical	Method
flow	Method
constraint	Method
equation	Method
implemented	O
with	O
spatial	Method
and	Method
temporal	Method
derivative	Method
filters	Method
.	O

Sometimes	O
methods	O
adopt	O
a	O
more	O
generic	O
filter	Method
constancy	Method
assumption	Method
.	O

Our	O
filters	O
are	O
somewhat	O
different	O
.	O

The	O
filters	Method
learned	O
by	O
SPyNet	Method
are	O
used	O
in	O
the	O
direct	Task
computation	Task
of	Task
the	Task
flow	Task
by	O
the	O
feed	Method
-	Method
forward	Method
network	Method
.	O

SPyNet	Method
is	O
small	O
compared	O
with	O
other	O
recent	O
optical	Method
flow	Method
networks	Method
.	O

Examination	O
of	O
the	O
filters	O
,	O
however	O
,	O
suggests	O
that	O
it	O
might	O
be	O
possible	O
to	O
make	O
it	O
significantly	O
smaller	O
still	O
.	O

Many	O
of	O
the	O
filters	O
resemble	O
derivative	Method
of	Method
Gaussian	Method
filters	Method
or	O
Gabor	Method
filters	Method
at	O
various	O
scales	O
,	O
orientations	O
,	O
spatial	O
frequencies	O
,	O
and	O
spatial	O
shifts	O
.	O

Given	O
this	O
,	O
it	O
may	O
be	O
possible	O
to	O
significantly	O
compress	O
the	O
filter	Method
bank	Method
by	O
using	O
dimensionality	Method
reduction	Method
or	O
by	O
using	O
a	O
set	O
of	O
analytic	O
spatio	O
-	O
temporal	O
features	O
.	O

Some	O
of	O
the	O
filters	O
may	O
also	O
be	O
separable	O
.	O

Early	O
methods	O
for	O
optical	Task
flow	Task
used	O
analytic	O
spatio	O
-	O
temporal	O
features	O
but	O
,	O
at	O
the	O
time	O
,	O
did	O
not	O
produce	O
good	O
results	O
and	O
the	O
general	O
line	O
of	O
spatio	Method
-	Method
temporal	Method
filtering	Method
decayed	O
.	O

The	O
difference	O
from	O
early	O
work	O
is	O
that	O
our	O
approach	O
suggests	O
the	O
need	O
for	O
a	O
large	O
filter	Method
bank	Method
of	Method
varied	Method
filters	Method
.	O

Note	O
also	O
that	O
these	O
approaches	O
considered	O
only	O
the	O
first	O
convolutional	Method
layer	Method
of	Method
filters	Method
and	O
did	O
not	O
seek	O
a	O
“	O
deep	Method
”	Method
solution	Method
.	O

This	O
all	O
suggests	O
the	O
possibility	O
that	O
a	O
deep	Method
network	Method
of	Method
analytic	Method
filters	Method
could	O
perform	O
well	O
.	O

This	O
could	O
vastly	O
reduce	O
the	O
size	O
of	O
the	O
network	O
and	O
the	O
number	O
of	O
parameters	O
that	O
need	O
to	O
be	O
learned	O
.	O

Note	O
that	O
pyramids	Method
have	O
well	O
-	O
known	O
limitations	O
for	O
dealing	O
with	O
large	Task
motions	Task
.	O

In	O
particular	O
,	O
small	O
or	O
thin	O
objects	O
that	O
move	O
quickly	O
effectively	O
disappear	O
at	O
coarse	O
pyramid	O
levels	O
,	O
making	O
it	O
impossible	O
to	O
capture	O
their	O
motion	O
.	O

Recent	O
approaches	O
for	O
dealing	O
with	O
such	O
large	Task
motions	Task
use	O
sparse	Method
matching	Method
to	O
augment	O
standard	O
pyramids	O
.	O

Future	O
work	O
should	O
explore	O
adding	O
long	O
-	O
range	O
matches	O
to	O
SPyNet	Method
.	O

Alternatively	O
Sevilla	O
et	O
al	O
.	O

define	O
a	O
channel	Method
constancy	Method
representation	Method
that	O
preserves	O
fine	O
structures	O
in	O
a	O
pyramid	O
.	O

The	O
channels	O
effectively	O
correspond	O
to	O
filters	O
that	O
could	O
be	O
learned	O
.	O

A	O
spatial	Method
pyramid	Method
can	O
be	O
thought	O
of	O
as	O
the	O
simple	O
application	O
of	O
a	O
set	O
of	O
linear	Method
filters	Method
.	O

Here	O
we	O
take	O
a	O
standard	O
spatial	Method
pyramid	Method
but	O
one	O
could	O
learn	O
the	O
filters	O
for	O
the	O
pyramid	O
itself	O
.	O

SPyNet	Method
also	O
uses	O
a	O
standard	O
warping	Method
function	Method
to	O
align	O
images	O
using	O
the	O
flow	O
computed	O
from	O
the	O
previous	O
pyramid	O
level	O
.	O

This	O
too	O
could	O
be	O
learned	O
.	O

An	O
appealing	O
feature	O
of	O
SPyNet	Method
is	O
that	O
it	O
is	O
small	O
enough	O
to	O
fit	O
on	O
a	O
mobile	O
device	O
.	O

Future	O
work	O
will	O
explore	O
a	O
mobile	Method
implementation	Method
and	O
its	O
applications	O
.	O

Additionally	O
,	O
we	O
will	O
explore	O
extending	O
the	O
method	O
to	O
use	O
more	O
frames	O
(	O
e.g.	O
3	O
or	O
4	O
)	O
.	O

Multiple	O
frames	O
could	O
enable	O
the	O
network	O
to	O
reason	O
more	O
effectively	O
about	O
occlusion	O
.	O

Finally	O
,	O
Flying	O
Chairs	O
is	O
not	O
representative	O
of	O
natural	O
scene	O
motions	O
,	O
containing	O
many	O
huge	O
displacements	O
.	O

We	O
are	O
exploring	O
new	O
training	O
datasets	O
to	O
improve	O
performance	O
on	O
common	O
sequences	O
where	O
the	O
motion	O
is	O
less	O
dramatic	O
.	O

section	O
:	O
Conclusions	O
In	O
summary	O
,	O
we	O
have	O
described	O
a	O
new	O
optical	Method
flow	Method
method	Method
that	O
combines	O
features	O
of	O
classical	O
optical	Method
flow	Method
algorithms	Method
with	O
deep	Method
learning	Method
.	O

In	O
a	O
sense	O
,	O
there	O
are	O
two	O
notions	O
of	O
“	O
deepness	O
”	O
here	O
.	O

First	O
we	O
use	O
a	O
“	O
deep	Method
”	Method
spatial	Method
pyramid	Method
to	O
deal	O
with	O
large	O
motions	O
.	O

Second	O
we	O
use	O
deep	Method
neural	Method
networks	Method
at	O
each	O
level	O
of	O
the	O
spatial	O
pyramid	O
and	O
train	O
them	O
to	O
estimate	O
a	O
flow	O
update	O
at	O
each	O
level	O
.	O

This	O
approach	O
means	O
that	O
each	O
network	O
has	O
less	O
work	O
to	O
do	O
than	O
a	O
fully	Method
generic	Method
flow	Method
method	Method
that	O
has	O
to	O
estimate	O
arbitrarily	O
large	O
motions	O
.	O

At	O
each	O
pyramid	O
level	O
we	O
assume	O
that	O
the	O
motion	O
is	O
small	O
(	O
on	O
the	O
order	O
of	O
a	O
pixel	O
)	O
.	O

This	O
is	O
borne	O
out	O
by	O
the	O
fact	O
that	O
the	O
network	O
learns	O
spatial	Method
and	Method
temporal	Method
filters	Method
that	O
resemble	O
classical	Method
derivatives	Method
of	Method
Gaussians	Method
and	O
Gabors	Method
.	O

Because	O
each	O
sub	O
-	O
task	O
is	O
so	O
much	O
simpler	O
,	O
our	O
network	O
needs	O
many	O
fewer	O
parameters	O
than	O
previous	O
methods	O
like	O
FlowNet	Method
.	O

This	O
results	O
in	O
a	O
method	O
with	O
a	O
small	O
memory	Metric
footprint	Metric
that	O
is	O
faster	O
than	O
existing	O
methods	O
.	O

At	O
the	O
same	O
time	O
,	O
SPyNet	Method
achieves	O
an	O
accuracy	Metric
comparable	O
to	O
FlowNet	Method
,	O
surpassing	O
it	O
in	O
several	O
benchmarks	O
.	O

This	O
opens	O
up	O
the	O
promise	O
of	O
optical	Task
flow	Task
that	O
is	O
both	O
accurate	O
,	O
practical	O
,	O
and	O
widely	O
deployable	O
.	O

section	O
:	O
Acknowledgement	O
We	O
thank	O
Jonas	O
Wulff	O
for	O
his	O
insightful	O
discussions	O
about	O
optical	Task
flow	Task
.	O

bibliography	O
:	O
References	O
