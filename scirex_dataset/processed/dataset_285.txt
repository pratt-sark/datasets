document	O
:	O
Faster	O
R	Method
-	Method
CNN	Method
:	O
Towards	O
Real	Task
-	Task
Time	Task
Object	Task
Detection	Task
with	O
Region	Method
Proposal	Method
Networks	Method
State	O
-	O
of	O
-	O
the	O
-	O
art	O
object	Method
detection	Method
networks	Method
depend	O
on	O
region	Method
proposal	Method
algorithms	Method
to	O
hypothesize	O
object	O
locations	O
.	O

Advances	O
like	O
SPPnet	Method
and	O
Fast	Method
R	Method
-	Method
CNN	Method
have	O
reduced	O
the	O
running	Metric
time	Metric
of	O
these	O
detection	Method
networks	Method
,	O
exposing	O
region	Method
proposal	Method
computation	Method
as	O
a	O
bottleneck	O
.	O

In	O
this	O
work	O
,	O
we	O
introduce	O
a	O
Region	Method
Proposal	Method
Network	Method
(	O
RPN	Method
)	O
that	O
shares	O
full	O
-	O
image	O
convolutional	O
features	O
with	O
the	O
detection	Method
network	Method
,	O
thus	O
enabling	O
nearly	Task
cost	Task
-	Task
free	Task
region	Task
proposals	Task
.	O

An	O
RPN	Method
is	O
a	O
fully	Method
convolutional	Method
network	Method
that	O
simultaneously	O
predicts	O
object	O
bounds	O
and	O
objectness	O
scores	O
at	O
each	O
position	O
.	O

The	O
RPN	Method
is	O
trained	O
end	O
-	O
to	O
-	O
end	O
to	O
generate	O
high	O
-	O
quality	O
region	O
proposals	O
,	O
which	O
are	O
used	O
by	O
Fast	Method
R	Method
-	Method
CNN	Method
for	O
detection	Task
.	O

We	O
further	O
merge	O
RPN	Method
and	Method
Fast	Method
R	Method
-	Method
CNN	Method
into	O
a	O
single	O
network	O
by	O
sharing	O
their	O
convolutional	O
features	O
—	O
using	O
the	O
recently	O
popular	O
terminology	O
of	O
neural	Method
networks	Method
with	O
“	O
attention	Method
”	Method
mechanisms	Method
,	O
the	O
RPN	Method
component	Method
tells	O
the	O
unified	Method
network	Method
where	O
to	O
look	O
.	O

For	O
the	O
very	O
deep	Method
VGG	Method
-	Method
16	Method
model	Method
,	O
our	O
detection	Method
system	Method
has	O
a	O
frame	Metric
rate	Metric
of	O
5fps	O
(	O
including	O
all	O
steps	O
)	O
on	O
a	O
GPU	O
,	O
while	O
achieving	O
state	O
-	O
of	O
-	O
the	O
-	O
art	O
object	Metric
detection	Metric
accuracy	Metric
on	O
PASCAL	Material
VOC	Material
2007	Material
,	O
2012	Material
,	O
and	O
MS	Material
COCO	Material
datasets	Material
with	O
only	O
300	O
proposals	O
per	O
image	O
.	O

In	O
ILSVRC	Material
and	Material
COCO	Material
2015	Material
competitions	Material
,	O
Faster	O
R	Method
-	Method
CNN	Method
and	O
RPN	Method
are	O
the	O
foundations	O
of	O
the	O
1st	O
-	O
place	O
winning	O
entries	O
in	O
several	O
tracks	O
.	O

Code	O
has	O
been	O
made	O
publicly	O
available	O
.	O

bject	Task
Detection	Task
,	O
Region	Method
Proposal	Method
,	O
Convolutional	Method
Neural	Method
Network	Method
.	O

section	O
:	O
Introduction	O
Recent	O
advances	O
in	O
object	Task
detection	Task
are	O
driven	O
by	O
the	O
success	O
of	O
region	Method
proposal	Method
methods	Method
(	O
,	O
)	O
and	O
region	Method
-	Method
based	Method
convolutional	Method
neural	Method
networks	Method
(	O
R	Method
-	Method
CNNs	Method
)	O
.	O

Although	O
region	Method
-	Method
based	Method
CNNs	Method
were	O
computationally	O
expensive	O
as	O
originally	O
developed	O
in	O
,	O
their	O
cost	O
has	O
been	O
drastically	O
reduced	O
thanks	O
to	O
sharing	O
convolutions	Method
across	O
proposals	O
.	O

The	O
latest	O
incarnation	O
,	O
Fast	Method
R	Method
-	Method
CNN	Method
,	O
achieves	O
near	O
real	Metric
-	Metric
time	Metric
rates	Metric
using	O
very	O
deep	Method
networks	Method
,	O
when	O
ignoring	O
the	O
time	O
spent	O
on	O
region	O
proposals	O
.	O

Now	O
,	O
proposals	O
are	O
the	O
test	O
-	O
time	Metric
computational	Metric
bottleneck	Metric
in	O
state	O
-	O
of	O
-	O
the	O
-	O
art	O
detection	Method
systems	Method
.	O

Region	Method
proposal	Method
methods	Method
typically	O
rely	O
on	O
inexpensive	O
features	O
and	O
economical	Method
inference	Method
schemes	Method
.	O

Selective	Method
Search	Method
,	O
one	O
of	O
the	O
most	O
popular	O
methods	O
,	O
greedily	O
merges	O
superpixels	Method
based	O
on	O
engineered	O
low	O
-	O
level	O
features	O
.	O

Yet	O
when	O
compared	O
to	O
efficient	O
detection	Method
networks	Method
,	O
Selective	Method
Search	Method
is	O
an	O
order	O
of	O
magnitude	O
slower	O
,	O
at	O
2	O
seconds	O
per	O
image	O
in	O
a	O
CPU	Method
implementation	Method
.	O

EdgeBoxes	Method
currently	O
provides	O
the	O
best	O
tradeoff	O
between	O
proposal	Metric
quality	Metric
and	O
speed	Metric
,	O
at	O
0.2	O
seconds	O
per	O
image	O
.	O

Nevertheless	O
,	O
the	O
region	Method
proposal	Method
step	Method
still	O
consumes	O
as	O
much	O
running	Metric
time	Metric
as	O
the	O
detection	Method
network	Method
.	O

One	O
may	O
note	O
that	O
fast	O
region	Method
-	Method
based	Method
CNNs	Method
take	O
advantage	O
of	O
GPUs	Method
,	O
while	O
the	O
region	Method
proposal	Method
methods	Method
used	O
in	O
research	O
are	O
implemented	O
on	O
the	O
CPU	O
,	O
making	O
such	O
runtime	Metric
comparisons	Metric
inequitable	O
.	O

An	O
obvious	O
way	O
to	O
accelerate	O
proposal	Task
computation	Task
is	O
to	O
re	O
-	O
implement	O
it	O
for	O
the	O
GPU	O
.	O

This	O
may	O
be	O
an	O
effective	O
engineering	Method
solution	Method
,	O
but	O
re	O
-	O
implementation	O
ignores	O
the	O
down	Method
-	Method
stream	Method
detection	Method
network	Method
and	O
therefore	O
misses	O
important	O
opportunities	O
for	O
sharing	Task
computation	Task
.	O

In	O
this	O
paper	O
,	O
we	O
show	O
that	O
an	O
algorithmic	O
change	O
—	O
computing	O
proposals	O
with	O
a	O
deep	Method
convolutional	Method
neural	Method
network	Method
—	O
leads	O
to	O
an	O
elegant	O
and	O
effective	O
solution	O
where	O
proposal	Task
computation	Task
is	O
nearly	O
cost	O
-	O
free	O
given	O
the	O
detection	Method
network	Method
’s	Method
computation	Method
.	O

To	O
this	O
end	O
,	O
we	O
introduce	O
novel	O
Region	Method
Proposal	Method
Networks	Method
(	O
RPNs	Method
)	O
that	O
share	O
convolutional	Method
layers	Method
with	O
state	O
-	O
of	O
-	O
the	O
-	O
art	O
object	Method
detection	Method
networks	Method
.	O

By	O
sharing	O
convolutions	Method
at	O
test	O
-	O
time	O
,	O
the	O
marginal	Metric
cost	Metric
for	O
computing	Task
proposals	Task
is	O
small	O
(	O
,	O
10ms	O
per	O
image	O
)	O
.	O

Our	O
observation	O
is	O
that	O
the	O
convolutional	Method
feature	Method
maps	Method
used	O
by	O
region	Method
-	Method
based	Method
detectors	Method
,	O
like	O
Fast	Method
R	Method
-	Method
CNN	Method
,	O
can	O
also	O
be	O
used	O
for	O
generating	O
region	Task
proposals	Task
.	O

On	O
top	O
of	O
these	O
convolutional	O
features	O
,	O
we	O
construct	O
an	O
RPN	Method
by	O
adding	O
a	O
few	O
additional	O
convolutional	Method
layers	Method
that	O
simultaneously	O
regress	O
region	O
bounds	O
and	O
objectness	O
scores	O
at	O
each	O
location	O
on	O
a	O
regular	O
grid	O
.	O

The	O
RPN	Method
is	O
thus	O
a	O
kind	O
of	O
fully	Method
convolutional	Method
network	Method
(	O
FCN	Method
)	O
and	O
can	O
be	O
trained	O
end	O
-	O
to	O
-	O
end	O
specifically	O
for	O
the	O
task	O
for	O
generating	Task
detection	Task
proposals	Task
.	O

RPNs	Method
are	O
designed	O
to	O
efficiently	O
predict	O
region	O
proposals	O
with	O
a	O
wide	O
range	O
of	O
scales	O
and	O
aspect	O
ratios	O
.	O

In	O
contrast	O
to	O
prevalent	O
methods	O
that	O
use	O
pyramids	O
of	O
images	O
(	O
Figure	O
[	O
reference	O
]	O
,	O
a	O
)	O
or	O
pyramids	O
of	O
filters	O
(	O
Figure	O
[	O
reference	O
]	O
,	O
b	O
)	O
,	O
we	O
introduce	O
novel	O
“	O
anchor	O
”	O
boxes	O
that	O
serve	O
as	O
references	O
at	O
multiple	O
scales	O
and	O
aspect	O
ratios	O
.	O

Our	O
scheme	O
can	O
be	O
thought	O
of	O
as	O
a	O
pyramid	Method
of	Method
regression	Method
references	Method
(	O
Figure	O
[	O
reference	O
]	O
,	O
c	O
)	O
,	O
which	O
avoids	O
enumerating	O
images	O
or	O
filters	O
of	O
multiple	O
scales	O
or	O
aspect	O
ratios	O
.	O

This	O
model	O
performs	O
well	O
when	O
trained	O
and	O
tested	O
using	O
single	Material
-	Material
scale	Material
images	Material
and	O
thus	O
benefits	O
running	Metric
speed	Metric
.	O

To	O
unify	O
RPNs	Method
with	O
Fast	O
R	Method
-	Method
CNN	Method
object	Method
detection	Method
networks	Method
,	O
we	O
propose	O
a	O
training	Method
scheme	Method
that	O
alternates	O
between	O
fine	Method
-	Method
tuning	Method
for	O
the	O
region	Task
proposal	Task
task	Task
and	O
then	O
fine	O
-	O
tuning	Task
for	O
object	Task
detection	Task
,	O
while	O
keeping	O
the	O
proposals	O
fixed	O
.	O

This	O
scheme	O
converges	O
quickly	O
and	O
produces	O
a	O
unified	Method
network	Method
with	O
convolutional	O
features	O
that	O
are	O
shared	O
between	O
both	O
tasks	O
.	O

We	O
comprehensively	O
evaluate	O
our	O
method	O
on	O
the	O
PASCAL	Task
VOC	Task
detection	Task
benchmarks	Task
where	O
RPNs	Method
with	O
Fast	Method
R	Method
-	Method
CNNs	Method
produce	O
detection	Metric
accuracy	Metric
better	O
than	O
the	O
strong	O
baseline	O
of	O
Selective	Method
Search	Method
with	O
Fast	Method
R	Method
-	Method
CNNs	Method
.	O

Meanwhile	O
,	O
our	O
method	O
waives	O
nearly	O
all	O
computational	Metric
burdens	Metric
of	O
Selective	Method
Search	Method
at	O
test	O
-	O
time	O
—	O
the	O
effective	O
running	Metric
time	Metric
for	O
proposals	Task
is	O
just	O
10	O
milliseconds	O
.	O

Using	O
the	O
expensive	O
very	O
deep	Method
models	Method
of	O
,	O
our	O
detection	Method
method	Method
still	O
has	O
a	O
frame	Metric
rate	Metric
of	O
5fps	O
(	O
including	O
all	O
steps	O
)	O
on	O
a	O
GPU	Method
,	O
and	O
thus	O
is	O
a	O
practical	O
object	Method
detection	Method
system	Method
in	O
terms	O
of	O
both	O
speed	Metric
and	O
accuracy	Metric
.	O

We	O
also	O
report	O
results	O
on	O
the	O
MS	Material
COCO	Material
dataset	Material
and	O
investigate	O
the	O
improvements	O
on	O
PASCAL	Task
VOC	Task
using	O
the	O
COCO	Material
data	Material
.	O

Code	O
has	O
been	O
made	O
publicly	O
available	O
at	O
(	O
in	O
MATLAB	Material
)	O
and	O
(	O
in	O
Python	Material
)	O
.	O

A	O
preliminary	O
version	O
of	O
this	O
manuscript	O
was	O
published	O
previously	O
.	O

Since	O
then	O
,	O
the	O
frameworks	O
of	O
RPN	Method
and	Method
Faster	Method
R	Method
-	Method
CNN	Method
have	O
been	O
adopted	O
and	O
generalized	O
to	O
other	O
methods	O
,	O
such	O
as	O
3D	Task
object	Task
detection	Task
,	O
part	Task
-	Task
based	Task
detection	Task
,	O
instance	Task
segmentation	Task
,	O
and	O
image	Task
captioning	Task
.	O

Our	O
fast	O
and	O
effective	O
object	Method
detection	Method
system	Method
has	O
also	O
been	O
built	O
in	O
commercial	O
systems	O
such	O
as	O
at	O
Pinterests	Method
,	O
with	O
user	O
engagement	O
improvements	O
reported	O
.	O

In	O
ILSVRC	Material
and	Material
COCO	Material
2015	Material
competitions	Material
,	O
Faster	O
R	Method
-	Method
CNN	Method
and	O
RPN	Method
are	O
the	O
basis	O
of	O
several	O
1st	O
-	O
place	O
entries	O
in	O
the	O
tracks	O
of	O
ImageNet	Task
detection	Task
,	O
ImageNet	Task
localization	Task
,	O
COCO	Task
detection	Task
,	O
and	O
COCO	Task
segmentation	Task
.	O

RPNs	Method
completely	O
learn	O
to	O
propose	O
regions	O
from	O
data	O
,	O
and	O
thus	O
can	O
easily	O
benefit	O
from	O
deeper	O
and	O
more	O
expressive	O
features	O
(	O
such	O
as	O
the	O
101	Method
-	Method
layer	Method
residual	Method
nets	Method
adopted	O
in	O
)	O
.	O

Faster	Method
R	Method
-	Method
CNN	Method
and	O
RPN	Method
are	O
also	O
used	O
by	O
several	O
other	O
leading	O
entries	O
in	O
these	O
competitions	O
.	O

These	O
results	O
suggest	O
that	O
our	O
method	O
is	O
not	O
only	O
a	O
cost	O
-	O
efficient	O
solution	O
for	O
practical	O
usage	O
,	O
but	O
also	O
an	O
effective	O
way	O
of	O
improving	O
object	Task
detection	Task
accuracy	Task
.	O

section	O
:	O
Related	O
Work	O
Object	Task
Proposals	Task
.	O

There	O
is	O
a	O
large	O
literature	O
on	O
object	Method
proposal	Method
methods	Method
.	O

Comprehensive	O
surveys	O
and	O
comparisons	O
of	O
object	Method
proposal	Method
methods	Method
can	O
be	O
found	O
in	O
.	O

Widely	O
used	O
object	Method
proposal	Method
methods	Method
include	O
those	O
based	O
on	O
grouping	O
super	O
-	O
pixels	O
(	O
,	O
Selective	Method
Search	Method
,	O
CPMC	Method
,	O
MCG	Method
)	O
and	O
those	O
based	O
on	O
sliding	O
windows	O
(	O
,	O
objectness	O
in	O
windows	O
,	O
EdgeBoxes	O
)	O
.	O

Object	Method
proposal	Method
methods	Method
were	O
adopted	O
as	O
external	Method
modules	Method
independent	O
of	O
the	O
detectors	O
(	O
,	O
Selective	Method
Search	Method
object	Method
detectors	Method
,	O
R	Method
-	Method
CNN	Method
,	O
and	O
Fast	Method
R	Method
-	Method
CNN	Method
)	O
.	O

Deep	Method
Networks	Method
for	O
Object	Task
Detection	Task
.	O

The	O
R	Method
-	Method
CNN	Method
method	Method
trains	O
CNNs	Method
end	O
-	O
to	O
-	O
end	O
to	O
classify	O
the	O
proposal	O
regions	O
into	O
object	O
categories	O
or	O
background	O
.	O

R	Method
-	Method
CNN	Method
mainly	O
plays	O
as	O
a	O
classifier	Method
,	O
and	O
it	O
does	O
not	O
predict	O
object	O
bounds	O
(	O
except	O
for	O
refining	O
by	O
bounding	Method
box	Method
regression	Method
)	O
.	O

Its	O
accuracy	Metric
depends	O
on	O
the	O
performance	O
of	O
the	O
region	Method
proposal	Method
module	Method
(	O
see	O
comparisons	O
in	O
)	O
.	O

Several	O
papers	O
have	O
proposed	O
ways	O
of	O
using	O
deep	Method
networks	Method
for	O
predicting	Task
object	Task
bounding	Task
boxes	Task
.	O

In	O
the	O
OverFeat	Method
method	Method
,	O
a	O
fully	Method
-	Method
connected	Method
layer	Method
is	O
trained	O
to	O
predict	O
the	O
box	O
coordinates	O
for	O
the	O
localization	Task
task	Task
that	O
assumes	O
a	O
single	O
object	O
.	O

The	O
fully	Method
-	Method
connected	Method
layer	Method
is	O
then	O
turned	O
into	O
a	O
convolutional	Method
layer	Method
for	O
detecting	Task
multiple	Task
class	Task
-	Task
specific	Task
objects	Task
.	O

The	O
MultiBox	Method
methods	Method
generate	O
region	O
proposals	O
from	O
a	O
network	O
whose	O
last	O
fully	Method
-	Method
connected	Method
layer	Method
simultaneously	O
predicts	O
multiple	O
class	O
-	O
agnostic	O
boxes	O
,	O
generalizing	O
the	O
“	O
single	O
-	O
box	O
”	O
fashion	O
of	O
OverFeat	Method
.	O

These	O
class	Method
-	Method
agnostic	Method
boxes	Method
are	O
used	O
as	O
proposals	O
for	O
R	Task
-	Task
CNN	Task
.	O

The	O
MultiBox	Method
proposal	Method
network	Method
is	O
applied	O
on	O
a	O
single	O
image	Task
crop	Task
or	O
multiple	O
large	O
image	Material
crops	Material
(	O
,	O
224	O
224	O
)	O
,	O
in	O
contrast	O
to	O
our	O
fully	Method
convolutional	Method
scheme	Method
.	O

MultiBox	Method
does	O
not	O
share	O
features	O
between	O
the	O
proposal	Method
and	Method
detection	Method
networks	Method
.	O

We	O
discuss	O
OverFeat	Method
and	O
MultiBox	O
in	O
more	O
depth	O
later	O
in	O
context	O
with	O
our	O
method	O
.	O

Concurrent	O
with	O
our	O
work	O
,	O
the	O
DeepMask	Method
method	Method
is	O
developed	O
for	O
learning	Task
segmentation	Task
proposals	Task
.	O

Shared	Method
computation	Method
of	Method
convolutions	Method
has	O
been	O
attracting	O
increasing	O
attention	O
for	O
efficient	O
,	O
yet	O
accurate	O
,	O
visual	Task
recognition	Task
.	O

The	O
OverFeat	O
paper	O
computes	O
convolutional	O
features	O
from	O
an	O
image	O
pyramid	O
for	O
classification	Task
,	O
localization	Task
,	O
and	O
detection	Task
.	O

Adaptively	Method
-	Method
sized	Method
pooling	Method
(	O
SPP	Method
)	O
on	O
shared	Method
convolutional	Method
feature	Method
maps	Method
is	O
developed	O
for	O
efficient	O
region	Task
-	Task
based	Task
object	Task
detection	Task
and	Task
semantic	Task
segmentation	Task
.	O

Fast	O
R	Method
-	Method
CNN	Method
enables	O
end	O
-	O
to	O
-	O
end	Task
detector	Task
training	Task
on	O
shared	O
convolutional	O
features	O
and	O
shows	O
compelling	O
accuracy	Metric
and	O
speed	Metric
.	O

section	O
:	O
Faster	O
R	Method
-	Method
CNN	Method
Our	O
object	Method
detection	Method
system	Method
,	O
called	O
Faster	Method
R	Method
-	Method
CNN	Method
,	O
is	O
composed	O
of	O
two	O
modules	O
.	O

The	O
first	O
module	O
is	O
a	O
deep	Method
fully	Method
convolutional	Method
network	Method
that	O
proposes	O
regions	O
,	O
and	O
the	O
second	O
module	O
is	O
the	O
Fast	Method
R	Method
-	Method
CNN	Method
detector	Method
that	O
uses	O
the	O
proposed	O
regions	O
.	O

The	O
entire	O
system	O
is	O
a	O
single	O
,	O
unified	Method
network	Method
for	O
object	Task
detection	Task
(	O
Figure	O
[	O
reference	O
]	O
)	O
.	O

Using	O
the	O
recently	O
popular	O
terminology	O
of	O
neural	Method
networks	Method
with	O
‘	O
attention	Method
’	Method
mechanisms	Method
,	O
the	O
RPN	Method
module	Method
tells	O
the	O
Fast	Method
R	Method
-	Method
CNN	Method
module	Method
where	O
to	O
look	O
.	O

In	O
Section	O
[	O
reference	O
]	O
we	O
introduce	O
the	O
designs	O
and	O
properties	O
of	O
the	O
network	O
for	O
region	Task
proposal	Task
.	O

In	O
Section	O
[	O
reference	O
]	O
we	O
develop	O
algorithms	O
for	O
training	O
both	O
modules	O
with	O
features	O
shared	O
.	O

subsection	O
:	O
Region	Method
Proposal	Method
Networks	Method
A	O
Region	Method
Proposal	Method
Network	Method
(	O
RPN	Method
)	O
takes	O
an	O
image	O
(	O
of	O
any	O
size	O
)	O
as	O
input	O
and	O
outputs	O
a	O
set	O
of	O
rectangular	O
object	O
proposals	O
,	O
each	O
with	O
an	O
objectness	Metric
score	Metric
.	O

We	O
model	O
this	O
process	O
with	O
a	O
fully	Method
convolutional	Method
network	Method
,	O
which	O
we	O
describe	O
in	O
this	O
section	O
.	O

Because	O
our	O
ultimate	O
goal	O
is	O
to	O
share	O
computation	O
with	O
a	O
Fast	O
R	Method
-	Method
CNN	Method
object	Method
detection	Method
network	Method
,	O
we	O
assume	O
that	O
both	O
nets	O
share	O
a	O
common	O
set	O
of	O
convolutional	Method
layers	Method
.	O

In	O
our	O
experiments	O
,	O
we	O
investigate	O
the	O
Zeiler	Method
and	Method
Fergus	Method
model	Method
(	O
ZF	Method
)	Method
,	O
which	O
has	O
5	O
shareable	Method
convolutional	Method
layers	Method
and	O
the	O
Simonyan	Method
and	Method
Zisserman	Method
model	Method
(	O
VGG	Method
-	Method
16	Method
)	Method
,	O
which	O
has	O
13	O
shareable	O
convolutional	Method
layers	Method
.	O

To	O
generate	O
region	Task
proposals	Task
,	O
we	O
slide	O
a	O
small	Method
network	Method
over	O
the	O
convolutional	O
feature	O
map	O
output	O
by	O
the	O
last	O
shared	Method
convolutional	Method
layer	Method
.	O

This	O
small	Method
network	Method
takes	O
as	O
input	O
an	O
spatial	O
window	O
of	O
the	O
input	O
convolutional	O
feature	O
map	O
.	O

Each	O
sliding	O
window	O
is	O
mapped	O
to	O
a	O
lower	O
-	O
dimensional	O
feature	O
(	O
256	O
-	O
d	O
for	O
ZF	O
and	O
512	O
-	O
d	O
for	O
VGG	Method
,	O
with	O
ReLU	O
following	O
)	O
.	O

This	O
feature	O
is	O
fed	O
into	O
two	O
sibling	O
fully	Method
-	Method
connected	Method
layers	Method
—	O
a	O
box	Method
-	Method
regression	Method
layer	Method
(	O
reg	Method
)	O
and	O
a	O
box	Method
-	Method
classification	Method
layer	Method
(	O
cls	Method
)	O
.	O

We	O
use	O
in	O
this	O
paper	O
,	O
noting	O
that	O
the	O
effective	O
receptive	O
field	O
on	O
the	O
input	O
image	O
is	O
large	O
(	O
171	O
and	O
228	O
pixels	O
for	O
ZF	Method
and	O
VGG	Method
,	O
respectively	O
)	O
.	O

This	O
mini	Method
-	Method
network	Method
is	O
illustrated	O
at	O
a	O
single	O
position	O
in	O
Figure	O
[	O
reference	O
]	O
(	O
left	O
)	O
.	O

Note	O
that	O
because	O
the	O
mini	Method
-	Method
network	Method
operates	O
in	O
a	O
sliding	Method
-	Method
window	Method
fashion	Method
,	O
the	O
fully	Method
-	Method
connected	Method
layers	Method
are	O
shared	O
across	O
all	O
spatial	O
locations	O
.	O

This	O
architecture	O
is	O
naturally	O
implemented	O
with	O
an	O
convolutional	Method
layer	Method
followed	O
by	O
two	O
sibling	Method
convolutional	Method
layers	Method
(	O
for	O
reg	Method
and	O
cls	Method
,	O
respectively	O
)	O
.	O

subsubsection	Method
:	O
Anchors	O
At	O
each	O
sliding	O
-	O
window	O
location	O
,	O
we	O
simultaneously	O
predict	O
multiple	O
region	O
proposals	O
,	O
where	O
the	O
number	O
of	O
maximum	O
possible	O
proposals	O
for	O
each	O
location	O
is	O
denoted	O
as	O
.	O

So	O
the	O
reg	Method
layer	Method
has	O
outputs	O
encoding	O
the	O
coordinates	O
of	O
boxes	O
,	O
and	O
the	O
cls	Method
layer	Method
outputs	O
scores	O
that	O
estimate	O
probability	O
of	O
object	O
or	O
not	O
object	O
for	O
each	O
proposal	O
.	O

The	O
proposals	O
are	O
parameterized	O
relative	O
to	O
reference	O
boxes	O
,	O
which	O
we	O
call	O
anchors	O
.	O

An	O
anchor	O
is	O
centered	O
at	O
the	O
sliding	O
window	O
in	O
question	O
,	O
and	O
is	O
associated	O
with	O
a	O
scale	O
and	O
aspect	O
ratio	O
(	O
Figure	O
[	O
reference	O
]	O
,	O
left	O
)	O
.	O

By	O
default	O
we	O
use	O
3	O
scales	O
and	O
3	O
aspect	O
ratios	O
,	O
yielding	O
anchors	O
at	O
each	O
sliding	O
position	O
.	O

For	O
a	O
convolutional	Method
feature	Method
map	Method
of	O
a	O
size	O
(	O
typically	O
2	O
,	O
400	O
)	O
,	O
there	O
are	O
anchors	O
in	O
total	O
.	O

Translation	O
-	O
Invariant	O
Anchors	O
An	O
important	O
property	O
of	O
our	O
approach	O
is	O
that	O
it	O
is	O
translation	O
invariant	O
,	O
both	O
in	O
terms	O
of	O
the	O
anchors	O
and	O
the	O
functions	O
that	O
compute	O
proposals	O
relative	O
to	O
the	O
anchors	O
.	O

If	O
one	O
translates	O
an	O
object	O
in	O
an	O
image	O
,	O
the	O
proposal	O
should	O
translate	O
and	O
the	O
same	O
function	O
should	O
be	O
able	O
to	O
predict	O
the	O
proposal	O
in	O
either	O
location	O
.	O

This	O
translation	O
-	O
invariant	O
property	O
is	O
guaranteed	O
by	O
our	O
method	O
.	O

As	O
a	O
comparison	O
,	O
the	O
MultiBox	Method
method	Method
uses	O
k	Method
-	Method
means	Method
to	O
generate	O
800	O
anchors	O
,	O
which	O
are	O
not	O
translation	O
invariant	O
.	O

So	O
MultiBox	Method
does	O
not	O
guarantee	O
that	O
the	O
same	O
proposal	O
is	O
generated	O
if	O
an	O
object	O
is	O
translated	O
.	O

The	O
translation	O
-	O
invariant	O
property	O
also	O
reduces	O
the	O
model	Metric
size	Metric
.	O

MultiBox	Method
has	O
a	O
-	O
dimensional	O
fully	O
-	O
connected	O
output	O
layer	O
,	O
whereas	O
our	O
method	O
has	O
a	O
-	Method
dimensional	Method
convolutional	Method
output	Method
layer	Method
in	O
the	O
case	O
of	O
anchors	O
.	O

As	O
a	O
result	O
,	O
our	O
output	Method
layer	Method
has	O
parameters	O
(	O
for	O
VGG	Method
-	Method
16	Method
)	O
,	O
two	O
orders	O
of	O
magnitude	O
fewer	O
than	O
MultiBox	Method
’s	Method
output	Method
layer	Method
that	O
has	O
parameters	O
(	O
for	O
GoogleNet	Material
in	O
MultiBox	Material
)	O
.	O

If	O
considering	O
the	O
feature	Method
projection	Method
layers	Method
,	O
our	O
proposal	Method
layers	Method
still	O
have	O
an	O
order	O
of	O
magnitude	O
fewer	O
parameters	O
than	O
MultiBox	O
.	O

We	O
expect	O
our	O
method	O
to	O
have	O
less	O
risk	O
of	O
overfitting	Metric
on	O
small	Material
datasets	Material
,	O
like	O
PASCAL	Material
VOC	Material
.	O

Multi	Task
-	Task
Scale	Task
Anchors	Task
as	O
Regression	O
References	O
Our	O
design	O
of	O
anchors	Method
presents	O
a	O
novel	O
scheme	O
for	O
addressing	O
multiple	O
scales	O
(	O
and	O
aspect	O
ratios	O
)	O
.	O

As	O
shown	O
in	O
Figure	O
[	O
reference	O
]	O
,	O
there	O
have	O
been	O
two	O
popular	O
ways	O
for	O
multi	Task
-	Task
scale	Task
predictions	Task
.	O

The	O
first	O
way	O
is	O
based	O
on	O
image	Method
/	Method
feature	Method
pyramids	Method
,	O
,	O
in	O
DPM	Method
and	Method
CNN	Method
-	Method
based	Method
methods	Method
.	O

The	O
images	O
are	O
resized	O
at	O
multiple	O
scales	O
,	O
and	O
feature	O
maps	O
(	O
HOG	O
or	O
deep	O
convolutional	O
features	O
)	O
are	O
computed	O
for	O
each	O
scale	O
(	O
Figure	O
[	O
reference	O
]	O
(	O
a	O
)	O
)	O
.	O

This	O
way	O
is	O
often	O
useful	O
but	O
is	O
time	O
-	O
consuming	O
.	O

The	O
second	O
way	O
is	O
to	O
use	O
sliding	O
windows	O
of	O
multiple	O
scales	O
(	O
and	O
/	O
or	O
aspect	O
ratios	O
)	O
on	O
the	O
feature	O
maps	O
.	O

For	O
example	O
,	O
in	O
DPM	Method
,	O
models	O
of	O
different	O
aspect	O
ratios	O
are	O
trained	O
separately	O
using	O
different	O
filter	O
sizes	O
(	O
such	O
as	O
5	O
7	O
and	O
7	O
5	O
)	O
.	O

If	O
this	O
way	O
is	O
used	O
to	O
address	O
multiple	O
scales	O
,	O
it	O
can	O
be	O
thought	O
of	O
as	O
a	O
“	O
pyramid	Method
of	Method
filters	Method
”	O
(	O
Figure	O
[	O
reference	O
]	O
(	O
b	O
)	O
)	O
.	O

The	O
second	O
way	O
is	O
usually	O
adopted	O
jointly	O
with	O
the	O
first	O
way	O
.	O

As	O
a	O
comparison	O
,	O
our	O
anchor	Method
-	Method
based	Method
method	Method
is	O
built	O
on	O
a	O
pyramid	Method
of	Method
anchors	Method
,	O
which	O
is	O
more	O
cost	O
-	O
efficient	O
.	O

Our	O
method	O
classifies	O
and	O
regresses	O
bounding	O
boxes	O
with	O
reference	O
to	O
anchor	O
boxes	O
of	O
multiple	O
scales	O
and	O
aspect	O
ratios	O
.	O

It	O
only	O
relies	O
on	O
images	Material
and	O
feature	O
maps	O
of	O
a	O
single	O
scale	O
,	O
and	O
uses	O
filters	Method
(	O
sliding	O
windows	O
on	O
the	O
feature	O
map	O
)	O
of	O
a	O
single	O
size	O
.	O

We	O
show	O
by	O
experiments	O
the	O
effects	O
of	O
this	O
scheme	O
for	O
addressing	O
multiple	O
scales	O
and	O
sizes	O
(	O
Table	O
[	O
reference	O
]	O
)	O
.	O

Because	O
of	O
this	O
multi	Method
-	Method
scale	Method
design	Method
based	O
on	O
anchors	O
,	O
we	O
can	O
simply	O
use	O
the	O
convolutional	O
features	O
computed	O
on	O
a	O
single	O
-	O
scale	Material
image	Material
,	O
as	O
is	O
also	O
done	O
by	O
the	O
Fast	Method
R	Method
-	Method
CNN	Method
detector	Method
.	O

The	O
design	O
of	O
multi	Method
-	Method
scale	Method
anchors	Method
is	O
a	O
key	O
component	O
for	O
sharing	O
features	O
without	O
extra	O
cost	O
for	O
addressing	O
scales	O
.	O

subsubsection	Method
:	O
Loss	Method
Function	Method
For	O
training	O
RPNs	Task
,	O
we	O
assign	O
a	O
binary	O
class	O
label	O
(	O
of	O
being	O
an	O
object	O
or	O
not	O
)	O
to	O
each	O
anchor	O
.	O

We	O
assign	O
a	O
positive	O
label	O
to	O
two	O
kinds	O
of	O
anchors	O
:	O
(	O
i	O
)	O
the	O
anchor	O
/	O
anchors	O
with	O
the	O
highest	O
Intersection	Metric
-	Metric
over	Metric
-	Metric
Union	Metric
(	O
IoU	O
)	O
overlap	O
with	O
a	O
ground	O
-	O
truth	O
box	O
,	O
or	O
(	O
ii	O
)	O
an	O
anchor	O
that	O
has	O
an	O
IoU	O
overlap	O
higher	O
than	O
0.7	O
with	O
any	O
ground	O
-	O
truth	O
box	O
.	O

Note	O
that	O
a	O
single	O
ground	O
-	O
truth	O
box	O
may	O
assign	O
positive	O
labels	O
to	O
multiple	O
anchors	O
.	O

Usually	O
the	O
second	O
condition	O
is	O
sufficient	O
to	O
determine	O
the	O
positive	O
samples	O
;	O
but	O
we	O
still	O
adopt	O
the	O
first	O
condition	O
for	O
the	O
reason	O
that	O
in	O
some	O
rare	O
cases	O
the	O
second	O
condition	O
may	O
find	O
no	O
positive	O
sample	O
.	O

We	O
assign	O
a	O
negative	O
label	O
to	O
a	O
non	O
-	O
positive	O
anchor	O
if	O
its	O
IoU	Metric
ratio	Metric
is	O
lower	O
than	O
0.3	O
for	O
all	O
ground	O
-	O
truth	O
boxes	O
.	O

Anchors	O
that	O
are	O
neither	O
positive	O
nor	O
negative	O
do	O
not	O
contribute	O
to	O
the	O
training	Metric
objective	Metric
.	O

With	O
these	O
definitions	O
,	O
we	O
minimize	O
an	O
objective	O
function	O
following	O
the	O
multi	Task
-	Task
task	Task
loss	Task
in	O
Fast	Task
R	Task
-	Task
CNN	Task
.	O

Our	O
loss	Method
function	Method
for	O
an	O
image	O
is	O
defined	O
as	O
:	O
Here	O
,	O
is	O
the	O
index	O
of	O
an	O
anchor	O
in	O
a	O
mini	O
-	O
batch	O
and	O
is	O
the	O
predicted	O
probability	O
of	O
anchor	O
being	O
an	O
object	O
.	O

The	O
ground	O
-	O
truth	O
label	O
is	O
1	O
if	O
the	O
anchor	O
is	O
positive	O
,	O
and	O
is	O
0	O
if	O
the	O
anchor	O
is	O
negative	O
.	O

is	O
a	O
vector	O
representing	O
the	O
4	O
parameterized	O
coordinates	O
of	O
the	O
predicted	O
bounding	O
box	O
,	O
and	O
is	O
that	O
of	O
the	O
ground	O
-	O
truth	O
box	O
associated	O
with	O
a	O
positive	O
anchor	O
.	O

The	O
classification	Metric
loss	Metric
is	O
log	O
loss	O
over	O
two	O
classes	O
(	O
object	O
not	O
object	O
)	O
.	O

For	O
the	O
regression	Task
loss	Task
,	O
we	O
use	O
where	O
is	O
the	O
robust	O
loss	O
function	O
(	O
smooth	O
L	O
)	O
defined	O
in	O
.	O

The	O
term	O
means	O
the	O
regression	O
loss	O
is	O
activated	O
only	O
for	O
positive	O
anchors	O
(	O
)	O
and	O
is	O
disabled	O
otherwise	O
(	O
)	O
.	O

The	O
outputs	O
of	O
the	O
cls	Method
and	Method
reg	Method
layers	Method
consist	O
of	O
and	O
respectively	O
.	O

The	O
two	O
terms	O
are	O
normalized	O
by	O
and	O
and	O
weighted	O
by	O
a	O
balancing	O
parameter	O
.	O

In	O
our	O
current	O
implementation	O
(	O
as	O
in	O
the	O
released	O
code	O
)	O
,	O
the	O
term	O
in	O
Eqn	O
.	O

(	O
[	O
reference	O
]	O
)	O
is	O
normalized	O
by	O
the	O
mini	O
-	O
batch	O
size	O
(	O
,	O
)	O
and	O
the	O
term	O
is	O
normalized	O
by	O
the	O
number	O
of	O
anchor	O
locations	O
(	O
,	O
)	O
.	O

By	O
default	O
we	O
set	O
,	O
and	O
thus	O
both	O
cls	O
and	O
reg	O
terms	O
are	O
roughly	O
equally	O
weighted	O
.	O

We	O
show	O
by	O
experiments	O
that	O
the	O
results	O
are	O
insensitive	O
to	O
the	O
values	O
of	O
in	O
a	O
wide	O
range	O
(	O
Table	O
[	O
reference	O
]	O
)	O
.	O

We	O
also	O
note	O
that	O
the	O
normalization	O
as	O
above	O
is	O
not	O
required	O
and	O
could	O
be	O
simplified	O
.	O

For	O
bounding	Task
box	Task
regression	Task
,	O
we	O
adopt	O
the	O
parameterizations	O
of	O
the	O
4	O
coordinates	O
following	O
:	O
where	O
,	O
,	O
,	O
and	O
denote	O
the	O
box	O
’s	O
center	O
coordinates	O
and	O
its	O
width	O
and	O
height	O
.	O

Variables	O
,	O
,	O
and	O
are	O
for	O
the	O
predicted	O
box	O
,	O
anchor	O
box	O
,	O
and	O
ground	O
-	O
truth	O
box	O
respectively	O
(	O
likewise	O
for	O
)	O
.	O

This	O
can	O
be	O
thought	O
of	O
as	O
bounding	Method
-	Method
box	Method
regression	Method
from	O
an	O
anchor	O
box	O
to	O
a	O
nearby	O
ground	O
-	O
truth	O
box	O
.	O

Nevertheless	O
,	O
our	O
method	O
achieves	O
bounding	Task
-	Task
box	Task
regression	Task
by	O
a	O
different	O
manner	O
from	O
previous	O
RoI	Method
-	Method
based	Method
(	Method
Region	Method
of	Method
Interest	Method
)	Method
methods	Method
.	O

In	O
,	O
bounding	Method
-	Method
box	Method
regression	Method
is	O
performed	O
on	O
features	O
pooled	O
from	O
arbitrarily	O
sized	O
RoIs	O
,	O
and	O
the	O
regression	O
weights	O
are	O
shared	O
by	O
all	O
region	O
sizes	O
.	O

In	O
our	O
formulation	O
,	O
the	O
features	O
used	O
for	O
regression	Task
are	O
of	O
the	O
same	O
spatial	O
size	O
(	O
)	O
on	O
the	O
feature	O
maps	O
.	O

To	O
account	O
for	O
varying	O
sizes	O
,	O
a	O
set	O
of	O
bounding	Method
-	Method
box	Method
regressors	Method
are	O
learned	O
.	O

Each	O
regressor	O
is	O
responsible	O
for	O
one	O
scale	O
and	O
one	O
aspect	O
ratio	O
,	O
and	O
the	O
regressors	O
do	O
not	O
share	O
weights	O
.	O

As	O
such	O
,	O
it	O
is	O
still	O
possible	O
to	O
predict	O
boxes	O
of	O
various	O
sizes	O
even	O
though	O
the	O
features	O
are	O
of	O
a	O
fixed	O
size	O
/	O
scale	O
,	O
thanks	O
to	O
the	O
design	O
of	O
anchors	O
.	O

subsubsection	Method
:	O
Training	O
RPNs	Method
The	O
RPN	Method
can	O
be	O
trained	O
end	O
-	O
to	O
-	O
end	O
by	O
back	Method
-	Method
propagation	Method
and	O
stochastic	Method
gradient	Method
descent	Method
(	O
SGD	Method
)	O
.	O

We	O
follow	O
the	O
“	O
image	Method
-	Method
centric	Method
”	Method
sampling	Method
strategy	Method
from	O
to	O
train	O
this	O
network	O
.	O

Each	O
mini	O
-	O
batch	O
arises	O
from	O
a	O
single	O
image	O
that	O
contains	O
many	O
positive	Material
and	Material
negative	Material
example	Material
anchors	Material
.	O

It	O
is	O
possible	O
to	O
optimize	O
for	O
the	O
loss	O
functions	O
of	O
all	O
anchors	O
,	O
but	O
this	O
will	O
bias	O
towards	O
negative	O
samples	O
as	O
they	O
are	O
dominate	O
.	O

Instead	O
,	O
we	O
randomly	O
sample	O
256	O
anchors	O
in	O
an	O
image	O
to	O
compute	O
the	O
loss	O
function	O
of	O
a	O
mini	Method
-	Method
batch	Method
,	O
where	O
the	O
sampled	O
positive	O
and	O
negative	O
anchors	O
have	O
a	O
ratio	O
of	O
up	O
to	O
1:1	O
.	O

If	O
there	O
are	O
fewer	O
than	O
128	O
positive	O
samples	O
in	O
an	O
image	O
,	O
we	O
pad	O
the	O
mini	O
-	O
batch	O
with	O
negative	O
ones	O
.	O

We	O
randomly	O
initialize	O
all	O
new	O
layers	O
by	O
drawing	O
weights	O
from	O
a	O
zero	Method
-	Method
mean	Method
Gaussian	Method
distribution	Method
with	O
standard	O
deviation	O
0.01	O
.	O

All	O
other	O
layers	O
(	O
,	O
the	O
shared	Method
convolutional	Method
layers	Method
)	O
are	O
initialized	O
by	O
pre	O
-	O
training	O
a	O
model	O
for	O
ImageNet	Task
classification	Task
,	O
as	O
is	O
standard	O
practice	O
.	O

We	O
tune	O
all	O
layers	O
of	O
the	O
ZF	Method
net	Method
,	O
and	O
conv3	Method
and	O
up	O
for	O
the	O
VGG	Method
net	Method
to	O
conserve	O
memory	O
.	O

We	O
use	O
a	O
learning	Metric
rate	Metric
of	O
0.001	O
for	O
60k	O
mini	O
-	O
batches	O
,	O
and	O
0.0001	O
for	O
the	O
next	O
20k	O
mini	O
-	O
batches	O
on	O
the	O
PASCAL	Material
VOC	Material
dataset	Material
.	O

We	O
use	O
a	O
momentum	O
of	O
0.9	O
and	O
a	O
weight	O
decay	O
of	O
0.0005	O
.	O

Our	O
implementation	O
uses	O
Caffe	Method
.	O

subsection	O
:	O
Sharing	O
Features	O
for	O
RPN	Method
and	O
Fast	Method
R	Method
-	Method
CNN	Method
Thus	O
far	O
we	O
have	O
described	O
how	O
to	O
train	O
a	O
network	O
for	O
region	Task
proposal	Task
generation	Task
,	O
without	O
considering	O
the	O
region	Method
-	Method
based	Method
object	Method
detection	Method
CNN	Method
that	O
will	O
utilize	O
these	O
proposals	O
.	O

For	O
the	O
detection	Task
network	Task
,	O
we	O
adopt	O
Fast	Method
R	Method
-	Method
CNN	Method
.	O

Next	O
we	O
describe	O
algorithms	O
that	O
learn	O
a	O
unified	Method
network	Method
composed	O
of	O
RPN	Method
and	Method
Fast	Method
R	Method
-	Method
CNN	Method
with	O
shared	Method
convolutional	Method
layers	Method
(	O
Figure	O
[	O
reference	O
]	O
)	O
.	O

Both	O
RPN	Method
and	O
Fast	Method
R	Method
-	Method
CNN	Method
,	O
trained	O
independently	O
,	O
will	O
modify	O
their	O
convolutional	Method
layers	Method
in	O
different	O
ways	O
.	O

We	O
therefore	O
need	O
to	O
develop	O
a	O
technique	O
that	O
allows	O
for	O
sharing	O
convolutional	O
layers	O
between	O
the	O
two	O
networks	O
,	O
rather	O
than	O
learning	O
two	O
separate	O
networks	O
.	O

We	O
discuss	O
three	O
ways	O
for	O
training	Task
networks	Task
with	O
features	O
shared	O
:	O
(	O
i	O
)	O
Alternating	Method
training	Method
.	O

In	O
this	O
solution	O
,	O
we	O
first	O
train	O
RPN	Method
,	O
and	O
use	O
the	O
proposals	O
to	O
train	O
Fast	Method
R	Method
-	Method
CNN	Method
.	O

The	O
network	O
tuned	O
by	O
Fast	Method
R	Method
-	Method
CNN	Method
is	O
then	O
used	O
to	O
initialize	O
RPN	Method
,	O
and	O
this	O
process	O
is	O
iterated	O
.	O

This	O
is	O
the	O
solution	O
that	O
is	O
used	O
in	O
all	O
experiments	O
in	O
this	O
paper	O
.	O

(	O
ii	O
)	O
Approximate	Method
joint	Method
training	Method
.	O

In	O
this	O
solution	O
,	O
the	O
RPN	Method
and	Method
Fast	Method
R	Method
-	Method
CNN	Method
networks	Method
are	O
merged	O
into	O
one	O
network	O
during	O
training	O
as	O
in	O
Figure	O
[	O
reference	O
]	O
.	O

In	O
each	O
SGD	Method
iteration	Method
,	O
the	O
forward	Method
pass	Method
generates	O
region	O
proposals	O
which	O
are	O
treated	O
just	O
like	O
fixed	O
,	O
pre	O
-	O
computed	O
proposals	O
when	O
training	O
a	O
Fast	Method
R	Method
-	Method
CNN	Method
detector	Method
.	O

The	O
backward	Method
propagation	Method
takes	O
place	O
as	O
usual	O
,	O
where	O
for	O
the	O
shared	O
layers	O
the	O
backward	O
propagated	O
signals	O
from	O
both	O
the	O
RPN	Method
loss	Method
and	O
the	O
Fast	Method
R	Method
-	Method
CNN	Method
loss	Method
are	O
combined	O
.	O

This	O
solution	O
is	O
easy	O
to	O
implement	O
.	O

But	O
this	O
solution	O
ignores	O
the	O
derivative	O
the	O
proposal	O
boxes	O
’	O
coordinates	O
that	O
are	O
also	O
network	O
responses	O
,	O
so	O
is	O
approximate	O
.	O

In	O
our	O
experiments	O
,	O
we	O
have	O
empirically	O
found	O
this	O
solver	O
produces	O
close	O
results	O
,	O
yet	O
reduces	O
the	O
training	Metric
time	Metric
by	O
about	O
25	O
-	O
50	O
%	O
comparing	O
with	O
alternating	Method
training	Method
.	O

This	O
solver	O
is	O
included	O
in	O
our	O
released	O
Python	Material
code	Material
.	O

(	O
iii	O
)	O
Non	Method
-	Method
approximate	Method
joint	Method
training	Method
.	O

As	O
discussed	O
above	O
,	O
the	O
bounding	O
boxes	O
predicted	O
by	O
RPN	Method
are	O
also	O
functions	O
of	O
the	O
input	O
.	O

The	O
RoI	Method
pooling	Method
layer	Method
in	O
Fast	Method
R	Method
-	Method
CNN	Method
accepts	O
the	O
convolutional	O
features	O
and	O
also	O
the	O
predicted	O
bounding	O
boxes	O
as	O
input	O
,	O
so	O
a	O
theoretically	O
valid	O
backpropagation	Method
solver	Method
should	O
also	O
involve	O
gradients	O
the	O
box	O
coordinates	O
.	O

These	O
gradients	O
are	O
ignored	O
in	O
the	O
above	O
approximate	Method
joint	Method
training	Method
.	O

In	O
a	O
non	O
-	O
approximate	Task
joint	Task
training	Task
solution	Task
,	O
we	O
need	O
an	O
RoI	Method
pooling	Method
layer	Method
that	O
is	O
differentiable	O
the	O
box	O
coordinates	O
.	O

This	O
is	O
a	O
nontrivial	O
problem	O
and	O
a	O
solution	O
can	O
be	O
given	O
by	O
an	O
“	O
RoI	Method
warping	Method
”	Method
layer	Method
as	O
developed	O
in	O
,	O
which	O
is	O
beyond	O
the	O
scope	O
of	O
this	O
paper	O
.	O

4	Method
-	Method
Step	Method
Alternating	Method
Training	Method
.	O

In	O
this	O
paper	O
,	O
we	O
adopt	O
a	O
pragmatic	Method
4	Method
-	Method
step	Method
training	Method
algorithm	Method
to	O
learn	O
shared	O
features	O
via	O
alternating	Method
optimization	Method
.	O

In	O
the	O
first	O
step	O
,	O
we	O
train	O
the	O
RPN	Method
as	O
described	O
in	O
Section	O
[	O
reference	O
]	O
.	O

This	O
network	O
is	O
initialized	O
with	O
an	O
ImageNet	Method
-	Method
pre	Method
-	Method
trained	Method
model	Method
and	O
fine	O
-	O
tuned	O
end	O
-	O
to	O
-	O
end	O
for	O
the	O
region	Task
proposal	Task
task	Task
.	O

In	O
the	O
second	O
step	O
,	O
we	O
train	O
a	O
separate	O
detection	Method
network	Method
by	O
Fast	Method
R	Method
-	Method
CNN	Method
using	O
the	O
proposals	O
generated	O
by	O
the	O
step	Method
-	Method
1	Method
RPN	Method
.	O

This	O
detection	Method
network	Method
is	O
also	O
initialized	O
by	O
the	O
ImageNet	Method
-	Method
pre	Method
-	Method
trained	Method
model	Method
.	O

At	O
this	O
point	O
the	O
two	O
networks	O
do	O
not	O
share	O
convolutional	Method
layers	Method
.	O

In	O
the	O
third	O
step	O
,	O
we	O
use	O
the	O
detector	Method
network	Method
to	O
initialize	O
RPN	Task
training	Task
,	O
but	O
we	O
fix	O
the	O
shared	O
convolutional	O
layers	O
and	O
only	O
fine	O
-	O
tune	O
the	O
layers	O
unique	O
to	O
RPN	Method
.	O

Now	O
the	O
two	O
networks	O
share	O
convolutional	Method
layers	Method
.	O

Finally	O
,	O
keeping	O
the	O
shared	O
convolutional	O
layers	O
fixed	O
,	O
we	O
fine	O
-	O
tune	O
the	O
unique	Method
layers	Method
of	O
Fast	Method
R	Method
-	Method
CNN	Method
.	O

As	O
such	O
,	O
both	O
networks	O
share	O
the	O
same	O
convolutional	O
layers	O
and	O
form	O
a	O
unified	Method
network	Method
.	O

A	O
similar	O
alternating	Method
training	Method
can	O
be	O
run	O
for	O
more	O
iterations	O
,	O
but	O
we	O
have	O
observed	O
negligible	O
improvements	O
.	O

subsection	O
:	O
Implementation	O
Details	O
We	O
train	O
and	O
test	O
both	O
region	Method
proposal	Method
and	Method
object	Method
detection	Method
networks	Method
on	O
images	O
of	O
a	O
single	O
scale	O
.	O

We	O
re	O
-	O
scale	O
the	O
images	O
such	O
that	O
their	O
shorter	O
side	O
is	O
pixels	O
.	O

Multi	Method
-	Method
scale	Method
feature	Method
extraction	Method
(	O
using	O
an	O
image	Method
pyramid	Method
)	O
may	O
improve	O
accuracy	Metric
but	O
does	O
not	O
exhibit	O
a	O
good	O
speed	Metric
-	Metric
accuracy	Metric
trade	O
-	O
off	O
.	O

On	O
the	O
re	Material
-	Material
scaled	Material
images	Material
,	O
the	O
total	O
stride	O
for	O
both	O
ZF	Method
and	Method
VGG	Method
nets	Method
on	O
the	O
last	O
convolutional	Method
layer	Method
is	O
16	O
pixels	O
,	O
and	O
thus	O
is	O
10	O
pixels	O
on	O
a	O
typical	O
PASCAL	Material
image	Material
before	O
resizing	O
(	O
500	O
375	O
)	O
.	O

Even	O
such	O
a	O
large	O
stride	O
provides	O
good	O
results	O
,	O
though	O
accuracy	Metric
may	O
be	O
further	O
improved	O
with	O
a	O
smaller	O
stride	O
.	O

For	O
anchors	O
,	O
we	O
use	O
3	O
scales	O
with	O
box	O
areas	O
of	O
,	O
,	O
and	O
pixels	O
,	O
and	O
3	O
aspect	O
ratios	O
of	O
1:1	O
,	O
1:2	O
,	O
and	O
2:1	O
.	O

These	O
hyper	O
-	O
parameters	O
are	O
not	O
carefully	O
chosen	O
for	O
a	O
particular	O
dataset	O
,	O
and	O
we	O
provide	O
ablation	O
experiments	O
on	O
their	O
effects	O
in	O
the	O
next	O
section	O
.	O

As	O
discussed	O
,	O
our	O
solution	O
does	O
not	O
need	O
an	O
image	O
pyramid	O
or	O
filter	O
pyramid	Method
to	O
predict	O
regions	O
of	O
multiple	O
scales	O
,	O
saving	O
considerable	O
running	Metric
time	Metric
.	O

Figure	O
[	O
reference	O
]	O
(	O
right	O
)	O
shows	O
the	O
capability	O
of	O
our	O
method	O
for	O
a	O
wide	O
range	O
of	O
scales	O
and	O
aspect	O
ratios	O
.	O

Table	O
[	O
reference	O
]	O
shows	O
the	O
learned	O
average	Metric
proposal	Metric
size	Metric
for	O
each	O
anchor	O
using	O
the	O
ZF	Method
net	Method
.	O

We	O
note	O
that	O
our	O
algorithm	O
allows	O
predictions	O
that	O
are	O
larger	O
than	O
the	O
underlying	O
receptive	O
field	O
.	O

Such	O
predictions	O
are	O
not	O
impossible	O
—	O
one	O
may	O
still	O
roughly	O
infer	O
the	O
extent	O
of	O
an	O
object	O
if	O
only	O
the	O
middle	O
of	O
the	O
object	O
is	O
visible	O
.	O

The	O
anchor	O
boxes	O
that	O
cross	O
image	O
boundaries	O
need	O
to	O
be	O
handled	O
with	O
care	O
.	O

During	O
training	Task
,	O
we	O
ignore	O
all	O
cross	O
-	O
boundary	O
anchors	O
so	O
they	O
do	O
not	O
contribute	O
to	O
the	O
loss	O
.	O

For	O
a	O
typical	O
image	O
,	O
there	O
will	O
be	O
roughly	O
20000	O
(	O
)	O
anchors	O
in	O
total	O
.	O

With	O
the	O
cross	O
-	O
boundary	O
anchors	O
ignored	O
,	O
there	O
are	O
about	O
6000	O
anchors	O
per	O
image	O
for	O
training	O
.	O

If	O
the	O
boundary	O
-	O
crossing	O
outliers	O
are	O
not	O
ignored	O
in	O
training	Task
,	O
they	O
introduce	O
large	O
,	O
difficult	O
to	O
correct	O
error	O
terms	O
in	O
the	O
objective	Metric
,	O
and	O
training	Task
does	O
not	O
converge	O
.	O

During	O
testing	O
,	O
however	O
,	O
we	O
still	O
apply	O
the	O
fully	Method
convolutional	Method
RPN	Method
to	O
the	O
entire	O
image	O
.	O

This	O
may	O
generate	O
cross	O
-	O
boundary	O
proposal	O
boxes	O
,	O
which	O
we	O
clip	O
to	O
the	O
image	O
boundary	O
.	O

Some	O
RPN	Method
proposals	Method
highly	O
overlap	O
with	O
each	O
other	O
.	O

To	O
reduce	O
redundancy	O
,	O
we	O
adopt	O
non	Method
-	Method
maximum	Method
suppression	Method
(	O
NMS	Method
)	O
on	O
the	O
proposal	O
regions	O
based	O
on	O
their	O
cls	Metric
scores	Metric
.	O

We	O
fix	O
the	O
IoU	O
threshold	O
for	O
NMS	Method
at	O
0.7	O
,	O
which	O
leaves	O
us	O
about	O
2000	O
proposal	O
regions	O
per	O
image	O
.	O

As	O
we	O
will	O
show	O
,	O
NMS	Method
does	O
not	O
harm	O
the	O
ultimate	Metric
detection	Metric
accuracy	Metric
,	O
but	O
substantially	O
reduces	O
the	O
number	O
of	O
proposals	O
.	O

After	O
NMS	Method
,	O
we	O
use	O
the	O
top	O
-	O
ranked	O
proposal	O
regions	O
for	O
detection	Task
.	O

In	O
the	O
following	O
,	O
we	O
train	O
Fast	Method
R	Method
-	Method
CNN	Method
using	O
2000	O
RPN	Method
proposals	Method
,	O
but	O
evaluate	O
different	O
numbers	O
of	O
proposals	O
at	O
test	O
-	O
time	O
.	O

section	O
:	O
Experiments	O
subsection	O
:	O
Experiments	O
on	O
PASCAL	Task
VOC	Task
We	O
comprehensively	O
evaluate	O
our	O
method	O
on	O
the	O
PASCAL	Material
VOC	Material
2007	Material
detection	Material
benchmark	Material
.	O

This	O
dataset	O
consists	O
of	O
about	O
5k	O
trainval	O
images	O
and	O
5k	O
test	O
images	O
over	O
20	O
object	O
categories	O
.	O

We	O
also	O
provide	O
results	O
on	O
the	O
PASCAL	Material
VOC	Material
2012	Material
benchmark	Material
for	O
a	O
few	O
models	O
.	O

For	O
the	O
ImageNet	Task
pre	Task
-	Task
trained	Task
network	Task
,	O
we	O
use	O
the	O
“	O
fast	O
”	O
version	O
of	O
ZF	Method
net	Method
that	O
has	O
5	O
convolutional	O
layers	O
and	O
3	O
fully	O
-	O
connected	O
layers	O
,	O
and	O
the	O
public	Method
VGG	Method
-	Method
16	Method
model	Method
that	O
has	O
13	O
convolutional	O
layers	O
and	O
3	O
fully	Method
-	Method
connected	Method
layers	Method
.	O

We	O
primarily	O
evaluate	O
detection	Metric
mean	Metric
Average	Metric
Precision	Metric
(	Metric
mAP	Metric
)	Metric
,	O
because	O
this	O
is	O
the	O
actual	O
metric	O
for	O
object	Task
detection	Task
(	O
rather	O
than	O
focusing	O
on	O
object	Metric
proposal	Metric
proxy	Metric
metrics	Metric
)	O
.	O

Table	O
[	O
reference	O
]	O
(	O
top	O
)	O
shows	O
Fast	Method
R	Method
-	Method
CNN	Method
results	O
when	O
trained	O
and	O
tested	O
using	O
various	O
region	Method
proposal	Method
methods	Method
.	O

These	O
results	O
use	O
the	O
ZF	Method
net	Method
.	O

For	O
Selective	Task
Search	Task
(	O
SS	Task
)	O
,	O
we	O
generate	O
about	O
2000	O
proposals	O
by	O
the	O
“	O
fast	O
”	O
mode	O
.	O

For	O
EdgeBoxes	O
(	O
EB	O
)	O
,	O
we	O
generate	O
the	O
proposals	O
by	O
the	O
default	O
EB	Method
setting	Method
tuned	O
for	O
0.7	O
IoU.	O
SS	O
has	O
an	O
mAP	Metric
of	O
58.7	O
%	O
and	O
EB	Method
has	O
an	O
mAP	Metric
of	O
58.6	O
%	O
under	O
the	O
Fast	Method
R	Method
-	Method
CNN	Method
framework	Method
.	O

RPN	Method
with	O
Fast	Method
R	Method
-	Method
CNN	Method
achieves	O
competitive	O
results	O
,	O
with	O
an	O
mAP	Metric
of	O
59.9	O
%	O
while	O
using	O
up	O
to	O
300	O
proposals	O
.	O

Using	O
RPN	Method
yields	O
a	O
much	O
faster	O
detection	Method
system	Method
than	O
using	O
either	O
SS	Method
or	O
EB	Method
because	O
of	O
shared	Method
convolutional	Method
computations	Method
;	O
the	O
fewer	O
proposals	O
also	O
reduce	O
the	O
region	O
-	O
wise	O
fully	O
-	O
connected	O
layers	O
’	O
cost	O
(	O
Table	O
[	O
reference	O
]	O
)	O
.	O

Ablation	Task
Experiments	O
on	O
RPN	Method
.	O

To	O
investigate	O
the	O
behavior	O
of	O
RPNs	Method
as	O
a	O
proposal	Method
method	Method
,	O
we	O
conducted	O
several	O
ablation	Task
studies	Task
.	O

First	O
,	O
we	O
show	O
the	O
effect	O
of	O
sharing	O
convolutional	Method
layers	Method
between	O
the	O
RPN	Method
and	Method
Fast	Method
R	Method
-	Method
CNN	Method
detection	Method
network	Method
.	O

To	O
do	O
this	O
,	O
we	O
stop	O
after	O
the	O
second	O
step	O
in	O
the	O
4	Task
-	Task
step	Task
training	Task
process	Task
.	O

Using	O
separate	Method
networks	Method
reduces	O
the	O
result	O
slightly	O
to	O
58.7	O
%	O
(	O
RPN	Method
+	Method
ZF	Method
,	O
unshared	O
,	O
Table	O
[	O
reference	O
]	O
)	O
.	O

We	O
observe	O
that	O
this	O
is	O
because	O
in	O
the	O
third	O
step	O
when	O
the	O
detector	O
-	O
tuned	O
features	O
are	O
used	O
to	O
fine	O
-	O
tune	O
the	O
RPN	Method
,	O
the	O
proposal	Metric
quality	Metric
is	O
improved	O
.	O

Next	O
,	O
we	O
disentangle	O
the	O
RPN	Method
’s	Method
influence	Method
on	O
training	O
the	O
Fast	Method
R	Method
-	Method
CNN	Method
detection	Method
network	Method
.	O

For	O
this	O
purpose	O
,	O
we	O
train	O
a	O
Fast	Method
R	Method
-	Method
CNN	Method
model	Method
by	O
using	O
the	O
2000	O
SS	O
proposals	O
and	O
ZF	Method
net	Method
.	O

We	O
fix	O
this	O
detector	O
and	O
evaluate	O
the	O
detection	Task
mAP	Task
by	O
changing	O
the	O
proposal	O
regions	O
used	O
at	O
test	O
-	O
time	O
.	O

In	O
these	O
ablation	O
experiments	O
,	O
the	O
RPN	Method
does	O
not	O
share	O
features	O
with	O
the	O
detector	Method
.	O

Replacing	O
SS	Method
with	O
300	O
RPN	O
proposals	O
at	O
test	O
-	O
time	O
leads	O
to	O
an	O
mAP	Metric
of	O
56.8	O
%	O
.	O

The	O
loss	O
in	O
mAP	Task
is	O
because	O
of	O
the	O
inconsistency	O
between	O
the	O
training	O
/	O
testing	O
proposals	O
.	O

This	O
result	O
serves	O
as	O
the	O
baseline	O
for	O
the	O
following	O
comparisons	O
.	O

Somewhat	O
surprisingly	O
,	O
the	O
RPN	Method
still	O
leads	O
to	O
a	O
competitive	O
result	O
(	O
55.1	O
%	O
)	O
when	O
using	O
the	O
top	O
-	O
ranked	O
100	O
proposals	O
at	O
test	O
-	O
time	O
,	O
indicating	O
that	O
the	O
top	O
-	O
ranked	O
RPN	Method
proposals	Method
are	O
accurate	O
.	O

On	O
the	O
other	O
extreme	O
,	O
using	O
the	O
top	O
-	O
ranked	O
6000	O
RPN	Method
proposals	Method
(	O
without	O
NMS	Method
)	O
has	O
a	O
comparable	O
mAP	Metric
(	O
55.2	O
%	O
)	O
,	O
suggesting	O
NMS	Method
does	O
not	O
harm	O
the	O
detection	Metric
mAP	Metric
and	O
may	O
reduce	O
false	O
alarms	O
.	O

Next	O
,	O
we	O
separately	O
investigate	O
the	O
roles	O
of	O
RPN	Method
’s	Method
cls	Method
and	O
reg	O
outputs	O
by	O
turning	O
off	O
either	O
of	O
them	O
at	O
test	O
-	O
time	O
.	O

When	O
the	O
cls	Method
layer	Method
is	O
removed	O
at	O
test	O
-	O
time	O
(	O
thus	O
no	O
NMS	Method
/	Method
ranking	Method
is	O
used	O
)	O
,	O
we	O
randomly	O
sample	O
proposals	O
from	O
the	O
unscored	O
regions	O
.	O

The	O
mAP	Metric
is	O
nearly	O
unchanged	O
with	O
(	O
55.8	O
%	O
)	O
,	O
but	O
degrades	O
considerably	O
to	O
44.6	O
%	O
when	O
.	O

This	O
shows	O
that	O
the	O
cls	Metric
scores	Metric
account	O
for	O
the	O
accuracy	Metric
of	O
the	O
highest	O
ranked	O
proposals	O
.	O

On	O
the	O
other	O
hand	O
,	O
when	O
the	O
reg	Method
layer	Method
is	O
removed	O
at	O
test	O
-	O
time	O
(	O
so	O
the	O
proposals	O
become	O
anchor	O
boxes	O
)	O
,	O
the	O
mAP	Metric
drops	O
to	O
52.1	O
%	O
.	O

This	O
suggests	O
that	O
the	O
high	O
-	O
quality	O
proposals	O
are	O
mainly	O
due	O
to	O
the	O
regressed	Method
box	Method
bounds	Method
.	O

The	O
anchor	O
boxes	O
,	O
though	O
having	O
multiple	O
scales	O
and	O
aspect	O
ratios	O
,	O
are	O
not	O
sufficient	O
for	O
accurate	Task
detection	Task
.	O

We	O
also	O
evaluate	O
the	O
effects	O
of	O
more	O
powerful	O
networks	O
on	O
the	O
proposal	Metric
quality	Metric
of	O
RPN	Method
alone	O
.	O

We	O
use	O
VGG	Method
-	Method
16	Method
to	O
train	O
the	O
RPN	Method
,	O
and	O
still	O
use	O
the	O
above	O
detector	Method
of	Method
SS	Method
+	Method
ZF	Method
.	O

The	O
mAP	Metric
improves	O
from	O
56.8	O
%	O
(	O
using	O
RPN	Method
+	Method
ZF	Method
)	O
to	O
59.2	O
%	O
(	O
using	O
RPN	Method
+	Method
VGG	Method
)	O
.	O

This	O
is	O
a	O
promising	O
result	O
,	O
because	O
it	O
suggests	O
that	O
the	O
proposal	Metric
quality	Metric
of	O
RPN	Method
+	Method
VGG	Method
is	O
better	O
than	O
that	O
of	O
RPN	Method
+	Method
ZF	Method
.	O

Because	O
proposals	O
of	O
RPN	Method
+	Method
ZF	Method
are	O
competitive	O
with	O
SS	Method
(	O
both	O
are	O
58.7	O
%	O
when	O
consistently	O
used	O
for	O
training	O
and	O
testing	O
)	O
,	O
we	O
may	O
expect	O
RPN	Method
+	Method
VGG	Method
to	O
be	O
better	O
than	O
SS	Method
.	O

The	O
following	O
experiments	O
justify	O
this	O
hypothesis	O
.	O

Performance	O
of	O
VGG	Method
-	Method
16	Method
.	O

Table	O
[	O
reference	O
]	O
shows	O
the	O
results	O
of	O
VGG	Method
-	Method
16	Method
for	O
both	O
proposal	Task
and	O
detection	Task
.	O

Using	O
RPN	Method
+	Method
VGG	Method
,	O
the	O
result	O
is	O
68.5	O
%	O
for	O
unshared	O
features	O
,	O
slightly	O
higher	O
than	O
the	O
SS	Method
baseline	Method
.	O

As	O
shown	O
above	O
,	O
this	O
is	O
because	O
the	O
proposals	O
generated	O
by	O
RPN	Method
+	Method
VGG	Method
are	O
more	O
accurate	O
than	O
SS	Method
.	O

Unlike	O
SS	Method
that	O
is	O
pre	O
-	O
defined	O
,	O
the	O
RPN	Method
is	O
actively	O
trained	O
and	O
benefits	O
from	O
better	O
networks	O
.	O

For	O
the	O
feature	O
-	O
shared	O
variant	O
,	O
the	O
result	O
is	O
69.9%—better	O
than	O
the	O
strong	O
SS	Method
baseline	Method
,	O
yet	O
with	O
nearly	O
cost	O
-	O
free	O
proposals	O
.	O

We	O
further	O
train	O
the	O
RPN	Method
and	Method
detection	Method
network	Method
on	O
the	O
union	Material
set	Material
of	Material
PASCAL	Material
VOC	Material
2007	Material
trainval	Material
and	O
2012	Material
trainval	Material
.	O

The	O
mAP	O
is	O
73.2	O
%	O
.	O

Figure	O
[	O
reference	O
]	O
shows	O
some	O
results	O
on	O
the	O
PASCAL	Material
VOC	Material
2007	Material
test	Material
set	Material
.	O

On	O
the	O
PASCAL	Material
VOC	Material
2012	Material
test	Material
set	Material
(	O
Table	O
[	O
reference	O
]	O
)	O
,	O
our	O
method	O
has	O
an	O
mAP	Metric
of	O
70.4	O
%	O
trained	O
on	O
the	O
union	Material
set	Material
of	Material
VOC	Material
2007	O
trainval	O
+	O
test	O
and	O
VOC	Material
2012	Material
trainval	Material
.	O

Table	O
[	O
reference	O
]	O
and	O
Table	O
[	O
reference	O
]	O
show	O
the	O
detailed	O
numbers	O
.	O

In	O
Table	O
[	O
reference	O
]	O
we	O
summarize	O
the	O
running	Metric
time	Metric
of	O
the	O
entire	O
object	Method
detection	Method
system	Method
.	O

SS	Method
takes	O
1	O
-	O
2	O
seconds	O
depending	O
on	O
content	O
(	O
on	O
average	O
about	O
1.5s	O
)	O
,	O
and	O
Fast	O
R	Method
-	Method
CNN	Method
with	O
VGG	Method
-	Method
16	Method
takes	O
320ms	O
on	O
2000	O
SS	O
proposals	O
(	O
or	O
223ms	O
if	O
using	O
SVD	Method
on	O
fully	Method
-	Method
connected	Method
layers	Method
)	O
.	O

Our	O
system	O
with	O
VGG	Method
-	Method
16	Method
takes	O
in	O
total	O
198ms	O
for	O
both	O
proposal	Task
and	O
detection	Task
.	O

With	O
the	O
convolutional	O
features	O
shared	O
,	O
the	O
RPN	Method
alone	Method
only	O
takes	O
10ms	O
computing	O
the	O
additional	O
layers	O
.	O

Our	O
region	Method
-	Method
wise	Method
computation	Method
is	O
also	O
lower	O
,	O
thanks	O
to	O
fewer	O
proposals	O
(	O
300	O
per	O
image	O
)	O
.	O

Our	O
system	O
has	O
a	O
frame	Metric
-	Metric
rate	Metric
of	O
17	O
fps	Metric
with	O
the	O
ZF	Method
net	Method
.	O

Sensitivities	O
to	O
Hyper	O
-	O
parameters	O
.	O

In	O
Table	O
[	O
reference	O
]	O
we	O
investigate	O
the	O
settings	O
of	O
anchors	O
.	O

By	O
default	O
we	O
use	O
3	O
scales	O
and	O
3	O
aspect	O
ratios	O
(	O
69.9	O
%	O
mAP	O
in	O
Table	O
[	O
reference	O
]	O
)	O
.	O

If	O
using	O
just	O
one	O
anchor	O
at	O
each	O
position	O
,	O
the	O
mAP	O
drops	O
by	O
a	O
considerable	O
margin	O
of	O
3	O
-	O
4	O
%	O
.	O

The	O
mAP	Metric
is	O
higher	O
if	O
using	O
3	O
scales	O
(	O
with	O
1	O
aspect	O
ratio	O
)	O
or	O
3	O
aspect	O
ratios	O
(	O
with	O
1	O
scale	O
)	O
,	O
demonstrating	O
that	O
using	O
anchors	O
of	O
multiple	O
sizes	O
as	O
the	O
regression	O
references	O
is	O
an	O
effective	O
solution	O
.	O

Using	O
just	O
3	O
scales	O
with	O
1	O
aspect	O
ratio	O
(	O
69.8	O
%	O
)	O
is	O
as	O
good	O
as	O
using	O
3	O
scales	O
with	O
3	O
aspect	O
ratios	O
on	O
this	O
dataset	O
,	O
suggesting	O
that	O
scales	O
and	O
aspect	O
ratios	O
are	O
not	O
disentangled	O
dimensions	O
for	O
the	O
detection	Metric
accuracy	Metric
.	O

But	O
we	O
still	O
adopt	O
these	O
two	O
dimensions	O
in	O
our	O
designs	O
to	O
keep	O
our	O
system	O
flexible	O
.	O

In	O
Table	O
[	O
reference	O
]	O
we	O
compare	O
different	O
values	O
of	O
in	O
Equation	O
(	O
[	O
reference	O
]	O
)	O
.	O

By	O
default	O
we	O
use	O
which	O
makes	O
the	O
two	O
terms	O
in	O
Equation	O
(	O
[	O
reference	O
]	O
)	O
roughly	O
equally	O
weighted	O
after	O
normalization	O
.	O

Table	O
[	O
reference	O
]	O
shows	O
that	O
our	O
result	O
is	O
impacted	O
just	O
marginally	O
(	O
by	O
)	O
when	O
is	O
within	O
a	O
scale	O
of	O
about	O
two	O
orders	O
of	O
magnitude	O
(	O
1	O
to	O
100	O
)	O
.	O

This	O
demonstrates	O
that	O
the	O
result	O
is	O
insensitive	O
to	O
in	O
a	O
wide	O
range	O
.	O

Analysis	Task
of	Task
Recall	Task
-	Task
to	Task
-	Task
IoU.	Task
Next	O
we	O
compute	O
the	O
recall	Metric
of	O
proposals	O
at	O
different	O
IoU	Metric
ratios	Metric
with	O
ground	O
-	O
truth	O
boxes	O
.	O

It	O
is	O
noteworthy	O
that	O
the	O
Recall	Metric
-	Metric
to	Metric
-	Metric
IoU	Metric
metric	Metric
is	O
just	O
loosely	O
related	O
to	O
the	O
ultimate	Metric
detection	Metric
accuracy	Metric
.	O

It	O
is	O
more	O
appropriate	O
to	O
use	O
this	O
metric	O
to	O
diagnose	O
the	O
proposal	O
method	O
than	O
to	O
evaluate	O
it	O
.	O

In	O
Figure	O
[	O
reference	O
]	O
,	O
we	O
show	O
the	O
results	O
of	O
using	O
300	O
,	O
1000	O
,	O
and	O
2000	O
proposals	O
.	O

We	O
compare	O
with	O
SS	Method
and	O
EB	Method
,	O
and	O
the	O
proposals	O
are	O
the	O
top	O
-	O
ranked	O
ones	O
based	O
on	O
the	O
confidence	O
generated	O
by	O
these	O
methods	O
.	O

The	O
plots	O
show	O
that	O
the	O
RPN	Method
method	Method
behaves	O
gracefully	O
when	O
the	O
number	O
of	O
proposals	O
drops	O
from	O
2000	O
to	O
300	O
.	O

This	O
explains	O
why	O
the	O
RPN	Method
has	O
a	O
good	O
ultimate	Metric
detection	Metric
mAP	Metric
when	O
using	O
as	O
few	O
as	O
300	O
proposals	O
.	O

As	O
we	O
analyzed	O
before	O
,	O
this	O
property	O
is	O
mainly	O
attributed	O
to	O
the	O
cls	O
term	O
of	O
the	O
RPN	Method
.	O

The	O
recall	Metric
of	O
SS	Method
and	O
EB	Method
drops	O
more	O
quickly	O
than	O
RPN	Method
when	O
the	O
proposals	O
are	O
fewer	O
.	O

One	O
-	O
Stage	Method
Detection	Method
Two	O
-	O
Stage	Method
Proposal	Method
+	Method
Detection	Method
.	O

The	O
OverFeat	O
paper	O
proposes	O
a	O
detection	Method
method	Method
that	O
uses	O
regressors	Method
and	O
classifiers	Method
on	O
sliding	O
windows	O
over	O
convolutional	O
feature	O
maps	O
.	O

OverFeat	Method
is	O
a	O
one	Method
-	Method
stage	Method
,	Method
class	Method
-	Method
specific	Method
detection	Method
pipeline	Method
,	O
and	O
ours	O
is	O
a	O
two	O
-	O
stage	Method
cascade	Method
consisting	O
of	O
class	Method
-	Method
agnostic	Method
proposals	Method
and	O
class	Method
-	Method
specific	Method
detections	Method
.	O

In	O
OverFeat	O
,	O
the	O
region	O
-	O
wise	O
features	O
come	O
from	O
a	O
sliding	O
window	O
of	O
one	O
aspect	O
ratio	O
over	O
a	O
scale	O
pyramid	O
.	O

These	O
features	O
are	O
used	O
to	O
simultaneously	O
determine	O
the	O
location	O
and	O
category	O
of	O
objects	O
.	O

In	O
RPN	Method
,	O
the	O
features	O
are	O
from	O
square	O
(	O
3	O
3	O
)	O
sliding	O
windows	O
and	O
predict	O
proposals	O
relative	O
to	O
anchors	O
with	O
different	O
scales	O
and	O
aspect	O
ratios	O
.	O

Though	O
both	O
methods	O
use	O
sliding	O
windows	O
,	O
the	O
region	Task
proposal	Task
task	Task
is	O
only	O
the	O
first	O
stage	O
of	O
Faster	Method
R	Method
-	Method
CNN	Method
—	O
the	O
downstream	Method
Fast	Method
R	Method
-	Method
CNN	Method
detector	Method
attends	O
to	O
the	O
proposals	O
to	O
refine	O
them	O
.	O

In	O
the	O
second	O
stage	O
of	O
our	O
cascade	O
,	O
the	O
region	O
-	O
wise	O
features	O
are	O
adaptively	O
pooled	O
from	O
proposal	O
boxes	O
that	O
more	O
faithfully	O
cover	O
the	O
features	O
of	O
the	O
regions	O
.	O

We	O
believe	O
these	O
features	O
lead	O
to	O
more	O
accurate	O
detections	Task
.	O

To	O
compare	O
the	O
one	Method
-	Method
stage	Method
and	Method
two	Method
-	Method
stage	Method
systems	Method
,	O
we	O
emulate	O
the	O
OverFeat	Method
system	Method
(	O
and	O
thus	O
also	O
circumvent	O
other	O
differences	O
of	O
implementation	O
details	O
)	O
by	O
one	O
-	O
stage	Method
Fast	Method
R	Method
-	Method
CNN	Method
.	O

In	O
this	O
system	O
,	O
the	O
“	O
proposals	O
”	O
are	O
dense	O
sliding	O
windows	O
of	O
3	O
scales	O
(	O
128	O
,	O
256	O
,	O
512	O
)	O
and	O
3	O
aspect	O
ratios	O
(	O
1:1	O
,	O
1:2	O
,	O
2:1	O
)	O
.	O

Fast	Method
R	Method
-	Method
CNN	Method
is	O
trained	O
to	O
predict	O
class	O
-	O
specific	O
scores	O
and	O
regress	O
box	O
locations	O
from	O
these	O
sliding	O
windows	O
.	O

Because	O
the	O
OverFeat	Method
system	Method
adopts	O
an	O
image	O
pyramid	O
,	O
we	O
also	O
evaluate	O
using	O
convolutional	O
features	O
extracted	O
from	O
5	O
scales	O
.	O

We	O
use	O
those	O
5	O
scales	O
as	O
in	O
.	O

Table	O
[	O
reference	O
]	O
compares	O
the	O
two	O
-	O
stage	Method
system	Method
and	O
two	O
variants	O
of	O
the	O
one	Method
-	Method
stage	Method
system	Method
.	O

Using	O
the	O
ZF	Method
model	Method
,	O
the	O
one	Method
-	Method
stage	Method
system	Method
has	O
an	O
mAP	Method
of	O
53.9	O
%	O
.	O

This	O
is	O
lower	O
than	O
the	O
two	O
-	O
stage	Method
system	Method
(	O
58.7	O
%	O
)	O
by	O
4.8	O
%	O
.	O

This	O
experiment	O
justifies	O
the	O
effectiveness	O
of	O
cascaded	Task
region	Task
proposals	Task
and	O
object	Task
detection	Task
.	O

Similar	O
observations	O
are	O
reported	O
in	O
,	O
where	O
replacing	O
SS	Method
region	Method
proposals	Method
with	O
sliding	O
windows	O
leads	O
to	O
6	O
%	O
degradation	O
in	O
both	O
papers	O
.	O

We	O
also	O
note	O
that	O
the	O
one	Method
-	Method
stage	Method
system	Method
is	O
slower	O
as	O
it	O
has	O
considerably	O
more	O
proposals	O
to	O
process	O
.	O

subsection	O
:	O
Experiments	O
on	O
MS	Material
COCO	Material
We	O
present	O
more	O
results	O
on	O
the	O
Microsoft	Material
COCO	Material
object	Material
detection	Material
dataset	Material
.	O

This	O
dataset	O
involves	O
80	O
object	O
categories	O
.	O

We	O
experiment	O
with	O
the	O
80k	O
images	O
on	O
the	O
training	O
set	O
,	O
40k	O
images	O
on	O
the	O
validation	Material
set	Material
,	O
and	O
20k	O
images	O
on	O
the	O
test	O
-	O
dev	O
set	O
.	O

We	O
evaluate	O
the	O
mAP	Metric
averaged	Metric
for	O
IoU	Metric
(	Metric
COCO	Metric
’s	Metric
standard	Metric
metric	Metric
,	O
simply	O
denoted	O
as	O
mAP@	Method
[	Method
.5	Method
,	O
.95	O
]	O
)	O
and	O
mAP@0.5	Method
(	O
PASCAL	Metric
VOC	Metric
’s	Metric
metric	Metric
)	O
.	O

There	O
are	O
a	O
few	O
minor	O
changes	O
of	O
our	O
system	O
made	O
for	O
this	O
dataset	O
.	O

We	O
train	O
our	O
models	O
on	O
an	O
8	Method
-	Method
GPU	Method
implementation	Method
,	O
and	O
the	O
effective	O
mini	Metric
-	Metric
batch	Metric
size	Metric
becomes	O
8	O
for	O
RPN	Method
(	O
1	O
per	O
GPU	O
)	O
and	O
16	O
for	O
Fast	Method
R	Method
-	Method
CNN	Method
(	O
2	O
per	O
GPU	O
)	O
.	O

The	O
RPN	Method
step	Method
and	O
Fast	Method
R	Method
-	Method
CNN	Method
step	Method
are	O
both	O
trained	O
for	O
240k	O
iterations	O
with	O
a	O
learning	Metric
rate	Metric
of	O
0.003	O
and	O
then	O
for	O
80k	O
iterations	O
with	O
0.0003	O
.	O

We	O
modify	O
the	O
learning	Metric
rates	Metric
(	O
starting	O
with	O
0.003	O
instead	O
of	O
0.001	O
)	O
because	O
the	O
mini	O
-	O
batch	O
size	O
is	O
changed	O
.	O

For	O
the	O
anchors	O
,	O
we	O
use	O
3	O
aspect	O
ratios	O
and	O
4	O
scales	O
(	O
adding	O
)	O
,	O
mainly	O
motivated	O
by	O
handling	O
small	O
objects	O
on	O
this	O
dataset	O
.	O

In	O
addition	O
,	O
in	O
our	O
Fast	O
R	Method
-	Method
CNN	Method
step	Method
,	O
the	O
negative	O
samples	O
are	O
defined	O
as	O
those	O
with	O
a	O
maximum	O
IoU	O
with	O
ground	O
truth	O
in	O
the	O
interval	O
of	O
,	O
instead	O
of	O
used	O
in	O
.	O

We	O
note	O
that	O
in	O
the	O
SPPnet	Method
system	Method
,	O
the	O
negative	O
samples	O
in	O
are	O
used	O
for	O
network	Task
fine	Task
-	Task
tuning	Task
,	O
but	O
the	O
negative	O
samples	O
in	O
are	O
still	O
visited	O
in	O
the	O
SVM	Method
step	Method
with	O
hard	Method
-	Method
negative	Method
mining	Method
.	O

But	O
the	O
Fast	O
R	Method
-	Method
CNN	Method
system	Method
abandons	O
the	O
SVM	Method
step	Method
,	O
so	O
the	O
negative	O
samples	O
in	O
are	O
never	O
visited	O
.	O

Including	O
these	O
samples	O
improves	O
mAP@0.5	Task
on	O
the	O
COCO	Material
dataset	Material
for	O
both	O
Fast	Method
R	Method
-	Method
CNN	Method
and	O
Faster	Method
R	Method
-	Method
CNN	Method
systems	Method
(	O
but	O
the	O
impact	O
is	O
negligible	O
on	O
PASCAL	Material
VOC	Material
)	O
.	O

The	O
rest	O
of	O
the	O
implementation	O
details	O
are	O
the	O
same	O
as	O
on	O
PASCAL	Material
VOC	Material
.	O

In	O
particular	O
,	O
we	O
keep	O
using	O
300	O
proposals	O
and	O
single	O
-	O
scale	O
(	O
)	O
testing	O
.	O

The	O
testing	Metric
time	Metric
is	O
still	O
about	O
200ms	O
per	O
image	O
on	O
the	O
COCO	Material
dataset	Material
.	O

In	O
Table	O
[	O
reference	O
]	O
we	O
first	O
report	O
the	O
results	O
of	O
the	O
Fast	Method
R	Method
-	Method
CNN	Method
system	Method
using	O
the	O
implementation	O
in	O
this	O
paper	O
.	O

Our	O
Fast	Method
R	Method
-	Method
CNN	Method
baseline	Method
has	O
39.3	O
%	O
mAP@0.5	Metric
on	O
the	O
test	Material
-	Material
dev	Material
set	Material
,	O
higher	O
than	O
that	O
reported	O
in	O
.	O

We	O
conjecture	O
that	O
the	O
reason	O
for	O
this	O
gap	O
is	O
mainly	O
due	O
to	O
the	O
definition	O
of	O
the	O
negative	O
samples	O
and	O
also	O
the	O
changes	O
of	O
the	O
mini	O
-	O
batch	O
sizes	O
.	O

We	O
also	O
note	O
that	O
the	O
mAP@	O
[	O
.5	O
,	O
.95	O
]	O
is	O
just	O
comparable	O
.	O

Next	O
we	O
evaluate	O
our	O
Faster	O
R	Method
-	Method
CNN	Method
system	Method
.	O

Using	O
the	O
COCO	Material
training	Material
set	Material
to	O
train	O
,	O
Faster	O
R	Method
-	Method
CNN	Method
has	O
42.1	O
%	O
mAP@0.5	Metric
and	O
21.5	O
%	O
mAP@	Metric
[	Metric
.5	Metric
,	O
.95	O
]	O
on	O
the	O
COCO	Material
test	Material
-	Material
dev	Material
set	Material
.	O

This	O
is	O
2.8	O
%	O
higher	O
for	O
mAP@0.5	Method
and	O
2.2	O
%	O
higher	O
for	O
mAP@	Task
[	Task
.5	Task
,	O
.95	O
]	O
than	O
the	O
Fast	Method
R	Method
-	Method
CNN	Method
counterpart	Method
under	O
the	O
same	O
protocol	O
(	O
Table	O
[	O
reference	O
]	O
)	O
.	O

This	O
indicates	O
that	O
RPN	Method
performs	O
excellent	O
for	O
improving	O
the	O
localization	Metric
accuracy	Metric
at	O
higher	O
IoU	Metric
thresholds	Metric
.	O

Using	O
the	O
COCO	Material
trainval	Material
set	Material
to	O
train	O
,	O
Faster	O
R	Method
-	Method
CNN	Method
has	O
42.7	O
%	O
mAP@0.5	Metric
and	O
21.9	O
%	O
mAP@	Metric
[	Metric
.5	Metric
,	O
.95	O
]	O
on	O
the	O
COCO	Material
test	Material
-	Material
dev	Material
set	Material
.	O

Figure	O
[	O
reference	O
]	O
shows	O
some	O
results	O
on	O
the	O
MS	Material
COCO	Material
test	Material
-	Material
dev	Material
set	Material
.	O

Faster	O
R	Method
-	Method
CNN	Method
in	O
ILSVRC	Material
&	Material
COCO	Material
2015	Material
competitions	Material
We	O
have	O
demonstrated	O
that	O
Faster	O
R	Method
-	Method
CNN	Method
benefits	O
more	O
from	O
better	O
features	O
,	O
thanks	O
to	O
the	O
fact	O
that	O
the	O
RPN	Method
completely	O
learns	O
to	O
propose	O
regions	O
by	O
neural	Method
networks	Method
.	O

This	O
observation	O
is	O
still	O
valid	O
even	O
when	O
one	O
increases	O
the	O
depth	O
substantially	O
to	O
over	O
100	O
layers	O
.	O

Only	O
by	O
replacing	O
VGG	Method
-	Method
16	Method
with	O
a	O
101	Method
-	Method
layer	Method
residual	Method
net	Method
(	O
ResNet	Method
-	Method
101	Method
)	O
,	O
the	O
Faster	O
R	Method
-	Method
CNN	Method
system	Method
increases	O
the	O
mAP	Metric
from	O
41.5%	O
/	O
21.2	O
%	O
(	O
VGG	Method
-	Method
16	Method
)	O
to	O
48.4%	O
/	O
27.2	O
%	O
(	O
ResNet	Method
-	Method
101	Method
)	O
on	O
the	O
COCO	Material
val	Material
set	Material
.	O

With	O
other	O
improvements	O
orthogonal	O
to	O
Faster	O
R	Method
-	Method
CNN	Method
,	O
He	O
obtained	O
a	O
single	O
-	O
model	O
result	O
of	O
55.7%	O
/	O
34.9	O
%	O
and	O
an	O
ensemble	Metric
result	Metric
of	O
59.0%	O
/	O
37.4	O
%	O
on	O
the	O
COCO	Material
test	Material
-	Material
dev	Material
set	Material
,	O
which	O
won	O
the	O
1st	O
place	O
in	O
the	O
COCO	Task
2015	Task
object	Task
detection	Task
competition	Task
.	O

The	O
same	O
system	O
also	O
won	O
the	O
1st	O
place	O
in	O
the	O
ILSVRC	Task
2015	Task
object	Task
detection	Task
competition	Task
,	O
surpassing	O
the	O
second	O
place	O
by	O
absolute	O
8.5	O
%	O
.	O

RPN	Method
is	O
also	O
a	O
building	O
block	O
of	O
the	O
1st	O
-	O
place	O
winning	O
entries	O
in	O
ILSVRC	Task
2015	Task
localization	Task
and	O
COCO	Task
2015	Task
segmentation	Task
competitions	Task
,	O
for	O
which	O
the	O
details	O
are	O
available	O
in	O
and	O
respectively	O
.	O

subsection	O
:	O
From	O
MS	Material
COCO	Material
to	O
PASCAL	Task
VOC	Task
Large	Material
-	Material
scale	Material
data	Material
is	O
of	O
crucial	O
importance	O
for	O
improving	O
deep	Method
neural	Method
networks	Method
.	O

Next	O
,	O
we	O
investigate	O
how	O
the	O
MS	Material
COCO	Material
dataset	Material
can	O
help	O
with	O
the	O
detection	Task
performance	O
on	O
PASCAL	Material
VOC	Material
.	O

As	O
a	O
simple	O
baseline	O
,	O
we	O
directly	O
evaluate	O
the	O
COCO	Method
detection	Method
model	Method
on	O
the	O
PASCAL	Material
VOC	Material
dataset	Material
,	O
without	O
fine	Method
-	Method
tuning	Method
on	O
any	O
PASCAL	Material
VOC	Material
data	Material
.	O

This	O
evaluation	O
is	O
possible	O
because	O
the	O
categories	O
on	O
COCO	Material
are	O
a	O
superset	O
of	O
those	O
on	O
PASCAL	Material
VOC	Material
.	O

The	O
categories	O
that	O
are	O
exclusive	O
on	O
COCO	Material
are	O
ignored	O
in	O
this	O
experiment	O
,	O
and	O
the	O
softmax	Method
layer	Method
is	O
performed	O
only	O
on	O
the	O
20	O
categories	O
plus	O
background	O
.	O

The	O
mAP	Metric
under	O
this	O
setting	O
is	O
76.1	O
%	O
on	O
the	O
PASCAL	Material
VOC	Material
2007	Material
test	Material
set	Material
(	O
Table	O
[	O
reference	O
]	O
)	O
.	O

This	O
result	O
is	O
better	O
than	O
that	O
trained	O
on	O
VOC07	Material
+	Material
12	Material
(	O
73.2	O
%	O
)	O
by	O
a	O
good	O
margin	O
,	O
even	O
though	O
the	O
PASCAL	Material
VOC	Material
data	Material
are	O
not	O
exploited	O
.	O

Then	O
we	O
fine	O
-	O
tune	O
the	O
COCO	Method
detection	Method
model	Method
on	O
the	O
VOC	Material
dataset	Material
.	O

In	O
this	O
experiment	O
,	O
the	O
COCO	Method
model	Method
is	O
in	O
place	O
of	O
the	O
ImageNet	Method
-	Method
pre	Method
-	Method
trained	Method
model	Method
(	O
that	O
is	O
used	O
to	O
initialize	O
the	O
network	O
weights	O
)	O
,	O
and	O
the	O
Faster	O
R	Method
-	Method
CNN	Method
system	Method
is	O
fine	O
-	O
tuned	O
as	O
described	O
in	O
Section	O
[	O
reference	O
]	O
.	O

Doing	O
so	O
leads	O
to	O
78.8	O
%	O
mAP	Metric
on	O
the	O
PASCAL	Material
VOC	Material
2007	Material
test	Material
set	Material
.	O

The	O
extra	O
data	O
from	O
the	O
COCO	Material
set	Material
increases	O
the	O
mAP	Metric
by	O
5.6	O
%	O
.	O

Table	O
[	O
reference	O
]	O
shows	O
that	O
the	O
model	O
trained	O
on	O
COCO	Method
+	Method
VOC	Method
has	O
the	O
best	O
AP	Metric
for	O
every	O
individual	O
category	O
on	O
PASCAL	Material
VOC	Material
2007	Material
.	O

Similar	O
improvements	O
are	O
observed	O
on	O
the	O
PASCAL	Material
VOC	Material
2012	Material
test	Material
set	Material
(	O
Table	O
[	O
reference	O
]	O
and	O
Table	O
[	O
reference	O
]	O
)	O
.	O

We	O
note	O
that	O
the	O
test	Metric
-	Metric
time	Metric
speed	Metric
of	O
obtaining	O
these	O
strong	O
results	O
is	O
still	O
about	O
200ms	O
per	O
image	O
.	O

section	O
:	O
Conclusion	O
We	O
have	O
presented	O
RPNs	Method
for	O
efficient	O
and	O
accurate	O
region	Task
proposal	Task
generation	Task
.	O

By	O
sharing	O
convolutional	O
features	O
with	O
the	O
down	Method
-	Method
stream	Method
detection	Method
network	Method
,	O
the	O
region	Method
proposal	Method
step	Method
is	O
nearly	O
cost	O
-	O
free	O
.	O

Our	O
method	O
enables	O
a	O
unified	O
,	O
deep	Method
-	Method
learning	Method
-	Method
based	Method
object	Method
detection	Method
system	Method
to	O
run	O
at	O
near	O
real	Metric
-	Metric
time	Metric
frame	Metric
rates	Metric
.	O

The	O
learned	O
RPN	Method
also	O
improves	O
region	Metric
proposal	Metric
quality	Metric
and	O
thus	O
the	O
overall	O
object	Metric
detection	Metric
accuracy	Metric
.	O

bibliography	O
:	O
References	O
