document	O
:	O
V	Method
-	Method
Net	Method
:	O
Fully	O
Convolutional	Method
Neural	Method
Networks	Method
for	O
Volumetric	Task
Medical	Task
Image	Task
Segmentation	Task
Convolutional	Method
Neural	Method
Networks	Method
(	O
CNNs	Method
)	O
have	O
been	O
recently	O
employed	O
to	O
solve	O
problems	O
from	O
both	O
the	O
computer	Task
vision	Task
and	O
medical	Task
image	Task
analysis	Task
fields	Task
.	O

Despite	O
their	O
popularity	O
,	O
most	O
approaches	O
are	O
only	O
able	O
to	O
process	O
2D	O
images	O
while	O
most	O
medical	O
data	O
used	O
in	O
clinical	O
practice	O
consists	O
of	O
3D	O
volumes	O
.	O

In	O
this	O
work	O
we	O
propose	O
an	O
approach	O
to	O
3D	Task
image	Task
segmentation	Task
based	O
on	O
a	O
volumetric	Method
,	Method
fully	Method
convolutional	Method
,	Method
neural	Method
network	Method
.	O

Our	O
CNN	Method
is	O
trained	O
end	O
-	O
to	O
-	O
end	O
on	O
MRI	O
volumes	O
depicting	O
prostate	O
,	O
and	O
learns	O
to	O
predict	O
segmentation	Task
for	O
the	O
whole	O
volume	O
at	O
once	O
.	O

We	O
introduce	O
a	O
novel	O
objective	Method
function	Method
,	O
that	O
we	O
optimise	O
during	O
training	Task
,	O
based	O
on	O
Dice	Method
coefficient	O
.	O

In	O
this	O
way	O
we	O
can	O
deal	O
with	O
situations	O
where	O
there	O
is	O
a	O
strong	O
imbalance	O
between	O
the	O
number	O
of	O
foreground	O
and	O
background	O
voxels	O
.	O

To	O
cope	O
with	O
the	O
limited	O
number	O
of	O
annotated	O
volumes	O
available	O
for	O
training	O
,	O
we	O
augment	O
the	O
data	O
applying	O
random	Method
non	Method
-	Method
linear	Method
transformations	Method
and	O
histogram	Method
matching	Method
.	O

We	O
show	O
in	O
our	O
experimental	O
evaluation	O
that	O
our	O
approach	O
achieves	O
good	O
performances	O
on	O
challenging	O
test	O
data	O
while	O
requiring	O
only	O
a	O
fraction	O
of	O
the	O
processing	Metric
time	Metric
needed	O
by	O
other	O
previous	O
methods	O
.	O

section	O
:	O
Introduction	O
and	O
Related	O
Work	O
Recent	O
research	O
in	O
computer	Task
vision	Task
and	O
pattern	Task
recognition	Task
has	O
highlighted	O
the	O
capabilities	O
of	O
Convolutional	Method
Neural	Method
Networks	Method
(	O
CNNs	Method
)	O
to	O
solve	O
challenging	O
tasks	O
such	O
as	O
classification	Task
,	O
segmentation	Task
and	O
object	Task
detection	Task
,	O
achieving	O
state	O
-	O
of	O
-	O
the	O
-	O
art	O
performances	O
.	O

This	O
success	O
has	O
been	O
attributed	O
to	O
the	O
ability	O
of	O
CNNs	Method
to	O
learn	O
a	O
hierarchical	Method
representation	Method
of	O
raw	O
input	O
data	O
,	O
without	O
relying	O
on	O
handcrafted	O
features	O
.	O

As	O
the	O
inputs	O
are	O
processed	O
through	O
the	O
network	Method
layers	Method
,	O
the	O
level	O
of	O
abstraction	O
of	O
the	O
resulting	O
features	O
increases	O
.	O

Shallower	O
layers	O
grasp	O
local	O
information	O
while	O
deeper	O
layers	O
use	O
filters	O
whose	O
receptive	O
fields	O
are	O
much	O
broader	O
that	O
therefore	O
capture	O
global	O
information	O
.	O

Segmentation	Task
is	O
a	O
highly	O
relevant	O
task	O
in	O
medical	Task
image	Task
analysis	Task
.	O

Automatic	Task
delineation	Task
of	Task
organs	Task
and	Task
structures	Task
of	Task
interest	Task
is	O
often	O
necessary	O
to	O
perform	O
tasks	O
such	O
as	O
visual	Task
augmentation	Task
,	O
computer	Task
assisted	Task
diagnosis	Task
,	O
interventions	Task
and	O
extraction	Task
of	Task
quantitative	Task
indices	Task
from	O
images	O
.	O

In	O
particular	O
,	O
since	O
diagnostic	Task
and	O
interventional	Task
imagery	Task
often	O
consists	O
of	O
3D	O
images	O
,	O
being	O
able	O
to	O
perform	O
volumetric	Task
segmentations	Task
by	O
taking	O
into	O
account	O
the	O
whole	O
volume	O
content	O
at	O
once	O
,	O
has	O
a	O
particular	O
relevance	O
.	O

In	O
this	O
work	O
,	O
we	O
aim	O
to	O
segment	O
prostate	O
MRI	O
volumes	O
.	O

This	O
is	O
a	O
challenging	O
task	O
due	O
to	O
the	O
wide	O
range	O
of	O
appearance	O
the	O
prostate	O
can	O
assume	O
in	O
different	O
scans	O
due	O
to	O
deformations	O
and	O
variations	O
of	O
the	O
intensity	O
distribution	O
.	O

Moreover	O
,	O
MRI	O
volumes	O
are	O
often	O
affected	O
by	O
artefacts	O
and	O
distortions	O
due	O
to	O
field	O
inhomogeneity	O
.	O

Prostate	Task
segmentation	Task
is	O
nevertheless	O
an	O
important	O
task	O
having	O
clinical	O
relevance	O
both	O
during	O
diagnosis	Task
,	O
where	O
the	O
volume	O
of	O
the	O
prostate	O
needs	O
to	O
be	O
assessed	O
,	O
and	O
during	O
treatment	Task
planning	Task
,	O
where	O
the	O
estimate	O
of	O
the	O
anatomical	O
boundary	O
needs	O
to	O
be	O
accurate	O
.	O

CNNs	Method
have	O
been	O
recently	O
used	O
for	O
medical	Task
image	Task
segmentation	Task
.	O

Early	O
approaches	O
obtain	O
anatomy	Task
delineation	Task
in	O
images	O
or	O
volumes	O
by	O
performing	O
patch	Method
-	Method
wise	Method
image	Method
classification	Method
.	O

Such	O
segmentations	O
are	O
obtained	O
by	O
only	O
considering	O
local	O
context	O
and	O
therefore	O
are	O
prone	O
to	O
failure	O
,	O
especially	O
in	O
challenging	O
modalities	O
such	O
as	O
ultrasound	Task
,	O
where	O
a	O
high	O
number	O
of	O
mis	O
-	O
classified	O
voxel	O
are	O
to	O
be	O
expected	O
.	O

Post	Method
-	Method
processing	Method
approaches	Method
such	O
as	O
connected	Method
components	Method
analysis	Method
normally	O
yield	O
no	O
improvement	O
and	O
therefore	O
,	O
more	O
recent	O
works	O
,	O
propose	O
to	O
use	O
the	O
network	Method
predictions	Method
in	O
combination	O
with	O
Markov	Method
random	Method
fields	Method
,	O
voting	Method
strategies	Method
or	O
more	O
traditional	O
approaches	O
such	O
as	O
level	Method
-	Method
sets	Method
.	O

Patch	Method
-	Method
wise	Method
approaches	Method
also	O
suffer	O
from	O
efficiency	Metric
issues	Metric
.	O

When	O
densely	O
extracted	O
patches	O
are	O
processed	O
in	O
a	O
CNN	Method
,	O
a	O
high	O
number	O
of	O
computations	O
is	O
redundant	O
and	O
therefore	O
the	O
total	O
algorithm	Metric
runtime	Metric
is	O
high	O
.	O

In	O
this	O
case	O
,	O
more	O
efficient	O
computational	Method
schemes	Method
can	O
be	O
adopted	O
.	O

Fully	Method
convolutional	Method
network	Method
trained	O
end	O
-	O
to	O
-	O
end	O
were	O
so	O
far	O
applied	O
only	O
to	O
2D	O
images	O
both	O
in	O
computer	Task
vision	Task
and	O
microscopy	Task
image	Task
analysis	Task
.	O

These	O
models	O
,	O
which	O
served	O
as	O
an	O
inspiration	O
for	O
our	O
work	O
,	O
employed	O
different	O
network	Method
architectures	Method
and	O
were	O
trained	O
to	O
predict	O
a	O
segmentation	O
mask	O
,	O
delineating	O
the	O
structures	O
of	O
interest	O
,	O
for	O
the	O
whole	O
image	O
.	O

In	O
a	O
pre	O
-	O
trained	O
VGG	Method
network	Method
architecture	Method
was	O
used	O
in	O
conjunction	O
with	O
its	O
mirrored	Method
,	Method
de	Method
-	Method
convolutional	Method
,	O
equivalent	O
to	O
segment	O
RGB	O
images	O
by	O
leveraging	O
the	O
descriptive	O
power	O
of	O
the	O
features	O
extracted	O
by	O
the	O
innermost	Method
layer	Method
.	O

In	O
three	O
fully	Method
convolutional	Method
deep	Method
neural	Method
networks	Method
,	O
pre	O
-	O
trained	O
on	O
a	O
classification	Task
task	Task
,	O
were	O
refined	O
to	O
produce	O
segmentations	Task
while	O
in	O
a	O
brand	O
new	O
CNN	Method
model	Method
,	O
especially	O
tailored	O
to	O
tackle	O
biomedical	Task
image	Task
analysis	Task
problems	Task
in	O
2D	O
,	O
was	O
proposed	O
.	O

In	O
this	O
work	O
we	O
present	O
our	O
approach	O
to	O
medical	Task
image	Task
segmentation	Task
that	O
leverages	O
the	O
power	O
of	O
a	O
fully	Method
convolutional	Method
neural	Method
networks	Method
,	O
trained	O
end	O
-	O
to	O
-	O
end	O
,	O
to	O
process	O
MRI	O
volumes	O
.	O

Differently	O
from	O
other	O
recent	O
approaches	O
we	O
refrain	O
from	O
processing	O
the	O
input	O
volumes	O
slice	O
-	O
wise	O
and	O
we	O
propose	O
to	O
use	O
volumetric	Task
convolutions	Task
instead	O
.	O

We	O
propose	O
a	O
novel	O
objective	Method
function	Method
based	O
on	O
Dice	Method
coefficient	Method
maximisation	Method
,	O
that	O
we	O
optimise	O
during	O
training	O
.	O

We	O
demonstrate	O
fast	O
and	O
accurate	O
results	O
on	O
prostate	O
MRI	O
test	O
volumes	O
and	O
we	O
provide	O
direct	O
comparison	O
with	O
other	O
methods	O
which	O
were	O
evaluated	O
on	O
the	O
same	O
test	O
data	O
.	O

section	O
:	O
Method	O
In	O
Figure	O
[	O
reference	O
]	O
we	O
provide	O
a	O
schematic	O
representation	O
of	O
our	O
convolutional	Method
neural	Method
network	Method
.	O

We	O
perform	O
convolutions	Method
aiming	O
to	O
both	O
extract	O
features	O
from	O
the	O
data	O
and	O
,	O
at	O
the	O
end	O
of	O
each	O
stage	O
,	O
to	O
reduce	O
its	O
resolution	O
by	O
using	O
appropriate	O
stride	O
.	O

The	O
left	O
part	O
of	O
the	O
network	O
consists	O
of	O
a	O
compression	Method
path	Method
,	O
while	O
the	O
right	O
part	O
decompresses	O
the	O
signal	O
until	O
its	O
original	O
size	O
is	O
reached	O
.	O

Convolutions	Method
are	O
all	O
applied	O
with	O
appropriate	O
padding	Method
.	O

The	O
left	O
side	O
of	O
the	O
network	O
is	O
divided	O
in	O
different	O
stages	O
that	O
operate	O
at	O
different	O
resolutions	O
.	O

Each	O
stage	O
comprises	O
one	O
to	O
three	O
convolutional	Method
layers	Method
.	O

Similarly	O
to	O
the	O
approach	O
presented	O
in	O
,	O
we	O
formulate	O
each	O
stage	O
such	O
that	O
it	O
learns	O
a	O
residual	O
function	O
:	O
the	O
input	O
of	O
each	O
stage	O
is	O
(	O
a	O
)	O
used	O
in	O
the	O
convolutional	Method
layers	Method
and	O
processed	O
through	O
the	O
non	O
-	O
linearities	O
and	O
(	O
b	O
)	O
added	O
to	O
the	O
output	O
of	O
the	O
last	O
convolutional	Method
layer	Method
of	O
that	O
stage	O
in	O
order	O
to	O
enable	O
learning	O
a	O
residual	O
function	O
.	O

As	O
confirmed	O
by	O
our	O
empirical	O
observations	O
,	O
this	O
architecture	O
ensures	O
convergence	O
in	O
a	O
fraction	O
of	O
the	O
time	O
required	O
by	O
a	O
similar	O
network	O
that	O
does	O
not	O
learn	O
residual	O
functions	O
.	O

The	O
convolutions	Method
performed	O
in	O
each	O
stage	O
use	O
volumetric	Method
kernels	Method
having	O
size	O
voxels	O
.	O

As	O
the	O
data	O
proceeds	O
through	O
different	O
stages	O
along	O
the	O
compression	O
path	O
,	O
its	O
resolution	O
is	O
reduced	O
.	O

This	O
is	O
performed	O
through	O
convolution	Method
with	O
voxels	Method
wide	Method
kernels	Method
applied	O
with	O
stride	O
(	O
Figure	O
[	O
reference	O
]	O
)	O
.	O

Since	O
the	O
second	O
operation	O
extracts	O
features	O
by	O
considering	O
only	O
non	O
overlapping	O
volume	O
patches	O
,	O
the	O
size	O
of	O
the	O
resulting	O
feature	O
maps	O
is	O
halved	O
.	O

This	O
strategy	O
serves	O
a	O
similar	O
purpose	O
as	O
pooling	Method
layers	Method
that	O
,	O
motivated	O
by	O
and	O
other	O
works	O
discouraging	O
the	O
use	O
of	O
max	Method
-	Method
pooling	Method
operations	Method
in	O
CNNs	Method
,	O
have	O
been	O
replaced	O
in	O
our	O
approach	O
by	O
convolutional	Method
ones	Method
.	O

Moreover	O
,	O
since	O
the	O
number	O
of	O
feature	O
channels	O
doubles	O
at	O
each	O
stage	O
of	O
the	O
compression	Method
path	Method
of	O
the	O
V	Method
-	Method
Net	Method
,	O
and	O
due	O
to	O
the	O
formulation	O
of	O
the	O
model	O
as	O
a	O
residual	Method
network	Method
,	O
we	O
resort	O
to	O
these	O
convolution	Method
operations	Method
to	O
double	O
the	O
number	O
of	O
feature	O
maps	O
as	O
we	O
reduce	O
their	O
resolution	O
.	O

PReLu	O
non	O
linearities	O
are	O
applied	O
throughout	O
the	O
network	O
.	O

Replacing	O
pooling	Method
operations	Method
with	O
convolutional	Method
ones	Method
results	O
also	O
to	O
networks	O
that	O
,	O
depending	O
on	O
the	O
specific	O
implementation	O
,	O
can	O
have	O
a	O
smaller	O
memory	O
footprint	O
during	O
training	O
,	O
due	O
to	O
the	O
fact	O
that	O
no	O
switches	O
mapping	O
the	O
output	O
of	O
pooling	O
layers	O
back	O
to	O
their	O
inputs	O
are	O
needed	O
for	O
back	Method
-	Method
propagation	Method
,	O
and	O
that	O
can	O
be	O
better	O
understood	O
and	O
analysed	O
by	O
applying	O
only	O
de	Method
-	Method
convolutions	Method
instead	O
of	O
un	Method
-	Method
pooling	Method
operations	Method
.	O

Downsampling	Method
allows	O
us	O
to	O
reduce	O
the	O
size	O
of	O
the	O
signal	O
presented	O
as	O
input	O
and	O
to	O
increase	O
the	O
receptive	O
field	O
of	O
the	O
features	O
being	O
computed	O
in	O
subsequent	O
network	Method
layers	Method
.	O

Each	O
of	O
the	O
stages	O
of	O
the	O
left	O
part	O
of	O
the	O
network	O
,	O
computes	O
a	O
number	O
of	O
features	O
which	O
is	O
two	O
times	O
higher	O
than	O
the	O
one	O
of	O
the	O
previous	O
layer	O
.	O

The	O
right	O
portion	O
of	O
the	O
network	O
extracts	O
features	O
and	O
expands	O
the	O
spatial	O
support	O
of	O
the	O
lower	O
resolution	O
feature	O
maps	O
in	O
order	O
to	O
gather	O
and	O
assemble	O
the	O
necessary	O
information	O
to	O
output	O
a	O
two	Task
channel	Task
volumetric	Task
segmentation	Task
.	O

The	O
two	O
features	O
maps	O
computed	O
by	O
the	O
very	O
last	O
convolutional	Method
layer	Method
,	O
having	O
kernel	O
size	O
and	O
producing	O
outputs	O
of	O
the	O
same	O
size	O
as	O
the	O
input	O
volume	O
,	O
are	O
converted	O
to	O
probabilistic	Method
segmentations	Method
of	O
the	O
foreground	O
and	O
background	O
regions	O
by	O
applying	O
soft	Method
-	Method
max	Method
voxelwise	Method
.	O

After	O
each	O
stage	O
of	O
the	O
right	O
portion	O
of	O
the	O
CNN	Method
,	O
a	O
de	Method
-	Method
convolution	Method
operation	Method
is	O
employed	O
in	O
order	O
increase	O
the	O
size	O
of	O
the	O
inputs	O
(	O
Figure	O
[	O
reference	O
]	O
)	O
followed	O
by	O
one	O
to	O
three	O
convolutional	Method
layers	Method
involving	O
half	O
the	O
number	O
of	O
kernels	O
employed	O
in	O
the	O
previous	O
layer	O
.	O

Similar	O
to	O
the	O
left	O
part	O
of	O
the	O
network	O
,	O
also	O
in	O
this	O
case	O
we	O
resort	O
to	O
learn	O
residual	O
functions	O
in	O
the	O
convolutional	Method
stages	Method
.	O

Similarly	O
to	O
,	O
we	O
forward	O
the	O
features	O
extracted	O
from	O
early	O
stages	O
of	O
the	O
left	O
part	O
of	O
the	O
CNN	Method
to	O
the	O
right	O
part	O
.	O

This	O
is	O
schematically	O
represented	O
in	O
Figure	O
[	O
reference	O
]	O
by	O
horizontal	O
connections	O
.	O

In	O
this	O
way	O
we	O
gather	O
fine	O
grained	O
detail	O
that	O
would	O
be	O
otherwise	O
lost	O
in	O
the	O
compression	O
path	O
and	O
we	O
improve	O
the	O
quality	O
of	O
the	O
final	O
contour	Task
prediction	Task
.	O

We	O
also	O
observed	O
that	O
when	O
these	O
connections	O
improve	O
the	O
convergence	Metric
time	Metric
of	O
the	O
model	O
.	O

We	O
report	O
in	O
Table	O
[	O
reference	O
]	O
the	O
receptive	O
fields	O
of	O
each	O
network	Method
layer	Method
,	O
showing	O
the	O
fact	O
that	O
the	O
innermost	O
portion	O
of	O
our	O
CNN	Method
already	O
captures	O
the	O
content	O
of	O
the	O
whole	O
input	O
volume	O
.	O

We	O
believe	O
that	O
this	O
characteristic	O
is	O
important	O
during	O
segmentation	Task
of	Task
poorly	Task
visible	Task
anatomy	Task
:	O
the	O
features	O
computed	O
in	O
the	O
deepest	O
layer	O
perceive	O
the	O
whole	O
anatomy	O
of	O
interest	O
at	O
once	O
,	O
since	O
they	O
are	O
computed	O
from	O
data	O
having	O
a	O
spatial	O
support	O
much	O
larger	O
than	O
the	O
typical	O
size	O
of	O
the	O
anatomy	O
we	O
seek	O
to	O
delineate	O
,	O
and	O
therefore	O
impose	O
global	O
constraints	O
.	O

section	O
:	O
Dice	Method
loss	O
layer	O
The	O
network	Method
predictions	Method
,	O
which	O
consist	O
of	O
two	O
volumes	O
having	O
the	O
same	O
resolution	O
as	O
the	O
original	O
input	O
data	O
,	O
are	O
processed	O
through	O
a	O
soft	Method
-	Method
max	Method
layer	Method
which	O
outputs	O
the	O
probability	O
of	O
each	O
voxel	O
to	O
belong	O
to	O
foreground	O
and	O
to	O
background	O
.	O

In	O
medical	O
volumes	O
such	O
as	O
the	O
ones	O
we	O
are	O
processing	O
in	O
this	O
work	O
,	O
it	O
is	O
not	O
uncommon	O
that	O
the	O
anatomy	O
of	O
interest	O
occupies	O
only	O
a	O
very	O
small	O
region	O
of	O
the	O
scan	O
.	O

This	O
often	O
causes	O
the	O
learning	Method
process	Method
to	O
get	O
trapped	O
in	O
local	O
minima	O
of	O
the	O
loss	O
function	O
yielding	O
a	O
network	O
whose	O
predictions	O
are	O
strongly	O
biased	O
towards	O
background	O
.	O

As	O
a	O
result	O
the	O
foreground	O
region	O
is	O
often	O
missing	O
or	O
only	O
partially	O
detected	O
.	O

Several	O
previous	O
approaches	O
resorted	O
to	O
loss	Method
functions	Method
based	O
on	O
sample	Method
re	Method
-	Method
weighting	Method
where	O
foreground	O
regions	O
are	O
given	O
more	O
importance	O
than	O
background	O
ones	O
during	O
learning	Task
.	O

In	O
this	O
work	O
we	O
propose	O
a	O
novel	O
objective	Metric
function	Metric
based	O
on	O
dice	Method
coefficient	Method
,	O
which	O
is	O
a	O
quantity	O
ranging	O
between	O
and	O
which	O
we	O
aim	O
to	O
maximise	O
.	O

The	O
dice	Method
coefficient	Method
between	O
two	O
binary	O
volumes	O
can	O
be	O
written	O
as	O
where	O
the	O
sums	O
run	O
over	O
the	O
voxels	O
,	O
of	O
the	O
predicted	O
binary	O
segmentation	O
volume	O
and	O
the	O
ground	O
truth	O
binary	O
volume	O
.	O

This	O
formulation	O
of	O
Dice	Method
can	O
be	O
differentiated	O
yielding	O
the	O
gradient	O
computed	O
with	O
respect	O
to	O
the	O
-	O
th	O
voxel	O
of	O
the	O
prediction	O
.	O

Using	O
this	O
formulation	O
we	O
do	O
not	O
need	O
to	O
assign	O
weights	O
to	O
samples	O
of	O
different	O
classes	O
to	O
establish	O
the	O
right	O
balance	O
between	O
foreground	O
and	O
background	O
voxels	O
,	O
and	O
we	O
obtain	O
results	O
that	O
we	O
experimentally	O
observed	O
are	O
much	O
better	O
than	O
the	O
ones	O
computed	O
through	O
the	O
same	O
network	O
trained	O
optimising	O
a	O
multinomial	Method
logistic	Method
loss	Method
with	O
sample	Method
re	Method
-	Method
weighting	Method
(	O
Fig	O
.	O

[	O
reference	O
]	O
)	O
.	O

subsection	O
:	O
Training	O
Our	O
CNN	Method
is	O
trained	O
end	O
-	O
to	O
-	O
end	O
on	O
a	O
dataset	O
of	O
prostate	O
scans	O
in	O
MRI	O
.	O

An	O
example	O
of	O
the	O
typical	O
content	O
of	O
such	O
volumes	O
is	O
shown	O
in	O
Figure	O
[	O
reference	O
]	O
.	O

All	O
the	O
volumes	O
processed	O
by	O
the	O
network	O
have	O
fixed	O
size	O
of	O
voxels	O
and	O
a	O
spatial	O
resolution	O
of	O
millimeters	O
.	O

Annotated	O
medical	O
volumes	O
are	O
not	O
easy	O
to	O
obtain	O
due	O
to	O
the	O
fact	O
that	O
one	O
or	O
more	O
experts	O
are	O
required	O
to	O
manually	O
trace	O
a	O
reliable	O
ground	O
truth	O
annotation	O
and	O
that	O
there	O
is	O
a	O
cost	O
associated	O
with	O
their	O
acquisition	O
.	O

In	O
this	O
work	O
we	O
found	O
necessary	O
to	O
augment	O
the	O
original	O
training	O
dataset	O
in	O
order	O
to	O
obtain	O
robustness	Metric
and	O
increased	O
precision	Metric
on	O
the	O
test	O
dataset	O
.	O

During	O
every	O
training	O
iteration	O
,	O
we	O
fed	O
as	O
input	O
to	O
the	O
network	O
randomly	O
deformed	O
versions	O
of	O
the	O
training	O
images	O
by	O
using	O
a	O
dense	O
deformation	O
field	O
obtained	O
through	O
a	O
grid	O
of	O
control	O
-	O
points	O
and	O
B	Method
-	Method
spline	Method
interpolation	Method
.	O

This	O
augmentation	O
has	O
been	O
performed	O
”	O
on	O
-	O
the	O
-	O
fly	O
”	O
,	O
prior	O
to	O
each	O
optimisation	Task
iteration	Task
,	O
in	O
order	O
to	O
alleviate	O
the	O
otherwise	O
excessive	O
storage	O
requirements	O
.	O

Additionally	O
we	O
vary	O
the	O
intensity	O
distribution	O
of	O
the	O
data	O
by	O
adapting	O
,	O
using	O
histogram	Method
matching	Method
,	O
the	O
intensity	O
distributions	O
of	O
the	O
training	O
volumes	O
used	O
in	O
each	O
iteration	O
,	O
to	O
the	O
ones	O
of	O
other	O
randomly	O
chosen	O
scans	O
belonging	O
to	O
the	O
dataset	O
.	O

subsection	O
:	O
Testing	O
A	O
Previously	O
unseen	O
MRI	O
volume	O
can	O
be	O
segmented	O
by	O
processing	O
it	O
in	O
a	O
feed	O
-	O
forward	O
manner	O
through	O
the	O
network	O
.	O

The	O
output	O
of	O
the	O
last	O
convolutional	Method
layer	Method
,	O
after	O
soft	Method
-	Method
max	Method
,	O
consists	O
of	O
a	O
probability	O
map	O
for	O
background	O
and	O
foreground	O
.	O

The	O
voxels	O
having	O
higher	O
probability	O
(	O
)	O
to	O
belong	O
to	O
the	O
foreground	O
than	O
to	O
the	O
background	O
are	O
considered	O
part	O
of	O
the	O
anatomy	O
.	O

section	O
:	O
Results	O
We	O
trained	O
our	O
method	O
on	O
MRI	O
volumes	O
,	O
and	O
the	O
relative	O
manual	O
ground	O
truth	O
annotation	O
,	O
obtained	O
from	O
the	O
”	Material
PROMISE2012	Material
”	Material
challenge	Material
dataset	Material
.	O

This	O
dataset	O
contains	O
medical	O
data	O
acquired	O
in	O
different	O
hospitals	O
,	O
using	O
different	O
equipment	O
and	O
different	O
acquisition	O
protocols	O
.	O

The	O
data	O
in	O
this	O
dataset	O
is	O
representative	O
of	O
the	O
clinical	O
variability	O
and	O
challenges	O
encountered	O
in	O
clinical	O
settings	O
.	O

As	O
previously	O
stated	O
we	O
massively	O
augmented	O
this	O
dataset	O
through	O
random	Method
transformation	Method
performed	O
in	O
each	O
training	O
iteration	O
,	O
for	O
each	O
mini	O
-	O
batch	O
fed	O
to	O
the	O
network	O
.	O

The	O
mini	O
-	O
batches	O
used	O
in	O
our	O
implementation	O
contained	O
two	O
volumes	O
each	O
,	O
mainly	O
due	O
to	O
the	O
high	O
memory	O
requirement	O
of	O
the	O
model	O
during	O
training	O
.	O

We	O
used	O
a	O
momentum	O
of	O
and	O
a	O
initial	O
learning	Metric
rate	Metric
of	O
which	O
decreases	O
by	O
one	O
order	O
of	O
magnitude	O
every	O
K	O
iterations	O
.	O

We	O
tested	O
V	Method
-	Method
Net	Method
on	O
MRI	O
volumes	O
depicting	O
prostate	O
whose	O
ground	O
truth	O
annotation	O
was	O
secret	O
.	O

All	O
the	O
results	O
reported	O
in	O
this	O
section	O
of	O
the	O
paper	O
were	O
obtained	O
directly	O
from	O
the	O
organisers	O
of	O
the	O
challenge	O
after	O
submitting	O
the	O
segmentation	Task
obtained	O
through	O
our	O
approach	O
.	O

The	O
test	O
set	O
was	O
representative	O
of	O
the	O
clinical	O
variability	O
encountered	O
in	O
prostate	O
scans	O
in	O
real	O
clinical	O
settings	O
.	O

We	O
evaluated	O
the	O
approach	O
performance	O
in	O
terms	O
of	O
Dice	Method
coefficient	O
,	O
Hausdorff	Metric
distance	Metric
of	O
the	O
predicted	Metric
delineation	Metric
to	O
the	O
ground	O
truth	O
annotation	O
and	O
in	O
terms	O
of	O
score	Metric
obtained	O
on	O
the	O
challenge	O
data	O
as	O
computed	O
by	O
the	O
organisers	O
of	O
”	O
PROMISE	Material
2012	Material
”	O
.	O

The	O
results	O
are	O
shown	O
in	O
Table	O
[	O
reference	O
]	O
and	O
Fig	O
.	O

[	O
reference	O
]	O
.	O

Our	O
implementation	O
was	O
realised	O
in	O
python	Method
,	O
using	O
a	O
custom	O
version	O
of	O
the	O
Caffe	Method
framework	Method
which	O
was	O
enabled	O
to	O
perform	O
volumetric	Task
convolutions	Task
via	O
CuDNN	Method
v3	Method
.	O

All	O
the	O
trainings	O
and	O
experiments	O
were	O
ran	O
on	O
a	O
standard	O
workstation	O
equipped	O
with	O
GB	O
of	O
memory	O
,	O
an	O
Intel	O
(	O
R	O
)	O
Core	O
(	O
TM	O
)	O
i7	O
-	O
5820	O
K	O
CPU	O
working	O
at	O
3.30GHz	O
,	O
and	O
a	O
NVidia	O
GTX	O
1080	O
with	O
GB	O
of	O
video	O
memory	O
.	O

We	O
let	O
our	O
model	O
train	O
for	O
hours	O
,	O
or	O
K	O
iterations	O
circa	O
,	O
and	O
we	O
were	O
able	O
to	O
segment	O
a	O
previously	O
unseen	O
volume	O
in	O
circa	O
second	O
.	O

The	O
datasets	O
were	O
first	O
normalised	O
using	O
the	O
N4	Method
bias	Method
filed	Method
correction	Method
function	Method
of	O
the	O
ANTs	Method
framework	Method
and	O
then	O
resampled	O
to	O
a	O
common	O
resolution	O
of	O
mm	O
.	O

We	O
applied	O
random	O
deformations	O
to	O
the	O
scans	O
used	O
for	O
training	O
by	O
varying	O
the	O
position	O
of	O
the	O
control	O
points	O
with	O
random	O
quantities	O
obtained	O
from	O
gaussian	Method
distribution	Method
with	O
zero	O
mean	O
and	O
voxels	O
standard	O
deviation	O
.	O

Qualitative	O
results	O
can	O
be	O
seen	O
in	O
Fig	O
.	O

[	O
reference	O
]	O
.	O

section	O
:	O
Conclusion	O
We	O
presented	O
and	O
approach	O
based	O
on	O
a	O
volumetric	O
convolutional	Method
neural	Method
network	Method
that	O
performs	O
segmentation	Task
of	Task
MRI	Task
prostate	Task
volumes	Task
in	O
a	O
fast	O
and	O
accurate	O
manner	O
.	O

We	O
introduced	O
a	O
novel	O
objective	Metric
function	Metric
that	O
we	O
optimise	O
during	O
training	Task
based	O
on	O
the	O
Dice	Method
overlap	Method
coefficient	Method
between	O
the	O
predicted	O
segmentation	O
and	O
the	O
ground	O
truth	O
annotation	O
.	O

Our	O
Dice	Method
loss	Method
layer	Method
does	O
not	O
need	O
sample	Method
re	Method
-	Method
weighting	Method
when	O
the	O
amount	O
of	O
background	O
and	O
foreground	O
pixels	O
is	O
strongly	O
unbalanced	O
and	O
is	O
indicated	O
for	O
binary	Task
segmentation	Task
tasks	Task
.	O

Although	O
we	O
inspired	O
our	O
architecture	O
to	O
the	O
one	O
proposed	O
in	O
,	O
we	O
divided	O
it	O
into	O
stages	O
that	O
learn	O
residuals	O
and	O
,	O
as	O
empirically	O
observed	O
,	O
improve	O
both	O
results	O
and	O
convergence	Metric
time	Metric
.	O

Future	O
works	O
will	O
aim	O
at	O
segmenting	O
volumes	O
containing	O
multiple	O
regions	O
in	O
other	O
modalities	O
such	O
as	O
ultrasound	O
and	O
at	O
higher	O
resolutions	O
by	O
splitting	O
the	O
network	O
over	O
multiple	O
GPUs	O
.	O

section	O
:	O
Acknowledgement	O
We	O
would	O
like	O
to	O
acknowledge	O
NVidia	O
corporation	O
,	O
that	O
donated	O
a	O
Tesla	O
K40	O
GPU	O
to	O
our	O
group	O
enabling	O
this	O
research	O
,	O
Dr.	O
Geert	O
Litjens	O
who	O
dedicated	O
some	O
of	O
his	O
time	O
to	O
evaluate	O
our	O
results	O
against	O
the	O
ground	O
truth	O
of	O
the	O
PROMISE	Material
2012	Material
dataset	Material
and	O
Ms.	O
Iro	O
Laina	O
for	O
her	O
support	O
to	O
this	O
project	O
.	O

bibliography	O
:	O
References	O
