document O
: O
Efficient O
Multi Method
- Method
Scale Method
3D Method
CNN Method
with O
fully Method
connected Method
CRF Method
for O
Accurate Task
Brain Task
Lesion Task
Segmentation Task
We O
propose O
a O
dual O
pathway O
, O
11 O
- O
layers O
deep O
, O
three O
- O
dimensional O
Convolutional Method
Neural Method
Network Method
for O
the O
challenging O
task O
of O
brain O
lesion O
segmentation Task
. O
The O
devised O
architecture O
is O
the O
result O
of O
an O
in O
- O
depth O
analysis O
of O
the O
limitations O
of O
current O
networks Method
proposed O
for O
similar O
applications O
. O
To O
overcome O
the O
computational Metric
burden O
of O
processing Task
3D Task
medical Task
scans Task
, O
we O
have O
devised O
an O
efficient O
and O
effective O
dense O
training Method
scheme O
which O
joins O
the O
processing O
of O
adjacent O
image O
patches O
into O
one O
pass O
through O
the O
network O
while O
automatically O
adapting O
to O
the O
inherent O
class O
imbalance O
present O
in O
the O
data O
. O
Further O
, O
we O
analyze O
the O
development O
of O
deeper O
, O
thus O
more O
discriminative Method
3D Method
CNNs Method
. O
In O
order O
to O
incorporate O
both O
local O
and O
larger O
contextual O
information O
, O
we O
employ O
a O
dual Method
pathway Method
architecture Method
that O
processes O
the O
input O
images O
at O
multiple O
scales O
simultaneously O
. O
For O
post O
- O
processing O
of O
the O
network O
’s O
soft O
segmentation Task
, O
we O
use O
a O
3D Method
fully Method
connected Method
Conditional Method
Random Method
Field Method
which O
effectively O
removes O
false O
positives O
. O
Our O
pipeline O
is O
extensively O
evaluated O
on O
three O
challenging O
tasks O
of O
lesion O
segmentation Task
in O
multi O
- O
channel O
MRI O
patient O
data O
with O
traumatic O
brain O
injuries O
, O
brain O
tumors O
, O
and O
ischemic O
stroke O
. O
We O
improve O
on O
the O
state O
- O
of O
- O
the O
- O
art O
for O
all O
three O
applications O
, O
with O
top O
ranking Metric
performance Metric
on O
the O
public O
benchmarks O
BRATS Material
2015 Material
and O
ISLES O
2015 O
. O
Our O
method O
is O
computationally O
efficient O
, O
which O
allows O
its O
adoption O
in O
a O
variety O
of O
research O
and O
clinical O
settings O
. O
The O
source O
code O
of O
our O
implementation O
is O
made O
publicly O
available O
. O
section O
: O
Introduction O
Segmentation Task
and O
the O
subsequent O
quantitative Task
assessment Task
of Task
lesions Task
in O
medical O
images O
provide O
valuable O
information O
for O
the O
analysis Task
of Task
neuropathologies Task
and O
are O
important O
for O
planning Task
of Task
treatment Task
strategies Task
, O
monitoring Task
of Task
disease Task
progression Task
and O
prediction Task
of Task
patient Task
outcome Task
. O
For O
a O
better O
understanding O
of O
the O
pathophysiology Task
of Task
diseases Task
, O
quantitative Task
imaging Task
can O
reveal O
clues O
about O
the O
disease O
characteristics O
and O
effects O
on O
particular O
anatomical O
structures O
. O
For O
example O
, O
the O
associations O
of O
different O
lesion O
types O
, O
their O
spatial O
distribution O
and O
extent O
with O
acute O
and O
chronic O
sequelae O
after O
traumatic O
brain O
injury O
( O
TBI O
) O
are O
still O
poorly O
understood O
( O
) O
. O
However O
, O
there O
is O
growing O
evidence O
that O
quantification Task
of Task
lesion Task
burden Task
may O
add O
insight O
into O
the O
functional O
outcome O
of O
patients O
( O
) O
. O
Additionally O
, O
exact O
locations O
of O
injuries O
relate O
to O
particular O
deficits O
depending O
on O
the O
brain O
structure O
that O
is O
affected O
( O
) O
. O
This O
is O
in O
line O
with O
estimates O
that O
functional O
deficits O
caused O
by O
stroke O
are O
associated O
with O
the O
extent O
of O
damage O
to O
particular O
parts O
of O
the O
brain O
( O
) O
. O
Lesion O
burden O
is O
commonly O
quantified O
by O
means O
of O
volume O
and O
number O
of O
lesions O
, O
biomarkers O
that O
have O
been O
shown O
to O
be O
related O
to O
cognitive Task
deficits Task
. O
For O
example O
, O
volume O
of O
white O
matter O
lesions O
( O
WML O
) O
correlates O
with O
cognitive O
decline O
and O
increased O
risk O
of O
dementia O
( O
) O
. O
In O
clinical O
research O
on O
multiple O
sclerosis O
( O
MS O
) O
, O
lesion O
count O
and O
volume O
are O
used O
to O
analyse Task
disease Task
progression Task
and O
effectiveness Task
of Task
pharmaceutical Task
treatment Task
( O
) O
. O
Finally O
, O
accurate Task
delineation Task
of Task
the Task
pathology Task
is O
important O
in O
the O
case O
of O
brain O
tumors O
, O
where O
estimation O
of O
the O
relative O
volume O
of O
a O
tumor O
’s O
sub O
- O
components O
is O
required O
for O
planning Task
radiotherapy Task
and Task
treatment Task
follow Task
- Task
up Task
( O
) O
. O
The O
quantitative Task
analysis Task
of Task
lesions Task
requires O
accurate O
lesion O
segmentation Task
in O
multi O
- O
modal O
, O
three O
- O
dimensional O
images O
which O
is O
a O
challenging O
task O
for O
a O
number O
of O
reasons O
. O
The O
heterogeneous O
appearance O
of O
lesions O
including O
the O
large O
variability O
in O
location O
, O
size O
, O
shape O
and O
frequency O
make O
it O
difficult O
to O
devise O
effective O
segmentation Task
rules O
. O
It O
is O
thus O
highly O
non O
- O
trivial O
to O
delineate O
contusions O
, O
edema O
and O
haemorrhages O
in O
TBI O
( O
) O
, O
or O
sub O
- O
components O
of O
brain O
tumors O
such O
as O
proliferating O
cells O
and O
necrotic O
core O
( O
) O
. O
The O
arguably O
most O
accurate O
segmentation Task
results O
can O
be O
obtained O
through O
manual Method
delineation Method
by O
a O
human O
expert O
which O
is O
tedious O
, O
expensive O
, O
time O
- O
consuming O
, O
impractical O
in O
larger O
studies O
, O
and O
introduces O
inter Metric
- Metric
observer Metric
variability Metric
. O
Additionally O
, O
for O
deciding O
whether O
a O
particular O
region O
is O
part O
of O
a O
lesion O
multiple O
image O
sequences O
with O
varying O
contrasts O
need O
to O
be O
considered O
, O
and O
the O
level O
of O
expert O
knowledge O
and O
experience O
are O
important O
factors O
that O
impact O
segmentation Task
accuracy O
. O
Hence O
, O
in O
clinical O
routine O
often O
only O
qualitative O
, O
visual Metric
inspection Metric
, O
or O
at O
best O
crude O
measures O
like O
approximate O
lesion O
volume O
and O
number O
of O
lesions O
are O
used O
( O
) O
. O
In O
order O
to O
capture O
and O
better O
understand O
the O
complexity O
of O
brain O
pathologies O
it O
is O
important O
to O
conduct O
large O
studies O
with O
many O
subjects O
to O
gain O
the O
statistical O
power O
for O
drawing O
conclusions O
across O
a O
whole O
patient O
population O
. O
The O
development O
of O
accurate O
, O
automatic O
segmentation Task
algorithms O
has O
therefore O
become O
a O
major O
research O
focus O
in O
medical Task
image Task
computing Task
with O
the O
potential O
to O
offer O
objective O
, O
reproducible O
, O
and O
scalable O
approaches O
to O
quantitative Task
assessment Task
of Task
brain Task
lesions Task
. O
Figure O
[ O
reference O
] O
illustrates O
some O
of O
the O
challenges O
that O
arise O
when O
devising O
a O
computational Metric
approach O
for O
the O
task O
of O
automatic O
lesion O
segmentation Task
. O
The O
figure O
summarizes O
statistics O
and O
shows O
examples O
of O
brain O
lesions O
in O
the O
case O
of O
TBI O
, O
but O
is O
representative O
of O
other O
pathologies O
such O
as O
brain O
tumors O
and O
ischemic O
stroke O
. O
Lesions O
can O
occur O
at O
multiple O
sites O
, O
with O
varying O
shapes O
and O
sizes O
, O
and O
their O
image O
intensity O
profiles O
largely O
overlap O
with O
non O
- O
affected O
, O
healthy O
parts O
of O
the O
brain O
or O
lesions O
which O
are O
not O
in O
the O
focus O
of O
interest O
. O
For O
example O
, O
stroke O
and O
MS O
lesions O
have O
a O
similar O
hyper O
- O
intense O
appearance O
in O
FLAIR O
sequences O
as O
other O
WMLs O
( O
) O
. O
It O
is O
generally O
difficult O
to O
derive O
statistical O
prior O
information O
about O
lesion O
shape O
and O
appearance O
. O
On O
the O
other O
hand O
, O
in O
some O
applications O
there O
is O
an O
expectation O
on O
the O
spatial O
configuration O
of O
segmentation Task
labels O
, O
for O
example O
there O
is O
a O
hierarchical O
layout O
of O
sub O
- O
components O
in O
brain O
tumors O
. O
Ideally O
, O
a O
computational Metric
approach O
is O
able O
to O
adjust O
itself O
to O
application O
specific O
characteristics O
by O
learning O
from O
a O
set O
of O
a O
few O
example O
images O
. O
[ O
b O
] O
0.225 O
[ O
b O
] O
0.225 O
[ O
b O
] O
0.225 O
[ O
b O
] O
0.22 O
[ O
b O
] O
1.0 O
subsection O
: O
Related O
Work O
A O
multitude O
of O
automatic O
lesion O
segmentation Task
methods O
have O
been O
proposed O
over O
the O
last O
decade O
, O
and O
several O
main O
categories O
of O
approaches O
can O
be O
identified O
. O
One O
group O
of O
methods O
poses O
the O
lesion O
segmentation Task
task O
as O
an O
abnormality Task
detection Task
problem Task
, O
for O
example O
by O
employing O
image Task
registration Task
. O
The O
early O
work O
of O
and O
more O
recent O
ones O
by O
and O
align O
the O
pathological O
scan O
to O
a O
healthy O
atlas O
and O
lesions O
are O
detected O
based O
on O
deviations O
in O
tissue O
appearance O
between O
the O
patient O
and O
the O
atlas O
image O
. O
Lesions O
, O
however O
, O
may O
cause O
large O
structural O
deformations O
that O
may O
lead O
to O
incorrect O
segmentation Task
due O
to O
incorrect O
registration Task
. O
alleviate O
this O
problem O
by O
jointly O
solving O
the O
segmentation Task
and O
registration Task
tasks Task
. O
showed O
that O
registration Method
together O
with O
a O
low Method
- Method
rank Method
decomposition Method
gives O
as O
a O
by O
- O
product O
the O
abnormal O
structures O
in O
the O
sparse O
components O
, O
although O
, O
this O
may O
not O
be O
precise O
enough O
for O
detection Task
of Task
small Task
lesions Task
. O
Abnormality Task
detection Task
has O
also O
been O
proposed O
within O
image Task
synthesis Task
works O
. O
Representative O
approaches O
are O
those O
of O
using O
dictionary Method
learning Method
and O
using O
a O
patch Method
- Method
based Method
approach Method
. O
The O
idea O
is O
to O
synthesize O
pseudo O
- O
healthy O
images O
that O
when O
compared O
to O
the O
patient O
scan O
allow O
to O
highlight O
abnormal O
regions O
. O
In O
this O
context O
, O
present O
a O
generative Method
model Method
for O
image Task
synthesis Task
that O
yields O
a O
probabilistic O
segmentation Task
of O
abnormalities O
. O
Another O
unsupervised Method
technique Method
is O
proposed O
by O
, O
a O
saliency Method
- Method
based Method
method Method
that O
exploits O
brain O
asymmetry O
in O
pathological O
cases O
. O
A O
common O
advantage O
of O
the O
above O
methods O
is O
that O
they O
do O
not O
require O
a O
training Method
dataset O
with O
corresponding O
manual O
annotations O
. O
In O
general O
, O
these O
approaches O
are O
more O
suitable O
for O
detecting Task
lesions Task
rather O
than O
accurately O
segmenting O
them O
. O
Some O
of O
the O
most O
successful O
, O
supervised Method
segmentation Method
methods Method
for O
brain Task
lesions Task
are O
based O
on O
voxel Method
- Method
wise Method
classifiers Method
, O
such O
as O
Random Method
Forests Method
. O
Representative O
work O
is O
that O
of O
on O
MS O
lesions O
, O
employing O
intensity O
features O
to O
capture O
the O
appearance O
of O
the O
region O
around O
each O
voxel O
. O
combine O
this O
with O
a O
generative Method
Gaussian Method
Mixture Method
Model Method
( Method
GMM Method
) Method
to O
obtain O
tissue O
- O
specific O
probabilistic O
priors O
( O
) O
. O
This O
framework O
was O
adopted O
in O
multiple O
works O
, O
with O
representative O
pipelines O
for O
brain O
tumors O
by O
and O
TBI O
by O
. O
Both O
works O
incorporate O
morphological O
and O
contextual O
features O
to O
better O
capture O
the O
heterogeneity O
of O
lesions O
. O
also O
incorporate O
brain O
structure O
segmentation Task
results O
obtained O
from O
a O
multi Method
- Method
atlas Method
label Method
propagation Method
approach Method
( O
) O
to O
provide O
strong O
tissue O
- O
class O
priors O
to O
the O
Random Method
Forests Method
. O
additionally O
use O
a O
Markov Method
Random Method
Field Method
( O
MRF Method
) Method
to O
incorporate O
spatial Method
regularization Method
. O
MRFs Method
are O
commonly O
used O
to O
encourage O
spatial O
continuity O
of O
the O
segmentation Task
( O
) O
. O
Although O
those O
methods O
have O
been O
very O
successful O
, O
it O
appears O
that O
their O
modeling O
capabilities O
still O
have O
significant O
limitations O
. O
This O
is O
confirmed O
by O
the O
results O
of O
the O
most O
recent O
challenges O
, O
and O
also O
by O
our O
own O
experience O
and O
experimentation O
with O
such O
approaches O
. O
At O
the O
same O
time O
, O
deep Method
learning Method
techniques Method
have O
emerged O
as O
a O
powerful O
alternative O
for O
supervised Task
learning Task
with O
great O
model Metric
capacity Metric
and O
the O
ability O
to O
learn O
highly O
discriminative O
features O
for O
the O
task O
at O
hand O
. O
These O
features O
often O
outperform O
hand O
- O
crafted O
and O
pre O
- O
defined O
feature O
sets O
. O
In O
particular O
, O
Convolutional Method
Neural Method
Networks Method
( O
CNNs Method
) O
( O
) O
have O
been O
applied O
with O
promising O
results O
on O
a O
variety O
of O
biomedical Task
imaging Task
problems Task
. O
presented O
the O
first O
GPU Method
implementation Method
of O
a O
two Method
- Method
dimensional Method
CNN Method
for O
the O
segmentation Task
of O
neural O
membranes O
. O
From O
the O
CNN Method
based O
work O
that O
followed O
, O
related O
to O
our O
approach O
are O
the O
methods O
of O
, O
with O
the O
latter O
being O
the O
best O
performing O
automatic O
approach O
in O
the O
BRATS Material
2015 Material
challenge O
( O
) O
. O
These O
methods O
are O
based O
on O
2D Method
CNNs Method
, O
which O
have O
been O
used O
extensively O
in O
computer Task
vision Task
applications Task
on O
natural O
images O
. O
Here O
, O
the O
segmentation Task
of O
a O
3D O
brain O
scan O
is O
achieved O
by O
processing O
each O
2D O
slice O
independently O
, O
which O
is O
arguably O
a O
non O
- O
optimal O
use O
of O
the O
volumetric O
medical O
image O
data O
. O
Despite O
the O
simplicity O
in O
the O
architecture O
, O
the O
promising O
results O
obtained O
by O
these O
methods O
indicate O
the O
potential O
of O
CNNs Method
. O
Fully Method
3D Method
CNNs Method
come O
with O
an O
increased O
number O
of O
parameters O
and O
significant O
memory O
and O
computational Metric
requirements O
. O
Previous O
work O
discusses O
problems O
and O
apparent O
limitations O
when O
employing O
a O
3D Method
CNN Method
on O
medical O
imaging O
data O
( O
) O
. O
To O
incorporate O
3D O
contextual O
information O
, O
multiple O
works O
used O
2D Method
CNNs Method
on O
three O
orthogonal O
2D O
patches O
( O
) O
. O
In O
their O
work O
for O
structural O
brain O
segmentation Task
, O
extracted O
large O
2D O
patches O
from O
multiple O
scales O
of O
the O
image O
and O
combined O
them O
with O
small O
single O
- O
scale O
3D O
patches O
, O
in O
order O
to O
avoid O
the O
memory Metric
requirements Metric
of O
fully O
3D O
networks Method
. O
One O
of O
the O
reasons O
that O
discouraged O
the O
use O
of O
3D Method
CNNs Method
is O
the O
slow O
inference Method
due O
to O
the O
computationally O
expensive O
3D Method
convolutions Method
. O
In O
contrast O
to O
the O
2D Method
/ Method
3D Method
hybrid Method
variants Method
( Method
) Method
, O
3D Method
CNNs Method
can O
fully O
exploit O
dense O
- O
inference Method
( O
) O
, O
a O
technique O
that O
greatly O
decreases O
inference Metric
times Metric
and O
which O
we O
will O
further O
discuss O
in O
section O
[ O
reference O
] O
. O
By O
employing O
dense O
- O
inference Method
with O
3D Method
CNNs Method
, O
and O
reported O
computation Metric
times O
of O
a O
few O
seconds O
and O
approximately O
a O
minute O
respectively O
for O
the O
processing O
of O
a O
single O
brain O
scan O
. O
Even O
though O
the O
size O
of O
their O
developed O
networks Method
was O
limited O
, O
a O
factor O
that O
is O
directly O
related O
to O
a O
network O
’s O
representational O
power O
, O
their O
results O
on O
MS O
and O
brain Task
tumor Task
segmentation Task
respectively O
were O
very O
promising O
. O
Performance O
of O
CNNs Method
is O
significantly O
influenced O
by O
the O
strategy O
for O
extracting O
training Method
samples O
. O
A O
commonly O
adopted O
approach O
is O
training Method
on O
image O
patches O
that O
are O
equally O
sampled O
from O
each O
class O
. O
This O
, O
however O
, O
biases O
the O
classifier Method
towards O
rare O
classes O
and O
may O
result O
in O
over Task
- Task
segmentation Task
. O
To O
counter O
this O
, O
proposes O
to O
train O
a O
second O
CNN Method
on O
samples O
with O
a O
class O
distribution O
close O
to O
the O
real O
one O
, O
but O
oversample O
pixels O
that O
were O
incorrectly O
classified O
in O
the O
first O
stage O
. O
A O
secondary O
training Method
stage O
was O
also O
suggested O
by O
, O
who O
retrain O
the O
classification Method
layer Method
on O
patches O
extracted O
uniformly O
from O
the O
image O
. O
In O
practice O
, O
two O
stage O
training Method
schemes O
can O
be O
prone O
to O
overfitting O
and O
sensitive O
to O
the O
state O
of O
the O
first O
classifier Method
. O
Alternatively O
, O
dense O
training Method
( O
) O
has O
been O
used O
to O
train O
a O
network O
on O
multiple O
or O
all O
voxels O
of O
a O
single O
image O
per O
optimisation O
step O
( O
) O
. O
This O
can O
introduce O
severe O
class O
imbalance O
, O
similarly O
to O
uniform Method
sampling Method
. O
Weighted Method
cost Method
functions Method
have O
been O
proposed O
in O
the O
two O
latter O
works O
to O
alleviate O
this O
problem O
. O
manually O
adjusted O
the O
sensitivity O
of O
the O
network O
, O
but O
the O
method O
can O
become O
difficult O
to O
calibrate O
for O
multi Task
- Task
class Task
problems Task
. O
first O
balance O
the O
cost O
from O
each O
class O
, O
which O
has O
an O
effect O
similar O
to O
equal Method
sampling Method
, O
and O
further O
adjust O
it O
for O
the O
specific O
task O
by O
estimating O
the O
difficulty O
of O
segmenting O
each O
pixel O
. O
subsection O
: O
Contributions O
We O
present O
a O
fully Method
automatic Method
approach Method
for O
lesion O
segmentation Task
in O
multi Task
- Task
modal Task
brain Task
MRI Task
based O
on O
an O
11 O
- O
layers O
deep O
, O
multi Method
- Method
scale Method
, Method
3D Method
CNN Method
with O
the O
following O
main O
contributions O
: O
We O
propose O
an O
efficient O
hybrid O
training Method
scheme O
, O
utilizing O
dense O
training Method
( O
) O
on O
sampled O
image O
segments O
, O
and O
analyze O
its O
behaviour O
in O
adapting O
to O
class O
imbalance O
of O
the O
segmentation Task
problem O
at O
hand O
. O
We O
analyze O
in O
depth O
the O
development O
of O
deeper O
, O
thus O
more O
discriminative O
, O
yet O
computationally O
efficient O
3D Method
CNNs Method
. O
We O
exploit O
the O
utilization O
of O
small Method
kernels Method
, O
a O
design Method
approach Method
previously O
found O
beneficial O
in O
2D O
networks Method
( O
) O
that O
impacts O
3D Method
CNNs Method
even O
more O
, O
and O
present O
adopted O
solutions O
that O
enable O
training Method
deeper O
networks Method
. O
We O
employ O
parallel Method
convolutional Method
pathways Method
for O
multi Task
- Task
scale Task
processing Task
, O
a O
solution O
to O
efficiently O
incorporate O
both O
local O
and O
contextual O
information O
which O
greatly O
improves O
segmentation Task
results O
. O
We O
demonstrate O
the O
generalization O
capabilities O
of O
our O
system O
, O
which O
without O
significant O
modifications O
outperforms O
the O
state O
- O
of O
- O
the O
- O
art O
on O
a O
variety O
of O
challenging O
segmentation Task
tasks O
, O
with O
top O
ranking O
results O
in O
two O
MICCAI O
challenges O
, O
ISLES O
and O
BRATS Material
. O
Furthermore O
, O
a O
detailed O
analysis O
of O
the O
network O
reveals O
valuable O
insights O
into O
the O
powerful O
black O
box O
of O
deep Method
learning Method
with O
CNNs Method
. O
For O
example O
, O
we O
have O
found O
that O
our O
network O
is O
capable O
of O
learning O
very O
complex O
, O
high O
level O
features O
that O
separate O
gray O
matter O
( O
GM O
) O
, O
cerebrospinal O
fluid O
( O
CSF O
) O
and O
other O
anatomical O
structures O
to O
identify O
the O
image O
regions O
corresponding O
to O
lesions O
. O
Additionally O
, O
we O
have O
extended O
the O
fully Method
- Method
connected Method
Conditional Method
Random Method
Field Method
( O
CRF Method
) O
model O
by O
to O
3D O
which O
we O
use O
for O
final O
post Task
- Task
processing Task
of O
the O
CNN Task
’s Task
soft Task
segmentation Task
maps Task
. O
This O
CRF Method
overcomes O
limitations O
of O
previous O
models O
as O
it O
can O
handle O
arbitrarily O
large O
neighborhoods O
while O
preserving O
fast O
inference Metric
times Metric
. O
To O
the O
best O
of O
our O
knowledge O
, O
this O
is O
the O
first O
use O
of O
a O
fully Method
connected Method
CRF Method
on O
medical O
data O
. O
To O
facilitate O
further O
research O
and O
encourage O
other O
researchers O
to O
build O
upon O
our O
results O
, O
the O
source O
code O
of O
our O
lesion O
segmentation Task
method O
including O
the O
CNN Method
and O
the O
3D O
fully Method
connected Method
CRF Method
is O
made O
publicly O
available O
on O
. O
section O
: O
Method O
Our O
proposed O
lesion O
segmentation Task
method O
consists O
of O
two O
main O
components O
, O
a O
3D Method
CNN Method
that O
produces O
highly O
accurate O
, O
soft O
segmentation Task
maps O
, O
and O
a O
fully O
connected O
3D O
CRF Method
that O
imposes O
regularization O
constraints O
on O
the O
CNN O
output O
and O
produces O
the O
final O
hard O
segmentation Task
labels O
. O
The O
main O
contributions O
of O
our O
work O
are O
within O
the O
CNN Method
component Method
which O
we O
describe O
first O
in O
the O
following O
. O
subsection O
: O
3D Method
CNNs Method
for O
Dense Task
Segmentation Task
– O
Setting O
the O
Baseline O
CNNs Method
produce O
estimates O
for O
the O
voxel O
- O
wise O
segmentation Task
labels O
by O
classifying O
each O
voxel O
in O
an O
image O
independently O
taking O
the O
neighborhood O
, O
i.e. O
local O
and O
contextual O
image O
information O
, O
into O
account O
. O
This O
is O
achieved O
by O
sequential Method
convolutions Method
of O
the O
input O
with O
multiple O
filters O
at O
the O
cascaded Method
layers Method
of Method
the Method
network Method
. O
Each O
layer O
consists O
of O
feature O
maps O
( O
FMs Method
) O
, O
also O
referred O
to O
as O
channels O
. O
Every O
FM Method
is O
a O
group O
of O
neurons O
that O
detects O
a O
particular O
pattern O
, O
i.e. O
a O
feature O
, O
in O
the O
channels O
of O
the O
previous O
layer O
. O
The O
pattern O
is O
defined O
by O
the O
kernel O
weights O
associated O
with O
the O
FM Method
. O
If O
the O
neurons O
of O
the O
- O
th O
FM O
in O
the O
- O
th O
layer O
are O
arranged O
in O
a O
3D O
grid O
, O
their O
activations O
constitute O
the O
image O
. O
This O
is O
the O
result O
of O
convolving O
each O
of O
the O
previous O
layer O
’s O
channels O
with O
a O
3 Method
- Method
dimensional Method
kernel Method
, O
adding O
a O
learned O
bias O
and O
applying O
a O
non Method
- Method
linearity Method
. O
Each O
kernel O
is O
a O
matrix O
of O
learned O
hidden O
weights O
. O
The O
images O
, O
input O
to O
the O
first O
layer O
, O
correspond O
to O
the O
channels O
of O
the O
original O
input O
image O
, O
for O
instance O
a O
multi O
- O
sequence O
3D O
MRI O
scan O
of O
the O
brain O
. O
The O
concatenation Method
of Method
the Method
kernels Method
can O
be O
viewed O
as O
a O
4 Method
- Method
dimensional Method
kernel Method
convolving O
the O
concatenated O
channels O
, O
which O
then O
intuitively O
expresses O
that O
the O
neurons O
of O
higher O
layers O
combine O
the O
patterns O
extracted O
in O
previous O
layers O
, O
which O
results O
in O
the O
detection Task
of O
increasingly O
more O
complex O
patterns O
. O
The O
activations O
of O
the O
neurons O
in O
the O
last O
layer O
correspond O
to O
particular O
segmentation Task
class O
labels O
, O
hence O
this O
layer O
is O
also O
referred O
to O
as O
the O
classification Method
layer Method
. O
The O
neurons O
are O
thus O
grouped O
in O
FMs Method
, O
one O
for O
each O
of O
the O
segmentation Task
classes O
. O
Their O
activations O
are O
fed O
into O
a O
position Method
- Method
wise Method
softmax Method
function Method
that O
produces O
the O
predicted O
posterior O
for O
each O
class O
, O
which O
form O
soft O
segmentation Task
maps O
with O
( O
pseudo O
-) O
probabilities O
. O
is O
the O
activation O
of O
the O
- O
th O
classification Method
FM Method
at O
position O
. O
This O
baseline O
network O
is O
depicted O
in O
Fig O
. O
[ O
reference O
] O
. O
[ O
b O
] O
1.0 O
The O
neighborhood O
of O
voxels O
in O
the O
input O
that O
influence O
the O
activation O
of O
a O
neuron O
is O
its O
receptive O
field O
. O
Its O
size O
, O
, O
increases O
at O
each O
subsequent O
layer O
and O
is O
given O
by O
the O
3 O
- O
dimensional O
vector O
: O
where O
are O
vectors O
expressing O
the O
size O
of O
the O
kernels O
and O
stride O
of O
the O
receptive O
field O
at O
layer O
. O
is O
given O
by O
the O
product O
of O
the O
strides O
of O
kernels O
in O
layers O
preceding O
. O
In O
this O
work O
only O
unary O
strides O
are O
used O
, O
as O
larger O
strides O
downsample O
the O
FMs O
( O
) O
, O
which O
is O
unwanted O
behaviour O
for O
accurate O
segmentation Task
. O
Thus O
in O
our O
system O
. O
The O
receptive O
field O
of O
a O
neuron O
in O
the O
classification Method
layer Method
corresponds O
to O
the O
image O
patch O
that O
influences O
the O
prediction O
for O
its O
central O
voxel O
. O
This O
is O
called O
the O
CNN Method
’s Method
receptive Method
field Method
, O
with O
. O
If O
input O
of O
size O
is O
provided O
, O
the O
dimensions O
of O
the O
FMs O
in O
layer O
are O
given O
by O
: O
In O
the O
common O
patch Task
- Task
wise Task
classification Task
setting Task
, O
an O
input O
patch O
of O
size O
is O
provided O
and O
the O
network O
outputs O
a O
single O
prediction O
for O
its O
central O
voxel O
. O
In O
this O
case O
the O
classification Method
layer Method
consists O
of O
FMs Method
with O
size O
. O
Networks Method
that O
are O
implemented O
as O
fully Method
- Method
convolutionals Method
are O
capable O
of O
dense O
- O
inference Method
, O
which O
is O
performed O
when O
input O
of O
size O
greater O
than O
is O
provided O
( O
) O
. O
In O
this O
case O
, O
the O
dimensions O
of O
FMs O
increase O
according O
to O
Eq O
. O
( O
[ O
reference O
] O
) O
. O
This O
includes O
the O
classification Method
FMs Method
which O
then O
output O
multiple O
predictions O
simultaneously O
, O
one O
for O
each O
stride O
of O
the O
CNN O
’s O
receptive O
field O
on O
the O
input O
( O
Fig O
. O
[ O
reference O
] O
) O
. O
All O
predictions O
are O
equally O
trustworthy O
, O
as O
long O
as O
the O
receptive O
field O
is O
fully O
contained O
within O
the O
input O
and O
captures O
only O
original O
content O
, O
i.e. O
no O
padding O
is O
used O
. O
This O
strategy O
significantly O
reduces O
the O
computational Metric
costs O
and O
memory O
loads O
since O
the O
otherwise O
repeated O
computations O
of O
convolutions O
on O
the O
same O
voxels O
in O
overlapping O
patches O
are O
avoided O
. O
Optimal O
performance Metric
is O
achieved O
if O
the O
whole O
image O
is O
scanned O
in O
one O
forward O
pass O
. O
If O
GPU O
memory O
constraints O
do O
not O
allow O
it O
, O
such O
as O
in O
the O
case O
of O
large O
3D O
networks Method
where O
a O
large O
number O
of O
FMs O
need O
to O
be O
cached O
, O
the O
volume O
is O
tiled O
in O
multiple O
image O
- O
segments O
, O
which O
are O
larger O
than O
individual O
patches O
, O
but O
small O
enough O
to O
fit O
into O
memory O
. O
Before O
analyzing O
how O
we O
exploit O
the O
above O
dense O
- O
inference Method
technique O
for O
training Method
, O
which O
is O
the O
first O
main O
contribution O
of O
our O
work O
, O
we O
present O
the O
commonly O
used O
setting O
in O
which O
CNNs Method
are O
trained O
patch O
- O
by O
- O
patch O
. O
Random O
patches O
of O
size O
are O
extracted O
from O
the O
training Method
images O
. O
A O
batch O
is O
formed O
out O
of O
of O
these O
samples O
, O
which O
is O
then O
processed O
by O
the O
network O
for O
one O
training Method
iteration O
of O
Stochastic Method
Gradient Method
Descent Method
( O
SGD Method
) Method
. O
This O
step O
aims O
to O
alter O
the O
network O
’s O
parameters O
, O
such O
as O
weights O
and O
biases O
, O
in O
order O
to O
maximize O
the O
log O
likelihood O
of O
the O
data O
or O
, O
equally O
, O
minimize O
the O
Cross O
Entropy O
via O
the O
cost O
function O
: O
where O
the O
pair O
is O
the O
- O
th O
patch O
in O
the O
batch O
and O
the O
true O
label O
of O
its O
central O
voxel O
, O
while O
the O
scalar O
value O
is O
the O
predicted O
posterior O
for O
class O
. O
Regularization O
terms O
were O
omitted O
for O
simplicity O
. O
Multiple O
sequential Method
optimization Method
steps O
over O
different O
batches O
gradually O
lead O
to O
convergence O
. O
subsection O
: O
Dense O
Training Method
on O
Image Task
Segments Task
and O
Class Task
Balance Task
Larger O
training Method
batch O
sizes O
are O
preferred O
as O
they O
approximate O
the O
overall O
data O
more O
accurately O
and O
lead O
to O
better O
estimation O
of O
the O
true O
gradient O
by O
SGD Method
. O
However O
, O
the O
memory Metric
requirement Metric
and O
computation Metric
time O
increase O
with O
the O
batch Metric
size Metric
. O
This O
limitation O
is O
especially O
relevant O
for O
3D Method
CNNs Method
, O
where O
only O
a O
few O
dozens O
of O
patches O
can O
be O
processed O
within O
reasonable O
time O
on O
modern O
GPUs Method
. O
To O
overcome O
this O
problem O
, O
we O
devise O
a O
training Method
strategy O
that O
exploits O
the O
dense O
inference Method
technique O
on O
image O
segments O
. O
Following O
from O
Eq O
. O
( O
[ O
reference O
] O
) O
, O
if O
an O
image O
segment O
of O
size O
greater O
than O
is O
given O
as O
input O
to O
our O
network O
, O
the O
output O
is O
a O
posterior O
probability O
for O
multiple O
voxels O
. O
If O
the O
training Method
batches O
are O
formed O
of O
segments O
extracted O
from O
the O
training Method
images O
, O
the O
cost Method
function Method
( O
[ O
reference O
] O
) O
in O
the O
case O
of O
dense O
- O
training Method
becomes O
: O
where O
and O
are O
the O
- O
th O
segment O
of O
the O
batch O
and O
the O
true O
labels O
of O
its O
predicted O
voxels O
respectively O
. O
is O
the O
true O
label O
of O
the O
- O
th O
voxel O
, O
the O
corresponding O
position O
in O
the O
classification Method
FMs Method
and O
the O
output O
of O
the O
softmax Method
function Method
. O
The O
effective O
batch Metric
size Metric
is O
increased O
by O
a O
factor O
of O
without O
a O
corresponding O
increase O
in O
computational Metric
and O
memory Metric
requirements Metric
, O
as O
earlier O
discussed O
in O
Sec O
. O
[ O
reference O
] O
. O
Notice O
that O
this O
is O
a O
hybrid Method
scheme Method
between O
the O
commonly O
used O
training Method
on O
individual O
patches O
and O
the O
dense O
training Method
scheme O
on O
a O
whole O
image O
( O
) O
, O
with O
the O
latter O
being O
problematic O
to O
apply O
for O
training Method
large Method
3D Method
CNNs Method
on O
volumes O
of O
high O
resolution O
due O
to O
memory O
limitations O
. O
[ O
b O
] O
0.5 O
An O
appealing O
consequence O
of O
this O
scheme O
is O
that O
the O
sampling Method
of Method
input Method
segments Method
provides O
a O
flexible O
and O
automatic O
way O
to O
balance O
the O
distribution O
of O
training Method
samples O
from O
different O
segmentation Task
classes O
which O
is O
an O
important O
issue O
that O
directly O
impacts O
the O
segmentation Task
accuracy O
. O
Specifically O
, O
we O
build O
the O
training Method
batches O
by O
extracting O
segments O
from O
the O
training Method
images O
with O
50 O
% O
probability O
being O
centred O
on O
a O
foreground O
or O
background O
voxel O
, O
alleviating O
class O
- O
imbalance O
. O
Note O
that O
the O
predicted O
voxels O
in O
a O
segment O
do O
not O
have O
to O
be O
of O
the O
same O
class O
, O
something O
that O
occurs O
when O
a O
segment O
is O
sampled O
from O
a O
region O
near O
class O
boundaries O
( O
Fig O
. O
[ O
reference O
] O
) O
. O
Hence O
, O
the O
sampling Metric
rate Metric
of O
the O
proposed O
hybrid Method
method Method
adjusts O
to O
the O
true O
distribution O
of O
the O
segmentation Task
task O
’s O
classes O
. O
Specifically O
, O
the O
smaller O
a O
labelled O
object O
, O
the O
more O
background O
voxels O
will O
be O
captured O
within O
segments O
centred O
on O
the O
foreground O
voxel O
. O
Implicitly O
, O
this O
yields O
a O
balance O
between O
sensitivity Metric
and O
specificity Metric
in O
the O
case O
of O
binary O
segmentation Task
tasks O
. O
In O
multi Task
- Task
class Task
problems Task
, O
the O
rate O
at O
which O
different O
classes O
are O
captured O
within O
a O
segment O
centred O
on O
foreground O
reflects O
the O
real O
relative O
distribution O
of O
the O
foreground O
classes O
, O
while O
adjusting O
their O
frequency O
relatively O
to O
the O
background O
. O
subsection O
: O
Building O
Deeper Method
Networks Method
Deeper O
networks Method
have O
greater O
discriminative O
power O
due O
to O
the O
additional O
non O
- O
linearities O
and O
better O
quality O
of O
local O
optima O
( O
) O
. O
However O
, O
convolutions Method
with Method
3D Method
kernels Method
are O
computationally O
expensive O
in O
comparison O
to O
the O
2D Method
variants Method
, O
which O
hampers O
the O
addition O
of O
more O
layers O
. O
Additionally O
, O
3D Method
architectures Method
have O
a O
larger O
number O
of O
trainable O
parameters O
, O
with O
each O
layer O
adding O
weights O
to O
the O
model O
. O
is O
the O
number O
of O
FMs O
in O
layer O
and O
the O
size O
of O
its O
kernel O
in O
the O
respective O
spatial O
dimension O
. O
Overall O
this O
makes O
the O
network O
increasingly O
prone O
to O
over O
- O
fitting O
. O
In O
order O
to O
build O
a O
deeper O
3D Method
architecture Method
, O
we O
adopt O
the O
sole O
use O
of O
small Method
kernels Method
that O
are O
faster O
to O
convolve O
with O
and O
contain O
less O
weights O
. O
This O
design O
approach O
was O
previously O
found O
beneficial O
for O
classification Task
of Task
natural Task
images Task
( O
) O
but O
its O
effect O
is O
even O
more O
drastic O
on O
3D O
networks Method
. O
When O
compared O
to O
common O
kernel O
choices O
of O
( O
) O
and O
in O
our O
baseline Method
CNN Method
, O
the O
smaller O
kernels O
reduce O
the O
element O
- O
wise O
multiplications O
by O
a O
factor O
of O
approximately O
while O
reducing O
the O
number O
of O
trainable O
parameters O
by O
the O
same O
factor O
. O
Thus O
deeper O
network Method
variants Method
that O
are O
implicitly O
regularised O
and O
more O
efficient O
can O
be O
designed O
by O
simply O
replacing O
each O
layer O
of O
common Method
architectures Method
with O
more O
layers O
that O
use O
smaller O
kernels O
( O
Fig O
. O
[ O
reference O
] O
) O
. O
[ O
b O
] O
0.5 O
However O
, O
deeper O
networks Method
are O
more O
difficult O
to O
train O
. O
It O
has O
been O
shown O
that O
the O
forward O
( O
neuron O
activations O
) O
and O
backwards O
( O
gradients O
) O
propagated O
signal O
may O
explode O
or O
vanish O
if O
care O
is O
not O
given O
to O
retain O
its O
variance O
( O
) O
. O
This O
occurs O
because O
at O
every O
successive O
layer O
, O
the O
variance O
of O
the O
signal O
is O
multiplied O
by O
, O
where O
is O
the O
number O
of O
weights O
through O
which O
a O
neuron O
of O
layer O
is O
connected O
to O
its O
input O
and O
is O
the O
variance O
of O
the O
layer O
’s O
weights O
. O
To O
better O
preserve O
the O
signal O
in O
the O
initial O
training Method
stage O
we O
adopt O
a O
scheme O
recently O
derived O
for O
ReLu O
- O
based O
networks Method
by O
and O
initialize O
the O
kernel O
weights O
of O
our O
system O
by O
sampling O
from O
the O
normal Method
distribution Method
. O
A O
phenomenon O
of O
similar O
nature O
that O
hinders O
the O
network O
’s O
performance Metric
is O
the O
“ O
internal O
covariate O
shift O
” O
( O
) O
. O
It O
occurs O
throughout O
training Method
, O
because O
the O
weight O
updates O
to O
deeper O
layers O
result O
in O
a O
continuously O
changing O
distribution O
of O
signal O
at O
higher O
layers O
, O
which O
hinders O
the O
convergence O
of O
their O
weights O
. O
Specifically O
, O
at O
training Method
iteration O
the O
weight Method
updates Method
may O
cause O
deviation O
to O
the O
variance O
of O
the O
weights O
. O
At O
the O
next O
iteration O
the O
signal O
will O
be O
amplified O
by O
. O
Thus O
before O
influencing O
the O
signal O
, O
any O
deviation O
is O
amplified O
by O
which O
is O
exponential O
in O
the O
number O
of O
dimensions O
. O
For O
this O
reason O
the O
problem O
affects O
training Method
of O
3D Task
CNNs Task
more O
severely O
than O
conventional O
2D Method
systems Method
. O
For O
countering O
it O
, O
we O
adopt O
the O
recently O
proposed O
Batch Method
Normalisation Method
( Method
BN Method
) Method
technique Method
to O
all O
hidden O
layers O
( O
) O
, O
which O
allows O
normalization O
of O
the O
FM O
activations O
at O
every O
optimization O
step O
in O
order O
to O
better O
preserve O
the O
signal O
. O
subsection O
: O
Multi Task
- Task
Scale Task
Processing Task
via O
Parallel Method
Convolutional Method
Pathways Method
The O
segmentation Task
of O
each O
voxel O
is O
performed O
by O
taking O
into O
account O
the O
contextual O
information O
that O
is O
captured O
by O
the O
receptive O
field O
of O
the O
CNN Method
when O
it O
is O
centred O
on O
the O
voxel O
. O
The O
spatial O
context O
is O
providing O
important O
information O
for O
being O
able O
to O
discriminate O
voxels O
that O
otherwise O
appear O
very O
similar O
when O
considering O
only O
local O
appearance O
. O
From O
Eq O
. O
( O
[ O
reference O
] O
) O
follows O
that O
an O
increase O
of O
the O
CNN O
’s O
receptive O
field O
requires O
bigger O
kernels O
or O
more O
convolutional O
layers O
, O
which O
increases O
computation Metric
and O
memory Metric
requirements Metric
. O
An O
alternative O
would O
be O
the O
use O
of O
pooling Method
( Method
) Method
, O
which O
however O
leads O
to O
loss O
of O
the O
exact O
position O
of O
the O
segmented O
voxel O
and O
thus O
can O
negatively O
impact O
accuracy Metric
. O
In O
order O
to O
incorporate O
both O
local O
and O
larger O
contextual O
information O
into O
our O
3D Method
CNN Method
, O
we O
add O
a O
second O
pathway O
that O
operates O
on O
down O
- O
sampled O
images O
. O
Thus O
, O
our O
dual Method
pathway Method
3D Method
CNN Method
simultaneously O
processes O
the O
input O
image O
at O
multiple O
scales O
( O
Fig O
. O
[ O
reference O
] O
) O
. O
Higher O
level O
features O
such O
as O
the O
location O
within O
the O
brain O
are O
learned O
in O
the O
second O
pathway O
, O
while O
the O
detailed O
local O
appearance O
of O
structures O
is O
captured O
in O
the O
first O
. O
As O
the O
two O
pathways O
are O
decoupled O
in O
this O
architecture O
, O
arbitrarily O
large O
context O
can O
be O
processed O
by O
the O
second O
pathway O
by O
simply O
adjusting O
the O
down O
- O
sampling O
factor O
. O
The O
size O
of O
the O
pathways O
can O
be O
independently O
adjusted O
according O
to O
the O
computational Metric
capacity O
and O
the O
task O
at O
hand O
, O
which O
may O
require O
relatively O
more O
or O
less O
filters O
focused O
on O
the O
down O
- O
sampled O
context O
. O
[ O
b O
] O
1.0 O
To O
preserve O
the O
capability O
of O
dense O
inference Method
, O
spatial O
correspondence O
of O
the O
activations O
in O
the O
FMs O
of O
the O
last O
convolutional O
layers O
of O
the O
two O
pathways O
, O
and O
, O
should O
be O
ensured O
. O
In O
networks Method
where O
only O
unary O
kernel O
strides O
are O
used O
, O
such O
as O
the O
proposed O
architecture O
, O
this O
requires O
that O
for O
every O
shifts O
of O
the O
receptive O
field O
over O
the O
normal O
resolution O
input O
, O
only O
one O
shift O
is O
performed O
by O
over O
the O
down O
- O
sampled O
input O
. O
Hence O
it O
is O
required O
that O
the O
dimensions O
of O
the O
FMs O
in O
are O
. O
From O
Eq O
. O
( O
[ O
reference O
] O
) O
, O
the O
size O
of O
the O
input O
to O
the O
second O
pathway O
is O
and O
similar O
is O
the O
relation O
between O
and O
. O
These O
establish O
the O
relation O
between O
the O
required O
dimensions O
of O
the O
input O
segments O
from O
the O
two O
resolutions O
, O
which O
can O
then O
be O
extracted O
centered O
on O
the O
same O
image O
location O
. O
The O
FMs O
of O
are O
up O
- O
sampled O
to O
match O
the O
dimensions O
of O
’s O
FMs O
and O
are O
then O
concatenated O
together O
. O
We O
add O
two O
more O
hidden O
layers O
for O
combining O
the O
multi O
- O
scale O
features O
before O
the O
final O
classification Task
, O
as O
shown O
in O
Fig O
. O
[ O
reference O
] O
. O
Integration O
of O
the O
multi Task
- Task
scale Task
parallel Task
pathways Task
in O
architectures O
with O
non O
- O
unary O
strides O
is O
discussed O
in O
[ O
reference O
] O
. O
Combining O
multi O
- O
scale O
features O
has O
been O
found O
beneficial O
in O
other O
recent O
works O
( O
) O
, O
in O
which O
whole O
2D O
images O
are O
processed O
in O
the O
network O
by O
applying O
a O
few O
number O
of O
convolutions Method
and O
then O
down O
- O
sampling O
the O
FMs Method
for O
further O
processing O
at O
various O
scales O
. O
Our O
decoupled O
pathways O
allow O
arbitrarily O
large O
context O
to O
be O
provided O
while O
avoiding O
the O
need O
to O
load O
large O
parts O
of O
the O
3D O
volume O
into O
memory O
. O
Additionally O
, O
our O
architecture O
extracts O
features O
completely O
independently O
from O
the O
multiple O
resolutions O
. O
This O
way O
, O
the O
features O
learned O
by O
the O
first O
pathway O
retain O
finest O
details O
, O
as O
they O
are O
not O
involved O
in O
processing Task
low Task
resolution Task
context Task
. O
subsection O
: O
3D O
Fully O
Connected O
CRF Method
for O
Structured Task
Prediction Task
Because O
neighboring O
voxels O
share O
substantial O
spatial O
context O
, O
the O
soft O
segmentation Task
maps O
produced O
by O
the O
CNN Method
tend O
to O
be O
smooth O
, O
even O
though O
neighborhood O
dependencies O
are O
not O
modeled O
directly O
. O
However O
, O
local O
minima O
in O
training Method
and O
noise O
in O
the O
input O
images O
can O
still O
result O
in O
some O
spurious O
outputs O
, O
with O
small O
isolated O
regions O
or O
holes O
in O
the O
predictions O
. O
We O
employ O
a O
fully Method
connected Method
CRF Method
( O
) O
as O
a O
post Method
- Method
processing Method
step Method
to O
achieve O
more O
structured Task
predictions Task
. O
As O
we O
describe O
below O
, O
this O
CRF Method
is O
capable O
of O
modeling O
arbitrarily Task
large Task
voxel Task
- Task
neighborhoods Task
but O
is O
also O
computationally O
efficient O
, O
making O
it O
ideal O
for O
processing O
3D Task
multi Task
- Task
modal Task
medical Task
scans Task
. O
For O
an O
input O
image O
and O
the O
label O
configuration O
( O
segmentation Task
) O
, O
the O
Gibbs O
energy O
in O
a O
CRF Method
model Method
is O
given O
by O
The O
unary O
potential O
is O
the O
negative O
log O
- O
likelihood O
, O
where O
in O
our O
case O
is O
the O
CNN Method
’s O
output O
for O
voxel O
. O
In O
a O
fully Method
connected Method
CRF Method
, O
the O
pairwise O
potential O
is O
of O
form O
between O
any O
pair O
of O
voxels O
, O
regardless O
of O
their O
spatial O
distance O
. O
The O
Pott Method
’s Method
Model Method
is O
commonly O
used O
as O
the O
label O
compatibility O
function O
, O
giving O
. O
The O
corresponding O
energy O
penalty O
is O
given O
by O
the O
function O
, O
which O
is O
defined O
over O
an O
arbitrary O
feature O
space O
, O
with O
being O
the O
feature O
vectors O
of O
the O
pair O
of O
voxels O
. O
observed O
that O
if O
the O
penalty O
function O
is O
defined O
as O
a O
linear Method
combination Method
of Method
Gaussian Method
kernels Method
, O
, O
the O
model O
lends O
itself O
for O
very O
efficient O
inference Method
with O
mean Method
field Method
approximation Method
, O
after O
expressing O
message Method
passing Method
as O
convolutions Method
with O
the O
Gaussian Method
kernels Method
in O
the O
space O
of O
the O
feature O
vectors O
. O
We O
extended O
the O
work O
of O
the O
original O
authors O
and O
implemented O
a O
3D Method
version Method
of O
the O
CRF Method
for O
processing Task
multi Task
- Task
modal Task
scans Task
. O
We O
make O
use O
of O
two O
Gaussian Method
kernels Method
, O
which O
operate O
in O
the O
feature O
space O
defined O
by O
the O
voxel O
coordinates O
and O
the O
intensities O
of O
the O
- O
th O
modality O
- O
channel O
for O
voxel O
. O
The O
smoothness O
kernel O
, O
, O
is O
defined O
by O
a O
diagonal O
covariance O
matrix O
with O
elements O
the O
configurable O
parameters O
, O
one O
for O
each O
axis O
. O
These O
parameters O
express O
the O
size O
and O
shape O
of O
neighborhoods O
that O
homogeneous O
labels O
are O
encouraged O
. O
The O
appearance O
kernel O
is O
defined O
similarly O
. O
The O
additional O
parameters O
can O
be O
interpreted O
as O
how O
strongly O
to O
enforce O
homogeneous O
appearance O
in O
the O
input O
channels O
, O
when O
voxels O
in O
an O
area O
spatially O
defined O
by O
are O
identically O
labelled O
. O
Finally O
, O
the O
configurable O
weights O
define O
the O
relative O
strength O
of O
the O
two O
factors O
. O
section O
: O
Analysis Task
of Task
Network Task
Architecture Task
In O
this O
section O
we O
present O
a O
series O
of O
experiments O
in O
order O
to O
analyze O
the O
impact O
of O
each O
of O
the O
main O
contributions O
and O
to O
justify O
the O
choices O
made O
in O
the O
design O
of O
the O
proposed O
11 Method
- Method
layers Method
, O
multi Method
- Method
scale Method
3D Method
CNN Method
architecture Method
, O
referred O
to O
as O
the O
DeepMedic Method
. O
Starting O
from O
the O
CNN Method
baseline Method
as O
discussed O
in O
Sec O
. O
[ O
reference O
] O
, O
we O
first O
explore O
the O
benefit O
of O
our O
proposed O
dense O
training Method
scheme O
( O
cf O
. O
Sec O
. O
[ O
reference O
] O
) O
, O
then O
investigate O
the O
use O
of O
deeper Method
models Method
( O
cf O
. O
Sec O
. O
[ O
reference O
] O
) O
and O
then O
evaluate O
the O
influence O
of O
the O
multi O
- O
scale O
dual O
pathway O
( O
cf O
. O
Sec O
. O
[ O
reference O
] O
) O
. O
Finally O
, O
we O
compare O
our O
method O
with O
corresponding O
2D Method
variants Method
to O
assess O
the O
benefit O
of O
processing Task
3D Task
context Task
. O
subsection O
: O
Experimental O
Setting O
The O
following O
experiments O
are O
conducted O
using O
the O
TBI O
dataset O
with O
61 O
multi O
- O
channel O
MRIs O
which O
is O
described O
in O
more O
detail O
later O
in O
Sec O
. O
[ O
reference O
] O
. O
Here O
, O
the O
images O
are O
randomly O
split O
into O
a O
validation O
and O
training Method
set O
, O
with O
15 O
and O
46 O
images O
each O
. O
The O
same O
sets O
are O
used O
in O
all O
analyses O
. O
To O
monitor O
the O
progress O
of O
segmentation Task
accuracy O
during O
training Method
, O
we O
extract O
10k O
random O
patches O
at O
regular O
intervals O
, O
with O
equal O
numbers O
extracted O
from O
each O
of O
the O
validation O
images O
. O
The O
patches O
are O
uniformly O
sampled O
from O
the O
brain O
region O
in O
order O
to O
approximate O
the O
true O
distribution O
of O
lesions O
and O
healthy O
tissue O
. O
Full O
segmentation Task
of O
the O
validation O
datasets O
is O
performed O
every O
five O
epochs O
and O
the O
mean Metric
Dice Metric
similarity Metric
coefficient Metric
( O
DSC Metric
) O
is O
determined O
. O
Details O
on O
the O
configuration O
of O
the O
networks Method
are O
provided O
in O
[ O
reference O
] O
. O
subsection O
: O
Effect O
of O
Dense O
Training Method
on O
Image Task
Segments Task
[ O
b O
] O
1.0 O
We O
compare O
our O
proposed O
dense O
training Method
method O
with O
two O
other O
commonly O
used O
training Method
schemes O
on O
the O
5 Method
- Method
layers Method
baseline Method
CNN Method
( O
see O
Fig O
. O
[ O
reference O
] O
) O
. O
The O
first O
common O
scheme O
trains O
on O
patches O
extracted O
uniformly O
from O
the O
brain O
region O
, O
and O
the O
second O
scheme O
samples O
patches O
equally O
from O
the O
lesion O
and O
background O
class O
. O
We O
refer O
to O
these O
schemes O
as O
P O
and O
P O
. O
The O
results O
shown O
in O
Fig O
. O
[ O
reference O
] O
show O
a O
correlation O
of O
sensitivity Metric
and O
specificity Metric
with O
the O
percentage O
of O
training Method
samples O
that O
come O
from O
the O
lesion O
class O
. O
P Method
performs O
poorly O
because O
of O
over O
- O
segmentation Task
( O
high O
sensitivity Metric
, O
low O
specificity Metric
) O
. O
P Method
has O
better O
classification Task
on O
the O
background O
class O
( O
high O
specificity Metric
) O
, O
which O
leads O
to O
high O
mean Metric
voxel Metric
- Metric
wise Metric
accuracy Metric
since O
the O
majority O
corresponds O
to O
background O
, O
but O
not O
particularly O
high O
DSC Metric
scores O
due O
to O
under O
- O
segmentation Task
( O
low O
sensitivity Metric
) O
. O
To O
evaluate O
our O
dense O
training Method
scheme O
, O
we O
train O
multiple O
models O
with O
varying O
sized O
image O
segments O
, O
equally O
sampled O
from O
lesions O
and O
background O
. O
The O
tested O
sizes O
of O
the O
segments O
go O
from O
upwards O
to O
. O
The O
models O
are O
referred O
to O
as O
“ O
S O
- O
” O
, O
where O
is O
the O
side O
length O
of O
the O
cubic O
segments O
. O
For O
fair O
comparison O
, O
the O
batch O
sizes O
in O
all O
the O
experiments O
are O
adjusted O
to O
have O
a O
similar O
memory O
footprint O
and O
lead O
to O
similar O
training Method
times O
as O
compared O
to O
training Method
on O
P O
and O
P O
. O
We O
observe O
a O
great O
performance Metric
increase O
for O
model O
S O
- O
over O
P O
. O
We O
account O
this O
partly O
to O
the O
efficient O
increase O
of O
the O
effective Metric
batch Metric
size Metric
( O
in O
Eq O
. O
( O
[ O
reference O
] O
) O
) O
, O
but O
also O
to O
the O
altered O
distribution O
of O
training Method
samples O
. O
As O
we O
increase O
the O
size O
of O
the O
training Method
segments O
further O
, O
we O
quickly O
reach O
a O
balance O
between O
the O
sensitivity Metric
of O
P O
and O
the O
specificity O
of O
P O
, O
which O
results O
in O
improved O
segmentation Task
as O
expressed O
by O
the O
DSC Metric
. O
The O
segment O
size O
is O
a O
hyper O
- O
parameter O
in O
our O
model O
. O
We O
observe O
that O
the O
increase O
in O
performance Metric
with O
increasing O
segment O
size O
quickly O
levels O
off O
, O
and O
similar O
performance Metric
is O
obtained O
for O
a O
wide O
range O
of O
segment O
sizes O
, O
which O
allows O
for O
easy O
configuration O
. O
For O
the O
remaining O
experiments O
, O
all O
models O
were O
trained O
on O
segments O
of O
size O
. O
subsection O
: O
Effect O
of O
Deeper O
Networks O
[ O
b O
] O
0.5 O
The O
5 Method
- Method
layers Method
baseline Method
CNN Method
( O
Fig O
. O
[ O
reference O
] O
) O
, O
here O
referred O
to O
as O
the O
“ O
Shallow Method
” Method
model Method
, O
is O
extended O
to O
9 O
- O
layers O
by O
replacing O
each O
convolutional Method
layer Method
that O
uses O
kernels O
with O
two O
layers O
that O
use O
kernels O
( O
Fig O
. O
[ O
reference O
] O
) O
. O
This O
model O
is O
referred O
to O
as O
“ O
Deep O
” O
. O
Training Method
the O
latter O
, O
however O
, O
utterly O
fails O
with O
the O
model O
making O
only O
predictions O
corresponding O
to O
the O
background O
class O
. O
This O
problem O
is O
related O
to O
the O
challenge O
of O
preserving O
the O
signal O
as O
it O
propagates O
through O
deep O
networks Method
and O
its O
variance O
gets O
multiplied O
with O
the O
variance O
of O
the O
weights O
, O
as O
previously O
discussed O
in O
Sec O
. O
[ O
reference O
] O
. O
One O
of O
the O
causes O
is O
that O
the O
weights O
of O
both O
models O
have O
been O
initialized O
with O
the O
commonly O
used O
scheme O
of O
sampling O
from O
the O
normal Method
distribution Method
( O
cf O
. O
) O
. O
In O
comparison O
, O
the O
initialization Method
scheme Method
by O
, O
derived O
for O
preserving O
the O
signal O
in O
the O
initial O
stage O
of O
training Method
, O
results O
in O
higher O
values O
and O
overcomes O
this O
problem O
. O
Further O
preservation O
of O
the O
signal O
is O
obtained O
by O
employing O
Batch Method
Normalization Method
. O
This O
results O
in O
an O
enhanced O
9 Method
- Method
layers Method
model Method
which O
we O
refer O
to O
as O
“ O
Deep O
+ O
” O
, O
and O
using O
the O
same O
enhancements O
on O
the O
Shallow Method
model Method
yields O
“ O
Shallow O
+ O
” O
. O
The O
significant O
performance Metric
improvement O
of O
Deep Method
+ Method
over O
Shallow Method
+ Method
, O
as O
shown O
in O
Fig O
. O
[ O
reference O
] O
, O
is O
the O
result O
of O
the O
greater O
representational O
power O
of O
the O
deeper Method
network Method
. O
The O
two O
models O
need O
similar O
computational Metric
times O
, O
which O
highlights O
the O
benefits O
of O
utilizing O
small Method
kernels Method
in O
the O
design O
of O
3D Task
CNNs Task
. O
Although O
the O
deeper Method
model Method
requires O
more O
sequential O
( O
layer Method
by Method
layer Method
) O
computations O
on O
the O
GPU O
, O
those O
are O
faster O
due O
to O
the O
smaller O
kernel O
size O
. O
subsection O
: O
Effect O
of O
the O
Multi Method
- Method
Scale Method
Dual Method
Pathway Method
[ O
b O
] O
0.5 O
The O
final O
version O
of O
the O
proposed O
network Method
architecture Method
, O
referred O
to O
as O
“ O
DeepMedic Method
” Method
, O
is O
built O
by O
extending O
the O
Deep Method
+ Method
model Method
with O
a O
second O
convolutional Method
pathway Method
that O
is O
identical O
to O
the O
first O
one O
. O
Two O
hidden O
layers O
are O
added O
for O
combining O
the O
multi O
- O
scale O
features O
before O
the O
classification Method
layer Method
, O
resulting O
in O
a O
deep Method
network Method
of Method
11 Method
- Method
layers Method
( O
cf O
. O
Fig O
. O
[ O
reference O
] O
) O
. O
The O
input O
segments O
to O
the O
second O
pathway O
are O
extracted O
from O
the O
images O
down O
- O
sampled O
by O
a O
factor O
of O
three O
. O
Thus O
, O
the O
network O
is O
capable O
of O
capturing O
context O
in O
a O
area O
of O
the O
original O
image O
through O
the O
receptive O
field O
of O
the O
lower Method
- Method
resolution Method
pathway Method
, O
while O
only O
doubling O
the O
computational Metric
and O
memory Metric
requirements Metric
over O
the O
single Method
pathway Method
CNN Method
. O
In O
comparison O
, O
the O
most O
recent O
2D Method
CNN Method
systems Method
proposed O
for O
lesion O
segmentation Task
( O
) O
have O
a O
receptive O
field O
limited O
to O
voxels O
. O
[ O
b O
] O
0.85 O
Figure O
[ O
reference O
] O
shows O
the O
improvement O
DeepMedic Method
achieves O
over O
the O
single Method
pathway Method
model Method
Deep O
+ O
. O
In O
Fig O
. O
[ O
reference O
] O
we O
show O
two O
representative O
visual O
examples O
of O
this O
improvement O
when O
using O
the O
multi Method
- Method
scale Method
CNN Method
. O
Finally O
, O
we O
confirm O
that O
the O
performance Metric
increase O
can O
be O
accounted O
to O
the O
additional O
context O
and O
not O
the O
additional O
capacity O
of O
DeepMedic Method
. O
To O
this O
end O
, O
we O
build O
a O
big O
single Method
- Method
scale Method
model Method
by O
doubling O
the O
FMs Method
at O
each O
of O
the O
9 Method
- Method
layers Method
of Method
Deep Method
+ Method
and O
adding O
two O
hidden O
layers O
. O
This O
11 Method
- Method
layers Method
deep Method
and Method
wide Method
model Method
, O
referred O
to O
as O
“ O
BigDeep Method
+ Method
” Method
, O
has O
the O
same O
number O
of O
parameters O
as O
DeepMedic Method
. O
The O
performance Metric
of O
the O
model O
is O
not O
improved O
, O
while O
showing O
signs O
of O
over O
- O
fitting O
. O
subsection O
: O
Processing Task
3D Task
in O
comparison O
to O
2D O
Context O
Acquired O
brain O
MRI O
scans O
are O
often O
anisotropic O
. O
Such O
is O
the O
case O
for O
most O
sequences O
in O
our O
TBI O
dataset O
, O
which O
have O
been O
acquired O
with O
lower O
axial O
resolution O
, O
except O
for O
the O
isotropic Method
MPRAGE Method
. O
We O
perform O
a O
series O
of O
experiments O
to O
investigate O
the O
behaviour O
of O
2D O
networks Method
and O
assess O
the O
benefit O
of O
processing Task
3D Task
context Task
in O
this O
setting O
. O
DeepMedic Method
can O
be O
converted O
to O
2D O
by O
setting O
the O
third O
dimension O
of O
each O
kernel O
to O
one O
. O
This O
way O
only O
information O
from O
the O
surrounding O
context O
on O
the O
axial O
plane O
influences O
the O
classification Task
of O
each O
voxel O
. O
If O
2D O
segments O
are O
given O
as O
input O
, O
the O
dimensionality O
of O
the O
feature O
maps O
decreases O
and O
so O
does O
the O
memory O
required O
. O
This O
allows O
developing O
2D Method
variants Method
with O
increased O
width O
, O
depth O
and O
size O
of O
training Method
batch O
with O
similar O
requirements O
as O
the O
3D Method
version Method
, O
which O
are O
valid O
candidates O
for O
model Task
selection Task
in O
practical O
scenarios O
. O
We O
assess O
various O
configurations O
and O
present O
some O
representatives O
in O
Table O
[ O
reference O
] O
along O
with O
their O
performance Metric
. O
Best O
segmentation Task
among O
investigated O
2D Method
variants Method
is O
achieved O
by O
a O
19 O
- O
layers O
, O
multi Method
- Method
scale Method
network Method
, O
reaching O
61.5 O
% O
average Metric
DSC Metric
on O
the O
validation Metric
fold Metric
. O
The O
decline O
from O
the O
66.6 O
% O
DSC Metric
achieved O
by O
the O
3D Method
version Method
of O
DeepMedic Method
indicates O
the O
importance O
of O
processing O
3D O
context O
even O
in O
settings O
where O
most O
acquired O
sequences O
have O
low O
resolution O
along O
a O
certain O
axis O
. O
section O
: O
Evaluation O
on O
Clinical O
Data O
The O
proposed O
system O
consisting O
of O
the O
DeepMedic Method
CNN Method
architecture Method
, O
optionally O
coupled O
with O
a O
fully Method
connected Method
CRF Method
, O
is O
evaluated O
on O
three O
lesion O
segmentation Task
tasks O
including O
challenging O
clinical O
data O
from O
patients O
with O
traumatic O
brain O
injuries O
, O
brain O
tumors O
, O
and O
ischemic O
stroke O
. O
Quantitative O
evaluation O
and O
comparisons O
with O
state O
- O
of O
- O
the O
- O
art O
are O
reported O
for O
each O
of O
the O
tasks O
. O
subsection O
: O
Traumatic O
Brain O
Injuries O
subsubsection O
: O
Material O
and O
Pre O
- O
Processing O
Sixty O
- O
six O
patients O
with O
moderate O
- O
to O
- O
severe O
TBI O
who O
required O
admission O
to O
the O
Neurosciences O
Critical O
Care O
Unit O
at O
Addenbrooke O
’s O
Hospital O
, O
Cambridge O
, O
UK O
, O
underwent O
imaging O
using O
a O
3 Method
- Method
Tesla Method
Siemens Method
Magnetom Method
TIM Method
Trio Method
within O
the O
first O
week O
of O
injury O
. O
Ethical O
approval O
was O
obtained O
from O
the O
Local O
Research O
Ethics O
Committee O
( O
LREC O
97 O
/ O
290 O
) O
and O
written O
assent O
via O
consultee O
agreement O
was O
obtained O
for O
all O
patients O
. O
The O
structural Method
MRI Method
sequences Method
that O
are O
used O
in O
this O
work O
are O
isotropic O
MPRAGE O
( O
1 O
1 O
1 O
) O
, O
axial O
FLAIR O
, O
T2 O
and O
Proton O
Density O
( O
PD O
) O
( O
0.7 O
0.7 O
5 O
) O
, O
and O
Gradient Method
- Method
Echo Method
( O
GE Method
) O
( O
0.86 O
0.86 O
5 O
) O
. O
All O
visible O
lesions O
were O
manually O
annotated O
on O
the O
FLAIR O
and O
GE O
sequences O
with O
separate O
labeling O
for O
each O
lesion O
type O
. O
In O
nine O
patients O
the O
presence O
of O
hyperintense O
white O
matter O
lesions O
that O
were O
felt O
to O
be O
chronic O
in O
nature O
were O
also O
annotated O
. O
Artifacts O
, O
for O
example O
, O
signal O
loss O
secondary O
to O
intraparenchymal O
pressure O
probes O
, O
were O
also O
noted O
. O
For O
the O
purpose O
of O
this O
study O
we O
focus O
on O
binary O
segmentation Task
of O
all O
abnormalities O
within O
the O
brain O
tissue O
. O
Thus O
, O
we O
merged O
all O
classes O
that O
correspond O
to O
intra O
- O
cerebral O
abnormalities O
into O
a O
single O
“ O
lesion O
” O
label O
. O
Extra O
- O
cerebral O
pathologies O
such O
as O
epidural O
and O
subdural O
hematoma O
were O
treated O
as O
background O
. O
We O
excluded O
two O
datasets O
because O
of O
corrupted O
FLAIR O
images O
, O
two O
cases O
because O
no O
lesions O
were O
found O
and O
one O
case O
because O
of O
a O
major O
scanning O
artifact O
corrupting O
the O
images O
. O
This O
results O
in O
a O
total O
of O
61 O
cases O
used O
for O
quantitative Task
evaluation Task
. O
Brain O
masks O
were O
obtained O
using O
the O
ROBEX Method
tool Method
( O
) O
. O
All O
images O
were O
resampled O
to O
an O
isotropic O
resolution O
, O
with O
dimensions O
193 O
229 O
193 O
and O
affinely O
registered O
( O
) O
to O
MNI O
space O
using O
the O
atlas O
by O
. O
No O
bias Method
field Method
correction Method
was O
used O
as O
preliminary O
results O
showed O
that O
this O
can O
negatively O
affect O
lesion O
appearance O
. O
Image O
intensities O
were O
normalized O
to O
have O
zero O
- O
mean O
and O
unit O
variance O
, O
as O
it O
has O
been O
reported O
that O
this O
improves O
CNN Task
results O
( O
) O
. O
subsubsection O
: O
Experimental O
Setting O
Network Method
configuration Method
and O
training Method
: O
The O
network Method
architecture Method
corresponds O
to O
the O
one O
described O
in O
Sec O
. O
[ O
reference O
] O
, O
i.e. O
a O
dual Method
- Method
pathway Method
, Method
11 Method
- Method
layers Method
deep Method
CNN Method
. O
The O
training Method
data O
is O
augmented O
by O
adding O
images O
reflected O
along O
the O
sagittal O
axis O
. O
To O
make O
the O
network O
invariant O
to O
absolute O
intensities O
we O
also O
shift O
the O
intensities O
of O
each O
MR O
channel O
of O
every O
training Method
segment O
by O
. O
is O
sampled O
for O
every O
segment O
from O
and O
is O
the O
standard O
deviation O
of O
intensities O
under O
the O
brain O
mask O
in O
the O
corresponding O
image O
. O
The O
network O
is O
regularized O
using O
dropout Method
( Method
) O
with O
a O
rate O
of O
2 O
% O
on O
all O
convolutional O
layers O
, O
which O
is O
in O
addition O
to O
a O
50 O
% O
rate O
used O
on O
the O
last O
two O
layers O
. O
The O
network O
is O
evaluated O
with O
5 Method
- Method
fold Method
cross Method
- Method
validation Method
on O
the O
61 O
subjects O
. O
CRF Method
configuration Method
: O
The O
parameters O
of O
the O
fully Method
connected Method
CRF Method
are O
determined O
in O
a O
configuration O
experiment O
using O
random Method
- Method
search Method
and O
15 O
randomly O
selected O
subjects O
from O
the O
TBI O
database O
with O
predictions O
from O
a O
preliminary O
version O
of O
the O
corresponding O
model O
. O
The O
15 O
subjects O
are O
reshuffled O
into O
the O
5 O
- O
folds O
used O
for O
subsequent O
evaluation O
. O
Random Method
Forest Method
baseline Method
: O
We O
have O
done O
our O
best O
to O
set O
up O
a O
competitive O
baseline O
for O
comparison O
. O
We O
employ O
a O
context Method
- Method
sensitive Method
Random Method
Forest Method
, O
similar O
to O
the O
model O
presented O
by O
for O
brain Task
tumors Task
except O
that O
we O
apply O
the O
forest O
to O
the O
MR O
images O
without O
additional O
tissue O
specific O
priors O
. O
We O
train O
a O
forest Method
with O
50 O
trees O
and O
maximum O
depth O
of O
30 O
. O
Larger O
size O
did O
not O
improve O
results O
. O
Training Method
data O
points O
are O
approximately O
equally O
sampled O
from O
lesion O
and O
background O
classes O
, O
with O
the O
optimal O
balance O
empirically O
chosen O
. O
Two O
hundred O
randomized O
cross O
- O
channel O
box O
features O
are O
evaluated O
at O
each O
split O
node O
with O
maximum O
offsets O
and O
box O
sizes O
of O
20 O
mm O
. O
The O
same O
folds O
of O
training Method
and O
test O
sets O
are O
used O
as O
for O
our O
CNN Method
approach Method
. O
subsubsection O
: O
Results O
Table O
[ O
reference O
] O
summarizes O
the O
results O
on O
TBI O
. O
Our O
CNN Method
significantly O
outperforms O
the O
Random Method
Forest Method
baseline Method
, O
while O
the O
relatively O
overall O
low O
DSC Metric
values Metric
indicate O
the O
difficulty O
of O
the O
task O
. O
Due O
to O
randomness O
during O
training Method
the O
local O
minima O
where O
a O
network O
converges O
are O
different O
between O
training Method
sessions O
and O
some O
errors O
they O
produce O
differ O
( O
) O
. O
To O
clear O
the O
unbiased O
errors O
of O
the O
network O
we O
form O
an O
ensemble O
of O
three O
similar O
networks Method
, O
aggregating O
their O
output O
by O
averaging Method
. O
This O
ensemble O
yields O
better O
performance Metric
in O
all O
metrics O
but O
also O
allows O
us O
to O
investigate O
the O
behaviour O
of O
our O
network O
focusing O
only O
on O
the O
biased O
errors O
. O
Fig O
. O
[ O
reference O
] O
shows O
the O
DSC Metric
obtained O
by O
the O
ensemble O
on O
each O
subject O
in O
relation O
to O
the O
manually O
segmented O
and O
predicted O
lesion O
volume O
. O
The O
network O
is O
capable O
of O
segmenting Task
cases Task
with O
very O
small O
lesions O
, O
although O
, O
performance Metric
is O
less O
robust O
in O
these O
cases O
as O
even O
small O
errors O
have O
large O
influence O
on O
the O
DSC Metric
metric Metric
. O
Investigation O
of O
the O
predicted O
lesion O
volume O
, O
which O
is O
an O
important O
biomarker O
for O
prognostication Task
, O
shows O
that O
the O
network O
is O
neither O
biased O
towards O
the O
lesion O
nor O
background O
class O
, O
with O
promising O
results O
even O
on O
cases O
with O
very O
small O
lesions O
. O
Furthermore O
, O
we O
separately O
evaluate O
the O
influence O
of O
the O
post Method
- Method
processing Method
with O
the O
fully Method
connected Method
CRF Method
. O
As O
shown O
in O
Table O
[ O
reference O
] O
, O
the O
CRF Method
yields O
improvements O
over O
all O
classifiers Method
. O
Effects O
are O
more O
prominent O
when O
the O
performance Metric
of O
the O
primary O
segmenter O
degrades O
, O
which O
shows O
the O
robustness O
of O
this O
regulariser Method
. O
Fig O
. O
[ O
reference O
] O
shows O
three O
representative O
cases O
. O
[ O
b O
] O
1.0 O
[ O
b O
] O
1.0 O
subsection O
: O
Brain Task
Tumor Task
Segmentation Task
subsubsection O
: O
Material O
and O
Pre Task
- Task
Processing Task
For O
brain Task
tumors Task
, O
we O
evaluate O
our O
system O
on O
the O
data O
from O
the O
2015 Material
Brain Material
Tumor Material
Segmentation Material
Challenge Material
( O
BRATS Material
) Material
( O
) O
. O
The O
training Method
set O
consists O
of O
220 O
cases O
with O
high O
grade O
( O
HG O
) O
and O
54 O
cases O
with O
low O
grade O
( O
LG O
) O
glioma O
for O
which O
corresponding O
reference Method
segmentations Method
are O
provided O
. O
The O
segmentations Task
include O
the O
following O
tumor O
tissue O
classes O
: O
1 O
) O
necrotic O
core O
, O
2 O
) O
edema O
, O
3 O
) O
non O
- O
enhancing O
and O
4 O
) O
enhancing O
core O
. O
The O
test O
set O
consists O
of O
110 O
cases O
of O
both O
HG O
and O
LG O
but O
the O
grade O
is O
not O
revealed O
. O
Reference Method
segmentations Method
for O
the O
test O
set O
are O
hidden O
and O
evaluation O
is O
carried O
out O
via O
an O
online Method
system Method
. O
For O
evaluation O
, O
the O
four O
predicted O
labels O
are O
merged O
into O
different O
sets O
of O
whole O
tumor O
( O
all O
four O
classes O
) O
, O
the O
core O
( O
classes O
1 O
, O
3 O
, O
4 O
) O
, O
and O
the O
enhancing O
tumor O
( O
class O
4 O
) O
. O
For O
each O
subject O
, O
four O
MRI O
sequences O
are O
available O
, O
FLAIR O
, O
T1 O
, O
T1 O
- O
contrast O
and O
T2 O
. O
The O
datasets O
are O
pre O
- O
processed O
by O
the O
organizers O
and O
provided O
as O
skull O
- O
stripped O
, O
registered O
to O
a O
common O
space O
and O
resampled O
to O
isotropic O
resolution O
. O
Dimensions O
of O
each O
volume O
are O
240 O
240 O
155 O
. O
We O
add O
minimal O
pre Method
- Method
processing Method
of O
normalizing O
the O
brain O
- O
tissue O
intensities O
of O
each O
sequence O
to O
have O
zero O
- O
mean O
and O
unit O
variance O
. O
subsubsection O
: O
Experimental O
Setting O
Network Method
configuration Method
and O
training Method
: O
We O
modify O
the O
DeepMedic Method
architecture Method
to O
handle O
multi Task
- Task
class Task
problems Task
by O
extending O
the O
classification Method
layer Method
to O
five O
feature O
maps O
( O
four O
tumor O
classes O
plus O
background O
) O
. O
The O
rest O
of O
the O
configuration O
remains O
unchanged O
. O
We O
enrich O
the O
dataset O
with O
sagittal O
reflections O
. O
Opposite O
to O
the O
experiments O
on O
TBI O
, O
we O
do O
not O
employ O
the O
intensity Method
perturbation Method
and O
dropout Method
on O
convolutional Method
layers Method
, O
because O
the O
network O
should O
not O
require O
as O
much O
regularisation O
with O
this O
large O
database O
. O
The O
network O
is O
trained O
on O
image O
segments O
extracted O
with O
equal O
probability O
centred O
on O
the O
whole O
tumor O
and O
healthy O
tissue O
. O
The O
distribution O
of O
the O
classes O
captured O
by O
our O
training Method
scheme O
is O
provided O
in O
[ O
reference O
] O
. O
To O
examine O
our O
network O
’s O
behaviour O
, O
we O
first O
evaluate O
it O
on O
the O
training Method
data O
of O
the O
challenge O
. O
For O
this O
, O
we O
run O
a O
5 Method
- Method
fold Method
cross Method
validation Method
where O
each O
fold O
contains O
both O
HG O
and O
LG O
images O
. O
We O
then O
retrain O
the O
network O
using O
all O
training Method
images O
, O
before O
applying O
it O
on O
the O
test O
data O
. O
CRF Method
configuration Method
: O
For O
the O
multi Task
- Task
class Task
problem Task
it O
is O
challenging O
to O
find O
a O
global O
set O
of O
parameters O
for O
the O
CRF Method
which O
can O
consistently O
improve O
the O
segmentation Task
of O
all O
classes O
. O
So O
instead O
we O
merge O
the O
four O
predicted O
probability O
maps O
into O
a O
single O
“ O
whole O
tumor O
” O
map O
for O
CRF Method
post O
- O
processing O
. O
The O
CRF Method
then O
only O
refines O
the O
boundaries O
between O
tumor O
and O
background O
and O
additionally O
removes O
isolated O
false O
positives O
. O
Similarly O
to O
the O
experiments O
on O
TBI O
, O
the O
CRF Method
is O
configured O
on O
a O
random O
subset O
of O
44 O
HG O
and O
18 O
LG O
training Method
images O
, O
which O
are O
then O
reshuffled O
into O
the O
subsequent O
5 Method
- Method
fold Method
cross Method
validation Method
. O
subsubsection O
: O
Results O
Quantitative O
results O
from O
the O
application O
of O
the O
DeepMedic Method
, O
the O
CRF Method
and O
an O
ensemble O
of O
three O
similar O
networks Method
on O
the O
training Method
data O
are O
presented O
in O
Table O
[ O
reference O
] O
. O
The O
latter O
two O
offer O
an O
improvement O
, O
albeit O
fairly O
small O
since O
the O
performance Metric
of O
DeepMedic Method
is O
already O
rather O
high O
in O
this O
task O
. O
Also O
shown O
are O
results O
from O
previous O
works O
, O
as O
reported O
on O
the O
online Task
evaluation Task
platform Task
. O
Various O
settings O
may O
vary O
among O
submissions O
, O
such O
as O
the O
pre Method
- Method
processing Method
pipeline O
or O
the O
number O
of O
folds O
used O
for O
cross Method
- Method
validation Method
. O
Still O
it O
appears O
that O
our O
system O
performs O
favourably O
compared O
to O
previous O
state O
- O
of O
- O
the O
- O
art O
, O
including O
the O
semi Method
- Method
automatic Method
system Method
of O
( O
bakas1 O
) O
who O
won O
the O
latest O
challenge O
and O
the O
method O
of O
( O
peres1 O
) O
, O
which O
is O
based O
on O
grade Method
- Method
specific Method
2D Method
CNNs Method
and O
requires O
visual O
inspection O
of O
the O
tumor O
and O
identification O
of O
the O
grade O
by O
the O
user O
prior O
to O
segmentation Task
. O
Examples O
of O
segmentations Task
obtained O
with O
our O
method O
are O
shown O
in O
Fig O
. O
[ O
reference O
] O
. O
DeepMedic Method
behaves O
very O
well O
in O
preserving O
the O
hierarchical O
structure O
of O
the O
tumor O
, O
which O
we O
account O
to O
the O
large O
context O
processed O
by O
our O
multi Method
- Method
scale Method
network Method
. O
Table O
[ O
reference O
] O
shows O
the O
results O
of O
our O
method O
on O
the O
BRATS Material
test Material
data Material
. O
Results O
of O
other O
submissions O
are O
not O
accessible O
. O
The O
decrease O
in O
performance Metric
is O
possibly O
due O
to O
the O
the O
inclusion O
of O
test O
images O
that O
vary O
significantly O
from O
the O
training Method
data O
, O
such O
as O
cases O
acquired O
in O
clinical O
centers O
that O
did O
not O
provide O
any O
of O
the O
training Method
images O
, O
something O
that O
was O
confirmed O
by O
the O
organisers O
. O
Note O
that O
performance Metric
gains O
obtained O
with O
the O
CRF Method
are O
larger O
in O
this O
case O
. O
This O
indicates O
not O
only O
that O
its O
configuration O
has O
not O
overfitted O
to O
the O
training Method
database O
but O
also O
that O
the O
CRF Method
is O
robust O
to O
factors O
of O
variation O
between O
acquisition O
sites O
, O
which O
complements O
nicely O
the O
more O
sensitive O
CNN Method
. O
[ O
b O
] O
1.0 O
subsection O
: O
Ischemic Task
Stroke Task
Lesion Task
Segmentation Task
subsubsection O
: O
Material O
and O
Pre O
- O
Processing O
We O
participated O
in O
the O
2015 O
Ischemic Task
Stroke Task
Lesion Task
Segmentation Task
( Task
ISLES Task
) Task
challenge Task
, O
where O
our O
system O
achieved O
the O
best O
results O
among O
all O
participants O
on O
sub Task
- Task
acute Task
ischemic Task
stroke Task
lesions Task
( O
) O
. O
In O
the O
training Method
phase O
of O
the O
challenge O
, O
28 O
datasets O
have O
been O
made O
available O
, O
along O
with O
manual O
segmentations O
. O
Each O
dataset O
included O
T1 O
, O
T1 O
- O
contrast O
, O
FLAIR O
and O
DWI O
sequences O
. O
All O
images O
were O
provided O
as O
skull O
- O
stripped O
and O
resampled O
to O
isotropic O
voxel O
resolution O
. O
Each O
volume O
is O
of O
size O
230 O
230 O
154 O
. O
In O
the O
testing O
stage O
, O
teams O
were O
provided O
with O
36 O
datasets O
for O
evaluation O
. O
The O
test O
data O
were O
acquired O
in O
two O
clinical O
centers O
, O
with O
one O
of O
them O
being O
the O
same O
that O
provided O
all O
training Method
images O
. O
Corresponding O
expert Method
segmentations Method
were O
hidden O
and O
results O
had O
to O
be O
submitted O
to O
an O
online Method
evaluation Method
platform Method
. O
Similar O
to O
BRATS Material
, O
the O
only O
pre Method
- Method
processing Method
that O
we O
applied O
is O
the O
normalization Method
of O
each O
image O
to O
the O
zero O
- O
mean O
and O
unit O
variance O
. O
subsubsection O
: O
Experimental O
Setting O
Network Method
Configuration Method
and O
Training Method
: O
The O
configuration O
of O
the O
network O
employed O
is O
described O
in O
. O
The O
main O
difference O
with O
the O
configuration O
used O
for O
TBI O
and O
tumors O
as O
employed O
above O
is O
the O
relatively O
smaller O
number O
of O
FMs O
in O
the O
low O
- O
resolution O
pathway O
. O
This O
choice O
should O
not O
significantly O
influence O
accuracy Metric
on O
the O
generally O
small O
SISS O
lesions O
but O
it O
allowed O
us O
to O
lower O
the O
computational Metric
cost O
. O
Similar O
to O
the O
other O
experiments O
, O
we O
evaluate O
our O
network O
with O
a O
5 Method
- Method
fold Method
cross Method
validation Method
on O
the O
training Method
datasets O
. O
We O
use O
data Method
augmentation Method
with O
sagittal O
reflections O
. O
For O
the O
testing O
phase O
of O
the O
challenge O
, O
we O
trained O
an O
ensemble O
of O
three O
networks Method
on O
all O
training Method
cases O
and O
aggregate O
their O
predictions O
by O
averaging O
. O
CRF Method
configuration Method
: O
The O
parameters O
of O
the O
CRF Method
were O
configured O
via O
a O
random Method
search Method
on O
the O
whole O
training Method
dataset O
. O
subsubsection O
: O
Results O
The O
performance Metric
of O
our O
system O
on O
the O
training Method
data O
is O
shown O
in O
Table O
[ O
reference O
] O
. O
Significant O
improvement O
is O
achieved O
by O
the O
structural Method
regularisation Method
offered O
by O
the O
CRF Method
, O
although O
it O
could O
be O
partially O
accounted O
for O
by O
overfitting O
the O
training Method
data O
during O
the O
CRF Method
’s Method
configuration Method
. O
Examples O
for O
visual Task
inspection Task
are O
shown O
in O
Fig O
. O
[ O
reference O
] O
. O
For O
the O
testing O
phase O
of O
the O
challenge O
we O
formed O
an O
ensemble O
of O
three O
networks Method
, O
coupled O
with O
the O
fully Method
connected Method
CRF Method
. O
Our O
submission O
ranked O
first O
, O
indicating O
superior O
performance Metric
on O
this O
challenging O
task O
among O
14 O
submissions O
. O
Table O
[ O
reference O
] O
shows O
our O
results O
, O
along O
with O
the O
other O
two O
top O
entries O
( O
) O
. O
Among O
the O
other O
participating O
methods O
was O
the O
CNN Method
of Method
with O
3 Method
layers Method
of Method
2D Method
convolutions Method
. O
That O
method O
perfomed O
less O
well O
on O
this O
challenging O
task O
( O
) O
. O
This O
points O
out O
the O
advantage O
offered O
by O
3D O
context O
, O
the O
large O
field O
of O
view O
of O
DeepMedic Method
thanks O
to O
multi Method
- Method
scale Method
processing Method
and O
the O
representational O
power O
of O
deeper O
networks Method
. O
It O
is O
important O
to O
note O
the O
decrease O
of O
performance Metric
in O
comparison O
to O
the O
training Method
set O
. O
All O
methods O
performed O
worse O
on O
the O
data O
coming O
from O
the O
second O
clinical O
center O
, O
including O
the O
method O
of O
that O
is O
not O
machine Method
- Method
learning Method
based Method
. O
This O
highlights O
a O
general O
difficulty O
with O
current O
approaches O
when O
applied O
on O
multi O
- O
center O
data O
. O
[ O
b O
] O
1.0 O
subsection O
: O
Implementation O
Details O
Our O
CNN Method
is O
implemented O
using O
the O
Theano Method
library Method
( O
) O
. O
Each O
training Method
session O
requires O
approximately O
one O
day O
on O
an O
NVIDIA Method
GTX Method
Titan Method
X Method
GPU Method
using O
cuDNN Method
v5.0 Method
. O
The O
efficient O
architecture O
of O
DeepMedic Method
also O
allows O
models O
to O
be O
trained O
on O
GPUs Method
with O
only O
3 O
GB O
of O
memory O
. O
Note O
that O
although O
dimensions O
of O
the O
volumes O
in O
the O
processed O
databases O
do O
not O
allow O
dense O
training Method
on O
whole O
volumes O
for O
this O
size O
of O
network O
, O
dense O
inference Method
on O
a O
whole O
volume O
is O
still O
possible O
, O
as O
it O
requires O
only O
a O
forward O
- O
pass O
and O
thus O
less O
memory O
. O
In O
this O
fashion O
segmentation Task
of O
a O
volume O
takes O
less O
than O
30 O
seconds O
but O
requires O
12 O
GB O
of O
GPU O
memory O
. O
Tiling O
the O
volume O
into O
multiple O
segments O
of O
size O
allows O
inference Method
on O
3 O
GB O
GPUs O
in O
less O
than O
three O
minutes O
. O
Our O
3D O
fully Method
connected Method
CRF Method
is O
implemented O
by O
extending O
the O
original O
source O
code O
by O
. O
A O
CPU Method
implementation Method
is O
fast O
, O
capable O
of O
processing O
a O
five Task
- Task
channel Task
brain Task
scan Task
in O
under O
three O
minutes O
. O
Further O
speed O
- O
up O
could O
be O
achieved O
with O
a O
GPU Method
implementation Method
, O
but O
was O
not O
found O
necessary O
in O
the O
scope O
of O
this O
work O
. O
section O
: O
Discussion O
and O
Conclusion O
We O
have O
presented O
DeepMedic Method
, O
a O
3D Method
CNN Method
architecture Method
for O
automatic O
lesion O
segmentation Task
that O
surpasses O
state O
- O
of O
- O
the O
- O
art O
on O
challenging O
data O
. O
The O
proposed O
novel O
training Method
scheme O
is O
not O
only O
computationally O
efficient O
but O
also O
offers O
an O
adaptive O
way O
of O
partially O
alleviating O
the O
inherent O
class O
- O
imbalance O
of O
segmentation Task
problems O
. O
We O
analyzed O
the O
benefits O
of O
using O
small Method
convolutional Method
kernels Method
in O
3D Method
CNNs Method
, O
which O
allowed O
us O
to O
develop O
a O
deeper O
and O
thus O
more O
discriminative Method
network Method
, O
without O
increasing O
the O
computational Metric
cost O
and O
number O
of O
trainable O
parameters O
. O
We O
discussed O
the O
challenges O
of O
training Method
deep O
neural O
networks Method
and O
the O
adopted O
solutions O
from O
the O
latest O
advances O
in O
deep Method
learning Method
. O
Furthermore O
, O
we O
proposed O
an O
efficient O
solution O
for O
processing Task
large Task
image Task
context Task
by O
the O
use O
of O
parallel Method
convolutional Method
pathways Method
for O
multi Task
- Task
scale Task
processing Task
, O
alleviating O
one O
of O
the O
main O
computational Metric
limitations O
of O
previous O
3D Method
CNNs Method
. O
Finally O
, O
we O
presented O
the O
first O
application O
of O
a O
3D O
fully Method
connected Method
CRF Method
on O
medical O
data O
, O
employed O
as O
a O
post O
- O
processing O
step O
to O
refine O
the O
network O
’s O
output O
, O
a O
method O
that O
has O
also O
been O
shown O
promising O
for O
processing O
2D O
natural O
images O
( O
) O
. O
The O
design O
of O
the O
proposed O
system O
is O
well O
suited O
for O
processing O
medical Task
volumes Task
thanks O
to O
its O
generic O
3D O
nature O
. O
The O
capabilities O
of O
DeepMedic Method
and O
the O
employed O
CRF Method
for O
capturing Task
3D Task
patterns Task
exceed O
those O
of O
2D O
networks Method
and O
locally Method
connected Method
random Method
fields Method
, O
models O
that O
have O
been O
commonly O
used O
in O
previous O
work O
. O
At O
the O
same O
time O
, O
our O
system O
is O
very O
efficient O
at O
inference Method
time O
, O
which O
allows O
its O
adoption O
in O
a O
variety O
of O
research O
and O
clinical O
settings O
. O
The O
generic O
nature O
of O
our O
system O
allows O
its O
straightforward O
application O
for O
different O
lesion O
segmentation Task
tasks O
without O
major O
adaptations O
. O
To O
the O
best O
of O
our O
knowledge O
, O
our O
system O
achieved O
the O
highest O
reported O
accuracy Metric
on O
a O
cohort O
of O
patients O
with O
severe O
TBI O
. O
As O
a O
comparison O
, O
we O
improved O
over O
the O
reported O
performance Metric
of O
the O
pipeline Method
in O
. O
Important O
to O
note O
is O
that O
the O
latter O
work O
focused O
only O
on O
segmentation Task
of O
contusions O
, O
while O
our O
system O
has O
been O
shown O
capable O
of O
segmenting O
even O
small O
and O
diffused O
pathologies O
. O
Additionally O
, O
our O
pipeline O
achieved O
state O
- O
of O
- O
the O
- O
art O
performance Metric
on O
both O
public O
benchmarks O
of O
brain O
tumors O
( O
BRATS Material
2015 Material
) O
and O
stroke O
lesions O
( O
SISS O
ISLES O
2015 O
) O
. O
We O
believe O
performance Metric
can O
be O
further O
improved O
with O
task Task
- Task
and Task
data Task
- Task
specific Task
adjustments Task
, O
for O
instance O
in O
the O
pre Method
- Method
processing Method
, O
but O
our O
results O
show O
the O
potential O
of O
this O
generically O
designed O
segmentation Task
system O
. O
When O
applying O
our O
pipeline O
to O
new O
tasks O
, O
a O
laborious O
process O
is O
the O
reconfiguration O
of O
the O
CRF Method
. O
The O
model O
improved O
our O
system O
’s O
performance Metric
with O
statistical Metric
significance Metric
in O
all O
investigated O
tasks O
, O
most O
profoundly O
when O
the O
performance Metric
of O
the O
underlying O
classifier Method
degrades O
, O
proving O
its O
flexibility O
and O
robustness O
. O
Finding O
optimal O
parameters O
for O
each O
task O
, O
however O
, O
can O
be O
challenging O
. O
This O
became O
most O
obvious O
on O
the O
task O
of O
multi O
- O
class O
tumor O
segmentation Task
. O
Because O
the O
tumor O
’s O
substructures O
vary O
significantly O
in O
appearance O
, O
finding O
a O
global O
set O
of O
parameters O
that O
yields O
improvements O
on O
all O
classes O
proved O
difficult O
. O
Instead O
, O
we O
applied O
the O
CRF Method
in O
a O
binary Method
fashion Method
. O
This O
CRF Method
model Method
can O
be O
configured O
with O
a O
separate O
set O
of O
parameters O
for O
each O
class O
. O
However O
the O
larger O
parameter O
space O
would O
complicate O
its O
configuration O
further O
. O
Recent O
work O
from O
showed O
that O
this O
particular O
CRF Method
can O
be O
casted O
as O
a O
neural Method
network Method
and O
its O
parameters O
can O
be O
learned O
with O
regular Method
gradient Method
descent Method
. O
Training Method
it O
in O
an O
end O
- O
to O
- O
end O
fashion O
on O
top O
of O
a O
neural Method
network Method
would O
alleviate O
the O
discussed O
problems O
. O
This O
will O
be O
explored O
as O
part O
of O
future O
work O
. O
[ O
b O
] O
0.95 O
The O
discriminative O
power O
of O
the O
learned O
features O
is O
indicated O
by O
the O
success O
of O
recent O
CNN Method
- Method
based Method
systems Method
in O
matching O
human O
performance Metric
in O
domains O
where O
it O
was O
previously O
considered O
too O
ambitious O
( O
) O
. O
Analysis O
of O
the O
automatically O
extracted O
information O
could O
potentially O
provide O
novel O
insights O
and O
facilitate O
research O
on O
pathologies O
for O
which O
little O
prior O
knowledge O
is O
currently O
available O
. O
In O
an O
attempt O
to O
illustrate O
this O
, O
we O
explore O
what O
patterns O
have O
been O
learned O
automatically O
for O
the O
lesion O
segmentation Task
tasks O
. O
We O
visualize O
the O
activations O
of O
DeepMedic Method
’s Method
FMs Method
when O
processing O
a O
subject O
from O
our O
TBI O
database O
. O
Many O
appearing O
patterns O
are O
difficult O
to O
interpret O
, O
especially O
in O
deeper O
layers O
. O
In O
Fig O
. O
[ O
reference O
] O
we O
provide O
some O
examples O
that O
have O
an O
intuitive O
explanation O
. O
One O
of O
the O
most O
interesting O
findings O
is O
that O
the O
network O
learns O
to O
identify O
the O
ventricles O
, O
CSF O
, O
white O
and O
gray O
matter O
. O
This O
reveals O
that O
differentiation O
of O
tissue O
type O
is O
beneficial O
for O
lesion O
segmentation Task
. O
This O
is O
in O
line O
with O
findings O
in O
the O
literature O
, O
where O
segmentation Task
performance Metric
of O
traditional O
classifiers Method
was O
significantly O
improved O
by O
incorporation O
of O
tissue O
priors O
( O
) O
. O
It O
is O
intuitive O
that O
different O
types O
of O
lesions O
affect O
different O
parts O
of O
the O
brain O
depending O
on O
the O
underlying O
mechanisms O
of O
the O
pathology O
. O
A O
rigorous O
analysis O
of O
spatial O
cues O
extracted O
by O
the O
network O
may O
reveal O
correlations O
that O
are O
not O
well O
defined O
yet O
. O
Similarly O
intriguing O
is O
the O
information O
extracted O
in O
the O
low O
- O
resolution O
pathway O
. O
As O
they O
process O
greater O
context O
, O
these O
neurons O
gain O
additional O
localization O
capabilities O
. O
The O
activations O
of O
certain O
FMs O
form O
fields O
in O
the O
surrounding O
areas O
of O
the O
brain O
. O
These O
patterns O
are O
preserved O
in O
the O
deepest O
hidden O
layers O
, O
which O
indicates O
they O
are O
beneficial O
for O
the O
final O
segmentation Task
( O
see O
two O
last O
rows O
of O
Fig O
. O
[ O
reference O
] O
) O
. O
We O
believe O
these O
cues O
provide O
a O
spatial O
bias O
to O
the O
system O
, O
for O
instance O
that O
large O
TBI O
contusions O
tend O
to O
occur O
towards O
the O
front O
and O
sides O
of O
the O
brain O
( O
see O
Fig O
. O
[ O
reference O
] O
) O
. O
Furthermore O
, O
the O
interaction O
of O
the O
multi O
- O
resolution O
features O
can O
be O
observed O
in O
FMs O
of O
the O
hidden O
layer O
that O
follows O
the O
concatenation O
of O
the O
pathways O
. O
The O
network O
learns O
to O
weight O
the O
output O
of O
the O
two O
pathways O
, O
preserving O
low O
resolution O
in O
certain O
parts O
and O
show O
fine O
details O
in O
others O
( O
bottom O
row O
of O
Fig O
. O
[ O
reference O
] O
, O
first O
three O
FMs O
) O
. O
Our O
assumption O
is O
that O
the O
low Method
- Method
resolution Method
pathway Method
provides O
a O
rough O
localization O
of O
large O
pathologies O
and O
brain O
areas O
that O
are O
challenging O
to O
segment O
, O
which O
reserves O
the O
rest O
of O
the O
network O
’s O
capacity O
for O
learning O
detailed O
patterns O
associated O
with O
the O
detection Task
of Task
smaller Task
lesions Task
, O
fine O
structures O
and O
ambiguous O
areas O
. O
The O
findings O
of O
the O
above O
exploration O
lead O
us O
to O
believe O
that O
great O
potential O
lies O
into O
fusing O
the O
discriminative O
power O
of O
the O
“ O
deep O
black O
box O
” O
with O
the O
knowledge O
acquired O
over O
years O
of O
targeted O
biomedical O
research O
. O
Clinical O
knowledge O
is O
available O
for O
certain O
pathologies O
, O
such O
as O
spatial O
priors O
for O
white O
matter O
lesions O
. O
Previously O
engineered Method
models Method
have O
been O
proven O
effective O
in O
tackling O
fundamental Task
imaging Task
problems Task
, O
such O
as O
brain Task
extraction Task
, O
tissue Task
segmentation Task
and O
bias Task
field Task
correction Task
. O
We O
show O
that O
a O
network O
is O
capable O
of O
automatically O
extracting O
some O
of O
this O
information O
. O
It O
would O
be O
interesting O
, O
however O
, O
to O
investigate O
structured O
ways O
for O
incorporating O
such O
existing O
information O
as O
priors O
into O
the O
network O
’s O
feature O
space O
, O
which O
should O
simplify O
the O
optimization Task
problem Task
while O
letting O
a O
specialist O
guide O
the O
network O
towards O
an O
optimal O
solution O
. O
Although O
neural O
networks Method
seem O
promising O
for O
medical Task
image Task
analysis Task
, O
making O
the O
inference Method
process O
more O
interpretable O
is O
required O
. O
This O
would O
allow O
understanding O
when O
the O
network O
fails O
, O
an O
important O
aspect O
in O
biomedical Task
applications Task
. O
Although O
the O
output O
is O
bounded O
in O
the O
range O
and O
commonly O
referred O
to O
as O
probability O
for O
convenience O
, O
it O
is O
not O
a O
true O
probability O
in O
a O
Bayesian O
sense O
. O
Research O
towards O
Bayesian O
networks Method
aims O
to O
alleviate O
this O
limitation O
. O
An O
example O
is O
the O
recent O
work O
of O
who O
show O
that O
model O
confidence O
can O
be O
estimated O
via O
sampling Method
the Method
dropout Method
mask Method
. O
A O
general O
point O
should O
be O
made O
about O
the O
performance Metric
drop O
observed O
when O
our O
system O
is O
applied O
on O
test O
datasets O
of O
BRATS Material
and O
ISLES O
in O
comparison O
to O
its O
cross O
- O
validated O
performance Metric
on O
the O
training Method
data O
. O
In O
both O
cases O
, O
subsets O
of O
the O
test O
images O
were O
acquired O
in O
clinical O
centers O
different O
from O
the O
ones O
of O
training Method
datasets O
. O
Differences O
in O
scanner O
type O
and O
acquisition O
protocols O
have O
significant O
impact O
on O
the O
appearance O
of O
the O
images O
. O
The O
issue O
of O
multi Task
- Task
center Task
data Task
heterogeneity Task
is O
considered O
a O
major O
bottleneck O
for O
enabling O
large Task
- Task
scale Task
imaging Task
studies Task
. O
This O
is O
not O
specific O
to O
our O
approach O
, O
but O
a O
general O
problem O
in O
medical Task
image Task
analysis Task
. O
One O
possible O
way O
of O
making O
the O
CNN Method
invariant O
to O
the O
data O
heterogeneity O
is O
to O
learn O
a O
generative Method
model Method
for O
the O
data Task
acquisition Task
process Task
, O
and O
use O
this O
model O
in O
the O
data Task
augmentation Task
step Task
. O
This O
is O
a O
direction O
we O
explore O
as O
part O
of O
future O
work O
. O
In O
order O
to O
facilitate O
further O
research O
in O
this O
area O
and O
to O
provide O
a O
baseline O
for O
future O
evaluations O
, O
we O
make O
the O
source O
code O
of O
the O
entire O
system O
publicly O
available O
. O
section O
: O
Acknowledgements O
This O
work O
is O
supported O
by O
the O
EPSRC O
First O
Grant O
scheme O
( O
grant O
ref O
no O
. O
EP O
/ O
N023668 O
/ O
1 O
) O
and O
partially O
funded O
under O
the O
7th O
Framework O
Programme O
by O
the O
European O
Commission O
( O
TBIcare O
: O
http: O
// O
www.tbicare.eu O
/ O
; O
CENTER O
- O
TBI O
: O
https: O
// O
www.center O
- O
tbi.eu O
/ O
) O
. O
This O
work O
was O
further O
supported O
by O
a O
Medical O
Research O
Council O
( O
UK O
) O
Program O
Grant O
( O
Acute O
brain O
injury O
: O
heterogeneity O
of O
mechanisms O
, O
therapeutic O
targets O
and O
outcome O
effects O
[ O
G9439390 O
ID O
65883 O
] O
) O
, O
the O
UK O
National O
Institute O
of O
Health O
Research O
Biomedical O
Research O
Centre O
at O
Cambridge O
and O
Technology O
Platform O
funding O
provided O
by O
the O
UK O
Department O
of O
Health O
. O
KK O
is O
supported O
by O
the O
Imperial O
College O
London O
PhD O
Scholarship O
Programme O
. O
VFJN Method
is O
supported O
by O
a O
Health O
Foundation O
/ O
Academy O
of O
Medical O
Sciences O
Clinician O
Scientist O
Fellowship O
. O
DKM Method
is O
supported O
by O
an O
NIHR O
Senior O
Investigator O
Award O
. O
We O
gratefully O
acknowledge O
the O
support O
of O
NVIDIA O
Corporation O
with O
the O
donation O
of O
two O
Titan O
X O
GPUs O
for O
our O
research O
. O
appendix O
: O
Additional O
Details O
on O
Multi Task
- Task
Scale Task
Processing Task
The O
integration O
of O
multi Task
- Task
scale Task
parallel Task
pathways Task
in O
architectures O
that O
use O
solely O
unary O
kernel O
strides O
, O
such O
as O
the O
proposed O
, O
was O
described O
in O
Sec O
. O
[ O
reference O
] O
. O
The O
required O
up Method
- Method
sampling Method
of O
the O
low O
- O
resolution O
features O
was O
performed O
with O
simple O
repetition O
in O
our O
experiments O
. O
This O
was O
found O
sufficient O
, O
with O
the O
following O
hidden Method
layers Method
learning Method
to O
combine O
the O
multi O
- O
scale O
features O
. O
In O
the O
case O
of O
architectures O
with O
strides O
greater O
than O
unary O
, O
the O
last O
convolutional Method
layers Method
of O
the O
two O
pathways O
, O
and O
, O
have O
receptive O
fields O
and O
with O
strides O
and O
respectively O
. O
To O
preserve O
spatial O
correspondence O
of O
the O
multi O
- O
scale O
features O
and O
enable O
the O
network O
for O
dense O
inference Method
, O
the O
dimensions O
of O
the O
input O
segments O
should O
be O
chosen O
such O
that O
the O
FMs O
in O
can O
be O
brought O
to O
the O
dimensions O
of O
the O
FMs O
in O
after O
sequential O
resampling O
by O
, O
, O
or O
equivalent O
combinations O
. O
Here O
and O
represent O
up O
- O
and O
down O
- O
sampling O
by O
the O
given O
factor O
. O
Because O
they O
are O
more O
reliant O
on O
these O
operations O
, O
utilization O
of O
more O
elaborate O
, O
learnt Method
upsampling Method
schemes Method
( O
) O
should O
be O
beneficial O
in O
such O
networks Method
. O
appendix O
: O
Additional O
Details O
on O
Network O
Configurations O
3D Task
Networks Task
: O
The O
main O
description O
of O
our O
system O
is O
presented O
in O
Sec O
. O
[ O
reference O
] O
. O
All O
models O
discussed O
in O
this O
work O
outside O
Sec O
. O
[ O
reference O
] O
are O
fully Method
3D Method
CNNs Method
. O
Their O
architectures O
are O
presented O
in O
Table O
[ O
reference O
] O
. O
They O
all O
use O
the O
PReLu Method
non Method
- Method
linearity Method
( O
) O
. O
They O
are O
trained O
using O
the O
RMSProp Method
optimizer Method
( O
) O
and O
Nesterov Method
momentum Method
( O
) O
with O
value O
. O
and O
regularisation Method
is O
applied O
. O
We O
train O
the O
networks Method
with O
dense O
- O
training Method
on O
batches O
of O
10 O
segments O
, O
each O
of O
size O
. O
Exceptions O
are O
the O
experiments O
in O
Sec O
[ O
reference O
] O
, O
where O
the O
batch O
sizes O
were O
adjusted O
along O
with O
the O
segment O
sizes O
, O
to O
achieve O
similar O
memory Metric
footprint Metric
and O
training Method
time O
per O
batch O
. O
The O
weights O
of O
our O
shallow O
, O
5 O
- O
layers O
networks Method
are O
initialized O
by O
sampling O
from O
a O
normal Method
distribution Method
and O
their O
initial O
learning Metric
rate Metric
is O
set O
to O
. O
Deeper Method
models Method
( O
and O
the O
“ O
Shallow Method
+ Method
” Method
model Method
in O
Sec O
[ O
reference O
] O
) O
use O
the O
weight Method
initialisation Method
scheme Method
of O
. O
The O
scheme O
increases O
the O
signal O
’s O
variance O
in O
our O
settings O
, O
which O
leads O
to O
RMSProm O
decreasing O
the O
effective Metric
learning Metric
rate Metric
. O
To O
counter O
this O
, O
we O
accompany O
it O
with O
an O
increased O
initial Metric
learning Metric
rate Metric
. O
Throughout O
training Method
, O
the O
learning Metric
rate Metric
of O
all O
models O
is O
halved O
whenever O
convergence O
plateaus O
. O
Dropout Method
with O
50 O
% O
rate Metric
is O
employed O
on O
the O
two O
last O
hidden Method
layers Method
of Method
11 Method
- Method
layers Method
deep Method
models Method
. O
2D Method
Networks Method
: O
Table O
[ O
reference O
] O
presents O
representative O
examples O
of O
2D O
configurations O
that O
were O
employed O
for O
the O
experiments O
discussed O
in O
Sec O
. O
[ O
reference O
] O
. O
Width O
, O
depth O
and O
batch O
size O
were O
adjusted O
so O
that O
total O
required O
memory O
was O
similar O
to O
the O
3D Method
version Method
of O
DeepMedic Method
. O
Wider O
or O
deeper O
variants O
than O
the O
ones O
presented O
did O
not O
show O
greater O
performance Metric
. O
A O
possible O
reason O
is O
that O
this O
number O
of O
filters O
is O
enough O
for O
the O
extraction O
of O
the O
limited O
2D O
information O
and O
that O
the O
field O
of O
view O
of O
the O
deep Method
multi Method
- Method
scale Method
variant Method
is O
already O
sufficient O
for O
the O
application O
. O
The O
presented O
2D Method
models Method
were O
regularized O
with O
and O
since O
they O
have O
less O
parameters O
than O
the O
3D Method
variants Method
. O
All O
but O
Dm2dPatch Method
were O
trained O
with O
momentum O
and O
initial Metric
learning Metric
rate Metric
, O
while O
the O
rest O
with O
and O
as O
this O
setting O
increased O
performance Metric
. O
The O
rest O
of O
the O
hyper O
parameters O
are O
the O
same O
as O
for O
the O
3D O
DeepMedic O
. O
1.0 Method
1.0 Method
Sampling Method
was O
manually O
calibrated O
to O
achieve O
similar O
class O
balance O
as O
models O
that O
are O
trained O
on O
image O
segments O
. O
Model O
underperformed O
otherwise O
. O
appendix O
: O
Distribution O
of O
Tumor O
Classes O
Captured O
in O
Training Method
le O
: O
trainingSamplesPercBrats2015Training O
] O
Table O
C.1 O
bibliography O
: O
References O
