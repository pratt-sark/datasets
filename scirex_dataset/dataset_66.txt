Face Task
Detection Task
Using O
Improved O
Faster Method
RCNN Method
section O
: O
Abstract O
Faster O
RCNN Method
has O
achieved O
great O
success O
for O
generic Task
object Task
detection Task
including O
PASCAL Task
object Task
detection Task
and O
MS Task
COCO Task
object Task
detection Task
. O
In O
this O
report O
, O
we O
propose O
a O
detailed O
designed O
Faster Method
RCNN Method
method Method
named O
FDNet1.0 Method
for O
face Task
detection Task
. O
Several O
techniques O
were O
employed O
including O
multi Method
- Method
scale Method
training Method
, O
multi Method
- Method
scale Method
testing Method
, O
light Method
- Method
designed Method
RCNN Method
, O
some O
tricks O
for O
inference Task
and O
a O
vote Method
- Method
based Method
ensemble Method
method Method
. O
Our O
method O
achieves O
two O
1th O
places O
and O
one O
2nd O
place O
in O
three O
tasks O
over O
WIDER Material
FACE Material
validation Material
dataset Material
( O
easy Material
set Material
, O
medium Material
set Material
, O
hard Material
set Material
) O
. O
section O
: O
object Method
detectors Method
including O
one O
stage O
methods O
( O
e.g. O
, O
YOLO O
[ O
reference O
][ O
reference O
], O
SSD O
[ O
reference O
][ O
reference O
] O
) O
and O
two O
stage O
methods O
( O
e.g O
. O
, O
Faster O
RCNN Method
[ O
reference O
][ O
reference O
], O
RFCN O
[ O
reference O
][ O
reference O
] O
) O
. O
One Method
stage Method
methods Method
refer O
broadly O
to O
architectures O
that O
use O
a O
single O
feed Method
- Method
forward Method
full Method
convolutional Method
neural Method
network Method
to O
directly O
predict O
each O
proposal O
's O
class O
and O
corresponding O
bounding O
box O
without O
requiring O
a O
second O
stage O
per Method
- Method
proposal Method
classification Method
operation Method
and O
box Method
refinement Method
. O
Two O
stage Method
methods Method
, O
especially O
Faster O
RCNN Method
achieves O
better O
performance O
than O
one O
stage Method
methods Method
over O
many O
object Task
detection Task
benchmarks O
[ O
reference O
][ O
reference O
] O
. O
In O
the O
Faster O
R Task
- Task
CNN Task
setting Task
, O
object Task
detection Task
happens O
over O
two O
pipes O
. O
In O
the O
first O
pipe O
, O
input O
image O
is O
directly O
processed O
by O
a O
feature Method
extractor Method
( O
e.g. O
, O
Vgg16 O
[ O
reference O
] O
, O
Inception O
[ O
reference O
][ O
reference O
][ O
reference O
][ O
reference O
] O
, O
ResNet101 O
[ O
reference O
] O
) O
without O
any O
hand O
engineering O
, O
and O
features O
at O
the O
selected O
intermediate O
layer O
( O
e.g. O
, O
"conv5_3 O
" O
[ O
reference O
], O
"res4f O
" O
[ O
reference O
] O
) O
will O
be O
fed O
to O
a O
convolutional Method
layer Method
, O
which O
simultaneously O
predict O
objectiveness O
scores O
and O
region O
bounds O
at O
each O
location O
on O
a O
regular O
grid O
according O
to O
predefined O
stride O
. O
The O
first O
pipe O
is O
also O
called O
region Method
proposal Method
network Method
( O
RPN Method
) O
. O
In O
the O
second O
pipe O
, O
these O
proposals O
with O
higher O
scores O
in O
the O
RPN Method
are O
used O
to O
crop O
features O
from O
the O
same O
intermediate O
feature O
map O
which O
are O
subsequently O
fed O
to O
the O
remainder O
of O
the O
feature Method
extractor Method
( O
e.g. O
, O
two O
full Method
connected Method
layer Method
[ O
reference O
] O
, O
5th O
block O
[ O
reference O
] O
) O
in O
order O
to O
predict O
a O
class O
and O
class O
- O
specific O
box O
refinement O
for O
each O
proposal O
. O
Face Task
detection Task
[ O
reference O
][ O
reference O
] O
has O
achieved O
great O
success O
thanks O
to O
the O
appearance O
of O
one O
stage Method
method Method
and O
two O
stage Method
methods Method
. O
However O
, O
there O
are O
still O
some O
issues O
with O
these O
methods O
that O
can O
be O
improved O
with O
elaborate O
design O
of O
the O
details O
. O
In O
this O
report O
, O
we O
propose O
a O
detailed O
design Method
Faster Method
RCNN Method
method Method
named O
FDNet1.0 Method
for O
face Task
detection Task
, O
which O
achieves O
more O
decent O
performance O
than O
previous O
methods O
[ O
reference O
][ O
reference O
][ O
reference O
][ O
reference O
][ O
reference O
][ O
reference O
][ O
reference O
][ O
reference O
][ O
reference O
][ O
reference O
][ O
reference O
][ O
reference O
][ O
reference O
] O
. O
A O
deformable Method
layer Method
with O
fewer O
channels O
is O
attached O
to O
the O
backbone Method
network Method
to O
produce O
a O
" O
thin O
" O
feature O
map O
, O
which O
is O
subsequently O
fed O
to O
a O
full Method
connected Method
layer Method
, O
building O
an O
efficient O
yet O
accurate O
two O
- O
stage Method
detector Method
[ O
reference O
] O
. O
At O
testing O
time O
, O
we O
also O
find O
a O
comparable O
mean Metric
average Metric
precision Metric
( O
mAP Metric
) O
be O
achieved O
when O
the O
top O
- O
ranked O
proposals O
( O
e.g. O
, O
6000 O
) O
are O
directly O
selected O
[ O
reference O
] O
without O
NMS Method
in O
the O
RPN Method
stage Method
over O
WIDER Material
FACE Material
dataset Material
. O
It O
is O
also O
beneficial O
for O
hard Material
set Material
to O
keep O
the O
small O
proposals O
( O
< O
16 O
pixels O
width O
/ O
height O
) O
at O
training O
and O
testing O
stage O
as O
there O
are O
many O
tinny O
faces O
of O
WIDER Material
FACE Material
dataset Material
. O
Furthermore O
, O
the O
multi Method
- Method
scale Method
training Method
and Method
testing Method
strategy Method
are O
also O
applied O
in O
our O
work O
. O
Our O
key O
contributions O
are O
summarized O
as O
follows O
: O
( O
1 O
) O
A O
light Method
head Method
based Method
two Method
- Method
stage Method
framework Method
named O
FDNet1.0 Method
is O
developed O
for O
face Task
detection Task
. O
( O
2 O
) O
Some O
useful O
tricks O
are O
found O
to O
improve O
final O
face Task
detection Task
performance O
including O
multi Method
- Method
scale Method
training Method
, O
multi Method
- Method
scale Method
testing Method
, O
keep O
the O
small O
proposals O
at O
training O
and O
testing O
stage O
, O
directly O
select O
top O
- O
ranked O
proposals O
( O
e.g. O
, O
6000 O
) O
without O
NMS Method
in O
the O
RPN Method
stage Method
for O
R Method
- Method
CNN Method
, O
a O
vote Method
- Method
based Method
NMS Method
ensemble Method
strategy Method
. O
( O
3 Method
) Method
Our Method
framework Method
achieves O
two O
1st O
places O
and O
one O
2nd O
place O
in O
three O
tasks O
over O
WIDER Material
FACE Material
validation Material
dataset Material
( O
easy Material
, O
medium Material
, O
hard Material
) O
, O
one O
illustrative O
example O
of O
our O
results O
in O
the O
crowd O
case O
can O
be O
found O
in O
Figure O
1 O
. O
Face Task
detection Task
is O
one O
of O
the O
most O
fundamental O
and O
challenging O
problems O
in O
computer Task
vision Task
, O
and O
has O
been O
extensively O
studied O
for O
decades O
. O
Compared O
against O
these O
hand O
- O
engineered O
features O
, O
a O
lot O
of O
progress O
for O
face Task
detection Task
has O
been O
made O
in O
recent O
years O
due O
to O
utilizing O
of O
modern O
object Method
detectors Method
, O
including O
Faster Method
R Method
- Method
CNN Method
, O
R Method
- Method
FCN Method
, O
SSD Method
, O
YOLO Method
and O
their O
extensions O
. O
section O
: O
Hand Method
- Method
engineered Method
approaches Method
: O
A O
cascaded Method
AdaBoost Method
face Method
detector Method
[ O
reference O
] O
is O
proposed O
to O
detect O
face O
by O
using O
Haar O
- O
like O
features O
. O
Based O
on O
this O
groundbreaking O
work O
, O
more O
advanced O
hand O
- O
engineered O
features O
and O
more O
powerful O
machine Method
learning Method
algorithms Method
[ O
reference O
][ O
reference O
][ O
reference O
] O
are O
developed O
to O
improve O
face Task
detection Task
performance O
. O
Additionally O
, O
deformable Method
part Method
models Method
( O
DPM Method
) Method
is O
also O
employed O
for O
face Task
detection Task
by O
several O
research O
groups O
, O
which O
achieve O
remarkable O
performance O
[ O
reference O
][ O
reference O
][ O
reference O
] O
. O
Single Method
- Method
stage Method
approaches Method
: O
CascadeCNN Method
[ O
reference O
] O
proposes O
a O
strategy O
to O
detect O
face Task
coarse Task
to Task
fine Task
. O
A O
mutli Method
- Method
task Method
learning Method
method Method
[ O
reference O
] O
named O
MTCNN Method
is O
present O
to O
predict O
face Task
and Task
landmark Task
location Task
simultaneously O
. O
Dense Method
- Method
Box Method
[ O
reference O
] O
employs O
a O
fully Method
deep Method
convolutional Method
neural Method
network Method
to O
directly O
predict O
face O
confidence O
and O
corresponding O
bounding O
box O
. O
UnitBox Method
[ O
reference O
] O
introduces O
a O
novel O
intersection Method
- Method
over Method
- Method
union Method
( Method
IoU Method
) Method
loss Method
to O
predict Task
bounding Task
box Task
, O
which O
regresses O
the O
four O
bounds O
of O
a O
predicted O
box O
as O
a O
whole O
unit O
. O
SAFD Method
[ O
reference O
] O
and O
RSA O
unit O
[ O
reference O
] O
[ O
reference O
] O
introduces O
an O
end O
- O
to O
- O
end Method
multi Method
- Method
task Method
discriminative Method
learning Method
framework Method
to O
increase O
occlusion Metric
robustness Metric
. O
Based O
on O
R Method
- Method
FCN Method
[ O
reference O
] O
, O
Face Method
R Method
- Method
FCN Method
[ O
reference O
] O
re O
- O
weights O
embedding O
responses O
on O
score O
maps O
and O
eliminates O
the O
effect O
of O
non O
- O
uniformed O
contribution O
in O
each O
facial O
part O
using O
a O
position Method
- Method
sensitive Method
average Method
pooling Method
. O
section O
: O
Proposed O
Approach O
Faster O
RCNN Method
, O
with O
two O
fully Method
connected Method
layers Method
or O
all O
the O
convolution Method
layers Method
in O
ResNet Method
5 Method
- Method
th Method
stage Method
to O
predict O
RoI Task
classification Task
and Task
regression Task
, O
consumes O
a O
large O
memory O
and O
computing O
resource O
. O
RFCN Method
is O
fully O
convolutional Method
with O
almost O
all O
computation O
shared O
on O
the O
entire O
image O
, O
but O
it O
has O
poor O
performance O
compared O
to O
Faster O
RCNN Method
. O
Inspired O
by O
[ O
reference O
] O
, O
we O
develop O
a O
light Method
- Method
head Method
Faster Method
RCNN Method
for O
face Task
detection Task
with O
good O
performance O
and O
inference Metric
speed Metric
. O
In O
this O
section O
, O
we O
will O
present O
our O
method O
in O
detail O
. O
section O
: O
Light O
- O
Head O
Faster O
RCNN Method
Based O
on O
Faster O
RCNN Method
, O
we O
make O
several O
effective O
modifications O
for O
improving O
detection Task
performance O
. O
The O
architecture O
of O
our O
framework O
is O
depicted O
in O
Figure O
2 O
. O
ResNet Method
architecture Method
plays O
the O
role O
of O
feature Method
extractor Method
, O
the O
" O
thin O
" O
feature O
maps O
is O
built O
by O
a O
deformable Method
layer Method
before O
Region Method
- Method
of Method
- Method
Interest Method
( O
RoI Method
) Method
warping Method
, O
which O
will O
exploit O
image O
context O
and O
be O
robust O
to O
variations O
. O
And O
a O
single O
fully Method
- Method
connected Method
layer Method
is O
used O
in O
the O
R Method
- Method
CNN Method
subnet Method
. O
We O
use O
ResNet Method
- Method
v1 Method
- Method
101 Method
as O
backbone Method
network Method
to O
extract O
high O
- O
level O
feature O
. O
The O
stride Method
of Method
ResNet Method
- Method
v1 Method
- Method
101 Method
is O
fixed O
to O
16 O
pixels O
, O
which O
is O
not O
good O
enough O
for O
detecting O
different O
scale O
faces O
. O
Therefore O
a O
large O
kernel Method
- Method
based Method
deformable Method
layer Method
is O
attached O
on O
backbone Method
network Method
to O
exploit O
image O
context O
and O
be O
robust O
to O
variations O
, O
where O
" O
D O
" O
stand O
for O
deformable O
. O
The O
output O
channel O
size O
of O
the O
deformable Method
layer Method
is O
512 O
, O
and O
each O
ROI O
will O
be O
resized O
to O
512×7×7 O
, O
which O
will O
be O
fed O
to O
the O
following O
fully Method
connected Method
layer Method
with O
2048 O
channels O
. O
Figure2 O
. O
Overview O
of O
our O
approach O
. O
A O
deformable Method
layer Method
with O
512 O
channels O
was O
employed O
to O
build O
" O
thin O
" O
feature O
maps O
with O
exploiting O
image O
context O
simultaneously O
before O
RoI O
warping O
. O
Hence O
, O
RCNN Method
can O
be O
designed O
with O
light O
- O
head O
to O
improve O
inference Metric
speed Metric
. O
Additionally O
, O
anchors O
are O
carefully O
designed O
to O
obtain O
better O
location O
samples O
. O
The O
aspect O
ratio O
is O
set O
to O
1 O
, O
1 O
. O
based O
on O
statistical Method
analysis Method
on O
the O
training O
dataset O
. O
These O
smaller O
anchors O
are O
very O
helpful O
for O
sufficiently O
capturing O
tiny O
face O
. O
As O
WIDER Material
FACE Material
dataset Material
contain O
many O
extremely O
tinny O
faces O
( O
< O
16 O
pixels O
width O
/ O
height O
) O
, O
we O
keep O
these O
small O
proposals O
( O
< O
16 O
pixels O
width O
/ O
height O
) O
valid O
in O
the O
training O
and O
testing O
time O
[ O
reference O
] O
. O
The O
experiments O
show O
that O
our O
method O
can O
achieve O
better O
performance O
. O
section O
: O
Multi Task
- Task
Scale Task
Training Task
and Task
Testing Task
The O
trained O
model O
can O
also O
be O
robust O
on O
different O
scale O
faces O
when O
both O
multi Method
- Method
scale Method
training Method
and Method
testing Method
strategy Method
are O
used O
. O
In O
our O
method O
, O
the O
shorter O
side O
is O
resized O
to O
600 O
, O
800 O
, O
1000 O
, O
1200 O
, O
1400 O
pixels O
according O
to O
the O
statistical Method
analysis Method
on O
the O
training O
dataset O
. O
Unlike O
[ O
reference O
] O
, O
we O
only O
use O
horizontal Method
image Method
flipping Method
augmentation Method
, O
and O
no O
other O
hard Material
example O
mining O
method O
is O
used O
in O
the O
training O
stage O
. O
In O
the O
testing O
phase O
, O
the O
shorter O
side O
of O
each O
image O
is O
also O
resized O
to O
600 O
, O
800 O
, O
1000 O
, O
1200 O
, O
1400 O
pixels O
and O
tested O
independently O
. O
Then O
all O
of O
the O
output O
results O
are O
merged O
. O
Next O
, O
a O
voted Method
- Method
based Method
NMS Method
strategy Method
is O
adapted O
. O
We O
firstly O
delete O
the O
output O
bounding O
box O
whose O
IOU O
is O
lower O
than O
0.3 O
with O
any O
other O
bounding O
boxes O
to O
suppress O
false O
positive O
samples O
, O
and O
then O
NMS Method
is O
used O
to O
get O
the O
best O
bounding O
boxes O
. O
section O
: O
Experiments O
We O
perform O
evaluation O
on O
WIDER Material
FACE Material
dataset Material
[ O
reference O
] O
which O
contains O
more O
challenges O
, O
including O
small O
scale O
, O
illumination O
, O
occlusion O
, O
background O
clutter O
and O
extreme O
poses O
when O
compared O
with O
other O
benchmarks O
. O
A O
total O
of O
393 O
, O
703 O
labeled O
faces O
in O
32 O
, O
203 O
images O
from O
61 O
different O
scenes O
are O
collected O
, O
of O
which O
40 O
% O
are O
chosen O
as O
train O
set O
, O
10 O
% O
as O
validation O
set O
and O
other O
50 O
% O
as O
test O
set O
. O
The O
validation O
set O
and O
the O
testing O
set O
are O
also O
divided O
into O
easy Material
set Material
, O
medium Material
set Material
and O
hard Material
set Material
according O
to O
the O
detection O
difficulties O
. O
It O
is O
noticed O
that O
our O
method O
is O
trained O
only O
on O
the O
train O
set O
and O
evaluate O
on O
both O
validation Metric
set Metric
and O
test O
set O
. O
Better O
performance O
might O
be O
achieved O
by O
merging O
the O
train O
set O
and O
the O
validation O
set O
for O
training O
. O
More O
detailed O
results O
of O
WIDER Material
FACE Material
are O
shown O
in O
Figure O
4 O
. O
section O
: O
Implementation O
Details O
Single O
NVIDIA Method
Tesla Method
K80 Method
is O
used O
for O
training O
and O
testing O
. O
Mini O
batch O
size O
is O
set O
to O
1 O
considering O
memory O
consumption O
. O
Specifically O
, O
ResNet_v1_101 Method
trained O
on O
ImageNet O
- O
128w O
is O
used O
for O
Faster O
RCNN Task
feature Task
extraction Task
. O
It O
is O
helpful O
to O
freeze O
the O
first O
two O
blocks O
in O
the O
training O
stage O
as O
data O
size O
of O
WIDER Material
FACE Material
is O
not O
so O
large O
. O
A O
deformable Method
layer Method
is O
used O
to O
output O
a O
" O
thin O
" O
feature O
map O
with O
exploiting O
image O
context O
. O
Aspect O
ratios O
( O
1 O
, O
1.5 O
, O
2 O
) O
and O
scales O
( O
16 O
2 O
, O
32 O
2 O
, O
64 O
2 O
, O
128 O
2 O
, O
256 O
2 O
, O
512 O
2 O
) O
are O
carefully O
designed O
to O
capture O
better O
locations O
of O
faces O
in O
the O
RPN Method
stage Method
, O
and O
the O
number O
of O
filters O
for O
the O
RPN Method
layer Method
is O
set O
as O
512 O
. O
The O
anchors O
with O
highest O
IoU Metric
score Metric
or O
IoU Metric
score Metric
with O
the O
ground O
truth O
above O
0.7 O
are O
defined O
as O
positive O
. O
The O
anchors O
whose O
IoU O
score O
with O
the O
ground O
truth O
that O
is O
lower O
than O
0.3 O
are O
defined O
as O
negative O
, O
while O
whose O
IoU O
score O
above O
0.3 O
but O
lower O
than O
0.7 O
will O
be O
ignored O
. O
The O
similar O
settings O
of O
anchors O
are O
used O
in O
the O
R Method
- Method
CNN Method
stage Method
. O
The O
anchors O
with O
IoU O
score O
with O
the O
ground O
truth O
above O
0.5 O
are O
assigned O
as O
positive O
, O
IoU Metric
score Metric
that O
is O
lower O
than O
0.3 O
is O
defined O
as O
negative O
, O
IoU O
score O
above O
0.3 O
but O
lower O
than O
0.5 O
will O
be O
ignored O
. O
By O
the O
way O
, O
the O
batch O
size O
of O
RPN Method
and Method
R Method
- Method
CNN Method
is O
respectively O
assigned O
as O
256 O
and O
128 O
. O
The O
initial O
learning Metric
rate Metric
is O
set O
to O
1e O
- O
3 O
, O
and O
decrease O
to O
1e O
- O
4 O
after O
20w O
iterations O
. O
Weight O
decay O
is O
and O
momentum O
is O
set O
to O
1e O
- O
4 O
and O
0.9 O
respectively O
. O
In O
testing Task
stage Task
, O
multi Method
- Method
scale Method
testing Method
strategy Method
is O
adapted O
to O
be O
robust O
to O
different O
scale O
faces O
. O
Specifically O
, O
the O
shorter O
side O
of O
each O
image O
is O
also O
resized O
to O
600 O
, O
800 O
, O
1000 O
, O
1200 O
, O
1400 O
pixels O
and O
tested O
independently O
. O
And O
a O
voted Method
- Method
based Method
NMS Method
strategy Method
is O
used O
to O
get O
the O
final O
result O
. O
We O
also O
find O
top O
- O
ranked O
6000 O
proposals O
are O
directly O
selected O
without O
NMS Method
during O
testing O
can O
boost O
0.1 O
% O
, O
0.3 O
% O
and O
0.6 O
% O
on O
easy Material
set Material
, O
medium Material
set Material
and O
hard Material
set Material
respectively O
. O
section O
: O
Comparison O
on O
Benchmarks O
Our O
model O
is O
trained O
on O
the O
train O
set O
and O
evaluated O
on O
WIDER Material
FACE Material
validation Material
set Material
. O
Compared O
with O
the O
recently O
published O
top O
approaches O
, O
FDNet1.0 Method
wins O
two O
1st O
places O
( O
easy Material
set Material
= O
95.9 O
% O
, O
medium Material
set Material
= O
94.5 O
% O
) O
and O
one O
2nd O
place O
( O
hard Material
set Material
= O
87.9 O
% O
) O
on O
the O
validation O
set O
, O
as O
illustrated O
in O
Figure O
3 O
. O
We O
believe O
that O
more O
kinds O
of O
data Task
augmentation Task
and O
hard Material
example O
mining O
[ O
reference O
] O
would O
further O
boost O
detection Task
performance O
. O
( O
a O
) O
Easy Material
set Material
: O
validation O
section O
: O
Conclusion O
In O
this O
paper O
, O
we O
propose O
a O
novel O
framework O
named O
FDNet1.0 Method
for O
face Task
detection Task
. O
FDNet1.0 Method
improves O
Faster O
RCNN Method
by O
integrating O
several O
efficient O
techniques O
for O
better O
performance O
. O
Experimental O
results O
on O
challenging O
WIDER Material
FACE Material
dataset Material
validate O
the O
effectiveness O
of O
our O
proposed O
algorithm O
. O
In O
the O
future O
, O
we O
will O
try O
more O
kinds O
of O
data Task
augmentation Task
and O
hard Material
example O
mining O
which O
may O
further O
boost O
detection Task
performance O
. O
We O
will O
also O
consider O
some O
ideas O
for O
faster O
inference Metric
speed Metric
, O
e.g. O
designing O
light O
backbone O
. O
section O
: O
