document	O
:	O
Joint	Task
Detection	Task
and	Task
Identification	Task
Feature	Task
Learning	Task
for	O
Person	Task
Search	Task
Existing	O
person	Task
re	Task
-	Task
identification	Task
benchmarks	O
and	O
methods	O
mainly	O
focus	O
on	O
matching	O
cropped	O
pedestrian	O
images	O
between	O
queries	O
and	O
candidates	O
.	O
However	O
,	O
it	O
is	O
different	O
from	O
real	O
-	O
world	O
scenarios	O
where	O
the	O
annotations	O
of	O
pedestrian	O
bounding	O
boxes	O
are	O
unavailable	O
and	O
the	O
target	O
person	O
needs	O
to	O
be	O
searched	O
from	O
a	O
gallery	O
of	O
whole	O
scene	O
images	O
.	O
To	O
close	O
the	O
gap	O
,	O
we	O
propose	O
a	O
new	O
deep	Method
learning	Method
framework	Method
for	O
person	Task
search	Task
.	O
Instead	O
of	O
breaking	O
it	O
down	O
into	O
two	O
separate	O
tasks	O
—	O
pedestrian	O
detection	Task
and	O
person	Task
re	Task
-	Task
identification	Task
,	O
we	O
jointly	O
handle	O
both	O
aspects	O
in	O
a	O
single	O
convolutional	Method
neural	Method
network	Method
.	O
An	O
Online	Method
Instance	Method
Matching	Method
(	O
OIM	Method
)	O
loss	O
function	O
is	O
proposed	O
to	O
train	O
the	O
network	O
effectively	O
,	O
which	O
is	O
scalable	O
to	O
datasets	O
with	O
numerous	O
identities	O
.	O
To	O
validate	O
our	O
approach	O
,	O
we	O
collect	O
and	O
annotate	O
a	O
large	O
-	O
scale	O
benchmark	O
dataset	O
for	O
person	Task
search	Task
.	O
It	O
contains	O
images	O
,	O
identities	O
,	O
and	O
pedestrian	O
bounding	O
boxes	O
.	O
Experiments	O
show	O
that	O
our	O
framework	O
outperforms	O
other	O
separate	O
approaches	O
,	O
and	O
the	O
proposed	O
OIM	Method
loss	O
function	O
converges	O
much	O
faster	O
and	O
better	O
than	O
the	O
conventional	O
Softmax	Method
loss	Method
.	O
section	O
:	O
Introduction	O
Person	Task
re	Task
-	Task
identification	Task
(	O
re	Task
-	Task
i	Task
d	Task
)	O
aims	O
at	O
matching	O
a	O
target	O
person	O
with	O
a	O
gallery	O
of	O
pedestrian	O
images	O
.	O
It	O
has	O
many	O
video	Task
surveillance	Task
applications	Task
,	O
such	O
as	O
finding	Task
criminals	Task
,	O
cross	Task
-	Task
camera	Task
person	Task
tracking	Task
,	O
and	O
person	Task
activity	Task
analysis	Task
.	O
The	O
problem	O
is	O
challenging	O
because	O
of	O
complex	O
variations	O
of	O
human	O
poses	O
,	O
camera	O
viewpoints	O
,	O
lighting	O
,	O
occlusion	O
,	O
resolution	O
,	O
background	O
clutter	O
,	O
,	O
and	O
thus	O
draws	O
much	O
research	O
attention	O
in	O
recent	O
years	O
.	O
[	O
b	O
]	O
[	O
1em	O
]	O
[	O
b	O
]	O
Although	O
numerous	O
person	Task
re	Task
-	Task
i	Task
d	Task
datasets	O
and	O
methods	O
have	O
been	O
proposed	O
,	O
there	O
is	O
still	O
a	O
big	O
gap	O
between	O
the	O
problem	O
setting	O
itself	O
and	O
real	O
-	O
world	O
applications	O
.	O
In	O
most	O
benchmarks	O
,	O
the	O
gallery	O
only	O
contains	O
manually	O
cropped	O
pedestrian	O
images	O
(	O
Figure	O
[	O
reference	O
]	O
)	O
,	O
while	O
in	O
real	O
applications	O
,	O
the	O
goal	O
is	O
to	O
find	O
a	O
target	O
person	O
in	O
a	O
gallery	O
of	O
whole	O
scene	O
images	O
,	O
as	O
shown	O
in	O
Figure	O
[	O
reference	O
]	O
.	O
Following	O
the	O
protocols	O
of	O
these	O
benchmarks	O
,	O
most	O
of	O
the	O
existing	O
person	O
re	Task
-	Task
i	Task
d	Task
methods	O
assume	O
perfect	O
pedestrian	O
detections	O
.	O
However	O
,	O
these	O
manually	O
cropped	O
bounding	O
boxes	O
are	O
unavailable	O
in	O
practical	O
applications	O
.	O
Off	O
-	O
the	O
-	O
shelf	O
pedestrian	Method
detectors	Method
would	O
inevitably	O
produce	O
false	O
alarms	O
,	O
misdetections	O
,	O
and	O
misalignments	O
,	O
which	O
could	O
harm	O
the	O
final	O
searching	Task
performance	O
significantly	O
.	O
In	O
2014	O
,	O
Xu	O
made	O
the	O
first	O
step	O
towards	O
closing	O
this	O
gap	O
.	O
They	O
introduced	O
the	O
person	Task
search	Task
problem	Task
to	O
the	O
community	O
,	O
and	O
proposed	O
a	O
sliding	Method
window	Method
searching	Method
strategy	Method
based	O
on	O
a	O
combination	O
of	O
pedestrian	O
detection	Task
and	O
person	O
matching	O
scores	O
.	O
However	O
,	O
the	O
performance	O
is	O
limited	O
by	O
the	O
handcrafted	O
features	O
,	O
and	O
the	O
sliding	Method
window	Method
framework	Method
is	O
not	O
scalable	O
.	O
In	O
this	O
paper	O
,	O
we	O
propose	O
a	O
new	O
deep	Method
learning	Method
framework	Method
for	O
person	Task
search	Task
.	O
Different	O
from	O
conventional	O
approaches	O
that	O
break	O
down	O
the	O
problem	O
into	O
two	O
separate	O
tasks	O
—	O
pedestrian	O
detection	Task
and	O
person	Task
re	Task
-	Task
identification	Task
,	O
we	O
jointly	O
handle	O
both	O
aspects	O
in	O
a	O
single	O
Convolutional	Method
Neural	Method
Network	Method
(	O
CNN	Method
)	O
.	O
Our	O
CNN	Method
consists	O
of	O
two	O
parts	O
,	O
given	O
a	O
whole	O
input	O
gallery	O
image	O
,	O
a	O
pedestrian	Method
proposal	Method
net	Method
is	O
used	O
to	O
produce	O
bounding	O
boxes	O
of	O
candidate	O
people	O
,	O
which	O
are	O
fed	O
into	O
an	O
identification	Method
net	Method
to	O
extract	O
features	O
for	O
comparing	O
with	O
the	O
target	O
person	O
.	O
The	O
pedestrian	Method
proposal	Method
net	Method
and	O
the	O
identification	Method
net	Method
adapt	O
with	O
each	O
other	O
during	O
the	O
joint	Task
optimization	Task
.	O
For	O
example	O
,	O
the	O
proposal	Method
net	Method
can	O
focus	O
more	O
on	O
the	O
recall	Metric
rather	O
than	O
the	O
precision	Metric
,	O
as	O
false	O
alarms	O
could	O
be	O
eliminated	O
through	O
the	O
latter	O
features	Method
matching	Method
process	Method
.	O
Meanwhile	O
,	O
misalignments	O
of	O
proposals	O
are	O
also	O
acceptable	O
,	O
as	O
they	O
can	O
be	O
further	O
adjusted	O
by	O
the	O
identification	O
net	O
.	O
To	O
improve	O
the	O
scalability	O
of	O
the	O
whole	O
system	O
,	O
inspired	O
by	O
recent	O
advances	O
in	O
object	O
detection	Task
,	O
we	O
encourage	O
both	O
parts	O
to	O
share	O
underlying	O
convolutional	O
feature	O
maps	O
,	O
which	O
significantly	O
accelerates	O
the	O
inference	Method
procedure	Method
.	O
Traditional	O
re	Task
-	Task
i	Task
d	Task
feature	Task
learning	Task
mainly	O
employs	O
pairwise	O
or	O
triplet	O
distance	O
loss	O
functions	O
.	O
However	O
,	O
they	O
are	O
not	O
efficient	O
as	O
only	O
several	O
data	O
samples	O
are	O
compared	O
at	O
each	O
time	O
,	O
and	O
there	O
are	O
potential	O
input	O
combinations	O
,	O
where	O
is	O
the	O
number	O
of	O
images	O
.	O
Different	O
sampling	Method
strategies	Method
could	O
significantly	O
impact	O
the	O
convergence	Metric
rate	Metric
and	Metric
quality	Metric
,	O
but	O
finding	O
efficient	O
sampling	Method
strategies	Method
becomes	O
much	O
more	O
difficult	O
as	O
increases	O
.	O
Another	O
approach	O
is	O
learning	O
to	O
classify	O
identities	O
with	O
the	O
Softmax	O
loss	O
function	O
,	O
which	O
effectively	O
compares	O
all	O
the	O
samples	O
at	O
the	O
same	O
time	O
.	O
But	O
as	O
the	O
number	O
of	O
classes	O
increases	O
,	O
training	O
the	O
big	O
Softmax	Method
classifier	Method
matrix	Method
becomes	O
much	O
slower	O
or	O
even	O
can	O
not	O
converge	O
.	O
In	O
this	O
paper	O
,	O
we	O
propose	O
a	O
novel	O
Online	Method
Instance	Method
Matching	Method
(	O
OIM	Method
)	O
loss	O
function	O
to	O
cope	O
with	O
the	O
problems	O
.	O
We	O
maintain	O
a	O
lookup	O
table	O
of	O
features	O
from	O
all	O
the	O
labeled	O
identities	O
,	O
and	O
compare	O
distances	O
between	O
mini	O
-	O
batch	O
samples	O
and	O
all	O
the	O
registered	O
entries	O
.	O
On	O
the	O
other	O
hand	O
,	O
many	O
unlabeled	O
identities	O
could	O
appear	O
in	O
scene	O
images	O
,	O
which	O
can	O
be	O
served	O
as	O
negatives	O
for	O
labeled	O
identities	O
.	O
We	O
thus	O
exploit	O
a	O
circular	O
queue	O
to	O
store	O
their	O
features	O
also	O
for	O
comparison	O
.	O
This	O
is	O
another	O
advantage	O
brought	O
by	O
the	O
person	Task
search	Task
problem	Task
setting	Task
.	O
The	O
proposed	O
parameter	O
-	O
free	O
OIM	Method
loss	O
converges	O
much	O
faster	O
and	O
better	O
than	O
the	O
Softmax	Method
loss	Method
in	O
our	O
experiments	O
.	O
The	O
contribution	O
of	O
our	O
work	O
is	O
three	O
-	O
fold	O
.	O
First	O
,	O
we	O
propose	O
a	O
new	O
deep	Method
learning	Method
framework	Method
to	O
search	O
a	O
target	O
person	O
from	O
a	O
gallery	O
of	O
whole	O
scene	O
images	O
.	O
Instead	O
of	O
simply	O
combining	O
the	O
pedestrian	Method
detectors	Method
and	O
person	O
re	Task
-	Task
i	Task
d	Task
methods	O
,	O
we	O
jointly	O
optimize	O
both	O
objectives	O
in	O
a	O
single	O
CNN	Method
and	O
they	O
better	O
adapt	O
with	O
each	O
other	O
.	O
Second	O
,	O
we	O
propose	O
an	O
Online	Method
Instance	Method
Matching	Method
loss	O
function	O
to	O
learn	O
identification	O
features	O
more	O
effectively	O
,	O
which	O
enables	O
our	O
framework	O
to	O
be	O
scalable	O
to	O
large	O
datasets	O
with	O
numerous	O
identities	O
.	O
Together	O
with	O
the	O
fast	O
inference	Metric
speed	Metric
,	O
our	O
framework	O
is	O
much	O
closer	O
to	O
the	O
real	O
-	O
world	O
application	O
requirements	O
.	O
At	O
last	O
,	O
we	O
collect	O
and	O
annotate	O
a	O
large	O
-	O
scale	O
benchmark	O
dataset	O
for	O
person	Task
search	Task
,	O
covering	O
hundreds	O
of	O
scenes	O
from	O
street	O
and	O
movie	O
snapshots	O
.	O
The	O
dataset	O
contains	O
images	O
,	O
identities	O
,	O
and	O
pedestrian	O
bounding	O
boxes	O
.	O
We	O
validate	O
the	O
effectiveness	O
of	O
our	O
approach	O
comparing	O
against	O
other	O
baselines	O
on	O
this	O
dataset	O
.	O
The	O
dataset	O
and	O
code	O
are	O
made	O
public	O
to	O
facilitate	O
further	O
research	O
.	O
section	O
:	O
Related	O
Work	O
Person	Task
re	Task
-	Task
identification	Task
.	O
Early	O
person	Task
re	Task
-	Task
identification	Task
methods	O
addressed	O
the	O
problem	O
by	O
manually	O
designing	O
discriminative	O
features	O
,	O
learning	O
feature	O
transforms	O
across	O
camera	O
views	O
,	O
and	O
learning	Metric
distance	Metric
metrics	Metric
.	O
Recent	O
years	O
,	O
many	O
researchers	O
have	O
proposed	O
various	O
deep	Method
learning	Method
based	Method
methods	Method
that	O
jointly	O
handle	O
all	O
these	O
aspects	O
.	O
Li	O
and	O
Ahmed	O
designed	O
specific	O
CNN	Method
models	O
for	O
person	Task
re	Task
-	Task
i	Task
d	Task
.	O
Both	O
the	O
networks	O
utilize	O
as	O
input	O
a	O
pair	O
of	O
cropped	O
pedestrian	O
images	O
and	O
employ	O
a	O
binary	Method
verification	Method
loss	Method
function	Method
to	O
train	O
the	O
parameters	O
.	O
Ding	O
and	O
Cheng	O
exploited	O
triplet	O
samples	O
for	O
training	O
CNNs	Method
to	O
minimize	O
the	O
feature	O
distance	O
between	O
the	O
same	O
person	O
and	O
maximize	O
the	O
distance	O
between	O
different	O
people	O
.	O
Apart	O
from	O
using	O
pairwise	O
or	O
triplet	O
loss	O
functions	O
,	O
Xiao	O
proposed	O
to	O
learn	O
features	O
by	O
classifying	O
identities	O
.	O
Multiple	O
datasets	O
are	O
combined	O
together	O
and	O
a	O
domain	Method
guided	Method
dropout	Method
technique	Method
is	O
proposed	O
to	O
improve	O
the	O
feature	Method
learning	Method
.	O
Several	O
recent	O
works	O
addressed	O
on	O
solving	O
person	Task
re	Task
-	Task
i	Task
d	Task
on	O
abnormal	O
images	O
,	O
such	O
as	O
low	O
-	O
resolution	O
images	O
,	O
or	O
partially	O
occluded	O
images	O
.	O
Concurrent	O
with	O
our	O
prior	O
arXiv	O
submission	O
,	O
Zheng	O
also	O
contributed	O
a	O
benchmark	O
dataset	O
for	O
person	Task
search	Task
.	O
They	O
exploited	O
separate	O
detection	Task
and	O
re	Task
-	Task
i	Task
d	Task
methods	Task
with	O
scores	O
re	O
-	O
weighting	O
to	O
solve	O
the	O
problem	O
,	O
while	O
in	O
this	O
work	O
we	O
propose	O
a	O
deep	Method
learning	Method
framework	Method
that	O
jointly	O
handles	O
both	O
aspects	O
.	O
Pedestrian	O
detection	Task
.	O
DPM	Method
,	O
ACF	Method
,	O
and	O
Checkerboards	Method
are	O
the	O
most	O
commonly	O
used	O
off	O
-	O
the	O
-	O
shelf	O
pedestrian	Method
detectors	Method
.	O
They	O
rely	O
on	O
hand	O
-	O
crafted	O
features	O
and	O
linear	Method
classifiers	Method
to	O
detect	O
pedestrians	O
.	O
Recent	O
years	O
,	O
CNN	Method
-	O
based	O
pedestrian	O
detectors	O
have	O
also	O
been	O
developed	O
.	O
Various	O
factors	O
,	O
including	O
CNN	Method
model	O
structures	O
,	O
training	O
data	O
,	O
and	O
different	O
training	Method
strategies	Method
are	O
studied	O
empirically	O
in	O
.	O
Tian	O
exploited	O
pedestrian	O
and	O
scene	O
attribute	O
labels	O
to	O
train	O
CNN	Method
pedestrian	O
detectors	O
in	O
a	O
multi	O
-	O
task	O
manner	O
.	O
Cai	O
proposed	O
a	O
complexity	Method
-	Method
aware	Method
boosting	Method
algorithm	Method
for	O
learning	O
CNN	Method
detector	O
cascades	O
.	O
section	O
:	O
Method	O
We	O
propose	O
a	O
new	O
deep	Method
learning	Method
framework	Method
that	O
jointly	O
handles	O
the	O
pedestrian	O
detection	Task
and	O
person	Task
re	Task
-	Task
identification	Task
in	O
a	O
single	O
convolutional	Method
neural	Method
network	Method
(	O
CNN	Method
)	O
,	O
as	O
shown	O
in	O
Figure	O
[	O
reference	O
]	O
.	O
Given	O
as	O
input	O
a	O
whole	O
scene	O
image	O
,	O
we	O
first	O
use	O
a	O
stem	O
CNN	Method
to	O
transform	O
from	O
raw	O
pixels	O
to	O
convolutional	O
feature	O
maps	O
.	O
A	O
pedestrian	Method
proposal	Method
net	Method
is	O
built	O
upon	O
these	O
feature	O
maps	O
to	O
predict	O
bounding	O
boxes	O
of	O
candidate	O
people	O
,	O
which	O
are	O
then	O
fed	O
into	O
an	O
identification	Method
net	Method
with	O
RoI	Method
-	Method
Pooling	Method
to	O
extract	O
L2	O
-	O
normalized	O
-	O
d	O
features	O
for	O
each	O
of	O
them	O
.	O
At	O
inference	Task
stage	Task
,	O
we	O
rank	O
the	O
gallery	O
people	O
according	O
to	O
their	O
feature	O
distances	O
to	O
the	O
target	O
person	O
.	O
At	O
training	O
stage	O
,	O
we	O
propose	O
an	O
Online	Method
Instance	Method
Matching	Method
(	O
OIM	Method
)	O
loss	O
function	O
on	O
top	O
of	O
the	O
feature	O
vectors	O
to	O
supervise	O
the	O
identification	Task
net	Task
,	O
together	O
with	O
several	O
other	O
loss	Method
functions	Method
for	O
training	O
the	O
proposal	Method
net	Method
in	O
a	O
multi	Task
-	Task
task	Task
manner	Task
.	O
Below	O
we	O
will	O
first	O
detail	O
the	O
CNN	Method
model	O
structure	O
,	O
and	O
then	O
elaborate	O
on	O
the	O
OIM	Method
loss	O
function	O
.	O
subsection	O
:	O
Model	O
Structure	O
We	O
adopt	O
the	O
ResNet	Method
-	Method
50	Method
as	O
our	O
base	O
CNN	Method
model	O
.	O
It	O
has	O
a	O
convolution	Method
layer	Method
in	O
front	O
(	O
named	O
conv1	O
)	O
,	O
followed	O
by	O
four	O
blocks	O
(	O
named	O
conv2_x	O
to	O
conv5_x	O
)	O
each	O
containing	O
residual	O
units	O
,	O
respectively	O
.	O
We	O
exploit	O
conv1	Method
to	O
conv4_3	O
as	O
the	O
stem	O
part	O
.	O
Given	O
an	O
input	O
image	O
,	O
the	O
stem	O
will	O
produce	O
channels	O
of	O
features	O
maps	O
,	O
which	O
have	O
resolutions	O
of	O
the	O
original	O
image	O
.	O
On	O
top	O
of	O
these	O
feature	O
maps	O
,	O
we	O
build	O
a	O
pedestrian	Method
proposal	Method
network	Method
to	O
detect	O
person	O
candidates	O
.	O
A	O
convolutional	Method
layer	Method
is	O
first	O
added	O
to	O
transform	O
the	O
features	O
specifically	O
for	O
pedestrians	O
.	O
Then	O
we	O
follow	O
to	O
associate	O
anchors	O
at	O
each	O
feature	O
map	O
location	O
,	O
and	O
use	O
a	O
Softmax	Method
classifier	Method
to	O
predict	O
whether	O
each	O
anchor	O
is	O
a	O
pedestrian	O
or	O
not	O
,	O
as	O
well	O
as	O
a	O
linear	Method
regression	Method
to	O
adjust	O
their	O
locations	O
.	O
We	O
will	O
keep	O
the	O
top	O
adjusted	O
bounding	O
boxes	O
after	O
non	O
-	O
maximum	O
suppression	O
as	O
our	O
final	O
proposals	O
.	O
To	O
find	O
the	O
target	O
person	O
among	O
all	O
these	O
proposals	O
,	O
we	O
build	O
an	O
identification	Method
net	Method
to	O
extract	O
the	O
features	O
of	O
each	O
proposal	O
,	O
and	O
compare	O
against	O
the	O
target	O
ones	O
.	O
We	O
first	O
exploit	O
an	O
RoI	Method
-	Method
Pooling	Method
layer	Method
to	O
pool	O
a	O
region	O
from	O
the	O
stem	O
feature	O
maps	O
for	O
each	O
proposal	O
.	O
Then	O
they	O
are	O
passed	O
through	O
the	O
rest	O
conv4_4	Method
to	O
conv5_3	O
of	O
the	O
ResNet	Method
-	Method
50	Method
,	O
followed	O
by	O
a	O
global	Method
average	Method
pooling	Method
layer	Method
to	O
summarize	O
into	O
a	O
dimensional	O
feature	O
vector	O
.	O
On	O
one	O
hand	O
,	O
as	O
the	O
pedestrian	O
proposals	O
would	O
inevitably	O
contain	O
some	O
false	O
alarms	O
and	O
misalignments	O
,	O
we	O
use	O
again	O
a	O
Softmax	Method
classifier	Method
and	O
a	O
linear	Method
regression	Method
to	O
reject	O
non	O
-	O
persons	O
and	O
refine	O
the	O
locations	O
.	O
On	O
the	O
other	O
hand	O
,	O
we	O
project	O
the	O
features	O
into	O
a	O
L2	O
-	O
normalized	O
dimensional	O
subspace	O
(	O
i	O
d	O
-	O
feat	O
)	O
,	O
and	O
use	O
them	O
to	O
compute	O
cosine	O
similarities	O
with	O
the	O
target	O
person	O
when	O
doing	O
inference	Task
.	O
During	O
the	O
training	O
stage	O
,	O
we	O
supervise	O
the	O
i	Method
d	Method
-	Method
feat	Method
with	O
the	O
proposed	O
OIM	Method
loss	O
function	O
.	O
Together	O
with	O
other	O
loss	Method
functions	Method
for	O
detection	Task
,	O
the	O
whole	O
net	O
is	O
jointly	O
trained	O
in	O
a	O
multi	Task
-	Task
task	Task
learning	Task
manner	Task
,	O
rather	O
than	O
using	O
the	O
alternative	O
optimizations	O
in	O
.	O
subsection	O
:	O
Online	Method
Instance	Method
Matching	Method
Loss	O
There	O
are	O
three	O
different	O
types	O
of	O
proposals	O
,	O
labeled	O
identities	O
,	O
unlabeled	O
identities	O
,	O
and	O
background	O
clutter	O
.	O
Suppose	O
there	O
are	O
different	O
target	O
people	O
in	O
the	O
training	O
set	O
,	O
when	O
a	O
proposal	O
matches	O
a	O
target	O
person	O
,	O
we	O
call	O
it	O
an	O
instance	O
of	O
the	O
labeled	O
identity	O
,	O
and	O
assign	O
a	O
class	O
-	O
i	O
d	O
(	O
from	O
to	O
)	O
to	O
it	O
accordingly	O
.	O
There	O
are	O
also	O
lots	O
of	O
proposals	O
predicting	O
pedestrians	O
correctly	O
,	O
but	O
do	O
not	O
belong	O
to	O
anyone	O
of	O
our	O
target	O
people	O
.	O
We	O
call	O
them	O
unlabeled	O
identities	O
in	O
such	O
cases	O
.	O
We	O
demonstrate	O
some	O
examples	O
of	O
labeled	O
and	O
unlabeled	O
identities	O
in	O
Figure	O
[	O
reference	O
]	O
with	O
blue	O
and	O
orange	O
bounding	O
boxes	O
,	O
respectively	O
.	O
Other	O
proposals	O
are	O
just	O
false	O
alarms	O
on	O
other	O
objects	O
or	O
background	O
regions	O
.	O
In	O
the	O
proposed	O
loss	Method
function	Method
,	O
we	O
only	O
consider	O
the	O
labeled	O
and	O
unlabeled	O
identities	O
,	O
while	O
leave	O
the	O
other	O
proposals	O
untouched	O
.	O
As	O
our	O
goal	O
is	O
to	O
distinguish	O
different	O
people	O
,	O
a	O
natural	O
objective	O
is	O
to	O
minimize	O
the	O
features	O
discrepancy	O
among	O
the	O
instances	O
of	O
the	O
same	O
person	O
,	O
while	O
maximize	O
the	O
discrepancy	O
among	O
different	O
people	O
.	O
To	O
fulfill	O
this	O
goal	O
,	O
we	O
need	O
to	O
memorize	O
the	O
features	O
of	O
all	O
the	O
people	O
.	O
This	O
could	O
be	O
done	O
offline	O
by	O
doing	O
network	Method
forward	Method
on	O
all	O
the	O
training	O
images	O
,	O
but	O
it	O
is	O
not	O
practical	O
when	O
using	O
stochastic	Method
gradient	Method
descent	Method
(	O
SGD	Method
)	Method
for	O
optimization	Task
.	O
Thus	O
in	O
our	O
approach	O
,	O
we	O
choose	O
an	O
online	Method
approximation	Method
instead	O
.	O
Denote	O
the	O
features	O
of	O
a	O
labeled	O
identity	O
inside	O
a	O
mini	O
-	O
batch	O
by	O
,	O
where	O
is	O
the	O
feature	O
dimension	O
,	O
we	O
maintain	O
a	O
lookup	O
table	O
(	O
LUT	O
)	O
to	O
store	O
the	O
features	O
of	O
all	O
the	O
labeled	O
identities	O
,	O
as	O
demonstrated	O
in	O
Figure	O
[	O
reference	O
]	O
.	O
During	O
the	O
forward	Method
propagation	Method
,	O
we	O
compute	O
cosine	O
similarities	O
between	O
the	O
mini	O
-	O
batch	O
sample	O
and	O
all	O
the	O
labeled	O
identities	O
by	O
.	O
During	O
backward	O
,	O
if	O
the	O
target	O
class	O
-	O
i	O
d	O
is	O
,	O
then	O
we	O
will	O
update	O
the	O
-	O
th	O
column	O
of	O
the	O
LUT	O
by	O
,	O
where	O
,	O
and	O
then	O
scale	O
to	O
have	O
unit	O
L2	O
-	O
norm	O
.	O
Apart	O
from	O
labeled	O
identities	O
,	O
many	O
unlabeled	O
identities	O
are	O
also	O
valuable	O
for	O
learning	O
feature	Method
representations	Method
.	O
They	O
can	O
be	O
safely	O
used	O
as	O
negative	O
classes	O
for	O
all	O
the	O
labeled	O
identities	O
.	O
We	O
use	O
a	O
circular	O
queue	O
to	O
store	O
the	O
features	O
of	O
these	O
unlabeled	O
identities	O
that	O
appear	O
in	O
recent	O
mini	O
-	O
batches	O
.	O
Denote	O
the	O
features	O
in	O
this	O
circular	O
queue	O
by	O
,	O
where	O
is	O
the	O
queue	O
size	O
,	O
we	O
can	O
also	O
compute	O
their	O
cosine	O
similarities	O
with	O
the	O
mini	O
-	O
batch	O
sample	O
by	O
.	O
After	O
each	O
iteration	O
,	O
we	O
push	O
the	O
new	O
feature	O
vectors	O
into	O
the	O
queue	O
,	O
while	O
pop	O
the	O
out	O
-	O
of	O
-	O
date	O
ones	O
to	O
keep	O
the	O
queue	O
size	O
unchanged	O
.	O
Based	O
on	O
these	O
two	O
data	O
structures	O
,	O
we	O
define	O
the	O
probability	O
of	O
being	O
recognized	O
as	O
the	O
identity	O
with	O
class	O
-	O
i	O
d	O
by	O
a	O
Softmax	Method
function	Method
where	O
higher	O
temperature	O
leads	O
to	O
softer	O
probability	O
distribution	O
.	O
Similarly	O
,	O
the	O
probability	O
of	O
being	O
recognized	O
as	O
the	O
-	O
th	O
unlabeled	O
identity	O
in	O
the	O
circular	O
queue	O
is	O
OIM	Method
objective	O
is	O
to	O
maximize	O
the	O
expected	O
log	O
-	O
likelihood	O
and	O
its	O
gradient	O
with	O
respect	O
to	O
can	O
be	O
derived	O
as	O
It	O
can	O
be	O
seen	O
that	O
our	O
OIM	Method
loss	O
effectively	O
compares	O
the	O
mini	O
-	O
batch	O
sample	O
with	O
all	O
the	O
labeled	O
and	O
unlabeled	O
identities	O
,	O
driving	O
the	O
underlying	O
feature	O
vector	O
to	O
be	O
similar	O
with	O
the	O
target	O
one	O
,	O
while	O
pushing	O
it	O
away	O
from	O
the	O
others	O
.	O
Why	O
not	O
Softmax	O
loss	O
?	O
A	O
natural	O
question	O
here	O
is	O
that	O
why	O
not	O
learning	O
a	O
classifier	Method
matrix	Method
with	O
a	O
conventional	O
Softmax	O
loss	O
to	O
predict	O
the	O
class	O
-	O
i	O
d	O
.	O
There	O
are	O
mainly	O
two	O
drawbacks	O
.	O
First	O
,	O
large	O
-	O
scale	O
person	O
search	O
datasets	O
would	O
have	O
a	O
large	O
number	O
of	O
identities	O
(	O
more	O
than	O
in	O
our	O
training	O
set	O
)	O
,	O
while	O
each	O
identity	O
only	O
has	O
several	O
instances	O
and	O
each	O
image	O
only	O
contains	O
a	O
few	O
identities	O
.	O
We	O
need	O
to	O
learn	O
more	O
than	O
discriminant	O
functions	O
simultaneously	O
,	O
but	O
during	O
each	O
SGD	Method
iteration	Method
we	O
only	O
have	O
positive	O
samples	O
from	O
tens	O
of	O
classes	O
.	O
The	O
classifier	Method
matrix	Method
suffers	O
from	O
large	O
variance	O
of	O
gradients	O
and	O
thus	O
can	O
not	O
be	O
learned	O
effectively	O
,	O
even	O
with	O
proper	O
pre	Method
-	Method
training	Method
and	O
high	O
momentum	O
.	O
Second	O
,	O
we	O
can	O
not	O
exploit	O
the	O
unlabeled	O
identities	O
with	O
Softmax	O
loss	O
,	O
as	O
they	O
have	O
no	O
specific	O
class	O
-	O
ids	O
.	O
Although	O
our	O
OIM	Method
loss	O
formulation	O
is	O
similar	O
to	O
the	O
Softmax	Method
one	Method
,	O
the	O
major	O
difference	O
is	O
that	O
the	O
OIM	Method
loss	O
is	O
non	O
-	O
parametric	O
.	O
The	O
LUT	O
and	O
circular	O
queue	O
are	O
considered	O
as	O
external	O
buffer	O
,	O
rather	O
than	O
the	O
network	O
parameters	O
.	O
The	O
gradients	O
directly	O
operate	O
on	O
the	O
features	O
without	O
the	O
transformation	O
by	O
a	O
classifier	Method
matrix	Method
.	O
The	O
potential	O
drawback	O
of	O
this	O
non	Method
-	Method
parametric	Method
loss	Method
is	O
that	O
it	O
could	O
overfit	O
more	O
easily	O
.	O
We	O
find	O
that	O
projecting	O
the	O
features	O
into	O
a	O
L2	O
-	O
normalized	O
low	O
-	O
dimensional	O
subspace	O
helps	O
reduce	O
overfitting	O
.	O
Scalability	O
.	O
Computing	O
the	O
partition	O
function	O
in	O
Eq	O
(	O
[	O
reference	O
]	O
)	O
and	O
Eq	O
(	O
[	O
reference	O
]	O
)	O
could	O
be	O
time	O
consuming	O
when	O
the	O
number	O
of	O
identities	O
increases	O
.	O
To	O
overcome	O
this	O
problem	O
,	O
we	O
can	O
approximate	O
the	O
denominators	O
by	O
sub	O
-	O
sampling	O
the	O
labeled	O
and	O
unlabeled	O
identities	O
,	O
which	O
results	O
in	O
optimizing	O
a	O
lower	Metric
-	Metric
bound	Metric
of	O
Eq	O
(	O
[	O
reference	O
]	O
)	O
.	O
section	O
:	O
Dataset	O
We	O
collect	O
and	O
annotate	O
a	O
large	O
-	O
scale	O
person	O
search	O
dataset	O
to	O
evaluate	O
of	O
our	O
proposed	O
method	O
.	O
We	O
exploit	O
two	O
data	O
sources	O
to	O
diversify	O
the	O
scenes	O
.	O
On	O
one	O
hand	O
,	O
we	O
use	O
hand	Method
-	Method
held	Method
cameras	Method
to	O
shoot	O
street	O
snaps	O
around	O
an	O
urban	O
city	O
.	O
On	O
the	O
other	O
hand	O
,	O
we	O
collect	O
from	O
movie	O
snapshots	O
that	O
contain	O
pedestrians	O
,	O
as	O
they	O
could	O
enrich	O
the	O
variations	O
of	O
viewpoints	O
,	O
lighting	O
,	O
and	O
background	O
conditions	O
.	O
In	O
this	O
section	O
,	O
we	O
will	O
show	O
the	O
basic	O
statistics	O
of	O
our	O
dataset	O
,	O
as	O
well	O
as	O
define	O
the	O
evaluation	Metric
protocols	Metric
and	O
metrics	O
.	O
subsection	O
:	O
Statistics	O
After	O
collecting	O
all	O
the	O
images	O
,	O
we	O
first	O
densely	O
annotate	O
all	O
the	O
pedestrians	O
bounding	O
boxes	O
in	O
these	O
scenes	O
,	O
and	O
then	O
associate	O
the	O
person	O
that	O
appears	O
across	O
different	O
images	O
,	O
resulting	O
in	O
labeled	O
identities	O
.	O
The	O
statistics	O
of	O
two	O
data	O
sources	O
are	O
listed	O
in	O
Table	O
[	O
reference	O
]	O
.	O
We	O
did	O
not	O
annotate	O
those	O
people	O
who	O
appear	O
with	O
half	O
bodies	O
or	O
abnormal	O
poses	O
such	O
as	O
sitting	O
or	O
squatting	O
.	O
Moreover	O
,	O
people	O
who	O
change	O
clothes	O
and	O
decorations	O
in	O
different	O
video	O
frames	O
are	O
not	O
associated	O
in	O
our	O
dataset	O
,	O
since	O
person	Task
search	Task
problem	Task
requires	O
to	O
recognize	O
identities	O
mainly	O
according	O
to	O
their	O
clothes	O
and	O
body	O
shapes	O
rather	O
than	O
faces	O
.	O
We	O
ensure	O
that	O
the	O
background	O
pedestrians	O
do	O
not	O
contain	O
labeled	O
identities	O
,	O
and	O
thus	O
they	O
can	O
be	O
safely	O
served	O
as	O
negative	O
samples	O
for	O
identification	Task
.	O
Note	O
that	O
we	O
also	O
ignore	O
the	O
background	O
pedestrians	O
whose	O
heights	O
are	O
smaller	O
than	O
pixels	O
,	O
as	O
they	O
would	O
be	O
hard	O
to	O
recognize	O
even	O
for	O
human	Task
labelers	Task
.	O
The	O
height	O
distributions	O
of	O
labeled	O
and	O
unlabeled	O
identities	O
are	O
demonstrated	O
in	O
Figure	O
[	O
reference	O
]	O
.	O
It	O
can	O
be	O
seen	O
that	O
our	O
dataset	O
has	O
rich	O
variations	O
of	O
pedestrian	O
scales	O
.	O
subsection	O
:	O
Evaluation	Metric
Protocols	Metric
and	O
Metrics	O
We	O
split	O
the	O
dataset	O
into	O
a	O
training	O
and	O
a	O
test	O
subset	O
,	O
ensuring	O
no	O
overlapped	O
images	O
or	O
labeled	O
identities	O
between	O
them	O
.	O
Table	O
[	O
reference	O
]	O
shows	O
the	O
statistics	O
of	O
these	O
two	O
subsets	O
.	O
We	O
divide	O
the	O
test	O
identity	O
instances	O
into	O
queries	O
and	O
galleries	O
.	O
For	O
each	O
of	O
the	O
test	O
identities	O
,	O
we	O
randomly	O
choose	O
one	O
of	O
his	O
/	O
her	O
instances	O
as	O
the	O
query	O
,	O
while	O
the	O
corresponding	O
gallery	O
set	O
consists	O
of	O
two	O
parts	O
—	O
all	O
the	O
images	O
containing	O
the	O
other	O
instances	O
and	O
some	O
randomly	O
sampled	O
images	O
not	O
containing	O
this	O
person	O
.	O
Different	O
queries	O
have	O
different	O
galleries	O
,	O
and	O
jointly	O
they	O
cover	O
all	O
the	O
test	O
images	O
.	O
To	O
better	O
understand	O
how	O
gallery	O
size	O
would	O
affect	O
the	O
person	Task
search	Task
performance	O
,	O
we	O
define	O
a	O
set	O
of	O
protocols	O
with	O
gallery	O
size	O
ranging	O
from	O
to	O
.	O
Taking	O
gallery	O
size	O
of	O
as	O
an	O
example	O
,	O
as	O
each	O
image	O
approximately	O
contains	O
pedestrians	O
,	O
then	O
our	O
task	O
is	O
to	O
find	O
the	O
target	O
person	O
among	O
about	O
people	O
.	O
This	O
setting	O
is	O
comparable	O
with	O
existing	O
person	Task
re	Task
-	Task
i	Task
d	Task
datasets	Task
(	O
,	O
CUHK	O
-	O
03	O
,	O
VIPeR	O
)	O
in	O
terms	O
of	O
the	O
number	O
of	O
gallery	O
pedestrians	O
,	O
and	O
is	O
even	O
more	O
challenging	O
as	O
there	O
could	O
be	O
thousands	O
of	O
background	O
clutter	O
bounding	O
boxes	O
distracting	O
our	O
attentions	O
.	O
We	O
employ	O
two	O
kinds	O
of	O
evaluation	Metric
metrics	Metric
—	O
cumulative	Metric
matching	Metric
characteristics	Metric
(	O
CMC	Metric
top	Metric
-	Metric
K	Metric
)	O
and	O
mean	Metric
averaged	Metric
precision	Metric
(	O
mAP	Metric
)	O
.	O
The	O
first	O
one	O
is	O
inherited	O
from	O
the	O
person	Task
re	Task
-	Task
i	Task
d	Task
problem	Task
,	O
where	O
a	O
matching	Task
is	O
counted	O
if	O
there	O
is	O
at	O
least	O
one	O
of	O
the	O
top	O
-	O
K	O
predicted	O
bounding	O
boxes	O
overlaps	O
with	O
the	O
ground	O
truths	O
with	O
intersection	Metric
-	Metric
over	Metric
-	Metric
union	Metric
(	O
IoU	Metric
)	O
greater	O
or	O
equal	O
to	O
.	O
The	O
second	O
one	O
is	O
inspired	O
from	O
the	O
object	O
detection	Task
tasks	O
.	O
We	O
follow	O
the	O
ILSVRC	O
object	O
detection	Task
criterion	O
to	O
judge	O
the	O
correctness	O
of	O
predicted	O
bounding	O
boxes	O
.	O
An	O
averaged	Metric
precision	Metric
(	O
AP	Metric
)	O
is	O
calculated	O
for	O
each	O
query	O
based	O
on	O
the	O
precision	Metric
-	Metric
recall	Metric
curve	Metric
,	O
and	O
then	O
we	O
average	O
the	O
APs	O
across	O
all	O
the	O
queries	O
to	O
get	O
the	O
final	O
result	O
.	O
section	O
:	O
Experiments	O
To	O
evaluate	O
the	O
effectiveness	O
of	O
our	O
approach	O
and	O
study	O
the	O
impact	O
of	O
various	O
factors	O
on	O
person	Task
search	Task
performance	O
,	O
we	O
conduct	O
several	O
groups	O
of	O
experiments	O
on	O
the	O
new	O
dataset	O
.	O
In	O
this	O
section	O
,	O
we	O
first	O
detail	O
the	O
baseline	O
methods	O
and	O
experiment	O
settings	O
in	O
Section	O
[	O
reference	O
]	O
.	O
Then	O
we	O
compare	O
our	O
joint	Method
framework	Method
with	O
the	O
baselines	O
of	O
using	O
separate	O
pedestrian	O
detection	Task
and	O
person	Task
re	Task
-	Task
identification	Task
in	O
Section	O
[	O
reference	O
]	O
.	O
Section	O
[	O
reference	O
]	O
shows	O
the	O
effectiveness	O
of	O
our	O
proposed	O
Online	Method
Instance	Method
Matching	Method
(	O
OIM	Method
)	O
loss	O
.	O
At	O
last	O
,	O
we	O
present	O
the	O
influence	O
of	O
various	O
factors	O
,	O
including	O
detection	Task
recall	O
and	O
gallery	Metric
size	Metric
.	O
subsection	O
:	O
Experiment	O
Settings	O
We	O
implement	O
our	O
framework	O
based	O
on	O
Caffe	Method
and	O
py	Method
-	Method
faster	Method
-	Method
rcnn	Method
.	O
ImageNet	Method
-	Method
pretrained	Method
ResNet	Method
-	Method
50	Method
are	O
exploited	O
for	O
parameters	Task
initialization	Task
.	O
We	O
fix	O
the	O
first	O
convolution	Method
layer	Method
and	O
the	O
batch	Method
normalization	Method
(	O
BN	Method
)	O
layers	O
as	O
constant	O
affine	O
transformations	O
in	O
the	O
stem	O
part	O
,	O
while	O
keep	O
the	O
other	O
BN	Method
layers	O
as	O
normal	O
in	O
the	O
identification	O
part	O
.	O
The	O
temperature	O
scalar	O
in	O
Eq	O
.	O
(	O
[	O
reference	O
]	O
)	O
and	O
Eq	O
.	O
(	O
[	O
reference	O
]	O
)	O
is	O
set	O
to	O
,	O
the	O
size	O
of	O
the	O
circular	O
queue	O
is	O
set	O
to	O
.	O
All	O
the	O
losses	O
have	O
the	O
same	O
loss	O
weight	O
.	O
Each	O
mini	O
-	O
batch	O
consists	O
of	O
two	O
scene	O
images	O
.	O
The	O
learning	Metric
rate	Metric
is	O
initialized	O
to	O
,	O
dropped	O
to	O
after	O
K	O
iterations	O
,	O
and	O
kept	O
unchanged	O
until	O
the	O
model	O
converges	O
at	O
K	O
iterations	O
.	O
We	O
compare	O
our	O
framework	O
with	O
conventional	O
methods	O
that	O
break	O
down	O
the	O
problem	O
into	O
two	O
separate	O
tasks	O
—	O
pedestrian	O
detection	Task
and	O
person	Task
re	Task
-	Task
identification	Task
.	O
Three	O
pedestrian	O
detection	Task
and	O
five	O
person	O
re	Task
-	Task
i	Task
d	Task
methods	O
are	O
used	O
in	O
our	O
experiments	O
,	O
resulting	O
in	O
baseline	O
combinations	O
.	O
For	O
pedestrian	O
detection	Task
,	O
we	O
directly	O
use	O
the	O
off	Method
-	Method
the	Method
-	Method
shelf	Method
deep	Method
learning	Method
CCF	Method
detector	Method
,	O
as	O
well	O
as	O
two	O
other	O
detectors	O
specifically	O
fine	O
-	O
tuned	O
on	O
our	O
dataset	O
.	O
One	O
is	O
the	O
ACF	Method
,	O
and	O
the	O
other	O
is	O
Faster	Method
-	Method
RCNN	Method
(	O
CNN	Method
)	O
with	O
ResNet	Method
-	Method
50	Method
,	O
which	O
is	O
equivalent	O
to	O
our	O
framework	O
but	O
without	O
the	O
identification	Task
task	Task
.	O
The	O
recall	Metric
-	Metric
precision	Metric
curve	Metric
of	O
each	O
detector	O
on	O
our	O
dataset	O
are	O
plotted	O
in	O
Figure	O
[	O
reference	O
]	O
.	O
We	O
also	O
use	O
the	O
ground	O
truth	O
(	O
GT	O
)	O
bounding	O
boxes	O
as	O
the	O
results	O
of	O
a	O
perfect	Method
detector	Method
.	O
For	O
person	Task
re	Task
-	Task
identification	Task
,	O
we	O
use	O
several	O
popular	O
re	Task
-	Task
i	Task
d	Task
feature	O
representations	O
,	O
including	O
DenseSIFT	Method
-	Method
ColorHist	Method
(	Method
DSIFT	Method
)	O
,	O
Bag	Method
of	Method
Words	Method
(	O
BoW	Method
)	O
,	O
and	O
Local	Method
Maximal	Method
Occurrence	Method
(	O
LOMO	Method
)	O
.	O
Each	O
feature	Method
representation	Method
is	O
used	O
in	O
conjunction	O
with	O
a	O
specific	O
distance	Metric
metric	Metric
,	O
including	O
Euclidean	O
,	O
Cosine	O
similarity	O
,	O
KISSME	Method
,	O
and	O
XQDA	Method
,	O
where	O
KISSME	Method
and	O
XQDA	Method
are	O
trained	O
on	O
our	O
dataset	O
.	O
Moreover	O
,	O
by	O
discarding	O
the	O
pedestrian	Method
proposal	Method
network	Method
in	O
our	O
framework	O
and	O
training	O
the	O
remaining	O
net	O
to	O
classify	O
identities	O
with	O
Softmax	O
loss	O
from	O
cropped	O
pedestrian	O
images	O
,	O
we	O
get	O
another	O
baseline	O
re	Task
-	Task
i	Task
d	Task
method	O
(	O
IDNet	Method
)	O
.	O
This	O
training	O
scheme	O
has	O
been	O
exploited	O
in	O
to	O
learn	O
discriminative	O
re	Task
-	Task
i	Task
d	Task
feature	O
representations	O
.	O
In	O
our	O
experiments	O
,	O
when	O
training	O
IDNet	Task
with	O
detector	O
boxes	O
,	O
we	O
found	O
that	O
adding	O
background	O
clutter	O
as	O
a	O
unique	O
class	O
improves	O
the	O
result	O
,	O
while	O
adding	O
unlabeled	O
identities	O
does	O
not	O
.	O
The	O
following	O
results	O
are	O
reported	O
using	O
the	O
protocol	O
with	O
gallery	O
size	O
equal	O
to	O
if	O
not	O
specified	O
.	O
subsection	O
:	O
Comparison	O
with	O
Detection	Task
and	O
Re	Task
-	Task
ID	Task
We	O
first	O
compare	O
our	O
proposed	O
person	Method
search	Method
framework	Method
(	O
with	O
or	O
without	O
using	O
unlabeled	O
identities	O
)	O
with	O
other	O
baseline	O
combinations	O
that	O
break	O
down	O
the	O
problem	O
into	O
separate	O
detection	Task
and	O
re	Task
-	Task
identification	Task
tasks	Task
.	O
The	O
results	O
are	O
summarized	O
in	O
Table	O
[	O
reference	O
]	O
.	O
Our	O
method	O
outperforms	O
the	O
others	O
by	O
large	O
margin	O
.	O
Comparing	O
with	O
CNN	Method
+	O
IDNet	O
,	O
the	O
gain	O
comes	O
from	O
the	O
joint	O
optimization	O
of	O
the	O
detection	Task
and	O
identification	O
parts	O
,	O
as	O
well	O
as	O
the	O
effective	O
use	O
of	O
unlabeled	O
identities	O
in	O
the	O
OIM	Method
loss	O
.	O
From	O
Table	O
[	O
reference	O
]	O
we	O
can	O
also	O
see	O
that	O
different	O
detectors	O
affect	O
the	O
person	Task
search	Task
performance	O
significantly	O
for	O
each	O
re	Task
-	Task
i	Task
d	Task
method	O
.	O
Directly	O
using	O
an	O
off	Method
-	Method
the	Method
-	Method
shelf	Method
detector	Method
may	O
not	O
be	O
a	O
good	O
choice	O
when	O
applying	O
existing	O
re	Task
-	Task
i	Task
d	Task
methods	Task
in	O
the	O
real	Task
-	Task
world	Task
person	Task
search	Task
applications	Task
.	O
Otherwise	O
the	O
detector	Method
could	O
become	O
a	O
bottleneck	O
that	O
diminishes	O
the	O
returns	O
of	O
better	O
re	Task
-	Task
i	Task
d	Task
methods	Task
.	O
On	O
the	O
other	O
hand	O
,	O
the	O
relative	O
performance	O
of	O
different	O
re	Task
-	Task
i	Task
d	Task
methods	Task
are	O
consistent	O
across	O
all	O
the	O
detectors	O
.	O
It	O
implies	O
that	O
existing	O
person	O
re	Task
-	Task
i	Task
d	Task
datasets	O
could	O
still	O
guide	O
us	O
to	O
design	O
better	O
feature	Method
representations	Method
,	O
but	O
it	O
may	O
lose	O
some	O
valuable	O
data	O
,	O
such	O
as	O
unlabeled	O
identities	O
and	O
background	O
clutter	O
,	O
which	O
come	O
with	O
the	O
person	O
search	O
datasets	O
.	O
Another	O
interesting	O
phenomenon	O
is	O
that	O
although	O
IDNet	Method
and	O
LOMO	Method
+	Method
XQDA	Method
have	O
similar	O
performance	O
when	O
using	O
GT	O
or	O
fine	O
-	O
tuned	O
ACF	O
and	O
CNN	Method
detectors	O
,	O
IDNet	Method
is	O
significantly	O
better	O
when	O
using	O
off	Method
-	Method
the	Method
-	Method
shelf	Method
CCF	Method
detector	Method
.	O
We	O
observe	O
that	O
the	O
CCF	O
detection	Task
results	O
contain	O
many	O
misalignments	O
.	O
Hand	O
-	O
crafted	O
features	O
in	O
such	O
cases	O
are	O
not	O
as	O
robust	O
as	O
the	O
IDNet	Method
counterpart	Method
.	O
subsection	O
:	O
Effectiveness	O
of	O
Online	Method
Instance	Method
Matching	Method
We	O
validate	O
the	O
effectiveness	O
of	O
the	O
proposed	O
Online	Method
Instance	Method
Matching	Method
(	O
OIM	Method
)	O
loss	O
by	O
comparing	O
it	O
against	O
Softmax	Method
baselines	Method
with	O
or	O
without	O
pretraining	O
the	O
classifier	O
matrix	O
.	O
The	O
training	Metric
identification	Metric
accuracy	Metric
and	O
test	O
person	Metric
search	Metric
mAP	Metric
curves	Metric
are	O
demonstrated	O
in	O
Figure	O
[	O
reference	O
]	O
.	O
First	O
,	O
we	O
can	O
see	O
that	O
using	O
Softmax	Method
loss	Method
without	O
pretraining	Method
classifier	Method
remains	O
at	O
low	O
accuracy	Metric
during	O
the	O
whole	O
process	O
.	O
This	O
phenomenon	O
verifies	O
our	O
analysis	O
in	O
Section	O
[	O
reference	O
]	O
that	O
learning	O
a	O
large	O
classifier	O
matrix	O
is	O
difficult	O
.	O
Even	O
with	O
proper	O
pretraining	Method
,	O
the	O
training	Metric
accuracy	Metric
still	O
improves	O
slowly	O
,	O
and	O
the	O
test	O
mAP	Metric
keeps	O
at	O
around	O
.	O
On	O
the	O
contrary	O
,	O
the	O
proposed	O
OIM	Method
loss	O
starts	O
with	O
a	O
low	O
training	Metric
accuracy	Metric
but	O
converges	O
much	O
faster	O
and	O
also	O
consistently	O
improves	O
the	O
test	O
performance	O
.	O
The	O
parameter	O
-	O
free	O
OIM	Method
loss	O
learns	O
features	O
directly	O
without	O
needing	O
to	O
learn	O
a	O
big	O
classifier	O
matrix	O
.	O
Moreover	O
,	O
the	O
mismatch	O
between	O
training	O
and	O
test	O
criterion	O
no	O
longer	O
exists	O
,	O
as	O
both	O
are	O
computed	O
based	O
on	O
the	O
inner	O
product	O
of	O
L2	O
-	O
normalized	O
feature	O
vectors	O
,	O
which	O
represents	O
the	O
cosine	O
similarity	O
.	O
We	O
further	O
evaluate	O
the	O
impact	O
of	O
OIM	Method
loss	O
on	O
the	O
standard	O
person	Task
re	Task
-	Task
identification	Task
task	O
.	O
We	O
train	O
two	O
different	O
base	Method
CNNs	Method
,	O
Inception	Method
(	O
from	O
scratch	O
)	O
and	O
ResNet	Method
-	Method
50	Method
(	O
ImageNet	O
pretrained	O
)	O
,	O
with	O
either	O
Softmax	O
loss	O
or	O
OIM	Method
loss	O
,	O
on	O
three	O
large	O
-	O
scale	O
person	O
re	Task
-	Task
i	Task
d	Task
datasets	O
,	O
CUHK03	O
,	O
Market1501	O
,	O
and	O
Duke	Material
.	O
Following	O
their	O
own	O
protocols	O
,	O
we	O
evaluate	O
the	O
CMC	Metric
top	Metric
-	Metric
1	Metric
accuracy	Metric
of	O
using	O
different	O
loss	O
functions	O
,	O
as	O
listed	O
in	O
Table	O
[	O
reference	O
]	O
.	O
OIM	Method
loss	O
consistently	O
outperforms	O
Softmax	O
loss	O
,	O
regardless	O
of	O
which	O
base	O
CNN	Method
is	O
used	O
.	O
We	O
refer	O
readers	O
to	O
Open	O
-	O
ReID	O
benchmarks	O
for	O
more	O
details	O
.	O
[	O
t	O
]	O
0.32	O
[	O
t	O
]	O
0.32	O
[	O
t	O
]	O
0.32	O
Sub	O
-	O
sampling	O
the	O
identities	O
.	O
As	O
the	O
number	O
of	O
identities	O
increases	O
,	O
the	O
computation	Metric
time	Metric
of	O
the	O
OIM	Method
loss	O
could	O
become	O
the	O
bottleneck	O
of	O
the	O
whole	O
system	O
.	O
Thus	O
we	O
proposed	O
in	O
Section	O
[	O
reference	O
]	O
to	O
approximate	O
Eq	O
.	O
(	O
[	O
reference	O
]	O
)	O
and	O
Eq	O
.	O
(	O
[	O
reference	O
]	O
)	O
by	O
sub	O
-	O
sampling	O
both	O
the	O
labeled	O
and	O
unlabeled	O
identities	O
in	O
the	O
denominators	O
.	O
We	O
validate	O
this	O
approach	O
here	O
by	O
training	O
the	O
framework	O
with	O
sub	O
-	O
sampling	O
size	O
of	O
,	O
,	O
and	O
.	O
The	O
test	O
mAP	Metric
curves	O
are	O
demonstrated	O
in	O
Figure	O
[	O
reference	O
]	O
.	O
In	O
general	O
,	O
sub	O
-	O
sampling	O
a	O
small	O
number	O
of	O
identities	O
relaxes	O
the	O
training	Metric
objective	Metric
,	O
which	O
leads	O
to	O
slightly	O
inferior	O
performance	O
but	O
much	O
faster	O
convergence	Metric
rate	Metric
.	O
This	O
indicates	O
that	O
our	O
framework	O
is	O
scalable	O
to	O
larger	O
datasets	O
with	O
even	O
more	O
identities	O
by	O
using	O
proper	O
sub	Metric
-	Metric
sampling	Metric
rate	Metric
.	O
Low	Method
-	Method
dimensional	Method
subspace	Method
.	O
We	O
further	O
investigate	O
how	O
the	O
dimension	O
of	O
the	O
L2	O
-	O
normalized	O
feature	O
vector	O
affects	O
the	O
person	Task
search	Task
performance	O
.	O
The	O
results	O
are	O
summarized	O
in	O
Table	O
[	O
reference	O
]	O
.	O
We	O
observe	O
that	O
using	O
the	O
-	O
d	O
global	O
pooled	O
feature	O
vector	O
directly	O
with	O
L2	Method
-	Method
normalization	Method
leads	O
to	O
lower	O
training	Metric
error	Metric
,	O
but	O
its	O
test	O
performance	O
is	O
worse	O
.	O
This	O
suggests	O
that	O
projecting	O
the	O
features	O
into	O
a	O
proper	O
low	O
-	O
rank	O
subspace	O
is	O
very	O
important	O
to	O
regularize	O
the	O
network	Task
training	Task
.	O
In	O
our	O
experiments	O
,	O
to	O
dimensions	O
have	O
similar	O
test	O
performance	O
,	O
and	O
we	O
choose	O
-	O
d	O
to	O
accelerate	O
the	O
computation	O
of	O
feature	O
distances	O
.	O
subsection	O
:	O
Factors	O
for	O
Person	Task
Search	Task
Detection	Metric
Recall	Metric
.	O
We	O
investigate	O
how	O
detection	Task
recalls	O
would	O
affect	O
the	O
person	Task
search	Task
performance	O
by	O
using	O
LOMO	Method
+	Method
XQDA	Method
as	O
the	O
re	Task
-	Task
i	Task
d	Task
method	Task
and	O
setting	O
different	O
thresholds	O
on	O
detection	Task
scores	O
.	O
A	O
lower	O
threshold	O
reduces	O
misdetections	O
(	O
increases	O
the	O
recall	Metric
)	O
but	O
results	O
in	O
more	O
false	O
alarms	O
.	O
We	O
choose	O
the	O
recall	Metric
rates	Metric
ranging	O
from	O
to	O
the	O
maximum	O
value	O
of	O
each	O
detector	O
.	O
The	O
final	O
person	Metric
search	Metric
mAP	Metric
under	O
each	O
setting	O
is	O
demonstrated	O
in	O
Figure	O
[	O
reference	O
]	O
.	O
An	O
interesting	O
observation	O
is	O
that	O
higher	O
recall	Metric
does	O
not	O
necessarily	O
lead	O
to	O
higher	O
person	Task
search	Task
performance	O
,	O
which	O
means	O
re	Task
-	Task
i	Task
d	Task
method	Task
could	O
still	O
get	O
confused	O
on	O
some	O
false	O
alarms	O
.	O
This	O
again	O
indicates	O
that	O
we	O
should	O
not	O
focus	O
solely	O
on	O
training	O
re	Task
-	Task
i	Task
d	Task
methods	Task
with	O
manually	O
cropped	O
pedestrians	O
,	O
but	O
should	O
consider	O
the	O
detections	O
jointly	O
under	O
the	O
person	Task
search	Task
problem	Task
setting	Task
.	O
Gallery	Metric
size	Metric
.	O
Person	Task
search	Task
could	O
be	O
more	O
challenging	O
as	O
the	O
gallery	O
size	O
increases	O
.	O
We	O
evaluate	O
several	O
methods	O
under	O
different	O
test	O
gallery	O
sizes	O
from	O
to	O
full	O
set	O
of	O
images	O
,	O
following	O
the	O
protocols	O
defined	O
in	O
Section	O
[	O
reference	O
]	O
.	O
The	O
test	O
mAPs	O
are	O
demonstrated	O
in	O
Figure	O
[	O
reference	O
]	O
.	O
Note	O
that	O
for	O
each	O
test	O
query	O
,	O
the	O
corresponding	O
gallery	O
images	O
are	O
randomly	O
sampled	O
from	O
the	O
whole	O
set	O
.	O
All	O
test	O
images	O
are	O
covered	O
even	O
with	O
small	O
gallery	O
sizes	O
.	O
The	O
performance	O
gaps	O
among	O
different	O
methods	O
are	O
reduced	O
as	O
the	O
gallery	O
size	O
increases	O
,	O
indicating	O
all	O
the	O
methods	O
may	O
suffer	O
from	O
some	O
common	O
hard	O
samples	O
,	O
and	O
we	O
could	O
further	O
improve	O
the	O
performance	O
with	O
hard	Task
example	Task
minings	Task
.	O
section	O
:	O
Conclusion	O
In	O
this	O
paper	O
,	O
we	O
propose	O
a	O
new	O
deep	Method
learning	Method
framework	Method
for	O
person	Task
search	Task
.	O
It	O
jointly	O
handles	O
detection	Task
and	O
identification	Task
in	O
a	O
single	O
CNN	Method
.	O
An	O
Online	Method
Instance	Method
Matching	Method
loss	O
function	O
is	O
proposed	O
to	O
train	O
the	O
network	O
effectively	O
.	O
Its	O
non	Method
-	Method
parametric	Method
nature	Method
enables	O
faster	O
yet	O
better	O
convergence	Metric
,	O
which	O
is	O
validated	O
through	O
series	O
of	O
experiments	O
.	O
Acknowledgements	O
.	O
This	O
work	O
is	O
supported	O
in	O
part	O
by	O
SenseTime	O
Group	O
Limited	O
,	O
in	O
part	O
by	O
the	O
General	O
Research	O
Fund	O
through	O
the	O
Research	O
Grants	O
Council	O
of	O
Hong	O
Kong	O
under	O
Grants	O
CUHK14213616	O
,	O
CUHK14206114	O
,	O
CUHK14205615	O
,	O
CUHK14207814	O
,	O
CUHK14203015	O
,	O
CUHK14239816	O
,	O
and	O
CUHK419412	O
,	O
in	O
part	O
by	O
the	O
Hong	O
Kong	O
Innovation	O
and	O
Technology	O
Support	O
Programme	O
Grant	O
ITS	O
/	O
121	O
/	O
15FX	O
,	O
in	O
part	O
by	O
the	O
State	O
Key	O
Development	O
Program	O
under	O
Grant	O
2016YFB1001004	O
,	O
in	O
part	O
by	O
the	O
Guangdong	O
Natural	O
Science	O
Foundation	O
under	O
Grant	O
No	O
.	O
2014A030313201	O
,	O
and	O
in	O
part	O
by	O
National	O
Natural	O
Science	O
Foundation	O
of	O
China	O
under	O
Grant	O
61371192	O
.	O
bibliography	O
:	O
References	O
