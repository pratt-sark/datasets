document	O
:	O
Regularizing	Method
Face	Method
Verification	Method
Nets	Method
For	O
Pain	Task
Intensity	Task
Regression	Task
Limited	O
labeled	O
data	O
are	O
available	O
for	O
the	O
research	O
of	O
estimating	Task
facial	Task
expression	Task
intensities	Task
.	O
For	O
instance	O
,	O
the	O
ability	O
to	O
train	O
deep	Method
networks	Method
for	O
automated	Task
pain	Task
assessment	Task
is	O
limited	O
by	O
small	O
datasets	O
with	O
labels	O
of	O
patient	O
-	O
reported	O
pain	O
intensities	O
.	O
Fortunately	O
,	O
fine	Task
-	Task
tuning	Task
from	O
a	O
data	O
-	O
extensive	O
pre	O
-	O
trained	O
domain	O
,	O
such	O
as	O
face	Task
verification	Task
,	O
can	O
alleviate	O
this	O
problem	O
.	O
In	O
this	O
paper	O
,	O
we	O
propose	O
a	O
network	O
that	O
fine	O
-	O
tunes	O
a	O
state	O
-	O
of	O
-	O
the	O
-	O
art	O
face	Method
verification	Method
network	Method
using	O
a	O
regularized	Method
regression	Method
loss	Method
and	O
additional	O
data	O
with	O
expression	O
labels	O
.	O
In	O
this	O
way	O
,	O
the	O
expression	O
intensity	O
regression	Method
task	O
can	O
benefit	O
from	O
the	O
rich	O
feature	Method
representations	Method
trained	O
on	O
a	O
huge	O
amount	O
of	O
data	O
for	O
face	Task
verification	Task
.	O
The	O
proposed	O
regularized	Method
deep	Method
regressor	Method
is	O
applied	O
to	O
estimate	O
the	O
pain	O
expression	O
intensity	O
and	O
verified	O
on	O
the	O
widely	O
-	O
used	O
UNBC	Material
-	Material
McMaster	Material
Shoulder	Material
-	Material
Pain	Material
dataset	Material
,	O
achieving	O
the	O
state	O
-	O
of	O
-	O
the	O
-	O
art	O
performance	O
.	O
A	O
weighted	Metric
evaluation	Metric
metric	Metric
is	O
also	O
proposed	O
to	O
address	O
the	O
imbalance	Task
issue	Task
of	O
different	O
pain	O
intensities	O
.	O
Feng	O
Wang1	O
,	O
4	O
,	O
Xiang	O
Xiang1⁣	O
*	O
*	O
Corresponding	O
author	O
(	O
e	O
-	O
mail	O
:	O
xxiang@cs.jhu.edu	O
)	O
,	O
Chang	O
Liu1	O
,	O
5	O
,	O
Trac	O
D.	O
Tran2	O
,	O
Austin	O
Reiter1	O
,	O
Gregory	O
D.	O
Hager1	O
,	O
Harry	O
Quon3	O
,	O
Jian	O
Cheng4	O
,	O
Alan	O
L.	O
Yuille1	O
Dept	O
.	O
of	O
{	O
Computer	Task
Science	Task
,	O
Electrical	Task
&	Task
Computer	Task
Engineering	Task
,	O
Radiation	Task
Oncology	Task
}	O
Johns	O
Hopkins	O
University	O
,	O
3400	O
N.	O
Charles	O
St	O
,	O
Baltimore	O
,	O
MD	O
21218	O
,	O
USA	O
Dept	O
.	O
of	O
EE	O
,	O
UESTC	O
,	O
2006	O
Xiyuan	O
Ave	O
,	O
Chengdu	O
,	O
Sichuan	O
611731	O
,	O
China	O
Dept	O
.	O
of	O
CS	O
,	O
Tsinghua	O
University	O
,	O
Beijing	O
100084	O
,	O
China	Task
fine	Task
-	Task
tuning	Task
,	O
CNN	Method
,	O
regularizer	Method
,	O
regression	Method
section	O
:	O
Introduction	O
Obtaining	O
accurate	O
patient	O
-	O
reported	O
pain	O
intensities	O
is	O
important	O
to	O
effectively	O
manage	O
pain	O
and	O
thus	O
reduce	O
anesthetic	O
doses	O
and	O
in	Task
-	Task
hospital	Task
deterioration	Task
.	O
Traditionally	O
,	O
caregivers	O
work	O
with	O
patients	O
to	O
manually	O
input	O
the	O
patients	O
’	O
pain	O
intensity	O
,	O
ranging	O
among	O
a	O
few	O
levels	O
such	O
as	O
mild	O
,	O
moderate	O
,	O
severe	O
and	O
excruciating	O
.	O
Recently	O
,	O
a	O
couple	O
of	O
concepts	O
have	O
been	O
proposed	O
such	O
as	O
active	Task
,	Task
automated	Task
and	Task
objective	Task
pain	Task
monitoring	Task
over	O
the	O
patient	O
’s	O
stay	O
in	O
hospital	O
,	O
with	O
roughly	O
the	O
same	O
motivation	O
:	O
first	O
to	O
simplify	O
the	O
pain	Task
reporting	Task
process	Task
and	O
reduce	O
the	O
strain	O
on	O
manual	O
efforts	O
;	O
second	O
to	O
standardize	O
the	O
feedback	Method
mechanism	Method
by	O
ensuring	O
a	O
single	O
metric	O
that	O
performs	O
all	O
assessments	O
and	O
thus	O
reduces	O
bias	O
.	O
There	O
indeed	O
exist	O
efforts	O
to	O
assess	O
pain	O
from	O
the	O
observational	O
or	O
behavioral	O
effect	O
caused	O
by	O
pain	O
such	O
as	O
physiological	O
data	O
.	O
©	O
Medasense	Method
has	O
developed	O
medical	Method
devices	Method
for	O
objective	Task
pain	Task
monitoring	Task
.	O
Their	O
basic	O
premise	O
is	O
that	O
pain	O
may	O
cause	O
vital	O
signs	O
such	O
as	O
blood	O
pressure	O
,	O
pulse	O
rate	O
,	O
respiration	Metric
rate	Metric
,	O
SpO2	O
from	O
EMG	O
,	O
ECG	O
or	O
EEG	O
,	O
alone	O
or	O
in	O
combination	O
to	O
change	O
and	O
often	O
to	O
increase	O
.	O
Nevertheless	O
,	O
it	O
takes	O
much	O
more	O
effort	O
to	O
obtain	O
physiological	O
data	O
than	O
videos	O
of	O
faces	O
.	O
Computer	Task
vision	Task
and	O
supervised	Task
learning	Task
have	O
come	O
a	O
long	O
way	O
in	O
recent	O
years	O
,	O
redefining	O
the	O
state	O
-	O
of	O
-	O
the	O
-	O
art	O
using	O
deep	Method
Convolutional	Method
Neural	Method
Networks	Method
(	O
CNNs	Method
)	O
.	O
However	O
,	O
the	O
ability	O
to	O
train	O
deep	Method
CNNs	Method
for	O
pain	Task
assessment	Task
is	O
limited	O
by	O
small	O
datasets	O
with	O
labels	O
of	O
patient	O
-	O
reported	O
pain	O
intensities	O
,	O
i.e.	O
,	O
annotated	O
datasets	O
such	O
as	O
EmoPain	Material
,	O
Shoulder	Material
-	Material
Pain	Material
,	O
BioVid	Material
Heat	Material
Pain	Material
.	O
Particularly	O
,	O
Shoulder	Material
-	Material
Pain	Material
is	O
the	O
only	O
dataset	O
available	O
for	O
visual	Task
analysis	Task
with	O
per	O
-	O
frame	O
labels	O
.	O
It	O
contains	O
only	O
200	O
videos	O
of	O
25	O
patients	O
who	O
suffer	O
from	O
shoulder	O
pain	O
and	O
repeatedly	O
raise	O
their	O
arms	O
and	O
then	O
put	O
them	O
down	O
(	O
onset	O
-	O
apex	O
-	O
offset	O
)	O
.	O
While	O
all	O
frames	O
are	O
labeled	O
with	O
discrete	O
-	O
valued	O
pain	O
intensities	O
(	O
see	O
Fig	O
.	O
[	O
reference	O
]	O
)	O
,	O
the	O
dataset	O
is	O
small	O
,	O
the	O
label	O
is	O
discrete	O
and	O
most	O
labels	O
are	O
0	O
.	O
Although	O
the	O
small	O
dataset	O
problem	O
prevents	O
us	O
from	O
directly	O
training	O
a	O
deep	Method
pain	Method
intensity	Method
regressor	Method
,	O
we	O
show	O
that	O
fine	Task
-	Task
tuning	Task
from	O
a	O
data	O
-	O
extensive	O
pre	O
-	O
trained	O
domain	O
such	O
as	O
face	Task
verification	Task
can	O
alleviate	O
this	O
problem	O
.	O
Our	O
solutions	O
are	O
fine	O
-	O
tuning	O
a	O
well	O
-	O
trained	O
face	Method
verification	Method
net	Method
on	O
additional	O
data	O
with	O
a	O
regularized	Method
regression	Method
loss	Method
and	O
a	O
hidden	Method
full	Method
-	Method
connected	Method
layer	Method
regularized	Method
using	O
dropout	Method
,	O
regularizing	Method
the	O
regression	Method
loss	O
using	O
a	O
center	Method
loss	Method
,	O
and	O
re	O
-	O
sampling	O
the	O
training	O
data	O
by	O
the	O
population	O
proportion	O
of	O
a	O
certain	O
pain	O
intensity	O
w.r.t	O
.	O
the	O
total	O
population	O
.	O
While	O
our	O
work	O
is	O
not	O
the	O
first	O
attempt	O
of	O
this	O
regularization	Method
idea	Method
,	O
to	O
our	O
knowledge	O
we	O
are	O
the	O
first	O
to	O
apply	O
it	O
to	O
the	O
pain	Task
expression	Task
intensity	Task
estimation	Task
.	O
Correspondingly	O
,	O
we	O
propose	O
three	O
solutions	O
to	O
address	O
the	O
four	O
issues	O
mentioned	O
above	O
.	O
In	O
summary	O
,	O
the	O
contributions	O
of	O
this	O
work	O
include	O
addressing	O
limited	O
data	O
with	O
expression	O
intensity	O
labels	O
by	O
relating	O
two	O
mappings	O
from	O
the	O
same	O
input	O
face	O
space	O
to	O
different	O
output	O
label	O
space	O
where	O
the	O
identity	O
labels	O
are	O
rich	O
,	O
pushing	O
the	O
pain	Metric
assessment	Metric
performance	O
by	O
a	O
large	O
margin	O
,	O
proposing	O
to	O
add	O
center	Method
loss	Method
regularizer	Method
to	O
make	O
the	O
regressed	O
values	O
closer	O
to	O
discrete	O
values	O
,	O
and	O
proposing	O
a	O
more	O
sensible	O
evaluation	Metric
metric	Metric
to	O
address	O
the	O
imbalance	Task
issue	Task
caused	O
by	O
a	O
natural	O
phenomena	O
where	O
most	O
of	O
the	O
time	O
a	O
patient	O
does	O
not	O
express	O
pain	O
.	O
section	O
:	O
Related	O
Works	O
Two	O
pieces	O
of	O
recent	O
work	O
make	O
progress	O
in	O
estimating	Task
pain	Task
intensity	Task
visually	Task
using	O
the	O
Shoulder	Material
-	Material
Pain	Material
dataset	Material
only	O
:	O
Ordinal	Method
Support	Method
Vector	Method
Regression	Method
(	O
OSVR	Method
)	O
and	O
Recurrent	Method
Convolutional	Method
Regression	Method
(	O
RCR	Method
)	O
.	O
Notably	O
,	O
RCR	Method
is	O
trained	O
end	O
-	O
to	O
-	O
end	O
yet	O
achieving	O
sub	O
-	O
optimal	O
performance	O
.	O
Please	O
see	O
reference	O
therein	O
for	O
other	O
existing	O
works	O
.	O
For	O
facial	Task
expression	Task
recognition	Task
in	O
general	O
,	O
there	O
is	O
a	O
trade	O
-	O
off	O
between	O
method	Metric
simplicity	Metric
and	O
performance	O
,	O
i.e.	O
,	O
image	Method
-	Method
based	Method
vs.	Method
video	Method
-	Method
based	Method
methods	Method
.	O
As	O
videos	O
are	O
sequential	O
signals	O
,	O
appearance	Method
-	Method
based	Method
methods	Method
including	O
ours	O
can	O
not	O
model	O
the	O
dynamics	O
given	O
by	O
a	O
temporal	Method
model	Method
or	O
spatio	Method
-	Method
temporal	Method
models	Method
.	O
As	O
regards	O
regularizing	Method
deep	O
networks	O
,	O
there	O
exists	O
recent	O
work	O
that	O
regularize	O
deep	Method
face	Method
recognition	Method
nets	Method
for	O
expression	Task
classification	Task
-	O
FaceNet2ExpNet	Task
.	O
During	O
pre	Task
-	Task
training	Task
,	O
they	O
train	O
convolutional	Method
layers	Method
of	O
the	O
expression	Method
net	Method
,	O
regularized	O
by	O
the	O
deep	Method
face	Method
recognition	Method
net	Method
.	O
In	O
the	O
refining	Task
stage	Task
,	O
they	O
append	O
fully	Method
-	Method
connected	Method
(	O
FC	Method
)	O
layers	O
to	O
the	O
pre	O
-	O
trained	O
convolutional	Method
layers	Method
and	O
train	O
the	O
whole	O
network	O
jointly	O
.	O
section	O
:	O
Regularized	O
deep	O
regressor	Method
Our	O
network	O
is	O
based	O
on	O
a	O
state	O
-	O
of	O
-	O
the	O
-	O
art	O
face	Method
verification	Method
network	Method
trained	O
using	O
the	O
CASIA	Material
-	Material
WebFace	Material
dataset	Material
contaning	O
million	O
face	O
images	O
with	O
identity	O
labels	O
.	O
As	O
a	O
classification	Method
network	Method
,	O
it	O
employs	O
the	O
Softmax	Method
loss	Method
regularized	Method
with	O
its	O
proposed	O
center	Method
loss	Method
.	O
But	O
it	O
is	O
difficult	O
to	O
directly	O
fine	O
-	O
tune	O
the	O
network	O
for	O
pain	Task
intensity	Task
classification	Task
due	O
to	O
limited	O
face	O
images	O
with	O
pain	O
labels	O
.	O
However	O
,	O
it	O
is	O
feasible	O
to	O
fit	O
the	O
data	O
points	O
as	O
a	O
regression	Method
problem	O
.	O
Our	O
fine	Method
-	Method
tuning	Method
network	Method
employs	O
a	O
regression	Method
loss	Method
regularized	Method
with	O
the	O
center	O
loss	O
,	O
as	O
shown	O
in	O
Fig	O
.	O
[	O
reference	O
]	O
.	O
First	O
,	O
we	O
modify	O
the	O
face	Task
verification	Task
net	Task
’s	O
softmax	Method
loss	Method
to	O
be	O
a	O
Mean	Metric
Square	Metric
Error	Metric
(	O
MSE	Metric
)	O
loss	O
for	O
regression	Method
.	O
The	O
last	O
layer	O
of	O
such	O
a	O
network	O
is	O
a	O
distance	Method
layer	Method
,	O
which	O
easily	O
causes	O
gradient	O
exploding	O
due	O
to	O
large	O
magnitudes	O
of	O
the	O
gradients	O
at	O
initial	O
iterations	O
.	O
Thus	O
,	O
we	O
replace	O
the	O
MSE	Metric
loss	O
using	O
a	O
smooth	Method
loss	Method
with	O
a	O
Huber	O
loss	O
flavor	O
(	O
see	O
Sec	O
.	O
[	O
reference	O
]	O
)	O
.	O
Secondly	O
,	O
as	O
labels	O
are	O
discrete	O
,	O
it	O
is	O
sensible	O
to	O
regularize	O
the	O
loss	O
to	O
make	O
the	O
regressed	O
values	O
to	O
be	O
more	O
âdiscreteâ.	O
We	O
introduce	O
the	O
center	O
loss	O
as	O
a	O
regularizer	Method
(	O
see	O
Sec	O
.	O
[	O
reference	O
]	O
)	O
.	O
Thirdly	O
,	O
we	O
propose	O
two	O
weighted	Metric
evaluation	Metric
metrics	Metric
in	O
Sec	O
.	O
[	O
reference	O
]	O
to	O
address	O
label	Task
imbalance	Task
which	O
may	O
induce	O
trivial	O
method	O
.	O
In	O
the	O
following	O
,	O
we	O
elaborate	O
on	O
the	O
three	O
solutions	O
.	O
subsection	O
:	O
Regression	Method
Loss	Method
Similar	O
to	O
conventional	O
regression	Method
models	O
,	O
a	O
regression	Method
net	O
minimizes	O
the	O
Mean	Metric
Square	Metric
Error	Metric
(	O
MSE	Metric
)	O
loss	O
defined	O
as	O
where	O
is	O
the	O
output	O
vector	O
of	O
the	O
hidden	O
FC	Method
layer	O
,	O
is	O
a	O
vector	O
of	O
real	O
-	O
valued	O
weights	O
,	O
is	O
the	O
ground	O
-	O
truth	O
label	O
,	O
and	O
is	O
a	O
sigmoid	Method
activation	Method
function	Method
.	O
We	O
use	O
to	O
truncate	O
the	O
output	O
of	O
the	O
second	O
FC	Method
layer	O
to	O
be	O
in	O
the	O
range	O
of	O
pain	O
intensity	O
.	O
Here	O
we	O
omitted	O
the	O
bias	O
term	O
for	O
elegance	O
.	O
The	O
gradient	Task
exploding	Task
problem	Task
often	O
happens	O
due	O
to	O
the	O
relatively	O
large	O
gradient	O
magnitude	O
during	O
initial	O
iterations	O
.	O
This	O
phenomenon	O
is	O
also	O
described	O
in	O
.	O
To	O
solve	O
this	O
problem	O
,	O
we	O
follow	O
to	O
apply	O
the	O
smooth	Method
loss	Method
which	O
makes	O
the	O
gradient	O
smaller	O
than	O
the	O
case	O
with	O
the	O
MSE	Metric
loss	O
when	O
the	O
absolute	Metric
error	Metric
is	O
large	O
.	O
Different	O
from	O
,	O
our	O
regressor	Method
outputs	O
a	O
scalar	O
instead	O
of	O
a	O
vector	O
.	O
It	O
is	O
a	O
compromise	O
between	O
squared	Metric
and	Metric
absolute	Metric
error	Metric
losses	Metric
:	O
where	O
is	O
the	O
turning	O
point	O
of	O
the	O
absolute	Metric
error	Metric
between	O
the	O
squared	O
error	O
function	O
and	O
the	O
absolute	O
error	O
function	O
.	O
It	O
has	O
a	O
flavor	O
with	O
the	O
Huber	O
loss	O
.	O
When	O
,	O
it	O
works	O
similar	O
with	O
MSE	Metric
loss	O
since	O
the	O
error	Metric
is	O
usually	O
below	O
1	O
.	O
When	O
,	O
it	O
is	O
equivalent	O
with	O
the	O
Mean	Metric
Abosolute	Metric
Error	Metric
(	O
MAE	Metric
)	O
loss	O
.	O
subsection	O
:	O
Regularization	Task
Using	O
Center	Method
Loss	Method
Since	O
the	O
pain	O
intensity	O
is	O
labeled	O
as	O
discrete	O
values	O
in	O
the	O
Shoulder	Material
-	Material
Pain	Material
dataset	Material
,	O
it	O
is	O
natural	O
to	O
regularize	O
the	O
network	O
to	O
make	O
the	O
regressed	O
values	O
to	O
be	O
‘	O
discrete	O
’	O
-	O
during	O
training	O
,	O
to	O
make	O
same	O
-	O
intensity	O
’s	O
regressed	O
values	O
as	O
compact	O
as	O
possible	O
(	O
see	O
Fig	O
.	O
[	O
reference	O
]	O
)	O
.	O
We	O
use	O
the	O
center	Method
loss	Method
which	O
minimizes	O
the	O
within	O
-	O
class	O
distance	O
and	O
thus	O
is	O
defined	O
as	O
where	O
represents	O
the	O
center	O
for	O
class	O
and	O
is	O
essentially	O
the	O
mean	O
of	O
features	O
per	O
class	O
.	O
denotes	O
the	O
norm	O
and	O
is	O
typically	O
or	O
.	O
We	O
observe	O
from	O
expriments	O
that	O
the	O
center	O
loss	O
shrinks	O
the	O
distances	O
of	O
features	O
that	O
have	O
the	O
same	O
label	O
,	O
which	O
is	O
illustrated	O
in	O
Fig	O
.	O
[	O
reference	O
]	O
.	O
To	O
relate	O
it	O
with	O
the	O
literature	O
,	O
it	O
is	O
a	O
similar	O
idea	O
to	O
the	O
Linear	Method
Discriminant	Method
Analysis	Method
yet	O
without	O
minimizing	O
between	O
-	O
class	O
distances	O
.	O
It	O
also	O
has	O
a	O
flavor	O
of	O
the	O
k	Method
-	Method
means	Method
clustering	Method
yet	O
in	O
a	O
supervised	O
way	O
.	O
Now	O
,	O
the	O
center	O
loss	O
is	O
added	O
to	O
the	O
regression	Method
loss	O
after	O
the	O
hidden	O
FC	Method
layer	O
to	O
induce	O
the	O
loss	O
where	O
is	O
a	O
coefficient	O
.	O
Thus	O
,	O
the	O
supervision	O
of	O
the	O
regularizer	Method
is	O
applied	O
to	O
the	O
features	O
.	O
Different	O
from	O
,	O
we	O
jointly	O
learn	O
the	O
centers	O
and	O
minimize	O
within	O
-	O
class	O
distances	O
by	O
gradient	Method
descent	Method
,	O
while	O
’s	O
centers	O
are	O
learned	O
by	O
moving	Method
average	Method
.	O
subsection	O
:	O
Weighted	Metric
Evaluation	Metric
Metrics	Metric
Labels	O
in	O
the	O
Shoulder	Material
-	Material
Pain	Material
dataset	Material
are	O
highly	O
imbalanced	O
,	O
as	O
91.35	O
%	O
of	O
the	O
frames	O
are	O
labeled	O
as	O
pain	O
intensity	O
0	O
.	O
Thus	O
,	O
it	O
is	O
relatively	O
safe	O
to	O
predict	O
the	O
pain	O
intensity	O
to	O
be	O
zero	O
.	O
To	O
fairly	O
evaluate	O
the	O
performance	O
,	O
we	O
propose	O
the	O
weighted	Metric
version	Metric
of	Metric
evaluation	Metric
metrics	Metric
,	O
i.e.	O
,	O
weighted	Metric
MAE	Metric
(	O
wMAE	Metric
)	O
and	O
weighted	O
MSE	Metric
(	O
wMSE	Method
)	O
to	O
address	O
the	O
dataset	Task
imbalance	Task
issue	Task
.	O
For	O
example	O
,	O
the	O
wMAE	Metric
is	O
simply	O
the	O
mean	O
of	O
MAE	Metric
on	O
each	O
pain	O
intensity	O
.	O
In	O
this	O
way	O
,	O
the	O
MAE	Metric
is	O
weighted	O
by	O
the	O
population	O
of	O
each	O
pain	O
intensity	O
.	O
We	O
apply	O
two	O
techniques	O
to	O
sample	O
the	O
training	O
data	O
to	O
make	O
our	O
training	O
set	O
more	O
consistent	O
with	O
the	O
new	O
metrics	O
.	O
First	O
,	O
we	O
eliminate	O
the	O
redundant	O
frames	O
on	O
the	O
sequences	O
following	O
.	O
If	O
the	O
intensity	O
remains	O
the	O
same	O
for	O
more	O
than	O
5	O
consecutive	O
frames	O
,	O
we	O
choose	O
the	O
first	O
one	O
as	O
the	O
representative	O
frame	O
.	O
Second	O
,	O
during	O
training	O
,	O
we	O
uniformly	O
sample	O
images	O
from	O
the	O
6	O
classes	O
to	O
feed	O
into	O
the	O
network	O
.	O
In	O
this	O
way	O
,	O
what	O
the	O
neural	Method
network	Method
‘	O
see	O
’	O
is	O
a	O
totally	O
balanced	O
dataset	O
.	O
section	O
:	O
Experiments	O
In	O
this	O
section	O
,	O
we	O
present	O
implementations	O
and	O
experiments	O
.	O
The	O
project	O
page	O
has	O
been	O
set	O
up	O
with	O
programs	O
and	O
data	O
.	O
subsection	O
:	O
Dataset	O
and	O
Training	O
Details	O
We	O
test	O
our	O
network	O
on	O
the	O
Shoulder	Material
-	Material
Pain	Material
dataset	Material
that	O
contains	O
200	O
videos	O
of	O
25	O
subjects	O
and	O
is	O
widely	O
used	O
for	O
benchmarking	O
the	O
pain	Task
intensity	Task
estimation	Task
.	O
The	O
dataset	O
comes	O
with	O
four	O
types	O
of	O
labels	O
.	O
The	O
three	O
annotated	O
online	O
during	O
the	O
video	O
collection	O
are	O
the	O
sensory	O
scale	O
,	O
affective	O
scale	O
and	O
visual	O
analog	O
scale	O
ranging	O
from	O
(	O
i.e.	O
,	O
no	O
pain	O
)	O
to	O
(	O
i.e.	O
,	O
severe	O
pain	O
)	O
.	O
In	O
addition	O
,	O
observers	O
rated	O
pain	O
intensity	O
(	O
OPI	O
)	O
offline	O
from	O
recorded	O
videos	O
ranging	O
from	O
(	O
no	O
pain	O
)	O
to	O
(	O
severe	O
pain	O
)	O
.	O
In	O
the	O
same	O
way	O
as	O
previous	O
works	O
,	O
we	O
take	O
the	O
same	O
online	O
label	O
and	O
quantify	O
the	O
original	O
pain	O
intensity	O
in	O
the	O
range	O
of	O
to	O
be	O
in	O
range	O
.	O
The	O
face	Method
verification	Method
network	Method
is	O
trained	O
on	O
CASIA	Material
-	Material
WebFace	Material
dataset	Material
,	O
which	O
contains	O
494	O
,	O
414	O
training	O
images	O
from	O
10	O
,	O
575	O
identities	O
.	O
To	O
be	O
consistent	O
with	O
face	Task
verification	Task
,	O
we	O
perform	O
the	O
same	O
pre	Method
-	Method
processing	Method
on	O
the	O
images	Material
of	Material
Shoulder	Material
-	Material
Pain	Material
dataset	Material
.	O
To	O
be	O
specific	O
,	O
we	O
leverage	O
MTCNN	Method
model	Method
to	O
detect	O
faces	O
and	O
facial	O
landmarks	O
.	O
Then	O
the	O
faces	O
are	O
aligned	O
according	O
to	O
the	O
detected	O
landmarks	O
.	O
The	O
learning	Metric
rate	Metric
is	O
set	O
to	O
to	O
avoid	O
huge	O
modification	O
on	O
the	O
convolution	O
layers	O
.	O
The	O
network	O
is	O
trained	O
over	O
5	O
,	O
000	O
iterations	O
,	O
which	O
is	O
reasonable	O
for	O
the	O
networks	O
to	O
converge	O
observed	O
in	O
a	O
few	O
cross	Metric
validation	Metric
folds	Metric
.	O
We	O
set	O
the	O
weight	O
of	O
the	O
regression	Method
loss	O
to	O
be	O
1	O
and	O
the	O
weights	O
of	O
softmax	O
loss	O
and	O
center	O
loss	O
to	O
be	O
1	O
and	O
0.01	O
respectively	O
.	O
subsection	O
:	O
Evaluation	Metric
Using	O
Unweighted	Metric
Metrics	Metric
Cross	Method
validation	Method
is	O
a	O
conventional	O
way	O
to	O
address	O
over	Task
-	Task
fitting	Task
small	Task
dataset	Task
.	O
In	O
our	O
case	O
,	O
we	O
run	O
25	Method
-	Method
fold	Method
cross	Method
validation	Method
25	O
times	O
on	O
the	O
Shoulder	Material
-	Material
Pain	Material
dataset	Material
which	O
contains	O
25	O
subjects	O
.	O
This	O
setting	O
is	O
exactly	O
the	O
leave	O
-	O
one	O
-	O
subject	O
-	O
out	O
setting	O
in	O
OSVR	Method
except	O
that	O
OSVR	O
’s	O
experiments	O
exclude	O
one	O
subject	O
whose	O
expressions	O
do	O
not	O
have	O
noticeable	O
pain	O
(	O
namely	O
24	O
-	O
fold	O
)	O
.	O
Each	O
time	O
,	O
the	O
videos	O
of	O
one	O
subject	O
are	O
reserved	O
for	O
testing	O
.	O
All	O
the	O
other	O
videos	O
are	O
used	O
to	O
train	O
the	O
deep	O
regression	Method
network	O
.	O
The	O
performance	O
is	O
summarized	O
in	O
Table	O
[	O
reference	O
]	O
.	O
It	O
can	O
be	O
concluded	O
that	O
our	O
algorithm	O
performs	O
best	O
or	O
equally	O
best	O
on	O
various	O
evaluation	Metric
metrics	Metric
,	O
especially	O
the	O
combination	O
of	O
smooth	Metric
loss	Metric
and	O
center	Metric
loss	Metric
.	O
Note	O
that	O
OSVR	Method
uses	O
hand	O
-	O
crafted	O
features	O
concatenated	O
from	O
landmark	O
points	O
,	O
Gabor	O
wavelet	O
coefficients	O
and	O
LBP	Method
+	O
PCA	Method
.	O
subsection	O
:	O
Evaluation	Metric
Using	O
Weighted	Metric
Metrics	Metric
In	O
Table	O
[	O
reference	O
]	O
,	O
we	O
provide	O
the	O
performance	O
of	O
predicting	O
all	O
zeros	O
as	O
a	O
baseline	O
.	O
Interestingly	O
,	O
on	O
the	O
metrics	O
MAE	Metric
and	O
MSE	Metric
,	O
zero	Method
prediction	Method
performs	O
much	O
better	O
than	O
several	O
state	O
-	O
of	O
-	O
the	O
-	O
art	O
algorithms	O
.	O
Now	O
,	O
using	O
the	O
new	O
proposed	O
metrics	O
,	O
the	O
performance	O
is	O
summarized	O
in	O
Table	O
[	O
reference	O
]	O
.	O
The	O
performance	O
of	O
previous	O
work	O
OSVR	Method
is	O
no	O
longer	O
below	O
that	O
of	O
predicting	O
all	O
zeros	O
.	O
We	O
can	O
also	O
see	O
from	O
Table	O
[	O
reference	O
]	O
that	O
the	O
uniform	Method
class	Method
sampling	Method
strategy	Method
does	O
help	O
a	O
lot	O
on	O
the	O
new	O
evaluation	Metric
metrics	Metric
.	O
Moreover	O
,	O
we	O
have	O
provided	O
the	O
evaluation	O
program	O
in	O
our	O
project	O
page	O
and	O
encourage	O
future	O
works	O
to	O
report	O
their	O
performance	O
with	O
the	O
new	O
evaluation	Metric
metrics	Metric
.	O
section	O
:	O
Summary	O
Given	O
the	O
restriction	O
of	O
labeled	O
data	O
which	O
prevents	O
us	O
from	O
directly	O
training	O
a	O
deep	Method
pain	Method
intensity	Method
regressor	Method
,	O
fine	Task
-	Task
tuning	Task
from	O
a	O
data	O
-	O
extensive	O
pre	O
-	O
trained	O
domain	O
such	O
as	O
face	Task
verification	Task
can	O
alleviate	O
the	O
problem	O
.	O
In	O
this	O
paper	O
,	O
we	O
regularize	O
a	O
face	Method
verification	Method
network	Method
for	O
pain	Task
intensity	Task
regression	Task
.	O
In	O
particular	O
,	O
we	O
introduce	O
the	O
Smooth	Method
Loss	Method
to	O
(	O
continuous	O
-	O
valued	O
)	O
pain	Task
intensity	Task
regression	Task
as	O
well	O
as	O
introduce	O
the	O
center	Method
loss	Method
as	O
a	O
regularizer	Method
to	O
induce	O
concentration	O
on	O
discrete	O
values	O
.	O
The	O
fine	Method
-	Method
tuned	Method
regularizered	Method
network	Method
with	O
a	O
regression	Method
layer	O
is	O
tested	O
on	O
the	O
UNBC	Material
-	Material
McMaster	Material
Shoulder	Material
-	Material
Pain	Material
dataset	Material
and	O
achieves	O
state	O
-	O
of	O
-	O
the	O
-	O
art	O
performance	O
on	O
pain	Task
intensity	Task
estimation	Task
.	O
The	O
main	O
problem	O
that	O
motivates	O
this	O
work	O
is	O
that	O
expertise	O
is	O
needed	O
to	O
label	O
the	O
pain	O
.	O
The	O
take	O
-	O
home	O
message	O
is	O
that	O
fine	Task
-	Task
tuning	Task
from	O
a	O
data	O
-	O
extensive	O
pre	O
-	O
trained	O
domain	O
can	O
alleviate	O
small	O
training	O
set	O
problems	O
.	O
On	O
the	O
other	O
hand	O
,	O
unsupervised	Method
learning	Method
does	O
not	O
rely	O
on	O
training	O
data	O
.	O
Indeed	O
,	O
discrete	O
-	O
valued	O
regression	Method
is	O
a	O
good	O
test	O
bed	O
for	O
center	Task
-	Task
based	Task
clustering	Task
.	O
Although	O
regularizing	Method
a	O
supervised	Method
deep	Method
network	Method
is	O
intuitive	O
,	O
its	O
performance	O
is	O
rather	O
empirical	O
.	O
In	O
the	O
future	O
,	O
we	O
need	O
insights	O
about	O
when	O
and	O
why	O
it	O
may	O
function	O
as	O
transfer	Method
learning	Method
.	O
Note	O
that	O
no	O
temporal	O
information	O
is	O
modeled	O
in	O
this	O
paper	O
.	O
As	O
pain	O
is	O
temporal	O
and	O
subjective	O
,	O
prior	O
knowledge	O
about	O
the	O
stimulus	O
needs	O
to	O
be	O
incorporated	O
to	O
help	O
quantify	O
individual	O
differences	O
.	O
section	O
:	O
ACKNOWLEDGMENT	O
When	O
performing	O
this	O
work	O
,	O
Xiang	O
Xiang	O
is	O
funded	O
by	O
JHU	O
CS	O
Dept	O
’s	O
teaching	O
assistantship	O
,	O
Feng	O
Wang	O
&	O
Alan	O
Yuille	O
are	O
supported	O
by	O
the	O
Office	O
of	O
Naval	O
Research	O
(	O
ONR	O
N00014	O
-	O
15	O
-	O
1	O
-	O
2356	O
)	O
,	O
Feng	O
&	O
Jian	O
Chen	O
are	O
supported	O
by	O
the	O
National	O
Natural	O
Science	O
Foundation	O
of	O
China	O
(	O
61671125	O
,	O
61201271	O
)	O
,	O
and	O
Feng	O
is	O
also	O
funded	O
by	O
China	O
Scholarship	O
Council	O
(	O
CSC	O
)	O
.	O
Xiang	O
is	O
grateful	O
for	O
a	O
fellowship	O
from	O
CSC	O
in	O
previous	O
years	O
.	O
bibliography	O
:	O
References	O
