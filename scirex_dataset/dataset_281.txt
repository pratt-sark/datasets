document	O
:	O
Deep	Task
Learning	Task
Face	Task
Representation	Task
by	O
Joint	Task
Identification	Task
-	Task
Verification	Task
The	O
key	O
challenge	O
of	O
face	Task
recognition	Task
is	O
to	O
develop	O
effective	O
feature	Method
representations	Method
for	O
reducing	Task
intra	Task
-	Task
personal	Task
variations	Task
while	O
enlarging	O
inter	O
-	O
personal	O
differences	O
.	O
In	O
this	O
paper	O
,	O
we	O
show	O
that	O
it	O
can	O
be	O
well	O
solved	O
with	O
deep	Method
learning	Method
and	O
using	O
both	O
face	Task
identification	Task
and	O
verification	Task
signals	Task
as	O
supervision	O
.	O
The	O
Deep	Method
IDentification	Method
-	Method
verification	Method
features	Method
(	O
DeepID2	Method
)	O
are	O
learned	O
with	O
carefully	O
designed	O
deep	Method
convolutional	Method
networks	Method
.	O
The	O
face	Task
identification	Task
task	O
increases	O
the	O
inter	O
-	O
personal	O
variations	O
by	O
drawing	O
DeepID2	Method
extracted	O
from	O
different	O
identities	O
apart	O
,	O
while	O
the	O
face	Task
verification	Task
task	Task
reduces	O
the	O
intra	O
-	O
personal	O
variations	O
by	O
pulling	O
DeepID2	Method
extracted	O
from	O
the	O
same	O
identity	O
together	O
,	O
both	O
of	O
which	O
are	O
essential	O
to	O
face	Task
recognition	Task
.	O
The	O
learned	O
DeepID2	Method
features	O
can	O
be	O
well	O
generalized	O
to	O
new	O
identities	O
unseen	O
in	O
the	O
training	O
data	O
.	O
On	O
the	O
challenging	O
LFW	Material
dataset	Material
,	O
face	Metric
verification	Metric
accuracy	Metric
is	O
achieved	O
.	O
Compared	O
with	O
the	O
best	O
deep	Method
learning	Method
result	O
on	O
LFW	Material
,	O
the	O
error	Metric
rate	Metric
has	O
been	O
significantly	O
reduced	O
by	O
.	O
section	O
:	O
Introduction	O
Faces	O
of	O
the	O
same	O
identity	O
could	O
look	O
much	O
different	O
when	O
presented	O
in	O
different	O
poses	O
,	O
illuminations	O
,	O
expressions	O
,	O
ages	O
,	O
and	O
occlusions	O
.	O
Such	O
variations	O
within	O
the	O
same	O
identity	O
could	O
overwhelm	O
the	O
variations	O
due	O
to	O
identity	O
differences	O
and	O
make	O
face	Task
recognition	Task
challenging	O
,	O
especially	O
in	O
unconstrained	O
conditions	O
.	O
Therefore	O
,	O
reducing	O
the	O
intra	O
-	O
personal	O
variations	O
while	O
enlarging	O
the	O
inter	O
-	O
personal	O
differences	O
is	O
an	O
eternal	O
topic	O
in	O
face	Task
recognition	Task
.	O
It	O
can	O
be	O
traced	O
back	O
to	O
early	O
subspace	Method
face	Method
recognition	Method
methods	Method
such	O
as	O
LDA	Method
,	O
Bayesian	Method
face	Method
,	O
and	O
unified	Method
subspace	Method
.	O
For	O
example	O
,	O
LDA	Method
approximates	O
inter	O
-	O
and	O
intra	O
-	O
personal	O
face	O
variations	O
by	O
using	O
two	O
linear	Method
subspaces	Method
and	O
finds	O
the	O
projection	O
directions	O
to	O
maximize	O
the	O
ratio	O
between	O
them	O
.	O
More	O
recent	O
studies	O
have	O
also	O
targeted	O
the	O
same	O
goal	O
,	O
either	O
explicitly	O
or	O
implicitly	O
.	O
For	O
example	O
,	O
metric	Method
learning	Method
maps	O
faces	O
to	O
some	O
feature	Method
representation	Method
such	O
that	O
faces	O
of	O
the	O
same	O
identity	O
are	O
close	O
to	O
each	O
other	O
while	O
those	O
of	O
different	O
identities	O
stay	O
apart	O
.	O
However	O
,	O
these	O
models	O
are	O
much	O
limited	O
by	O
their	O
linear	O
nature	O
or	O
shallow	O
structures	O
,	O
while	O
inter	O
-	O
and	O
intra	O
-	O
personal	O
variations	O
are	O
complex	O
,	O
highly	O
nonlinear	O
,	O
and	O
observed	O
in	O
high	O
-	O
dimensional	O
image	O
space	O
.	O
In	O
this	O
work	O
,	O
we	O
show	O
that	O
deep	Method
learning	Method
provides	O
much	O
more	O
powerful	O
tools	O
to	O
handle	O
the	O
two	O
types	O
of	O
variations	O
.	O
Thanks	O
to	O
its	O
deep	Method
architecture	Method
and	O
large	O
learning	O
capacity	O
,	O
effective	O
features	O
for	O
face	Task
recognition	Task
can	O
be	O
learned	O
through	O
hierarchical	Method
nonlinear	Method
mappings	Method
.	O
We	O
argue	O
that	O
it	O
is	O
essential	O
to	O
learn	O
such	O
features	O
by	O
using	O
two	O
supervisory	O
signals	O
simultaneously	O
,	O
i.e.	O
the	O
face	Task
identification	Task
and	O
verification	Task
signals	Task
,	O
and	O
the	O
learned	O
features	O
are	O
referred	O
to	O
as	O
Deep	Method
IDentification	Method
-	Method
verification	Method
features	Method
(	O
DeepID2	Method
)	O
.	O
Identification	Task
is	O
to	O
classify	O
an	O
input	O
image	O
into	O
a	O
large	O
number	O
of	O
identity	O
classes	O
,	O
while	O
verification	Task
is	O
to	O
classify	O
a	O
pair	O
of	O
images	O
as	O
belonging	O
to	O
the	O
same	O
identity	O
or	O
not	O
(	O
i.e.	O
binary	O
classification	Task
)	O
.	O
In	O
the	O
training	O
stage	O
,	O
given	O
an	O
input	O
face	O
image	O
with	O
the	O
identification	O
signal	O
,	O
its	O
DeepID2	Method
features	O
are	O
extracted	O
in	O
the	O
top	O
hidden	O
layer	O
of	O
the	O
learned	O
hierarchical	Method
nonlinear	Method
feature	Method
representation	Method
,	O
and	O
then	O
mapped	O
to	O
one	O
of	O
a	O
large	O
number	O
of	O
identities	O
through	O
another	O
function	O
.	O
In	O
the	O
testing	O
stage	O
,	O
the	O
learned	O
DeepID2	Method
features	O
can	O
be	O
generalized	O
to	O
other	O
tasks	O
(	O
such	O
as	O
face	Task
verification	Task
)	O
and	O
new	O
identities	O
unseen	O
in	O
the	O
training	O
data	O
.	O
The	O
identification	O
supervisory	O
signal	O
tend	O
to	O
pull	O
apart	O
DeepID2	Method
of	O
different	O
identities	O
since	O
they	O
have	O
to	O
be	O
classified	O
into	O
different	O
classes	O
.	O
Therefore	O
,	O
the	O
learned	O
features	O
would	O
have	O
rich	O
identity	O
-	O
related	O
or	O
inter	O
-	O
personal	O
variations	O
.	O
However	O
,	O
the	O
identification	O
signal	O
has	O
a	O
relatively	O
weak	O
constraint	O
on	O
DeepID2	Method
extracted	O
from	O
the	O
same	O
identity	O
,	O
since	O
dissimilar	O
DeepID2	Method
could	O
be	O
mapped	O
to	O
the	O
same	O
identity	O
through	O
function	O
.	O
This	O
leads	O
to	O
problems	O
when	O
DeepID2	Method
features	O
are	O
generalized	O
to	O
new	O
tasks	O
and	O
new	O
identities	O
in	O
test	O
where	O
is	O
not	O
applicable	O
anymore	O
.	O
We	O
solve	O
this	O
by	O
using	O
an	O
additional	O
face	O
verification	O
signal	O
,	O
which	O
requires	O
that	O
every	O
two	O
DeepID2	Method
vectors	O
extracted	O
from	O
the	O
same	O
identity	O
are	O
close	O
to	O
each	O
other	O
while	O
those	O
extracted	O
from	O
different	O
identities	O
are	O
kept	O
away	O
.	O
The	O
strong	O
per	O
-	O
element	O
constraint	O
on	O
DeepID2	Method
can	O
effectively	O
reduce	O
the	O
intra	O
-	O
personal	O
variations	O
.	O
On	O
the	O
other	O
hand	O
,	O
using	O
the	O
verification	O
signal	O
alone	O
(	O
i.e.	O
only	O
distinguishing	O
a	O
pair	O
of	O
DeepID2	Method
at	O
a	O
time	O
)	O
is	O
not	O
as	O
effective	O
in	O
extracting	O
identity	Task
-	Task
related	Task
features	Task
as	O
using	O
the	O
identification	O
signal	O
(	O
i.e.	O
distinguishing	O
thousands	O
of	O
identities	O
at	O
a	O
time	O
)	O
.	O
Therefore	O
,	O
the	O
two	O
supervisory	O
signals	O
emphasize	O
different	O
aspects	O
in	O
feature	Task
learning	Task
and	O
should	O
be	O
employed	O
together	O
.	O
To	O
characterize	O
faces	O
from	O
different	O
aspects	O
,	O
complementary	O
DeepID2	Method
features	O
are	O
extracted	O
from	O
various	O
face	O
regions	O
and	O
resolutions	O
,	O
and	O
are	O
concatenated	O
to	O
form	O
the	O
final	O
feature	Method
representation	Method
after	O
PCA	Method
dimension	Method
reduction	Method
.	O
Since	O
the	O
learned	O
DeepID2	Method
features	O
are	O
diverse	O
among	O
different	O
identities	O
while	O
consistent	O
within	O
the	O
same	O
identity	O
,	O
it	O
makes	O
the	O
following	O
face	Task
recognition	Task
easier	O
.	O
Using	O
the	O
learned	O
feature	Method
representation	Method
and	O
a	O
recently	O
proposed	O
face	Method
verification	Method
model	Method
,	O
we	O
achieved	O
the	O
highest	O
face	Metric
verification	Metric
accuracy	Metric
on	O
the	O
challenging	O
and	O
extensively	O
studied	O
LFW	Material
dataset	Material
.	O
This	O
is	O
the	O
first	O
time	O
that	O
a	O
machine	O
provided	O
with	O
only	O
the	O
face	O
region	O
achieves	O
an	O
accuracy	Metric
on	O
par	O
with	O
the	O
accuracy	Metric
of	O
human	O
to	O
whom	O
the	O
entire	O
LFW	Material
face	O
image	O
including	O
the	O
face	O
region	O
and	O
large	O
background	O
area	O
are	O
presented	O
to	O
verify	O
.	O
In	O
recent	O
years	O
,	O
a	O
great	O
deal	O
of	O
efforts	O
have	O
been	O
made	O
for	O
face	Task
recognition	Task
with	O
deep	Method
learning	Method
.	O
Among	O
the	O
deep	Method
learning	Method
works	O
,	O
learned	O
features	O
or	O
deep	Method
metrics	Method
with	O
the	O
verification	O
signal	O
,	O
while	O
learned	O
features	O
with	O
the	O
identification	O
signal	O
and	O
achieved	O
accuracies	Metric
around	O
on	O
LFW	Material
.	O
Our	O
approach	O
significantly	O
improves	O
the	O
state	O
-	O
of	O
-	O
the	O
-	O
art	O
.	O
The	O
idea	O
of	O
jointly	O
solving	O
the	O
classification	Task
and	O
verification	Task
tasks	Task
was	O
applied	O
to	O
general	Task
object	Task
recognition	Task
,	O
with	O
the	O
focus	O
on	O
improving	O
classification	Task
accuracy	O
on	O
fixed	O
object	O
classes	O
instead	O
of	O
hidden	Method
feature	Method
representations	Method
.	O
Our	O
work	O
targets	O
on	O
learning	O
features	O
which	O
can	O
be	O
well	O
generalized	O
to	O
new	O
classes	O
(	O
identities	O
)	O
and	O
the	O
verification	Task
task	Task
,	O
while	O
the	O
classification	Task
accuracy	O
on	O
identities	O
in	O
the	O
training	O
set	O
is	O
not	O
crucial	O
for	O
us	O
.	O
section	O
:	O
Identification	Task
-	Task
verification	Task
guided	Task
deep	Task
feature	Task
learning	Task
We	O
learn	O
features	O
with	O
variations	O
of	O
deep	Method
convolutional	Method
neural	Method
networks	Method
(	O
deep	Method
ConvNets	Method
)	O
.	O
The	O
convolution	Method
and	Method
pooling	Method
operations	Method
in	O
deep	Method
ConvNets	Method
are	O
specially	O
designed	O
to	O
extract	O
visual	O
features	O
hierarchically	O
,	O
from	O
local	O
low	O
-	O
level	O
features	O
to	O
global	O
high	O
-	O
level	O
ones	O
.	O
Our	O
deep	Method
ConvNets	Method
take	O
similar	O
structures	O
as	O
in	O
.	O
It	O
contains	O
four	O
convolutional	Method
layers	Method
,	O
the	O
first	O
three	O
of	O
which	O
are	O
followed	O
by	O
max	Method
-	Method
pooling	Method
.	O
To	O
learn	O
a	O
diverse	O
number	O
of	O
high	O
-	O
level	O
features	O
,	O
we	O
do	O
not	O
require	O
weight	O
-	O
sharing	O
on	O
the	O
entire	O
feature	O
map	O
in	O
higher	O
convolutional	Method
layers	Method
.	O
Specifically	O
,	O
in	O
the	O
third	O
convolutional	Method
layer	Method
of	O
our	O
deep	Method
ConvNets	Method
,	O
neuron	O
weights	O
are	O
locally	O
shared	O
in	O
every	O
local	O
regions	O
.	O
In	O
the	O
fourth	O
convolutional	Method
layer	Method
,	O
which	O
is	O
more	O
appropriately	O
called	O
a	O
locally	Method
-	Method
connected	Method
layer	Method
,	O
weights	O
are	O
totally	O
unshared	O
between	O
neurons	O
.	O
The	O
ConvNet	Method
extracts	O
a	O
-	O
dimensional	O
DeepID2	Method
vector	O
at	O
its	O
last	O
layer	O
of	O
the	O
feature	Method
extraction	Method
cascade	Method
.	O
The	O
DeepID2	Method
layer	O
to	O
be	O
learned	O
are	O
fully	O
-	O
connected	O
to	O
both	O
the	O
third	Method
and	Method
fourth	Method
convolutional	Method
layers	Method
.	O
Since	O
the	O
fourth	O
convolutional	Method
layer	Method
extracts	O
more	O
global	O
features	O
than	O
the	O
third	O
one	O
,	O
the	O
DeepID2	Method
layer	O
takes	O
multi	O
-	O
scale	O
features	O
as	O
input	O
,	O
forming	O
the	O
so	O
called	O
multi	Method
-	Method
scale	Method
ConvNets	Method
.	O
We	O
use	O
rectified	O
linear	O
units	O
(	O
ReLU	Method
)	O
for	O
neurons	O
in	O
the	O
convolutional	Method
layers	Method
and	O
the	O
DeepID2	Method
layer	O
.	O
ReLU	Method
has	O
better	O
fitting	O
abilities	O
than	O
the	O
sigmoid	Method
units	Method
for	O
large	O
training	O
datasets	O
.	O
An	O
illustration	O
of	O
the	O
ConvNet	O
structure	O
used	O
to	O
extract	O
DeepID2	Method
is	O
shown	O
in	O
Fig	O
.	O
[	O
reference	O
]	O
given	O
an	O
RGB	O
input	O
of	O
size	O
.	O
When	O
the	O
size	O
of	O
the	O
input	O
region	O
changes	O
,	O
the	O
map	O
sizes	O
in	O
the	O
following	O
layers	O
will	O
change	O
accordingly	O
.	O
The	O
DeepID2	Method
extraction	O
process	O
is	O
denoted	O
as	O
,	O
where	O
is	O
the	O
feature	O
extraction	O
function	O
defined	O
by	O
the	O
ConvNet	Method
,	O
is	O
the	O
input	O
face	O
patch	O
,	O
is	O
the	O
extracted	O
DeepID2	Method
vector	O
,	O
and	O
denotes	O
ConvNet	O
parameters	O
to	O
be	O
learned	O
.	O
DeepID2	Method
features	O
are	O
learned	O
under	O
two	O
supervisory	O
signals	O
.	O
The	O
first	O
is	O
face	Task
identification	Task
signal	O
,	O
which	O
classifies	O
each	O
face	O
image	O
into	O
one	O
of	O
(	O
_	O
meaning	O
:	O
NTF	O
.	O
e.g	O
_	O
catcode	Method
:	O
NTF	O
a	O
e.g.	O
e.g.	O
,	O
)	O
different	O
identities	O
.	O
Identification	Task
is	O
achieved	O
by	O
following	O
the	O
DeepID2	Method
layer	O
with	O
an	O
-	Method
way	Method
softmax	Method
layer	Method
,	O
which	O
outputs	O
a	O
probability	O
distribution	O
over	O
the	O
classes	O
.	O
The	O
network	O
is	O
trained	O
to	O
minimize	O
the	O
cross	Metric
-	Metric
entropy	Metric
loss	Metric
,	O
which	O
we	O
call	O
the	O
identification	Metric
loss	Metric
.	O
It	O
is	O
denoted	O
as	O
where	O
is	O
the	O
DeepID2	Method
vector	O
,	O
is	O
the	O
target	O
class	O
,	O
and	O
denotes	O
the	O
softmax	O
layer	O
parameters	O
.	O
is	O
the	O
target	O
probability	O
distribution	O
,	O
where	O
for	O
all	O
except	O
for	O
the	O
target	O
class	O
.	O
is	O
the	O
predicted	O
probability	O
distribution	O
.	O
To	O
correctly	O
classify	O
all	O
the	O
classes	O
simultaneously	O
,	O
the	O
DeepID2	Method
layer	O
must	O
form	O
discriminative	O
identity	O
-	O
related	O
features	O
(	O
i.e.	O
features	O
with	O
large	O
inter	O
-	O
personal	O
variations	O
)	O
.	O
The	O
second	O
is	O
face	Task
verification	Task
signal	Task
,	O
which	O
encourages	O
DeepID2	Method
extracted	O
from	O
faces	O
of	O
the	O
same	O
identity	O
to	O
be	O
similar	O
.	O
The	O
verification	O
signal	O
directly	O
regularize	O
DeepID2	Method
and	O
can	O
effectively	O
reduce	O
the	O
intra	O
-	O
personal	O
variations	O
.	O
Commonly	O
used	O
constraints	O
include	O
the	O
L1	O
/	O
L2	O
norm	O
and	O
cosine	O
similarity	O
.	O
We	O
adopt	O
the	O
following	O
loss	Method
function	Method
based	O
on	O
the	O
L2	Method
norm	Method
,	O
which	O
was	O
originally	O
proposed	O
by	O
Hadsell	O
_	O
meaning	O
:	O
NTF	Method
.	O
et	O
al	O
_	O
catcode	O
:	O
NTF	O
a	O
et	O
al	O
.	O
et	O
al	O
.	O
for	O
dimensionality	Task
reduction	Task
,	O
where	O
and	O
are	O
DeepID2	Method
vectors	O
extracted	O
from	O
the	O
two	O
face	O
images	O
in	O
comparison	O
.	O
means	O
that	O
and	O
are	O
from	O
the	O
same	O
identity	O
.	O
In	O
this	O
case	O
,	O
it	O
minimizes	O
the	O
L2	O
distance	O
between	O
the	O
two	O
DeepID2	Method
vectors	O
.	O
means	O
different	O
identities	O
,	O
and	O
Eq	O
.	O
(	O
[	O
reference	O
]	O
)	O
requires	O
the	O
distance	O
larger	O
than	O
a	O
margin	O
.	O
is	O
the	O
parameter	O
to	O
be	O
learned	O
in	O
the	O
verification	Metric
loss	Metric
function	Metric
.	O
Loss	Method
functions	Method
based	O
on	O
the	O
L1	Method
norm	Method
could	O
have	O
similar	O
formulations	O
.	O
The	O
cosine	O
similarity	O
was	O
used	O
in	O
as	O
where	O
is	O
the	O
cosine	O
similarity	O
between	O
DeepID2	Method
vectors	O
,	O
are	O
learnable	O
scaling	O
and	O
shifting	O
parameters	O
,	O
is	O
the	O
sigmoid	O
function	O
,	O
and	O
is	O
the	O
binary	O
target	O
of	O
whether	O
the	O
two	O
compared	O
face	O
images	O
belong	O
to	O
the	O
same	O
identity	O
.	O
All	O
the	O
three	O
loss	Method
functions	Method
are	O
evaluated	O
and	O
compared	O
in	O
our	O
experiments	O
.	O
Our	O
goal	O
is	O
to	O
learn	O
the	O
parameters	O
in	O
the	O
feature	Method
extraction	Method
function	Method
,	O
while	O
and	O
are	O
only	O
parameters	O
introduced	O
to	O
propagate	O
the	O
identification	O
and	O
verification	Task
signals	Task
during	O
training	O
.	O
In	O
the	O
testing	Task
stage	Task
,	O
only	O
is	O
used	O
for	O
feature	Task
extraction	Task
.	O
The	O
parameters	O
are	O
updated	O
by	O
stochastic	Method
gradient	Method
descent	Method
.	O
The	O
identification	Task
and	Task
verification	Task
gradients	Task
are	O
weighted	O
by	O
a	O
hyperparameter	Method
.	O
The	O
margin	O
in	O
Eq	O
.	O
(	O
[	O
reference	O
]	O
)	O
is	O
a	O
special	O
case	O
,	O
which	O
can	O
not	O
be	O
updated	O
by	O
gradient	Method
descent	Method
since	O
its	O
gradient	O
would	O
always	O
be	O
nonnegative	O
.	O
Instead	O
,	O
we	O
adaptively	O
update	O
during	O
training	Task
such	O
that	O
it	O
is	O
the	O
threshold	O
that	O
gives	O
the	O
lowest	O
verification	Metric
error	Metric
on	O
recent	O
training	O
samples	O
.	O
Our	O
learning	Method
algorithm	Method
is	O
summarized	O
in	O
Tab	O
.	O
[	O
reference	O
]	O
.	O
section	O
:	O
Face	Task
Verification	Task
To	O
evaluate	O
the	O
feature	Method
learning	Method
algorithm	Method
described	O
in	O
Sec	O
.	O
[	O
reference	O
]	O
,	O
DeepID2	Method
features	O
are	O
embedded	O
into	O
the	O
conventional	O
face	Method
verification	Method
pipeline	Method
of	O
face	Task
alignment	Task
,	O
feature	Task
extraction	Task
,	O
and	O
face	Task
verification	Task
.	O
We	O
first	O
use	O
the	O
recently	O
proposed	O
SDM	Method
algorithm	Method
to	O
detect	O
facial	O
landmarks	O
.	O
Then	O
the	O
face	O
images	O
are	O
globally	O
aligned	O
by	O
similarity	Method
transformation	Method
according	O
to	O
the	O
detected	O
landmarks	O
.	O
We	O
cropped	O
face	O
patches	O
,	O
which	O
vary	O
in	O
positions	O
,	O
scales	O
,	O
color	O
channels	O
,	O
and	O
horizontal	O
flipping	O
,	O
according	O
to	O
the	O
globally	O
aligned	O
faces	O
and	O
the	O
position	O
of	O
the	O
facial	O
landmarks	O
.	O
Accordingly	O
,	O
DeepID2	Method
vectors	O
are	O
extracted	O
by	O
a	O
total	O
of	O
deep	Method
ConvNets	Method
,	O
each	O
of	O
which	O
is	O
trained	O
to	O
extract	O
two	O
160	O
-	O
dimensional	O
DeepID2	Method
vectors	O
on	O
one	O
particular	O
face	O
patch	O
and	O
its	O
horizontally	O
flipped	O
counterpart	O
,	O
respectively	O
,	O
of	O
each	O
face	O
.	O
To	O
reduce	O
the	O
redundancy	O
among	O
the	O
large	O
number	O
of	O
DeepID2	Method
features	O
and	O
make	O
our	O
system	O
practical	O
,	O
we	O
use	O
the	O
forward	Method
-	Method
backward	Method
greedy	Method
algorithm	Method
to	O
select	O
a	O
small	O
number	O
of	O
effective	O
and	O
complementary	O
DeepID2	Method
vectors	O
(	O
in	O
our	O
experiment	O
)	O
,	O
which	O
saves	O
most	O
of	O
the	O
feature	Metric
extraction	Metric
time	Metric
during	O
test	O
.	O
Fig	O
.	O
[	O
reference	O
]	O
shows	O
all	O
the	O
selected	O
patches	O
,	O
from	O
which	O
-	O
dimensional	O
DeepID2	Method
vectors	O
are	O
extracted	O
and	O
are	O
concatenated	O
to	O
a	O
-	O
dimensional	O
DeepID2	Method
vector	O
.	O
The	O
-	O
dimensional	O
vector	O
is	O
further	O
compressed	O
by	O
PCA	Method
for	O
face	Task
verification	Task
.	O
We	O
learned	O
the	O
Joint	Method
Bayesian	Method
model	O
for	O
face	Task
verification	Task
based	O
on	O
the	O
extracted	O
DeepID2	Method
.	O
Joint	Method
Bayesian	Method
has	O
been	O
successfully	O
used	O
to	O
model	O
the	O
joint	O
probability	O
of	O
two	O
faces	O
being	O
the	O
same	O
or	O
different	O
persons	O
.	O
It	O
models	O
the	O
feature	Method
representation	Method
of	Method
a	Method
face	Method
as	O
the	O
sum	O
of	O
inter	O
-	O
and	O
intra	O
-	O
personal	O
variations	O
,	O
or	O
,	O
where	O
both	O
and	O
are	O
modeled	O
as	O
Gaussian	Method
distributions	Method
and	O
are	O
estimated	O
from	O
the	O
training	O
data	O
.	O
Face	Task
verification	Task
is	O
achieved	O
through	O
log	Metric
-	Metric
likelihood	Metric
ratio	Metric
test	Metric
,	O
,	O
where	O
the	O
numerator	O
and	O
denominator	O
are	O
joint	O
probabilities	O
of	O
two	O
faces	O
given	O
the	O
inter	O
-	O
or	O
intra	O
-	O
personal	O
variation	O
hypothesis	O
,	O
respectively	O
.	O
section	O
:	O
Experiments	O
We	O
report	O
face	Task
verification	Task
results	O
on	O
the	O
LFW	Material
dataset	Material
,	O
which	O
is	O
the	O
de	O
facto	O
standard	O
test	O
set	O
for	O
face	Task
verification	Task
in	O
unconstrained	Task
conditions	Task
.	O
It	O
contains	O
face	O
images	O
of	O
identities	O
collected	O
from	O
the	O
Internet	O
.	O
For	O
comparison	O
purposes	O
,	O
algorithms	O
typically	O
report	O
the	O
mean	O
face	Metric
verification	Metric
accuracy	Metric
and	O
the	O
ROC	Metric
curve	Metric
on	O
given	O
face	O
pairs	O
in	O
LFW	Material
.	O
Though	O
being	O
sound	O
as	O
a	O
test	O
set	O
,	O
it	O
is	O
inadequate	O
for	O
training	Task
,	O
since	O
the	O
majority	O
of	O
identities	O
in	O
LFW	Material
have	O
only	O
one	O
face	O
image	O
.	O
Therefore	O
,	O
we	O
rely	O
on	O
a	O
larger	O
outside	O
dataset	O
for	O
training	O
,	O
as	O
did	O
by	O
all	O
recent	O
high	O
-	O
performance	O
face	Method
verification	Method
algorithms	Method
.	O
In	O
particular	O
,	O
we	O
use	O
the	O
CelebFaces	Material
+	Material
dataset	O
for	O
training	O
,	O
which	O
contains	O
face	O
images	O
of	O
identities	O
(	O
celebrities	O
)	O
collected	O
from	O
the	O
Internet	O
.	O
People	O
in	O
CelebFaces	Material
+	Material
and	O
LFW	Material
are	O
mutually	O
exclusive	O
.	O
DeepID2	Method
features	O
are	O
learned	O
from	O
the	O
face	O
images	O
of	O
identities	O
randomly	O
sampled	O
from	O
CelebFaces	Material
+	Material
(	O
referred	O
to	O
as	O
CelebFaces	Material
+	Material
A	O
)	O
,	O
while	O
the	O
remaining	O
face	O
images	O
of	O
identities	O
(	O
referred	O
to	O
as	O
CelebFaces	Material
+	Material
B	Material
)	O
are	O
used	O
for	O
the	O
following	O
feature	Method
selection	Method
and	O
learning	O
the	O
face	Method
verification	Method
models	Method
(	O
Joint	Method
Bayesian	Method
)	O
.	O
When	O
learning	O
DeepID2	Method
on	O
CelebFaces	Material
+	Material
A	Material
,	O
CelebFaces	Material
+	Material
B	Material
is	O
used	O
as	O
a	O
validation	O
set	O
to	O
decide	O
the	O
learning	Metric
rate	Metric
,	O
training	O
epochs	O
,	O
and	O
hyperparameter	O
.	O
After	O
that	O
,	O
CelebFaces	Material
+	Material
B	Material
is	O
separated	O
into	O
a	O
training	O
set	O
of	O
identities	O
and	O
a	O
validation	O
set	O
of	O
identities	O
for	O
feature	Task
selection	Task
.	O
Finally	O
,	O
we	O
train	O
the	O
Joint	Method
Bayesian	Method
model	O
on	O
the	O
entire	O
CelebFaces	Material
+	Material
B	Material
data	Material
and	O
test	O
on	O
LFW	Material
using	O
the	O
selected	O
DeepID2	Method
.	O
We	O
first	O
evaluate	O
various	O
aspect	O
of	O
feature	Task
learning	Task
from	O
Sec	O
.	O
[	O
reference	O
]	O
to	O
Sec	O
.	O
[	O
reference	O
]	O
by	O
using	O
a	O
single	O
deep	Method
ConvNet	Method
to	O
extract	O
DeepID2	Method
from	O
the	O
entire	O
face	O
region	O
.	O
Then	O
the	O
final	O
system	O
is	O
constructed	O
and	O
compared	O
with	O
existing	O
best	O
performing	O
methods	O
in	O
Sec	O
.	O
[	O
reference	O
]	O
.	O
subsection	O
:	O
Balancing	O
the	O
identification	O
and	O
verification	Task
signals	Task
We	O
investigates	O
the	O
interactions	O
of	O
identification	O
and	O
verification	Task
signals	Task
on	O
feature	Task
learning	Task
,	O
by	O
varying	O
from	O
to	O
.	O
At	O
,	O
the	O
verification	O
signal	O
vanishes	O
and	O
only	O
the	O
identification	O
signal	O
takes	O
effect	O
.	O
When	O
increases	O
,	O
the	O
verification	O
signal	O
gradually	O
dominates	O
the	O
training	Task
process	Task
.	O
At	O
the	O
other	O
extreme	O
of	O
,	O
only	O
the	O
verification	O
signal	O
remains	O
.	O
The	O
L2	Metric
norm	Metric
verification	Metric
loss	Metric
in	O
Eq	O
.	O
(	O
[	O
reference	O
]	O
)	O
is	O
used	O
for	O
training	O
.	O
Figure	O
[	O
reference	O
]	O
shows	O
the	O
face	Metric
verification	Metric
accuracy	Metric
on	O
the	O
test	O
set	O
by	O
comparing	O
the	O
learned	O
DeepID2	Method
with	O
L2	Method
norm	Method
and	O
the	O
Joint	Method
Bayesian	Method
model	O
,	O
respectively	O
.	O
It	O
clearly	O
shows	O
that	O
neither	O
the	O
identification	Task
nor	O
the	O
verification	O
signal	O
is	O
the	O
optimal	O
one	O
to	O
learn	O
features	O
.	O
Instead	O
,	O
effective	O
features	O
come	O
from	O
the	O
appropriate	O
combination	O
of	O
the	O
two	O
.	O
This	O
phenomenon	O
can	O
be	O
explained	O
from	O
the	O
view	O
of	O
inter	O
-	O
and	O
intra	O
-	O
personal	O
variations	O
,	O
which	O
could	O
be	O
approximated	O
by	O
LDA	Method
.	O
According	O
to	O
LDA	Method
,	O
the	O
inter	O
-	O
personal	O
scatter	O
matrix	O
is	O
,	O
where	O
is	O
the	O
mean	O
feature	O
of	O
the	O
-	O
th	O
identity	O
,	O
is	O
the	O
mean	O
of	O
the	O
entire	O
dataset	O
,	O
and	O
is	O
the	O
number	O
of	O
face	O
images	O
of	O
the	O
-	O
th	O
identity	O
.	O
The	O
intra	O
-	O
personal	O
scatter	O
matrix	O
is	O
,	O
where	O
is	O
the	O
set	O
of	O
features	O
of	O
the	O
-	O
th	O
identity	O
,	O
is	O
the	O
corresponding	O
mean	O
,	O
and	O
is	O
the	O
number	O
of	O
different	O
identities	O
.	O
The	O
inter	O
-	O
and	O
intra	O
-	O
personal	O
variances	O
are	O
the	O
eigenvalues	O
of	O
the	O
corresponding	O
scatter	O
matrices	O
,	O
and	O
are	O
shown	O
in	O
Fig	O
.	O
[	O
reference	O
]	O
.	O
The	O
corresponding	O
eigenvectors	O
represent	O
different	O
variation	O
patterns	O
.	O
Both	O
the	O
magnitude	O
and	O
diversity	O
of	O
feature	O
variances	O
matter	O
in	O
recognition	Task
.	O
If	O
all	O
the	O
feature	O
variances	O
concentrate	O
on	O
a	O
small	O
number	O
of	O
eigenvectors	O
,	O
it	O
indicates	O
the	O
diversity	O
of	O
intra	O
-	O
or	O
inter	O
-	O
personal	O
variations	O
is	O
low	O
.	O
The	O
features	O
are	O
learned	O
with	O
,	O
,	O
and	O
,	O
respectively	O
.	O
The	O
feature	O
variances	O
of	O
each	O
given	O
are	O
normalized	O
by	O
the	O
corresponding	O
mean	O
feature	O
variance	O
.	O
When	O
only	O
the	O
identification	O
signal	O
is	O
used	O
(	O
)	O
,	O
the	O
learned	O
features	O
contain	O
both	O
diverse	O
inter	O
-	O
and	O
intra	O
-	O
personal	O
variations	O
,	O
as	O
shown	O
by	O
the	O
long	O
tails	O
of	O
the	O
red	O
curves	O
in	O
both	O
figures	O
.	O
While	O
diverse	O
inter	O
-	O
personal	O
variations	O
help	O
to	O
distinguish	O
different	O
identities	O
,	O
large	O
and	O
diverse	O
intra	O
-	O
personal	O
variations	O
are	O
noises	O
and	O
makes	O
face	Task
verification	Task
difficult	O
.	O
When	O
both	O
the	O
identification	O
and	O
verification	Task
signals	Task
are	O
used	O
with	O
appropriate	O
weighting	O
(	O
)	O
,	O
the	O
diversity	O
of	O
the	O
inter	O
-	O
personal	O
variations	O
keeps	O
unchanged	O
while	O
the	O
variations	O
in	O
a	O
few	O
main	O
directions	O
become	O
even	O
larger	O
,	O
as	O
shown	O
by	O
the	O
green	O
curve	O
in	O
the	O
left	O
compared	O
to	O
the	O
red	O
one	O
.	O
At	O
the	O
same	O
time	O
,	O
the	O
intra	O
-	O
personal	O
variations	O
decrease	O
in	O
both	O
the	O
diversity	O
and	O
magnitude	O
,	O
as	O
shown	O
by	O
the	O
green	O
curve	O
in	O
the	O
right	O
.	O
Therefore	O
,	O
both	O
the	O
inter	O
-	O
and	O
intra	O
-	O
personal	O
variations	O
changes	O
in	O
a	O
direction	O
that	O
makes	O
face	Task
verification	Task
easier	O
.	O
When	O
further	O
increases	O
towards	O
infinity	O
,	O
both	O
the	O
inter	O
-	O
and	O
intra	O
-	O
personal	O
variations	O
collapse	O
to	O
the	O
variations	O
in	O
only	O
a	O
few	O
main	O
directions	O
,	O
since	O
without	O
the	O
identification	O
signal	O
,	O
diverse	O
features	O
can	O
not	O
be	O
formed	O
.	O
With	O
low	O
diversity	O
on	O
inter	O
-	O
personal	O
variations	O
,	O
distinguishing	O
different	O
identities	O
becomes	O
difficult	O
.	O
Therefore	O
the	O
performance	O
degrades	O
significantly	O
.	O
Figure	O
[	O
reference	O
]	O
shows	O
the	O
first	O
two	O
PCA	O
dimensions	O
of	O
features	O
learned	O
with	O
,	O
,	O
and	O
,	O
respectively	O
.	O
These	O
features	O
come	O
from	O
the	O
six	O
identities	O
with	O
the	O
largest	O
numbers	O
of	O
face	O
images	O
in	O
LFW	Material
,	O
and	O
are	O
marked	O
by	O
different	O
colors	O
.	O
The	O
figure	O
further	O
verifies	O
our	O
observations	O
.	O
When	O
(	O
left	O
)	O
,	O
different	O
clusters	O
are	O
mixed	O
together	O
due	O
to	O
the	O
large	O
intra	O
-	O
personal	O
variations	O
,	O
although	O
the	O
cluster	O
centers	O
are	O
actually	O
different	O
.	O
When	O
increases	O
to	O
(	O
middle	O
)	O
,	O
intra	O
-	O
personal	O
variations	O
are	O
significantly	O
reduced	O
and	O
the	O
clusters	O
become	O
distinguishable	O
.	O
When	O
further	O
increases	O
towards	O
infinity	O
(	O
right	O
)	O
,	O
although	O
the	O
intra	O
-	O
personal	O
variations	O
further	O
decrease	O
,	O
the	O
cluster	O
centers	O
also	O
begin	O
to	O
collapse	O
and	O
some	O
clusters	O
become	O
significantly	O
overlapped	O
(	O
as	O
the	O
red	O
,	O
blue	O
,	O
and	O
cyan	O
clusters	O
in	O
Fig	O
.	O
[	O
reference	O
]	O
right	O
)	O
,	O
making	O
it	O
hard	O
to	O
distinguish	O
again	O
.	O
subsection	O
:	O
Rich	O
identity	O
information	O
improves	O
feature	Method
learning	Method
We	O
investigate	O
how	O
would	O
the	O
identity	O
information	O
contained	O
in	O
the	O
identification	O
supervisory	O
signal	O
influence	O
the	O
learned	O
features	O
.	O
In	O
particular	O
,	O
we	O
experiment	O
with	O
an	O
exponentially	O
increasing	O
number	O
of	O
identities	O
used	O
for	O
identification	Task
during	O
training	O
from	O
to	O
,	O
while	O
the	O
verification	O
signal	O
is	O
generated	O
from	O
all	O
the	O
training	O
identities	O
all	O
the	O
time	O
.	O
Fig	O
.	O
[	O
reference	O
]	O
shows	O
how	O
the	O
verification	Metric
accuracies	Metric
of	O
the	O
learned	O
DeepID2	Method
(	O
derived	O
from	O
the	O
L2	Method
norm	Method
and	O
Joint	Method
Bayesian	Method
)	O
vary	O
on	O
the	O
test	O
set	O
with	O
the	O
number	O
of	O
identities	O
used	O
in	O
the	O
identification	O
signal	O
.	O
It	O
shows	O
that	O
identifying	O
a	O
large	O
number	O
(	O
_	O
meaning	O
:	O
NTF	Method
.	O
e.g	O
_	O
catcode	Method
:	O
NTF	Method
a	O
e.g.	O
e.g.	O
,	O
8192	O
)	O
of	O
identities	O
is	O
key	O
to	O
learning	O
effective	O
DeepID2	Method
representation	O
.	O
This	O
observation	O
is	O
consistent	O
with	O
those	O
in	O
Sec	O
.	O
[	O
reference	O
]	O
.	O
The	O
increasing	O
number	O
of	O
identities	O
provides	O
richer	O
identity	O
information	O
and	O
helps	O
to	O
form	O
DeepID2	Method
with	O
diverse	O
inter	O
-	O
personal	O
variations	O
,	O
making	O
the	O
class	O
centers	O
of	O
different	O
identities	O
more	O
distinguishable	O
.	O
subsection	O
:	O
Investigating	O
the	O
verification	Task
signals	Task
As	O
shown	O
in	O
Sec	O
.	O
[	O
reference	O
]	O
,	O
the	O
verification	O
signal	O
with	O
moderate	O
intensity	O
mainly	O
takes	O
the	O
effect	O
of	O
reducing	O
the	O
intra	O
-	O
personal	O
variations	O
.	O
To	O
further	O
verify	O
this	O
,	O
we	O
compare	O
our	O
L2	Metric
norm	Metric
verification	Metric
signal	Metric
on	O
all	O
the	O
sample	O
pairs	O
with	O
those	O
only	O
constrain	O
either	O
the	O
positive	O
or	O
negative	O
sample	O
pairs	O
,	O
denoted	O
as	O
L2	O
+	O
and	O
L2	O
-	O
,	O
respectively	O
.	O
That	O
is	O
,	O
the	O
L2	Method
+	Method
only	O
decreases	O
the	O
distances	O
between	O
DeepID2	Method
of	O
the	O
same	O
identity	O
,	O
while	O
L2	Method
-	Method
only	O
increases	O
the	O
distances	O
between	O
DeepID2	Method
of	O
different	O
identities	O
if	O
they	O
are	O
smaller	O
than	O
the	O
margin	O
.	O
The	O
face	Metric
verification	Metric
accuracies	Metric
of	O
the	O
learned	O
DeepID2	Method
on	O
the	O
test	O
set	O
,	O
measured	O
by	O
the	O
L2	Metric
norm	Metric
and	O
Joint	Method
Bayesian	Method
respectively	O
,	O
are	O
shown	O
in	O
Table	O
[	O
reference	O
]	O
.	O
It	O
also	O
compares	O
with	O
the	O
L1	O
norm	O
and	O
cosine	O
verification	Task
signals	Task
,	O
as	O
well	O
as	O
no	O
verification	O
signal	O
(	O
none	O
)	O
.	O
The	O
identification	O
signal	O
is	O
the	O
same	O
(	O
classifying	O
the	O
identities	O
)	O
for	O
all	O
the	O
comparisons	O
.	O
DeepID2	Method
features	O
learned	O
with	O
the	O
L2	Method
+	Method
verification	Method
signal	Method
are	O
only	O
slightly	O
worse	O
than	O
those	O
learned	O
with	O
L2	Method
.	O
In	O
contrast	O
,	O
the	O
L2	O
-	O
verification	O
signal	O
helps	O
little	O
in	O
feature	Task
learning	Task
and	O
gives	O
almost	O
the	O
same	O
result	O
as	O
no	O
verification	O
signal	O
is	O
used	O
.	O
This	O
is	O
a	O
strong	O
evidence	O
that	O
the	O
effect	O
of	O
the	O
verification	O
signal	O
is	O
mainly	O
reducing	O
the	O
intra	O
-	O
personal	O
variations	O
.	O
Another	O
observation	O
is	O
that	O
the	O
face	Metric
verification	Metric
accuracy	Metric
improves	O
in	O
general	O
whenever	O
the	O
verification	O
signal	O
is	O
added	O
in	O
addition	O
to	O
the	O
identification	O
signal	O
.	O
However	O
,	O
the	O
L2	Method
norm	Method
is	O
better	O
than	O
the	O
other	O
compared	O
verification	Metric
metrics	Metric
.	O
This	O
may	O
be	O
due	O
to	O
that	O
all	O
the	O
other	O
constraints	O
are	O
weaker	O
than	O
L2	O
and	O
less	O
effective	O
in	O
reducing	O
the	O
intra	O
-	O
personal	O
variations	O
.	O
For	O
example	O
,	O
the	O
cosine	O
similarity	O
only	O
constrains	O
the	O
angle	O
,	O
but	O
not	O
the	O
magnitude	O
.	O
subsection	O
:	O
Final	O
system	O
and	O
comparison	O
with	O
other	O
methods	O
Before	O
learning	O
Joint	Method
Bayesian	Method
,	O
DeepID2	Method
features	O
are	O
first	O
projected	O
to	O
a	O
low	O
dimensional	O
feature	O
space	O
by	O
PCA	Method
.	O
After	O
PCA	Method
,	O
the	O
Joint	Method
Bayesian	Method
model	O
is	O
trained	O
on	O
the	O
entire	O
CelebFaces	Material
+	Material
B	Material
data	Material
and	O
tested	O
on	O
the	O
given	O
face	O
pairs	O
in	O
LFW	Material
,	O
where	O
the	O
log	Metric
-	Metric
likelihood	Metric
ratio	Metric
given	O
by	O
Joint	Method
Bayesian	Method
is	O
compared	O
to	O
a	O
threshold	O
optimized	O
on	O
the	O
training	O
data	O
for	O
face	Task
verification	Task
.	O
Tab	O
.	O
[	O
reference	O
]	O
shows	O
the	O
face	Metric
verification	Metric
accuracy	Metric
with	O
an	O
increasing	O
number	O
of	O
face	O
patches	O
to	O
extract	O
DeepID2	Method
,	O
as	O
well	O
as	O
the	O
time	O
used	O
to	O
extract	O
those	O
DeepID2	Method
features	O
from	O
each	O
face	O
with	O
a	O
single	O
Titan	O
GPU	O
.	O
We	O
achieve	O
accuracy	Metric
with	O
all	O
the	O
selected	O
face	O
patches	O
and	O
-	O
dimensional	O
DeepID2	Method
features	O
after	O
PCA	Method
.	O
The	O
feature	Method
extraction	Method
process	Method
is	O
also	O
efficient	O
and	O
takes	O
only	O
ms	O
for	O
each	O
face	O
image	O
.	O
To	O
further	O
exploit	O
the	O
rich	O
pool	O
of	O
DeepID2	Method
features	O
extracted	O
from	O
the	O
large	O
number	O
of	O
patches	O
.	O
We	O
repeat	O
the	O
feature	Method
selection	Method
algorithm	Method
for	O
another	O
six	O
times	O
,	O
each	O
time	O
choosing	O
DeepID2	Method
from	O
the	O
patches	O
that	O
have	O
not	O
been	O
selected	O
by	O
previous	O
feature	Method
selection	Method
steps	Method
.	O
Then	O
we	O
learn	O
the	O
Joint	Method
Bayesian	Method
model	O
on	O
each	O
of	O
the	O
seven	O
groups	O
of	O
selected	O
features	O
,	O
respectively	O
.	O
We	O
fuse	O
the	O
seven	O
Joint	Method
Bayesian	Method
scores	O
on	O
each	O
pair	O
of	O
compared	O
faces	O
by	O
further	O
learning	O
an	O
SVM	Method
.	O
In	O
this	O
way	O
,	O
we	O
achieve	O
an	O
even	O
higher	O
face	Metric
verification	Metric
accuracy	Metric
.	O
The	O
accuracy	Metric
and	O
ROC	Metric
comparison	O
with	O
previous	O
state	O
-	O
of	O
-	O
the	O
-	O
art	O
methods	O
on	O
LFW	Material
are	O
shown	O
in	O
Tab	O
.	O
[	O
reference	O
]	O
and	O
Fig	O
.	O
[	O
reference	O
]	O
,	O
respectively	O
.	O
We	O
achieve	O
the	O
best	O
results	O
and	O
improve	O
previous	O
results	O
with	O
a	O
large	O
margin	O
.	O
section	O
:	O
Conclusion	O
This	O
paper	O
have	O
shown	O
that	O
the	O
effect	O
of	O
the	O
face	Task
identification	Task
and	O
verification	O
supervisory	O
signals	O
on	O
deep	Task
feature	Task
representation	Task
coincide	O
with	O
the	O
two	O
aspects	O
of	O
constructing	O
ideal	O
features	O
for	O
face	Task
recognition	Task
,	O
_	O
meaning	O
:	O
NTF	O
.	O
i.e	O
_	O
catcode	O
:	O
NTF	Method
a	O
i.e.	O
i.e.	O
,	O
increasing	O
inter	O
-	O
personal	O
variations	O
and	O
reducing	O
intra	O
-	O
personal	O
variations	O
,	O
and	O
the	O
combination	O
of	O
the	O
two	O
supervisory	O
signals	O
lead	O
to	O
significantly	O
better	O
features	O
than	O
either	O
one	O
of	O
them	O
.	O
When	O
embedding	O
the	O
learned	O
features	O
to	O
the	O
traditional	O
face	Method
verification	Method
pipeline	Method
,	O
we	O
achieved	O
an	O
extremely	O
effective	O
system	O
with	O
face	Metric
verification	Metric
accuracy	Metric
on	O
LFW	Material
.	O
bibliography	O
:	O
References	O
