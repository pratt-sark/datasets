document	O
:	O
Multiple	Method
Instance	Method
Detection	Method
Network	Method
with	O
Online	Method
Instance	Method
Classifier	Method
Refinement	Method
Of	O
late	O
,	O
weakly	Task
supervised	Task
object	Task
detection	Task
is	O
with	O
great	O
importance	O
in	O
object	Task
recognition	Task
.	O
Based	O
on	O
deep	Method
learning	Method
,	O
weakly	Method
supervised	Method
detectors	Method
have	O
achieved	O
many	O
promising	O
results	O
.	O
However	O
,	O
compared	O
with	O
fully	Task
supervised	Task
detection	Task
,	O
it	O
is	O
more	O
challenging	O
to	O
train	O
deep	Method
network	Method
based	Method
detectors	Method
in	O
a	O
weakly	Method
supervised	Method
manner	Method
.	O
Here	O
we	O
formulate	O
weakly	Task
supervised	Task
detection	Task
as	O
a	O
Multiple	Task
Instance	Task
Learning	Task
(	Task
MIL	Task
)	Task
problem	Task
,	O
where	O
instance	Method
classifiers	Method
(	O
object	Method
detectors	Method
)	O
are	O
put	O
into	O
the	O
network	O
as	O
hidden	O
nodes	O
.	O
We	O
propose	O
a	O
novel	O
online	Method
instance	Method
classifier	Method
refinement	Method
algorithm	Method
to	O
integrate	O
MIL	Method
and	O
the	O
instance	Method
classifier	Method
refinement	Method
procedure	Method
into	O
a	O
single	O
deep	Method
network	Method
,	O
and	O
train	O
the	O
network	O
end	O
-	O
to	O
-	O
end	O
with	O
only	O
image	O
-	O
level	O
supervision	O
,	O
,	O
without	O
object	O
location	O
information	O
.	O
More	O
precisely	O
,	O
instance	O
labels	O
inferred	O
from	O
weak	O
supervision	O
are	O
propagated	O
to	O
their	O
spatially	O
overlapped	O
instances	O
to	O
refine	O
instance	Method
classifier	Method
online	O
.	O
The	O
iterative	Method
instance	Method
classifier	Method
refinement	Method
procedure	Method
is	O
implemented	O
using	O
multiple	O
streams	O
in	O
deep	Method
network	Method
,	O
where	O
each	O
stream	O
supervises	O
its	O
latter	O
stream	O
.	O
Weakly	Task
supervised	Task
object	Task
detection	Task
experiments	O
are	O
carried	O
out	O
on	O
the	O
challenging	O
PASCAL	Material
VOC	Material
2007	Material
and	O
2012	Material
benchmarks	O
.	O
We	O
obtain	O
mAP	Metric
on	O
VOC	Material
2007	Material
that	O
significantly	O
outperforms	O
the	O
previous	O
state	O
-	O
of	O
-	O
the	O
-	O
art	O
.	O
section	O
:	O
Introduction	O
With	O
the	O
development	O
of	O
Convolutional	O
Neural	O
Network	O
(	O
CNN	Method
)	O
,	O
great	O
improvements	O
have	O
been	O
achieved	O
on	O
object	Task
detection	Task
,	O
due	O
to	O
the	O
availability	O
of	O
large	O
scale	O
datasets	O
with	O
accurate	O
boundingbox	O
-	O
level	O
annotations	O
.	O
However	O
,	O
collecting	O
such	O
accurate	O
annotations	O
can	O
be	O
very	O
labor	O
-	O
intensive	O
and	O
time	O
-	O
consuming	O
,	O
whereas	O
achieving	O
only	O
image	O
-	O
level	O
annotations	O
(	O
,	O
image	O
tags	O
)	O
is	O
much	O
easier	O
,	O
as	O
these	O
annotations	O
are	O
often	O
available	O
at	O
the	O
Internet	O
(	O
,	O
image	O
search	O
queries	O
)	O
.	O
In	O
this	O
paper	O
,	O
we	O
aim	O
at	O
the	O
Weakly	Task
Supervised	Task
Object	Task
Detection	Task
(	O
WSOD	Task
)	O
problem	O
,	O
,	O
only	O
image	O
tags	O
are	O
available	O
during	O
training	O
to	O
indicate	O
whether	O
an	O
object	O
exists	O
in	O
an	O
image	O
.	O
Most	O
of	O
previous	O
methods	O
follow	O
the	O
Multiple	Method
Instance	Method
Learning	Method
(	Method
MIL	Method
)	Method
pipeline	Method
for	O
WSOD	Task
.	O
They	O
treat	O
images	O
as	O
bags	O
and	O
image	O
regions	O
generated	O
by	O
object	Method
proposal	Method
methods	Method
as	O
instances	O
to	O
train	O
instance	Method
classifiers	Method
(	O
object	Method
detectors	Method
)	O
under	O
the	O
MIL	O
constraints	O
.	O
Meanwhile	O
,	O
recent	O
efforts	O
tend	O
to	O
combine	O
MIL	Method
and	O
CNN	Method
by	O
either	O
using	O
CNN	Method
as	O
an	O
off	Method
-	Method
the	Method
-	Method
shelf	Method
feature	Method
extractor	Method
or	O
training	O
an	O
end	Method
-	Method
to	Method
-	Method
end	Method
MIL	Method
network	Method
.	O
Here	O
we	O
are	O
also	O
along	O
the	O
MIL	O
line	O
for	O
WSOD	Task
,	O
and	O
train	O
an	O
end	Method
-	Method
to	Method
-	Method
end	Method
network	Method
.	O
Though	O
many	O
promising	O
results	O
have	O
been	O
achieved	O
in	O
WSOD	Task
,	O
they	O
are	O
still	O
far	O
from	O
comparable	O
to	O
fully	O
supervised	O
ones	O
.	O
Weakly	Task
supervised	Task
object	Task
detection	Task
only	O
requires	O
supervision	O
at	O
image	O
category	O
level	O
.	O
Bilen	O
and	O
Vedaldi	O
presents	O
an	O
end	Method
-	Method
to	Method
-	Method
end	Method
deep	Method
network	Method
for	O
WSOD	Task
,	O
in	O
which	O
final	O
image	Metric
classification	Metric
score	Metric
is	O
the	O
weighted	O
sum	O
of	O
proposal	O
scores	O
,	O
that	O
is	O
,	O
each	O
proposal	O
contributes	O
a	O
percentage	O
to	O
the	O
final	O
image	Task
classification	Task
.	O
The	O
deep	Method
network	Method
can	O
correctly	O
classify	O
image	O
even	O
only	O
“	O
see	O
”	O
a	O
part	O
of	O
object	O
,	O
and	O
as	O
a	O
result	O
,	O
the	O
top	O
ranking	O
proposal	O
may	O
fail	O
to	O
meet	O
the	O
standard	O
object	Metric
detection	Metric
requirement	Metric
(	O
IoU	O
0.5	O
between	O
ground	O
truths	O
and	O
predicted	O
boxes	O
)	O
.	O
As	O
shown	O
in	O
Fig	O
.	O
[	O
reference	O
]	O
(	O
left	O
)	O
,	O
the	O
top	O
-	O
ranking	O
proposal	O
A	O
is	O
too	O
small	O
.	O
Meanwhile	O
,	O
proposals	O
B	O
,	O
C	O
,	O
and	O
D	O
have	O
similar	O
detection	Metric
scores	Metric
.	O
This	O
shows	O
that	O
the	O
WSOD	Task
network	Task
is	O
not	O
discriminative	O
enough	O
to	O
correctly	O
localize	O
object	O
.	O
This	O
is	O
a	O
core	O
problem	O
of	O
end	Task
-	Task
to	Task
-	Task
end	Task
deep	Task
network	Task
based	Task
WSOD	Task
.	O
To	O
address	O
this	O
problem	O
,	O
we	O
put	O
forward	O
two	O
improvements	O
in	O
this	O
paper	O
:	O
1	O
)	O
Instead	O
of	O
estimating	O
instance	O
weights	O
through	O
weighted	Method
sum	Method
pooling	Method
,	O
we	O
propose	O
to	O
add	O
some	O
blocks	O
in	O
the	O
network	O
for	O
learning	O
more	O
discriminative	O
instance	Method
classifiers	Method
by	O
explicitly	O
assigning	O
binary	O
instance	O
labels	O
;	O
2	O
)	O
We	O
propose	O
to	O
refine	O
instance	Method
classifier	Method
online	O
using	O
spatial	O
relation	O
.	O
Our	O
motivation	O
is	O
that	O
,	O
though	O
some	O
detectors	O
only	O
capture	O
objects	O
partially	O
,	O
proposals	O
having	O
high	O
spatial	O
overlaps	O
with	O
detected	O
parts	O
may	O
cover	O
the	O
whole	O
object	O
,	O
or	O
at	O
least	O
contain	O
larger	O
portion	O
of	O
the	O
object	O
.	O
In	O
,	O
Bilen	O
and	O
Vedaldi	O
propose	O
a	O
spatial	Method
regulariser	Method
via	O
forcing	O
features	O
of	O
highest	O
scoring	O
region	O
and	O
its	O
adjacent	O
regions	O
to	O
be	O
the	O
same	O
,	O
which	O
significantly	O
improves	O
WSOD	Task
performance	O
.	O
Nevertheless	O
,	O
forcing	O
spatially	O
overlapped	O
proposals	O
to	O
have	O
the	O
same	O
features	O
seems	O
too	O
rigorous	O
.	O
Rather	O
than	O
taking	O
the	O
rigorous	O
constraint	O
,	O
we	O
think	O
the	O
features	O
of	O
spatially	O
overlapped	O
proposals	O
are	O
in	O
the	O
same	O
manifold	O
.	O
Then	O
these	O
overlapped	O
proposals	O
could	O
share	O
similar	O
label	O
information	O
.	O
As	O
shown	O
in	O
Fig	O
.	O
[	O
reference	O
]	O
(	O
right	O
)	O
,	O
we	O
except	O
the	O
label	O
information	O
of	O
A	O
can	O
propagate	O
to	O
B	O
and	O
C	O
which	O
has	O
large	O
overlap	O
with	O
A	O
,	O
and	O
then	O
the	O
label	O
information	O
of	O
B	O
and	O
C	O
can	O
propagate	O
to	O
D	O
to	O
correctly	O
localize	O
object	O
.	O
To	O
implement	O
this	O
idea	O
,	O
we	O
design	O
some	O
instance	Method
classifiers	Method
in	O
the	O
network	O
of	O
.	O
The	O
labels	O
of	O
instance	O
could	O
be	O
refined	O
by	O
their	O
spatially	O
overlapped	O
instances	O
.	O
We	O
name	O
this	O
new	O
network	Method
structure	Method
Multiple	Method
Instance	Method
Detection	Method
Network	Method
(	O
MIDN	Method
)	O
with	O
instance	Method
classifier	Method
.	O
In	O
practice	O
,	O
there	O
are	O
two	O
important	O
issues	O
.	O
1	O
)	O
How	O
to	O
initialize	O
instance	O
labels	O
,	O
since	O
there	O
is	O
no	O
instance	O
-	O
level	O
supervision	O
in	O
this	O
task	O
.	O
2	O
)	O
How	O
to	O
train	O
the	O
network	O
with	O
instance	Method
classifier	Method
efficiently	O
.	O
A	O
natural	O
way	O
for	O
classifier	Task
refinement	Task
is	O
the	O
alternative	O
strategy	O
,	O
that	O
is	O
,	O
alternatively	O
relabelling	Method
instance	Method
and	Method
training	Method
instance	Method
classifier	Method
,	O
while	O
this	O
procedure	O
is	O
very	O
time	O
-	O
consuming	O
,	O
especially	O
considering	O
training	O
deep	Method
networks	Method
with	O
a	O
huge	O
number	O
of	O
Stochastic	Method
Gradient	Method
Descent	Method
(	O
SGD	Method
)	Method
iterations	Method
.	O
To	O
overcome	O
these	O
difficulties	O
,	O
we	O
propose	O
a	O
novel	O
Online	Method
Instance	Method
Classifier	Method
Refinement	Method
(	O
OICR	Method
)	Method
algorithm	Method
to	O
train	O
the	O
network	O
online	O
.	O
Our	O
method	O
has	O
multiple	O
output	O
streams	O
for	O
different	O
stages	O
:	O
the	O
first	O
is	O
the	O
MIDN	Method
to	O
train	O
a	O
basic	O
instance	Method
classifier	Method
and	O
others	O
refine	O
the	O
classifier	O
.	O
To	O
refine	O
instance	Method
classifier	Method
online	O
,	O
after	O
the	O
forward	O
process	O
of	O
SGD	Method
,	O
we	O
can	O
obtain	O
a	O
set	O
of	O
proposal	O
scores	O
.	O
According	O
to	O
these	O
scores	O
,	O
for	O
each	O
stage	O
,	O
we	O
can	O
label	O
the	O
top	O
-	O
scoring	O
proposal	O
along	O
with	O
its	O
spatially	O
overlapped	O
proposals	O
to	O
the	O
image	O
label	O
.	O
Then	O
these	O
proposal	O
labels	O
can	O
be	O
used	O
as	O
the	O
supervision	O
to	O
train	O
instance	Method
classifier	Method
in	O
the	O
next	O
stage	O
.	O
Though	O
the	O
top	O
-	O
scoring	O
proposal	O
may	O
only	O
contain	O
a	O
part	O
of	O
an	O
object	O
,	O
its	O
adjacent	O
proposals	O
will	O
cover	O
larger	O
portion	O
of	O
the	O
object	O
.	O
Thus	O
the	O
instance	Method
classifier	Method
can	O
be	O
refined	O
.	O
After	O
implementing	O
the	O
refinement	Method
procedure	Method
multiple	O
times	O
,	O
the	O
detector	Method
can	O
discover	O
the	O
whole	O
object	O
instead	O
of	O
parts	O
gradually	O
,	O
as	O
shown	O
in	O
Fig	O
.	O
[	O
reference	O
]	O
.	O
But	O
in	O
the	O
beginning	O
of	O
training	O
,	O
all	O
classifiers	Method
are	O
almost	O
non	O
-	O
trained	O
,	O
which	O
will	O
result	O
in	O
very	O
noisy	O
supervision	O
of	O
refined	O
classifiers	O
,	O
and	O
then	O
the	O
training	O
will	O
deviate	O
from	O
correct	O
solutions	O
a	O
lot	O
.	O
To	O
solve	O
this	O
problem	O
,	O
we	O
design	O
a	O
weighted	O
loss	O
further	O
by	O
assigning	O
different	O
weights	O
to	O
different	O
proposals	O
in	O
different	O
training	O
iterations	O
.	O
Using	O
this	O
strategy	O
,	O
all	O
classifier	Method
refinement	Method
procedures	Method
can	O
thus	O
be	O
integrated	O
into	O
a	O
single	O
network	O
and	O
trained	O
end	O
-	O
to	O
-	O
end	O
.	O
It	O
can	O
improve	O
the	O
performance	O
benefiting	O
from	O
the	O
classifier	Method
refinement	Method
procedure	Method
.	O
Meanwhile	O
,	O
the	O
multi	Method
-	Method
stage	Method
strategy	Method
and	O
online	Method
refinement	Method
algorithm	Method
is	O
very	O
computational	O
efficient	O
in	O
both	O
training	Task
and	O
testing	Task
.	O
Moreover	O
,	O
performance	O
can	O
be	O
improved	O
by	O
sharing	O
representations	O
among	O
different	O
training	O
stages	O
.	O
We	O
elaborately	O
conduct	O
many	O
experiments	O
on	O
the	O
challenging	Material
PASCAL	Material
VOC	Material
dataset	Material
to	O
confirm	O
the	O
effectiveness	O
of	O
our	O
method	O
.	O
Our	O
method	O
achieves	O
mAP	Metric
and	O
CorLoc	Task
on	O
VOC	Material
2007	Material
that	O
outperforms	O
previous	O
best	O
performed	O
methods	O
by	O
a	O
large	O
margin	O
.	O
In	O
summary	O
,	O
the	O
main	O
contributions	O
of	O
our	O
work	O
are	O
listed	O
as	O
follows	O
.	O
We	O
propose	O
a	O
framework	O
for	O
weakly	Task
supervised	Task
learning	Task
that	O
combines	O
MIDN	Method
with	O
multi	O
-	O
stage	O
instance	Method
classifiers	Method
.	O
With	O
only	O
supervision	O
of	O
the	O
outputs	O
from	O
its	O
preceding	O
stage	O
,	O
the	O
discriminatory	O
power	O
of	O
the	O
instance	Method
classifier	Method
can	O
be	O
enhanced	O
iteratively	O
.	O
We	O
further	O
design	O
a	O
novel	O
OICR	Method
algorithm	Method
that	O
integrates	O
the	O
basic	Method
detection	Method
network	Method
and	O
the	O
multi	Method
-	Method
stage	Method
instance	Method
-	Method
level	Method
classifier	Method
into	O
a	O
single	O
network	O
.	O
The	O
proposed	O
network	O
is	O
end	O
-	O
to	O
-	O
end	O
trainable	O
.	O
Compared	O
with	O
the	O
alternatively	Method
training	Method
strategy	Method
,	O
we	O
demonstrate	O
that	O
our	O
method	O
can	O
not	O
only	O
reduce	O
the	O
training	Metric
time	Metric
,	O
but	O
also	O
boost	O
the	O
performance	O
.	O
Our	O
method	O
achieves	O
significantly	O
better	O
results	O
over	O
previous	O
state	O
-	O
of	O
-	O
the	O
-	O
art	O
methods	O
on	O
the	O
challenging	O
PASCAL	Material
VOC	Material
2007	Material
and	O
2012	Material
benchmarks	O
for	O
weakly	Task
supervised	Task
object	Task
detection	Task
.	O
section	O
:	O
Related	O
work	O
MIL	Method
is	O
a	O
classical	O
weakly	Task
supervised	Task
learning	Task
problem	Task
and	O
was	O
first	O
proposed	O
in	O
for	O
drug	Task
activity	Task
prediction	Task
.	O
After	O
that	O
,	O
many	O
solutions	O
have	O
been	O
proposed	O
for	O
MIL	Method
.	O
In	O
MIL	Method
,	O
a	O
set	O
of	O
bags	O
are	O
given	O
,	O
and	O
each	O
bag	O
is	O
associated	O
with	O
a	O
collection	O
of	O
instances	O
.	O
MIL	Method
has	O
two	O
constraints	O
:	O
1	O
)	O
If	O
a	O
bag	O
is	O
positive	O
,	O
at	O
least	O
one	O
instance	O
in	O
the	O
bag	O
is	O
positive	O
;	O
2	O
)	O
If	O
a	O
bag	O
is	O
negative	O
,	O
all	O
instances	O
in	O
the	O
bag	O
are	O
negative	O
.	O
It	O
is	O
natural	O
to	O
treat	O
WSOD	Task
as	O
a	O
MIL	Task
problem	Task
.	O
Then	O
the	O
problem	O
turns	O
into	O
finding	O
an	O
instance	Method
classifier	Method
only	O
given	O
bag	O
labels	O
.	O
Our	O
method	O
also	O
follows	O
the	O
MIL	O
line	O
,	O
and	O
the	O
classifier	Method
refinement	Method
is	O
inspired	O
by	O
the	O
classifier	Method
updating	Method
procedure	Method
in	O
mi	Method
-	Method
SVM	Method
to	O
some	O
extent	O
.	O
The	O
differences	O
are	O
that	O
,	O
in	O
mi	Method
-	Method
SVM	Method
,	O
it	O
uses	O
an	O
alternative	O
strategy	O
to	O
relabel	O
instances	O
and	O
retrain	O
a	O
classifier	Method
,	O
while	O
we	O
adopt	O
an	O
online	Method
refinement	Method
algorithm	Method
;	O
the	O
mi	Method
-	Method
SVM	Method
relabel	O
instances	O
according	O
to	O
the	O
instance	O
score	O
predicted	O
by	O
the	O
classifier	Method
,	O
while	O
we	O
select	O
instances	O
according	O
to	O
the	O
spatial	O
relation	O
.	O
Most	O
of	O
the	O
existing	O
methods	O
solve	O
the	O
WSOD	Task
problem	Task
based	O
on	O
MIL	Method
.	O
For	O
example	O
,	O
Wang	O
relaxed	O
the	O
MIL	O
restraints	O
into	O
a	O
differentiable	O
loss	O
function	O
and	O
optimized	O
it	O
by	O
SGD	Method
to	O
speed	O
up	O
training	Task
and	O
improve	O
results	O
.	O
Cibis	Method
trained	O
a	O
multi	Method
-	Method
fold	Method
MIL	Method
detector	Method
by	O
alternatively	O
relabelling	O
instances	O
and	O
retraining	Method
classifier	Method
.	O
Recently	O
,	O
some	O
researchers	O
combined	O
CNN	Method
and	O
MIL	Method
to	O
train	O
an	O
end	Method
-	Method
to	Method
-	Method
end	Method
network	Method
for	O
WSOD	Task
.	O
Oquab	Method
trained	O
a	O
CNN	Method
network	O
using	O
the	O
max	Method
-	Method
pooing	Method
MIL	Method
strategy	Method
to	O
localize	Task
objects	Task
.	O
But	O
their	O
methods	O
can	O
only	O
coarsely	O
localize	O
objects	O
regardless	O
of	O
their	O
sizes	O
and	O
aspect	O
ratios	O
,	O
our	O
method	O
can	O
detect	O
objects	O
more	O
accurately	O
.	O
Bilen	O
and	O
Vedaldi	O
proposed	O
a	O
Weakly	Method
Supervised	Method
Deep	Method
Detection	Method
Network	Method
(	O
WSDDN	Method
)	Method
,	O
which	O
presents	O
a	O
novel	O
weighted	Method
MIL	Method
pooling	Method
strategy	Method
and	O
combines	O
with	O
the	O
proposal	Method
objectness	Method
and	Method
spatial	Method
regulariser	Method
for	O
better	O
performance	O
.	O
Based	O
on	O
the	O
WSDDN	Method
,	O
Kantorov	Method
used	O
a	O
contrastive	Method
model	Method
to	O
consider	O
the	O
context	O
information	O
for	O
improvement	O
.	O
We	O
also	O
choose	O
the	O
WSDDN	Method
as	O
our	O
basic	O
network	O
,	O
but	O
we	O
combine	O
it	O
with	O
multi	Method
-	Method
stage	Method
classifier	Method
refinement	Method
,	O
and	O
propose	O
a	O
novel	O
OICR	Method
algorithm	Method
to	O
train	O
our	O
network	O
effectively	O
and	O
efficiently	O
,	O
which	O
can	O
boost	O
the	O
performance	O
significantly	O
.	O
Different	O
from	O
the	O
spatial	Method
regulariser	Method
in	O
WSDDN	Method
that	O
forces	O
features	O
of	O
highest	O
scoring	O
proposal	O
and	O
its	O
spatially	O
overlapped	O
proposals	O
to	O
be	O
the	O
same	O
,	O
our	O
OICR	Method
assumes	O
features	O
of	O
spatially	O
overlapped	O
proposals	O
are	O
in	O
the	O
same	O
manifold	O
,	O
which	O
is	O
more	O
reasonable	O
.	O
Experiments	O
on	O
Section	O
[	O
reference	O
]	O
demonstrate	O
that	O
our	O
strategy	O
can	O
obtain	O
more	O
superior	O
results	O
.	O
The	O
proposal	Method
labelling	Method
procedure	Method
is	O
also	O
related	O
to	O
the	O
semi	Method
-	Method
supervised	Method
label	Method
propagation	Method
method	Method
.	O
But	O
in	O
label	Task
propagation	Task
,	O
it	O
labels	O
data	O
according	O
to	O
the	O
similarity	O
among	O
labelled	O
and	O
unlabelled	O
data	O
,	O
while	O
we	O
use	O
spatial	O
overlap	O
as	O
the	O
metric	O
;	O
and	O
there	O
are	O
no	O
available	O
labelled	O
instances	O
for	O
propagation	Task
,	O
which	O
is	O
quite	O
different	O
from	O
semi	Method
-	Method
supervised	Method
methods	Method
.	O
Meanwhile	O
,	O
the	O
sharing	Method
representation	Method
strategy	Method
in	O
our	O
network	O
is	O
similar	O
to	O
multi	Task
-	Task
task	Task
learning	Task
.	O
Unlike	O
the	O
multi	Method
-	Method
task	Method
learning	Method
that	O
each	O
output	O
stream	O
has	O
their	O
own	O
relatively	O
independent	O
external	O
supervision	O
,	O
in	O
our	O
method	O
,	O
supervision	O
of	O
latter	O
streams	O
only	O
depends	O
on	O
the	O
outputs	O
from	O
their	O
preceding	O
streams	O
.	O
section	O
:	O
Method	O
The	O
overall	O
architecture	O
of	O
our	O
method	O
is	O
shown	O
in	O
Fig	O
.	O
[	O
reference	O
]	O
.	O
Given	O
an	O
image	O
,	O
we	O
first	O
generate	O
about	O
object	O
proposals	O
by	O
Selective	Method
Search	Method
.	O
The	O
image	O
and	O
these	O
proposals	O
are	O
fed	O
into	O
some	O
convolutional	Method
(	Method
conv	Method
)	Method
layers	Method
with	O
Spatial	Method
Pyramid	Method
Pooling	Method
(	Method
SPP	Method
)	Method
layer	Method
to	O
produce	O
a	O
fixed	O
-	O
size	O
conv	O
feature	O
map	O
per	O
-	O
proposal	O
,	O
and	O
then	O
they	O
are	O
fed	O
into	O
two	O
fully	Method
connected	Method
(	Method
fc	Method
)	Method
layers	Method
to	O
generate	O
a	O
collection	O
of	O
proposal	O
feature	O
vectors	O
.	O
These	O
features	O
are	O
branched	O
into	O
different	O
streams	O
,	O
,	O
different	O
stages	O
:	O
the	O
first	O
one	O
is	O
the	O
MIDN	Method
to	O
train	O
a	O
basic	O
instance	Method
classifier	Method
and	O
others	O
refine	O
classifier	Method
.	O
Specially	O
,	O
supervision	O
for	O
classifier	Task
refinement	Task
is	O
decided	O
by	O
outputs	O
from	O
their	O
preceding	O
stages	O
,	O
,	O
supervision	O
of	O
the	O
first	O
refined	Method
classifier	Method
depends	O
on	O
the	O
output	O
from	O
the	O
basic	Method
classifier	Method
,	O
and	O
supervision	Method
of	Method
refined	Method
classifier	Method
depends	O
on	O
outputs	O
from	O
refined	Method
classifier	Method
.	O
In	O
this	O
section	O
,	O
we	O
will	O
introduce	O
the	O
chosen	O
basic	O
MIDN	Method
,	O
and	O
explain	O
our	O
OICR	Method
algorithm	Method
in	O
detail	O
.	O
subsection	O
:	O
Multiple	Method
instance	Method
detection	Method
network	Method
It	O
is	O
necessary	O
to	O
achieve	O
instance	O
-	O
level	O
supervision	O
to	O
train	O
refined	O
classifier	Method
,	O
yet	O
such	O
supervision	Method
is	O
unavailable	O
.	O
As	O
we	O
have	O
stated	O
before	O
,	O
the	O
top	O
-	O
scoring	O
proposal	O
by	O
instance	Method
classifiers	Method
and	O
its	O
adjacent	O
proposals	O
can	O
be	O
labelled	O
to	O
its	O
image	O
label	O
as	O
supervision	O
.	O
So	O
we	O
first	O
introduce	O
our	O
MIDN	Method
to	O
generate	O
the	O
basic	O
instance	Method
classifier	Method
.	O
There	O
are	O
many	O
possible	O
choices	O
to	O
achieve	O
this	O
.	O
Here	O
we	O
choose	O
the	O
method	O
by	O
Bilen	O
and	O
Vedaldi	O
which	O
proposes	O
a	O
weighted	Method
pooling	Method
strategy	Method
to	O
obtain	O
the	O
instance	Method
classifier	Method
,	O
for	O
its	O
effectiveness	O
and	O
implementation	O
convenience	O
.	O
Notice	O
that	O
our	O
network	O
is	O
independent	O
of	O
special	O
MIL	Method
methods	Method
,	O
so	O
any	O
method	O
that	O
can	O
be	O
trained	O
end	O
-	O
to	O
-	O
end	O
could	O
be	O
embedded	O
into	O
our	O
network	O
.	O
As	O
shown	O
in	O
the	O
“	O
Multiple	Method
instance	Method
detection	Method
network	Method
”	O
block	O
of	O
Fig	O
.	O
[	O
reference	O
]	O
,	O
proposal	O
features	O
are	O
branched	O
into	O
two	O
streams	O
to	O
produce	O
two	O
matrices	O
of	O
image	O
by	O
two	O
fc	Method
layers	Method
,	O
where	O
denotes	O
the	O
number	O
of	O
image	O
classes	O
and	O
denotes	O
the	O
number	O
of	O
proposals	O
.	O
Then	O
the	O
two	O
matrices	O
are	O
passing	O
through	O
two	O
softmax	Method
layer	Method
along	O
different	O
directions	O
:	O
and	O
.	O
The	O
proposal	O
scores	O
are	O
generated	O
by	O
element	Method
-	Method
wise	Method
product	Method
.	O
At	O
last	O
,	O
image	O
score	O
of	O
class	O
can	O
be	O
obtained	O
by	O
the	O
sum	O
over	O
all	O
proposals	O
:	O
.	O
The	O
interpretation	O
of	O
the	O
two	O
streams	Method
framework	Method
is	O
as	O
follows	O
.	O
The	O
is	O
the	O
probability	O
of	O
proposal	O
belonging	O
to	O
class	O
.	O
The	O
is	O
the	O
normalized	O
weight	O
that	O
indicates	O
the	O
contribution	O
of	O
proposal	O
to	O
image	O
being	O
classified	O
to	O
class	O
.	O
So	O
is	O
achieved	O
by	O
weighted	Method
sum	Method
pooling	Method
and	O
falls	O
in	O
the	O
range	O
of	O
.	O
Given	O
image	O
label	O
,	O
where	O
or	O
indicates	O
the	O
image	O
with	O
or	O
without	O
object	O
.	O
We	O
can	O
train	O
the	O
basic	O
instance	Method
classifier	Method
by	O
standard	O
multi	Method
-	Method
class	Method
cross	Method
entropy	Method
loss	Method
,	O
as	O
shown	O
in	O
Eq	O
.	O
(	O
[	O
reference	O
]	O
)	O
,	O
then	O
the	O
instance	Method
classifier	Method
can	O
be	O
obtained	O
according	O
to	O
the	O
proposal	O
score	O
.	O
More	O
details	O
can	O
be	O
found	O
in	O
.	O
subsection	O
:	O
Online	Task
instance	Task
classifier	Task
refinement	Task
In	O
the	O
last	O
subsection	O
,	O
we	O
have	O
obtained	O
the	O
basic	O
instance	Method
classifier	Method
.	O
Here	O
we	O
will	O
expound	O
how	O
to	O
refine	O
instance	Method
classifiers	Method
online	O
.	O
A	O
natural	O
way	O
to	O
refine	O
classifier	Method
is	O
an	O
alternative	O
strategy	O
,	O
that	O
is	O
,	O
fixing	O
the	O
classifier	O
and	O
labelling	O
proposals	O
,	O
fixing	O
proposal	O
labels	O
and	O
training	O
the	O
classifier	Method
.	O
But	O
it	O
has	O
some	O
limitations	O
:	O
1	O
)	O
It	O
is	O
very	O
time	O
-	O
consuming	O
as	O
it	O
requires	O
training	O
the	O
classifier	Method
multiple	O
times	O
;	O
2	O
)	O
Training	O
different	O
classifiers	Method
in	O
different	O
refinement	O
steps	O
separately	O
may	O
harm	O
the	O
performance	O
because	O
it	O
hinders	O
the	O
process	O
to	O
benefit	O
from	O
the	O
shared	Method
representations	Method
.	O
Hence	O
,	O
we	O
integrate	O
the	O
basic	O
MIDN	Method
and	O
different	O
classifier	Method
refinement	Method
stages	Method
into	O
a	O
single	O
network	O
and	O
train	O
it	O
end	O
-	O
to	O
-	O
end	O
.	O
The	O
difficulty	O
is	O
how	O
to	O
obtain	O
instance	O
labels	O
for	O
refinement	Task
when	O
there	O
are	O
no	O
available	O
labelled	O
instances	O
.	O
To	O
deal	O
with	O
this	O
problem	O
,	O
we	O
propose	O
an	O
online	Method
labelling	Method
and	Method
refinement	Method
strategy	Method
.	O
Different	O
from	O
the	O
basic	O
instance	Method
classifier	Method
,	O
the	O
output	O
score	O
vector	O
of	O
proposal	O
for	O
refined	Method
classifier	Method
is	O
a	O
-	O
dimensional	O
vector	O
,	O
,	O
,	O
where	O
the	O
is	O
for	O
time	Task
refinement	Task
,	O
is	O
the	O
total	O
refinement	O
times	O
,	O
and	O
the	O
dimension	O
is	O
for	O
background	O
(	O
here	O
we	O
represent	O
the	O
proposal	O
score	O
vector	O
from	O
the	O
basic	Method
classifier	Method
as	O
)	O
.	O
The	O
is	O
obtained	O
by	O
passing	O
the	O
proposal	O
feature	O
vector	O
through	O
a	O
single	O
fc	Method
layer	Method
and	O
a	O
softmax	Method
over	Method
classes	Method
layer	Method
,	O
as	O
shown	O
in	O
the	O
“	O
Instance	Method
classifier	Method
refinement	Method
”	O
block	O
of	O
Fig	O
.	O
[	O
reference	O
]	O
.	O
Suppose	O
the	O
label	O
vector	O
for	O
proposal	O
is	O
.	O
In	O
each	O
training	O
iteration	O
,	O
after	O
the	O
forward	Method
process	Method
of	O
SGD	Method
,	O
we	O
can	O
get	O
a	O
set	O
of	O
proposal	O
scores	O
.	O
Then	O
we	O
can	O
obtain	O
the	O
supervision	O
of	O
refinement	O
time	O
according	O
to	O
.	O
There	O
are	O
many	O
possible	O
methods	O
to	O
obtain	O
instance	O
labels	O
using	O
,	O
,	O
labeling	O
an	O
instance	O
as	O
positive	O
if	O
its	O
score	O
exceeds	O
a	O
threshold	O
,	O
otherwise	O
as	O
negative	O
,	O
as	O
the	O
mi	Method
-	Method
SVM	Method
.	O
But	O
in	O
our	O
case	O
,	O
the	O
score	O
for	O
each	O
instance	O
is	O
changed	O
during	O
each	O
training	O
iteration	O
,	O
and	O
for	O
different	O
classes	O
,	O
using	O
the	O
same	O
threshold	O
may	O
not	O
be	O
suitable	O
,	O
thus	O
it	O
is	O
hard	O
to	O
settle	O
a	O
threshold	O
.	O
Here	O
we	O
choose	O
a	O
different	O
strategy	O
,	O
inspired	O
by	O
the	O
fact	O
that	O
highly	O
spatially	O
overlapped	O
instances	O
should	O
have	O
the	O
same	O
label	O
.	O
Suppose	O
an	O
image	O
has	O
class	O
label	O
,	O
we	O
first	O
select	O
proposal	O
with	O
highest	O
score	O
for	O
time	O
as	O
in	O
Eq	O
.	O
(	O
[	O
reference	O
]	O
)	O
,	O
and	O
label	O
it	O
to	O
class	O
,	O
,	O
and	O
.	O
As	O
different	O
proposals	O
always	O
have	O
overlaps	O
,	O
and	O
proposals	O
with	O
high	O
overlap	O
should	O
belong	O
to	O
the	O
same	O
class	O
,	O
we	O
can	O
label	O
proposal	O
and	O
its	O
adjacent	O
proposals	O
to	O
class	O
for	O
refinement	Task
,	O
,	O
if	O
proposal	O
have	O
a	O
high	O
overlap	O
with	O
proposal	O
,	O
we	O
label	O
proposal	O
to	O
class	O
(	O
)	O
,	O
otherwise	O
we	O
label	O
proposal	O
as	O
background	O
(	O
)	O
.	O
Here	O
we	O
label	O
proposal	O
to	O
class	O
if	O
the	O
IoU	O
between	O
proposal	O
and	O
greater	O
than	O
a	O
threshold	O
which	O
is	O
determined	O
by	O
experiments	O
.	O
Meanwhile	O
,	O
if	O
there	O
is	O
no	O
object	O
in	O
the	O
image	O
,	O
we	O
set	O
all	O
.	O
Using	O
this	O
supervision	O
,	O
we	O
can	O
train	O
the	O
refined	Method
classifier	Method
based	O
on	O
the	O
loss	O
function	O
in	O
Eq	O
.	O
(	O
[	O
reference	O
]	O
)	O
.	O
Through	O
multiple	O
times	O
of	O
refinement	O
,	O
our	O
detector	O
can	O
detect	O
larger	O
parts	O
of	O
objects	O
gradually	O
.	O
[	O
t	O
]	O
Online	Method
instance	Method
classifier	Method
refinement	Method
[	O
1	O
]	O
Image	O
and	O
its	O
proposals	O
;	O
image	O
label	O
vector	O
;	O
refinement	O
times	O
.	O
Loss	O
weights	O
;	O
proposal	O
label	O
vectors	O
.	O
Where	O
and	O
.	O
Feed	O
and	O
its	O
proposals	O
into	O
the	O
network	O
to	O
produce	O
proposal	O
score	O
matrices	O
,	O
.	O
Set	O
all	O
elements	O
in	O
to	O
.	O
Set	O
all	O
and	O
.	O
Choose	O
the	O
top	O
-	O
scoring	O
proposal	O
by	O
Eq	O
.	O
(	O
[	O
reference	O
]	O
)	O
.	O
Compute	O
IoU	O
between	O
proposal	O
and	O
.	O
Set	O
and	O
.	O
Set	O
and	O
.	O
Actually	O
the	O
acquired	O
supervision	O
for	O
refining	Task
classifier	Task
is	O
very	O
noisy	O
,	O
especially	O
in	O
the	O
beginning	O
of	O
training	O
,	O
which	O
will	O
result	O
in	O
unstable	O
solutions	O
.	O
To	O
solve	O
this	O
problem	O
,	O
we	O
change	O
the	O
loss	O
in	O
Eq	O
.	O
(	O
[	O
reference	O
]	O
)	O
to	O
a	O
weighted	Method
version	Method
,	O
as	O
in	O
Eq	O
.	O
(	O
[	O
reference	O
]	O
)	O
.	O
where	O
is	O
the	O
loss	O
weight	O
and	O
can	O
be	O
acquired	O
by	O
the	O
line	Method
of	Method
Algorithm	Method
[	O
reference	O
]	O
.	O
The	O
explanation	O
of	O
such	O
choice	O
is	O
as	O
follows	O
.	O
In	O
the	O
beginning	O
of	O
training	O
,	O
the	O
is	O
small	O
,	O
hence	O
,	O
the	O
loss	Metric
is	O
also	O
small	O
.	O
As	O
a	O
consequence	O
,	O
the	O
performance	O
of	O
the	O
network	O
will	O
not	O
decrease	O
a	O
lot	O
though	O
good	O
positive	O
instances	O
can	O
not	O
be	O
found	O
.	O
Meanwhile	O
,	O
during	O
the	O
training	O
procedure	O
,	O
the	O
network	O
can	O
achieve	O
positive	O
instances	O
with	O
high	O
scores	O
easily	O
for	O
easy	O
bags	O
,	O
and	O
these	O
positive	O
instances	O
are	O
always	O
with	O
high	O
scores	O
,	O
,	O
is	O
large	O
.	O
On	O
the	O
contrary	O
,	O
it	O
is	O
difficult	O
to	O
get	O
positive	O
instances	O
for	O
difficult	O
bags	O
,	O
as	O
a	O
result	O
,	O
these	O
positive	O
instances	O
are	O
always	O
very	O
noisy	O
.	O
Nevertheless	O
,	O
the	O
refined	O
classifier	Method
will	O
not	O
deviate	O
from	O
the	O
correct	O
solution	O
a	O
lot	O
,	O
because	O
the	O
scores	O
of	O
these	O
noisy	O
positive	O
instances	O
are	O
relatively	O
low	O
,	O
,	O
is	O
small	O
.	O
To	O
make	O
the	O
OICR	Method
algorithm	Method
more	O
clear	O
,	O
we	O
summarize	O
the	O
process	O
to	O
obtain	O
supervision	O
in	O
Algorithm	O
[	O
reference	O
]	O
,	O
where	O
indicates	O
the	O
maximum	O
IoU	O
between	O
proposal	O
and	O
the	O
top	O
-	O
scoring	O
proposal	O
.	O
After	O
obtaining	O
supervision	O
and	O
loss	O
for	O
training	O
refined	Method
classifiers	Method
,	O
we	O
can	O
get	O
the	O
loss	O
of	O
our	O
overall	Method
network	Method
by	O
combining	O
Eq	O
.	O
(	O
[	O
reference	O
]	O
)	O
and	O
Eq	O
.	O
(	O
[	O
reference	O
]	O
)	O
,	O
as	O
Eq	O
.	O
(	O
[	O
reference	O
]	O
)	O
.	O
Through	O
optimizing	O
this	O
loss	O
function	O
,	O
we	O
can	O
integrate	O
the	O
basic	Method
network	Method
and	O
different	O
classifier	Method
refinement	Method
stages	Method
into	O
a	O
single	O
network	O
,	O
and	O
share	O
representations	O
among	O
different	O
stages	O
.	O
section	O
:	O
Experiments	O
subsection	O
:	O
Experimental	O
setup	O
In	O
this	O
section	O
we	O
will	O
perform	O
thorough	O
experiments	O
to	O
analyse	O
our	O
OICR	Method
and	O
its	O
components	O
for	O
weakly	Task
supervised	Task
object	Task
detection	Task
.	O
paragraph	O
:	O
Datasets	O
and	O
evaluation	Metric
measures	Metric
We	O
evaluate	O
our	O
method	O
on	O
the	O
challenging	O
PASCAL	Material
VOC	Material
2007	Material
and	O
2012	Material
datasets	O
which	O
have	O
and	O
images	O
respectively	O
for	O
object	O
classes	O
.	O
These	O
two	O
datasets	O
are	O
divided	O
into	O
train	O
,	O
val	O
,	O
and	O
test	O
sets	O
.	O
Here	O
we	O
choose	O
the	O
trainval	O
set	O
(	O
images	O
for	O
2007	O
and	O
for	O
2012	Material
)	O
to	O
train	O
our	O
network	O
.	O
As	O
we	O
focus	O
on	O
weakly	Task
supervised	Task
detection	Task
,	O
only	O
image	O
-	O
level	O
labels	O
are	O
utilized	O
during	O
training	O
.	O
For	O
testing	O
,	O
there	O
are	O
two	O
metrics	O
for	O
evaluation	Task
:	O
mAP	Metric
and	O
CorLoc	Metric
.	O
Average	Metric
Precision	Metric
(	O
AP	Metric
)	O
and	O
the	O
mean	Metric
of	Metric
AP	Metric
(	O
mAP	Metric
)	O
is	O
the	O
evaluation	Metric
metric	Metric
to	O
test	O
our	O
model	O
on	O
the	O
testing	O
set	O
,	O
which	O
follows	O
the	O
standard	O
PASCAL	Material
VOC	Material
protocol	Material
.	O
Correct	Metric
localization	Metric
(	O
CorLoc	Metric
)	O
is	O
to	O
test	O
our	O
model	O
on	O
the	O
training	O
set	O
measuring	O
the	O
localization	Metric
accuracy	Metric
.	O
All	O
these	O
two	O
metrics	O
are	O
based	O
on	O
the	O
PASCAL	Metric
criteria	Metric
,	O
,	O
IoU	O
0.5	O
between	O
ground	O
truths	O
and	O
predicted	O
boxes	O
.	O
paragraph	O
:	O
Implementation	O
details	O
Our	O
method	O
is	O
built	O
on	O
two	O
pre	Method
-	Method
trained	Method
ImageNet	Method
networks	Method
:	O
VGG	Method
M	Method
and	O
VGG16	Method
,	O
each	O
of	O
which	O
has	O
some	O
conv	Method
layers	Method
with	O
max	Method
-	Method
pooling	Method
layer	Method
and	O
three	O
fc	Method
layers	Method
.	O
We	O
replace	O
the	O
last	O
max	Method
-	Method
pooling	Method
layer	Method
of	O
the	O
two	O
models	O
by	O
SPP	Method
layer	Method
,	O
and	O
the	O
last	O
fc	Method
layer	Method
and	O
softmax	Method
loss	Method
layer	Method
by	O
the	O
layers	O
described	O
in	O
Section	O
[	O
reference	O
]	O
.	O
To	O
increase	O
the	O
feature	O
map	O
size	O
from	O
the	O
last	O
conv	O
layer	O
,	O
we	O
replace	O
the	O
penultimate	Method
max	Method
-	Method
pooling	Method
layer	Method
and	O
its	O
subsequent	O
conv	Method
layers	Method
by	O
the	O
dilated	Method
conv	Method
layers	Method
.	O
The	O
new	O
added	O
layers	O
are	O
initialized	O
using	O
Gaussian	Method
distributions	Method
with	O
-	O
mean	O
and	O
standard	O
deviations	O
.	O
Biases	O
are	O
initialized	O
to	O
.	O
During	O
training	Task
,	O
the	O
mini	O
-	O
batch	O
size	O
for	O
SGD	Method
is	O
set	O
to	O
,	O
and	O
the	O
learning	Metric
rate	Metric
is	O
set	O
to	O
for	O
the	O
first	O
K	O
iterations	O
and	O
then	O
decrease	O
to	O
in	O
the	O
following	O
K	O
iterations	O
.	O
The	O
momentum	O
and	O
weight	O
decay	O
are	O
set	O
to	O
and	O
respectively	O
.	O
As	O
we	O
have	O
stated	O
in	O
Section	O
[	O
reference	O
]	O
,	O
Selective	Method
Search	Method
(	O
SS	Method
)	Method
is	O
adopted	O
to	O
generate	O
about	O
proposals	O
per	O
-	O
image	O
.	O
For	O
data	Task
augmentation	Task
,	O
we	O
use	O
five	O
image	O
scales	O
(	O
resize	O
the	O
shortest	O
side	O
to	O
one	O
of	O
these	O
scales	O
)	O
and	O
cap	O
the	O
longest	O
image	O
side	O
to	O
less	O
than	O
with	O
horizontal	O
flips	O
for	O
both	O
training	O
and	O
testing	Task
.	O
We	O
refine	O
instance	Method
classifier	Method
three	O
times	O
,	O
,	O
in	O
Section	O
[	O
reference	O
]	O
,	O
so	O
there	O
are	O
four	O
stages	O
in	O
total	O
.	O
The	O
IoU	O
threshold	O
in	O
the	O
line	O
of	O
Algorithm	O
[	O
reference	O
]	O
is	O
set	O
to	O
.	O
During	O
testing	O
,	O
the	O
mean	O
output	O
of	O
these	O
three	O
refined	Method
classifiers	Method
is	O
chosen	O
.	O
We	O
also	O
follow	O
the	O
to	O
train	O
a	O
supervised	Method
object	Method
detector	Method
by	O
choosing	O
top	O
-	O
scoring	O
proposals	O
given	O
by	O
our	O
method	O
as	O
pseudo	O
ground	O
truths	O
to	O
further	O
improve	O
our	O
results	O
.	O
Here	O
we	O
train	O
a	O
Fast	Method
RCNN	Method
(	O
FRCNN	Method
)	O
detector	O
using	O
the	O
VGG16	Method
model	Method
and	O
the	O
same	O
five	O
image	O
scales	O
(	O
horizontal	O
flips	O
only	O
in	O
training	O
)	O
.	O
SS	Method
is	O
also	O
chosen	O
for	O
proposal	Task
generation	Task
to	O
train	O
the	O
FRCNN	Method
.	O
Non	Method
-	Method
maxima	Method
suppression	Method
(	O
with	O
IoU	O
threshold	O
)	O
is	O
applied	O
to	O
compute	O
AP	Metric
and	O
CorLoc	O
.	O
Our	O
experiments	O
are	O
implemented	O
based	O
on	O
the	O
Caffe	Method
deep	Method
learning	Method
framework	Method
.	O
All	O
of	O
our	O
experiments	O
are	O
running	O
on	O
a	O
NVIDIA	Method
GTX	Method
TitanX	Method
GPU	Method
.	O
Codes	O
for	O
reproducing	O
the	O
results	O
are	O
available	O
at	O
.	O
subsection	O
:	O
Ablation	Task
experiments	O
We	O
first	O
conduct	O
some	O
ablation	O
experiments	O
to	O
illustrate	O
the	O
effectiveness	O
of	O
our	O
training	Method
strategy	Method
,	O
including	O
the	O
influence	O
of	O
classifier	Method
refinement	Method
,	O
OICR	Method
,	O
weighted	Method
loss	Method
,	O
and	O
the	O
IoU	O
threshold	O
.	O
Without	O
loss	O
generality	O
,	O
we	O
only	O
perform	O
experiments	O
on	O
VOC	Material
2007	Material
and	O
use	O
the	O
VGG	Method
M	Method
model	Method
.	O
subsubsection	O
:	O
The	O
influence	O
of	O
instance	Method
classifier	Method
refinement	Method
As	O
in	O
the	O
blue	O
line	O
of	O
Fig	O
.	O
[	O
reference	O
]	O
,	O
we	O
can	O
observe	O
that	O
compared	O
with	O
the	O
basic	O
network	O
,	O
even	O
just	O
refining	O
instance	Method
classifier	Method
one	O
time	O
can	O
boost	O
the	O
performance	O
a	O
lot	O
(	O
mAP	Metric
from	O
to	O
and	O
CorLoc	O
from	O
to	O
)	O
,	O
which	O
confirms	O
the	O
necessity	O
of	O
refinement	O
.	O
If	O
we	O
refine	O
the	O
classifier	O
multiple	O
times	O
,	O
the	O
results	O
can	O
be	O
improved	O
further	O
.	O
But	O
when	O
refinement	Method
is	O
implemented	O
too	O
many	O
times	O
,	O
the	O
performance	O
tends	O
to	O
be	O
saturated	O
(	O
the	O
improvement	O
from	O
2	O
times	O
to	O
3	O
times	O
is	O
small	O
)	O
.	O
Maybe	O
this	O
is	O
because	O
the	O
network	O
tends	O
to	O
converge	O
so	O
that	O
the	O
supervision	O
of	O
time	O
is	O
similar	O
to	O
time	O
.	O
In	O
the	O
rest	O
of	O
this	O
paper	O
we	O
only	O
refine	O
the	O
classifier	O
times	O
.	O
Notice	O
that	O
in	O
Fig	O
.	O
[	O
reference	O
]	O
,	O
the	O
“	O
0	O
time	O
”	O
is	O
similar	O
to	O
the	O
WSDDN	Method
using	O
SS	Method
as	O
proposals	O
.	O
Our	O
result	O
is	O
a	O
little	O
worse	O
than	O
theirs	O
(	O
mAP	Metric
in	O
their	O
paper	O
)	O
,	O
due	O
to	O
the	O
different	O
implementing	O
platform	O
and	O
details	O
.	O
subsubsection	O
:	O
The	O
influence	O
of	O
OICR	Method
Fig	O
.	O
[	O
reference	O
]	O
compares	O
the	O
results	O
of	O
different	O
refinement	O
times	O
and	O
different	O
training	Method
strategies	Method
for	O
classifier	Task
refinement	Task
.	O
As	O
we	O
can	O
see	O
,	O
whether	O
for	O
our	O
OICR	Method
algorithm	Method
or	O
the	O
alternative	O
strategy	O
,	O
results	O
can	O
be	O
improved	O
by	O
refinement	O
.	O
More	O
importantly	O
,	O
compared	O
with	O
the	O
alternatively	Method
refinement	Method
strategy	Method
,	O
our	O
OICR	Method
can	O
boost	O
the	O
performance	O
consistently	O
and	O
significantly	O
,	O
which	O
confirms	O
the	O
necessity	O
of	O
sharing	O
representations	O
.	O
Meanwhile	O
,	O
our	O
method	O
can	O
also	O
reduce	O
the	O
training	Metric
time	Metric
a	O
lot	O
,	O
as	O
it	O
only	O
requires	O
to	O
train	O
a	O
single	O
model	O
instead	O
of	O
training	O
models	O
for	O
times	O
refinement	O
in	O
the	O
alternative	O
strategy	O
.	O
subsubsection	O
:	O
The	O
influence	O
of	O
weighted	Method
loss	Method
We	O
also	O
study	O
the	O
influence	O
of	O
our	O
weighted	Method
loss	Method
in	O
Eq	O
.	O
(	O
[	O
reference	O
]	O
)	O
.	O
So	O
here	O
we	O
train	O
a	O
network	O
based	O
on	O
the	O
Eq	O
.	O
(	O
[	O
reference	O
]	O
)	O
.	O
From	O
Table	O
[	O
reference	O
]	O
,	O
we	O
can	O
see	O
that	O
using	O
the	O
unweighted	O
loss	O
,	O
the	O
improvement	O
from	O
refinement	Task
is	O
very	O
scant	O
,	O
and	O
the	O
performance	O
is	O
even	O
worse	O
than	O
the	O
alternative	O
strategy	O
.	O
Using	O
the	O
weighted	Method
loss	Method
can	O
achieve	O
much	O
better	O
performance	O
,	O
which	O
confirms	O
our	O
theory	O
in	O
Section	O
[	O
reference	O
]	O
.	O
subsubsection	O
:	O
The	O
influence	O
of	O
IoU	O
threshold	O
In	O
previous	O
experiments	O
,	O
we	O
set	O
the	O
IoU	O
threshold	O
in	O
the	O
line	O
of	O
Algorithm	O
[	O
reference	O
]	O
to	O
.	O
Here	O
we	O
conduct	O
experiments	O
to	O
analyse	O
the	O
influence	O
of	O
.	O
As	O
in	O
Fig	O
.	O
[	O
reference	O
]	O
,	O
outperforms	O
other	O
choices	O
,	O
and	O
the	O
results	O
are	O
not	O
very	O
sensitive	O
to	O
the	O
:	O
when	O
changing	O
from	O
to	O
,	O
the	O
performance	O
only	O
drops	O
a	O
little	O
(	O
mAP	Metric
from	O
to	O
,	O
CorLoc	O
maintains	O
)	O
.	O
Here	O
we	O
set	O
to	O
in	O
other	O
experiments	O
.	O
subsection	O
:	O
Comparison	O
with	O
other	O
methods	O
We	O
report	O
our	O
results	O
for	O
each	O
class	O
on	O
VOC	Material
2007	Material
and	O
2012	Material
in	O
Table	O
[	O
reference	O
]	O
,	O
Table	O
[	O
reference	O
]	O
,	O
and	O
Table	O
[	O
reference	O
]	O
.	O
Compared	O
with	O
other	O
methods	O
,	O
our	O
method	O
achieves	O
the	O
state	O
-	O
of	O
-	O
the	O
-	O
art	O
performance	O
using	O
single	O
model	O
,	O
and	O
even	O
outperforms	O
the	O
results	O
by	O
combining	O
multiple	O
different	O
models	O
.	O
Specially	O
,	O
our	O
methods	O
achieves	O
much	O
better	O
performance	O
than	O
the	O
method	O
by	O
Bilen	Method
and	O
Vedaldi	Method
using	O
the	O
same	O
CNN	Method
model	O
.	O
Notice	O
that	O
not	O
only	O
uses	O
the	O
weighted	Method
pooling	Method
as	O
we	O
stated	O
in	O
Section	O
[	O
reference	O
]	O
,	O
but	O
also	O
combines	O
the	O
objectness	Method
measure	Method
of	Method
EdgeBoxes	Method
and	O
the	O
spatial	Method
regulariser	Method
,	O
which	O
is	O
much	O
complicated	O
than	O
our	O
basic	O
MIDN	Method
.	O
We	O
believe	O
that	O
our	O
performance	O
can	O
be	O
improved	O
by	O
choosing	O
better	O
basic	Method
detection	Method
network	Method
,	O
like	O
the	O
complete	Method
network	Method
in	O
and	O
using	O
the	O
context	O
information	O
.	O
As	O
reimplementing	O
their	O
method	O
completely	O
is	O
trivial	O
,	O
here	O
we	O
only	O
choose	O
the	O
simplest	O
architecture	O
in	O
.	O
Even	O
in	O
this	O
simplified	O
case	O
,	O
our	O
method	O
can	O
achieve	O
very	O
promising	O
results	O
.	O
We	O
also	O
show	O
some	O
visualization	O
comparisons	O
among	O
the	O
WSDDN	Method
,	O
the	O
WSDDN	Method
+	Method
context	Method
,	O
and	O
our	O
method	O
in	O
Fig	O
.	O
[	O
reference	O
]	O
of	O
the	O
Supplementary	O
Material	O
.	O
Our	O
results	O
can	O
also	O
be	O
improved	O
by	O
combing	O
multiple	Method
models	Method
.	O
As	O
shown	O
in	O
the	O
tables	O
,	O
if	O
we	O
simply	O
sum	O
up	O
the	O
scores	O
produced	O
by	O
the	O
VGG	Method
M	Method
model	Method
and	O
VGG16	Method
model	Method
(	O
OICR	Method
-	Method
Ens	Method
.	O
in	O
tables	O
)	O
,	O
there	O
is	O
little	O
improvement	O
.	O
Also	O
,	O
as	O
mentioned	O
in	O
Section	O
[	O
reference	O
]	O
,	O
we	O
train	O
a	O
FRCNN	Method
detector	O
using	O
top	O
-	O
scoring	O
proposals	O
produced	O
by	O
OICR	Method
-	Method
Ens	Method
.	O
as	O
ground	O
truths	O
(	O
OICR	Method
-	Method
Ens.	Method
+	O
FRCNN	Method
in	O
tables	O
)	O
.	O
As	O
we	O
can	O
see	O
,	O
the	O
performance	O
can	O
be	O
improved	O
further	O
.	O
Though	O
our	O
method	O
significantly	O
outperforms	O
other	O
methods	O
for	O
some	O
class	O
,	O
like	O
“	O
bicyle	O
”	O
,	O
“	O
bus	O
”	O
,	O
“	O
motorbike	O
”	O
,	O
etc	O
,	O
the	O
performance	O
is	O
poor	O
for	O
classes	O
like	O
“	O
cat	O
”	O
,	O
“	O
dog	O
”	O
,	O
and	O
“	O
person	O
”	O
.	O
For	O
analysis	O
,	O
we	O
visualize	O
some	O
success	Metric
and	Metric
failure	Metric
detection	Metric
results	O
on	O
VOC	Material
2007	Material
trainval	O
by	O
OICR	Method
-	Method
Ens	Method
.	O
,	O
as	O
in	O
Fig	O
.	O
[	O
reference	O
]	O
.	O
We	O
can	O
observe	O
that	O
,	O
our	O
method	O
is	O
robust	O
to	O
the	O
size	O
and	O
aspect	O
of	O
objects	O
,	O
especially	O
for	O
rigid	O
objects	O
.	O
The	O
main	O
failures	O
for	O
these	O
rigid	O
objects	O
are	O
always	O
due	O
to	O
overlarge	O
boxes	O
that	O
not	O
only	O
contain	O
objects	O
,	O
but	O
also	O
include	O
their	O
adjacent	O
similar	O
objects	O
.	O
For	O
non	O
-	O
rigid	O
objects	O
like	O
“	O
cat	O
”	O
,	O
“	O
dog	O
”	O
,	O
and	O
“	O
person	O
”	O
,	O
they	O
are	O
always	O
with	O
great	O
deformation	O
,	O
while	O
there	O
is	O
less	O
deformation	O
of	O
their	O
most	O
representative	O
parts	O
(	O
like	O
head	O
)	O
,	O
so	O
our	O
detector	O
is	O
still	O
inclined	O
to	O
find	O
these	O
parts	O
.	O
An	O
ideal	O
solution	O
is	O
yet	O
wanted	O
because	O
there	O
is	O
still	O
room	O
for	O
improvement	O
.	O
section	O
:	O
Conclusion	O
In	O
this	O
paper	O
,	O
we	O
present	O
a	O
novel	O
algorithm	Method
framework	Method
for	O
weakly	Task
supervised	Task
object	Task
detection	Task
.	O
Different	O
from	O
traditional	O
approaches	O
in	O
this	O
field	O
,	O
our	O
method	O
integrates	O
a	O
basic	O
multiple	Method
instance	Method
detection	Method
network	Method
and	O
multi	O
-	O
stage	O
instance	Method
classifiers	Method
into	O
a	O
single	O
network	O
.	O
Moreover	O
,	O
we	O
propose	O
an	O
online	Method
instance	Method
classifier	Method
refinement	Method
algorithm	Method
to	O
train	O
the	O
proposed	O
network	O
end	O
-	O
to	O
-	O
end	O
.	O
Experiments	O
show	O
substantial	O
and	O
consistent	O
improvements	O
by	O
our	O
method	O
.	O
Our	O
learning	Method
algorithm	Method
is	O
potential	O
to	O
be	O
applied	O
in	O
many	O
other	O
weakly	Task
supervised	Task
visual	Task
learning	Task
tasks	Task
.	O
In	O
the	O
future	O
,	O
we	O
will	O
explore	O
other	O
cues	O
such	O
as	O
instance	O
visual	O
similarity	O
for	O
performing	O
instance	Task
classifier	Task
refinement	Task
better	O
.	O
paragraph	O
:	O
Acknowledgements	O
This	O
work	O
was	O
partly	O
supported	O
by	O
NSFC	O
(	O
No	O
.	O
61503145	O
,	O
No	O
.	O
61572207	O
,	O
No	O
.	O
61573160	O
)	O
and	O
the	O
CAST	O
Young	O
Talent	O
Supporting	O
Program	O
.	O
bibliography	O
:	O
References	O
Supplementary	O
Material	O
Here	O
are	O
the	O
supplementary	O
materials	O
for	O
“	O
Multiple	Method
Instance	Method
Detection	Method
Network	Method
with	O
Online	Method
Instance	Method
Classifier	Method
Refinement	Method
”	O
.	O
We	O
provide	O
detailed	O
per	O
-	O
class	O
results	O
on	O
VOC	O
2012	Material
,	O
and	O
some	O
visualization	O
comparisons	O
among	O
the	O
WSDDN	Method
,	O
the	O
WSDDN	Method
+	Method
context	Method
,	O
and	O
our	O
method	O
(	O
OICR	Method
)	O
.	O
section	O
:	O
Per	O
-	O
class	O
results	O
on	O
VOC	O
2012	Material
The	O
detailed	O
per	O
-	O
class	O
results	O
on	O
VOC	O
2012	Material
can	O
be	O
viewed	O
in	O
Supplementary	O
Table	O
[	O
reference	O
]	O
and	O
Supplementary	O
Table	O
[	O
reference	O
]	O
.	O
Obviously	O
our	O
method	O
outperforms	O
the	O
previous	O
state	O
-	O
of	O
-	O
the	O
-	O
art	O
by	O
a	O
large	O
margin	O
.	O
Similar	O
to	O
results	O
on	O
VOC	Material
2007	Material
,	O
our	O
results	O
are	O
better	O
than	O
for	O
rigid	O
objects	O
such	O
as	O
“	O
bicycle	O
”	O
,	O
“	O
car	O
”	O
,	O
and	O
“	O
motorbike	O
”	O
,	O
but	O
worse	O
than	O
for	O
non	O
-	O
rigid	O
objects	O
“	O
cat	O
”	O
,	O
“	O
dog	O
”	O
,	O
and	O
“	O
person	O
”	O
.	O
This	O
is	O
because	O
non	O
-	O
rigid	O
objects	O
are	O
always	O
with	O
great	O
deformation	O
.	O
Our	O
method	O
tends	O
to	O
detect	O
the	O
most	O
discriminative	O
parts	O
of	O
these	O
objects	O
(	O
like	O
head	O
)	O
.	O
The	O
considers	O
more	O
context	O
information	O
thus	O
can	O
deal	O
with	O
these	O
classes	O
better	O
.	O
section	O
:	O
Visualization	Task
comparisons	O
We	O
show	O
some	O
visualization	O
comparisons	O
among	O
the	O
WSDDN	Method
,	O
the	O
WSDDN	Method
+	Method
context	Method
,	O
and	O
our	O
method	O
in	O
Supplementary	O
Fig	O
.	O
[	O
reference	O
]	O
.	O
From	O
this	O
visualization	O
and	O
results	O
from	O
tables	O
,	O
we	O
can	O
observe	O
that	O
for	O
classes	O
such	O
as	O
aeroplane	O
,	O
bike	O
,	O
car	O
,	O
,	O
our	O
method	O
tends	O
to	O
provide	O
more	O
accurate	O
detections	O
,	O
whereas	O
other	O
two	O
methods	O
sometimes	O
fails	O
to	O
produce	O
boxes	O
that	O
are	O
overlarge	O
or	O
only	O
contain	O
parts	O
of	O
objects	O
(	O
the	O
first	O
four	O
rows	O
in	O
Supplementary	O
Fig	O
.	O
[	O
reference	O
]	O
)	O
.	O
But	O
for	O
some	O
classes	O
such	O
as	O
person	O
,	O
our	O
method	O
always	O
fails	O
to	O
detect	O
only	O
parts	O
of	O
objects	O
(	O
the	O
fifth	O
row	O
in	O
Supplementary	O
Fig	O
.	O
[	O
reference	O
]	O
)	O
.	O
Because	O
considering	O
context	O
information	O
sometimes	O
help	O
the	O
detection	Task
(	O
as	O
in	O
WSDDN	Task
+	Task
context	Task
)	O
,	O
we	O
believe	O
our	O
method	O
can	O
be	O
further	O
improved	O
by	O
incorporating	O
context	O
information	O
into	O
our	O
framework	O
.	O
All	O
these	O
three	O
methods	O
(	O
actually	O
almost	O
all	O
weakly	Task
supervised	Task
object	Task
detection	Task
methods	O
)	O
suffers	O
from	O
two	O
problems	O
:	O
producing	O
boxes	O
that	O
not	O
only	O
contain	O
the	O
target	O
object	O
but	O
also	O
include	O
their	O
adjacent	O
similar	O
objects	O
,	O
or	O
only	O
detecting	O
parts	O
of	O
object	O
for	O
objects	O
with	O
deformation	O
(	O
the	O
last	O
row	O
in	O
Supplementary	O
Fig	O
.	O
[	O
reference	O
]	O
)	O
.	O
An	O
ideal	O
solution	O
for	O
these	O
problems	O
is	O
yet	O
wanted	O
.	O
